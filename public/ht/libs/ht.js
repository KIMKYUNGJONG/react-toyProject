!function(i,E,M){"use strict";function G(){this.el=[1,0,0,0,1,0,0,0,1]}var D="ht";if(!i[D]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),i.performance&&i.performance.now||function(){var R=Date.now();i.performance||(i.performance={}),i.performance.now=function(){return Date.now()-R}}();for(var L=Date.now(),c=16,s=["ms","moz","webkit","o"],C=0;C<s.length&&!i.requestAnimationFrame;++C)i.requestAnimationFrame=i[s[C]+"RequestAnimationFrame"],i.cancelAnimationFrame=i[s[C]+"CancelAnimationFrame"]||i[s[C]+"CancelRequestAnimationFrame"];i.requestAnimationFrame||(i.requestAnimationFrame=function(T){var s=Date.now(),S=c+L-s;return 0>S&&(S=0),L=s,i.setTimeout(function(){L=Date.now(),T(performance.now())},S)}),i.cancelAnimationFrame||(i.cancelAnimationFrame=function(b){return i.clearTimeout(b)}),E.assign===M&&(E.assign=function(U){if(U===M||null===U)throw new TypeError("Cannot convert undefined or null to object");for(var r=E(U),N=1;N<arguments.length;N++){var d=arguments[N];if(d!==M&&null!==d)for(var l in d)E.prototype.hasOwnProperty.call(d,l)&&(r[l]=d[l])}return r})}();var j=i.document,a=null,w=i[D]={},H=i[D+"config"],n=w.Default=H&&H.Default||{},P=w.Style=H&&H.Style||{},T=w.Attr=H&&H.Attr||{},S=w.Color=H&&H.Color||{},C=w.IsGetter=H&&H.IsGetter||{};!function(){var j=!1;try{var g=E.defineProperty({},"passive",{get:function(){j=!0}});i.addEventListener("test",g,g),i.removeEventListener("test",g,g)}catch(Q){j=!1}n.passiveSupported=j}();var L,U,A,c,K=n.passiveSupported,Y=n.eventListenerOptionsFalse=K?{passive:!1,capture:!1}:!1,v=n.eventListenerOptionsTrue=K?{passive:!1,capture:!0}:!0,B=Math,J=B.round,R=B.floor,b=B.ceil,l=B.sqrt,t=B.max,p=B.min,y=B.abs,s=B.cos,I=B.acos,N=B.sin,g=B.pow,k=B.asin,W=B.PI,O=2*W,Z=W/2,X=B.tan,x=B.atan2,f=B.random,o=B.log,d=!1,V=!1,Q=i.parseInt||global.parseInt,F="2019-09-15",h=i.navigator?i.navigator.platform.indexOf("Win")>-1:!1,z=function(C){return C*C},_=i.setTimeout,$=i.clearTimeout,q=i.location,m=i.navigator?i.navigator.userAgent.toLowerCase():"",u=function(S){return S.test(m)},e=u(/msie/),r=u(/msie/)||u(/trident/),Gd=u(/msie 10/),rk=u(/edge/),wi=u(/firefox/),er=u(/mac/),jl=n.isTouchable===M?h?!1:j?"ontouchend"in j:!1:n.isTouchable,Mp="default",hn="single",xb="multiple",xr="front",Th="back",Ul="left",Te="right",rr="top",tf="bottom",Ho="center",Or="eye",rq="middle",Wh="east",Sn="west",Mr="north",ik="none",$h="px",Cm="absolute",Sj="border",gi="triangle",vn="rect",Sk="circle",ye="cylinder",Of="shape",Ii="items",Vm="normal",Rp="remove",Hg="clear",np="width",Kk="height",zo="ingroup",Yi="check",xk="uncheck",mk="radio",qh="radioOn",pf="radioOff",uf="points",Bc="values",bp="series",Ck="body",Hj="label",Kf="label2",Jd="note",Re="note2",bf="icons",ab="labelFont",nc="labelColor",Hl="labelSelectColor",Ag="note.expanded",Ve="note2.expanded",vg="edge.expanded",tk="edge.points",dg="edge.type",cj="rotation",de="hidden",Wm="visible",no="tuv",Er="no",ej="draw",kd="select",Tq="currentSubGraph",An="selectBackground",Hh="autoMakeVisible",ai="autoHideScrollBar",yf="scrollBarColor",vr="scrollBarSize",ro="indent",zl="rowHeight",Cb="columnLineColor",Jg="rowLineColor",xj="columnLineVisible",Eo="rowLineVisible",Fm="visibleFunc",qk="expandIcon",ob="collapseIcon",dl="checkMode",Cr="sortFunc",_g="editable",tj="batchEditable",Dq="tristate",hd="asc",Ur="desc",Bk="position",ek="elevation",ld="children",Uk="translateX",Si="translateY",Yo="dataModel",Yn="maxSize",yi="state",Pj="shape3d",kn="shape3d.resolution",gb="shape3d.visible",aq="shape3d.from.visible",cs="shape3d.to.visible",ff="shape3d.top.visible",De="shape3d.bottom.visible",hl="repeat.uv.length",Mg="serializeValue",fc="deserializeValue",ck="centerUniform",um="uniform",jq="rgba(255,255,255,0)",cf="style",Vr="attr",oo="field",Ce="string",kg="boolean",Be="color",Fh="int",Qh="number",be="ew-resize",ug="ns-resize",kk="pointer",Uo="auto",mo="mousedown",gd="mousemove",Kn="mouseup",Jr="mouseout",fh="touchstart",Wj="touchmove",cm="touchend",wm="keydown",zi="keyup",Ch=["DOMMouseScroll","mousewheel"],Mk=wi?Ch[0]:Ch[1],zj=jl?[fh,Wj,cm,wm,zi,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[wm,zi,"keypress","input",mo,gd,Kn,Jr,Mk,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],we=a,fs=a,_c=a,Ml=Kn.length,qd=function(){_c&&($(_c.timeout),_c=a)},Zj=function(){_c&&jc(_c.e,_c.info)};i.addEventListener&&(jl||(i.addEventListener(Jr,function(){qd()},Y),i.addEventListener(Mk,function(){xl()},Y)),i.addEventListener(zi,function(R){91===R.keyCode?jj={}:delete jj[R.keyCode]},v),i.addEventListener(wm,function(t){jj[t.keyCode]=!0},v),i.addEventListener("blur",function(){jj={}},Y));var ip,lh,kj,sn=0,Kd=a,fm=function(j,f){var X=_(function(){delete Kd[X],os(Kd)&&(Kd=a),j()},f);return X},qr=a,zf=a,hs={},Yc={},ls={},Ah={},Bj={},jj={},dp={},Cd={},ui={},Nr={},Uj=/.json$/,Qi=/^data:image\/svg\+xml/,po={},Wo=[],si={},Vo=a,qs=a,is=function(){},db=function(){throw"Oops!"},ak=[0,0,0],Ob={x:0,y:0,width:0,height:0},Pe=a,Ek=a,Vq=a,$m=function(x,J){Yc[x]=J,J&&J.comps&&!J.uuid&&(J.uuid=w.Math.generateUUID()),cq[x]&&(J.cacheRule=cq[x],delete cq[x])},Br=function(p){Ek&&!p._72O&&(Vq||(Vq={}),Vq[p._72O=dj()]=p),ip!=a?ol()<.05&&c&&!lh&&(Dh=qd):Dh=tq},$q=function(Q,K,O,o){Ek||(Ek={});var F=Ek[Q];if(F){if(F.url===K)return;F.image?(F.image.onload=is,F.image.onerror=is):F.request&&(F.request.onload=is,F.request.onerror=is)}if(Uj.test(K)){var p=new Gm;if(Ek[Q]={request:p,url:K},K=n.beforeLoadURL(K),K.data){var M=n.parse(K.data);ar(Q,M),n.handleImageLoaded(Q,M)}else{p.onload=function(){if(200===this.status||0===this.status){var s=n.parse(p.getResponseText());ar(Q,s),n.handleImageLoaded(Q,s)}else ar(Q,n.handleUnfoundImage(Q,K)||a)},p.onerror=function(){ar(Q,n.handleUnfoundImage(Q,K)||a)};var v={};v.url=encodeURI(K),v.sync=!1,p.send(v)}}else{var M=new Image;Ek[Q]={image:M,url:K},/^data:image/.test(K)||(K=n.beforeLoadURL(K),K=n.appendTimeStamp(K),K=encodeURI(K),n.crossOrigin&&(M.crossOrigin=n.crossOrigin)),n.convertImageSrc(K,function(x){r&&(K.toLowerCase().indexOf(".svg")>0||Qi.test(K))?(j.body.appendChild(M),M.style.visibility="hidden",M.onload=function(){_(function(){if(O&&(M.width=O),o&&(M.height=o),!M.width||!M.height){var q=M.width||M.clientWidth,w=M.height||M.clientHeight;M.width=q,M.height=w}n.handleImageLoaded(Q,M),ar(Q,M),j.body.removeChild(M),M.style.visibility=""},180)},M.onerror=function(){ar(Q,n.handleUnfoundImage(Q,K)||a),j.body.removeChild(M),M.style.visibility=""}):(M.onload=function(){O&&(M.width=O),o&&(M.height=o),n.handleImageLoaded(Q,M),ar(Q,M)},M.onerror=function(){ar(Q,n.handleUnfoundImage(Q,K)||a)}),M.src=x})}},ar=function(W,n){if($m(W,n),delete Ek[W],os(Ek)&&(Ek=a,Vq)){for(var q in Vq){var N=Vq[q];N._2O&&N._2O[W]&&(N.deleteTexture(W),delete N._2O[W]),N.invalidateAll&&N.invalidateAll(M,"imageLoaded",W),N.redraw&&N.redraw(),N.iv(),delete N._72O}Vq=a}if(n&&Vq)for(var q in Vq){var N=Vq[q];N.invalidateAll&&N.invalidateAll(M,"imageLoading",W),N.redraw&&N.redraw(),N.iv()}},xd=function(){return o=B&&Date,function(){return i.performance&&i.performance.now?i.performance.now():Date.now()}}(),Oi=function(T,O){O?$(T):i.cancelAnimationFrame(T)},qp=function(c,V,h){return{width:c,height:V,comps:uo(h)?h:[h]}},wh=function(Y,S){return{type:Sk,rect:[Y,S,1.6,1.6],borderWidth:1,borderColor:Lq,gradient:rl,gradientColor:He,background:Lq}},dd=function(U,m){return qp(16,16,{type:gi,rect:[4,4,10,8],background:U,rotation:m?1.57:3.14})},io=function(O,L){return qp(16,16,{type:gi,rect:[4,4,8,7],background:O,rotation:L?3.14:0})},ym=function(p){var o=p._orientation;return"horizontal"===o||"h"===o},vb=function(p,w){var P=a||4,t=a||1,q=a||1;0>P?P=0:P>.25&&(P=.25);var b,x,F,g,$,y,o,X=.5,e=[],c=[],J=[],u=O/q,d=O/t,v=X-P;for(x=0;t>=x;x++)for(g=-W+x*d,y=s(g),$=N(g),b=0;q>=b;b++)F=b*u,o=v+P*y,e.push(s(F)*o,$*P,-N(F)*o),(U=[p,w])&&c.push(b/q,1-x/t);for(x=0;t>x;x++){var C=x*(q+1),M=(x+1)*(q+1);for(b=0;q>b;b++)J.push(C+b,M+b+1,M+b,C+b,C+b+1,M+b+1),Yk.z=Ab.z=[p,w]}},Pq=function(x){var m=2,t=0;for(var f in x)f.length===m&&Q(f,32)===Sq&&(Vo=qs=x[f]),t++;return t},bm=function(E,F,j,Z){return j||(j=jl?5:3,j/=Z||1),{x:E-j,y:F-j,width:2*j,height:2*j}},Pi=function(O,C,D,P){var d=this;C||(C=jl?5:3,D=20,P=20);var $={x:O,y:C,width:D,height:P};if(D)for(var K=0;D>K;K++)if(3===D)P=20;else for(var n=0;P>n;n++)d=i?i:D;var o={x:W,y:2*W};if(Aj($,o)){var x=Kk[0]+rr[0]+Hg[1]+hd.length,V=de[0]+Dq[0]+Hg[1]+Ck.length;lo[Or]=[d[x],d[V]],d[x]=Ip[Or],d[V]=Ip[Pj]}},mp=function(u){return(/ble$/.test(u)||/ed$/.test(u)||C[u]?"is":"get")+u.charAt(0).toUpperCase()+u.slice(1)},Ip=function(l){return"set"+l.charAt(0).toUpperCase()+l.slice(1)},mc=function(W){return typeof W===Ce||W instanceof String},qg=function(D){return typeof D===Qh},tq=function(F){return typeof F===kg},$l=function(V){return V&&"object"==typeof V},bi=function(e){return"function"==typeof e},uo=function(l){return l instanceof Array},Qp=function(W){return W instanceof Yp},_p=function(n){return uo(n)?new Yp(n):n},wc=function(m){return m instanceof uq},wj=function(d){return d instanceof Qc},ni=function(f){return f instanceof Ri},Hp=function(l,v){if(!(l instanceof w.Group))return!1;if(!v)return l.isExpanded();var P=v.getDataUI(l);return P&&P._88I?!0:!1},or=function(_){return _ instanceof Md},kc=function(b){return b&&"IFRAME"===b.tagName},Sb=function(r){return r==a||n.numberDigits==a?r:parseFloat(r.toFixed(n.numberDigits))},ks=function(q,v,Y){var e,Q=v.length;if(Y)for(var g=0;Y>g;g++)if(3===Q)q.push(v[0]),q.push(v[1]),q.push(v[2]);else for(e=0;Q>e;e++)q.push(v[e]);else if(3===Q)q.push(v[0]),q.push(v[1]),q.push(v[2]);else for(e=0;Q>e;e++)q.push(v[e])},nh=function(I){return I?$l(I)?I:{}:!1},jn=function(S,R,n){var J,x=$l(S)?S:S.prototype;for(J in R)n&&x[J]!==M||(x[J]=R[J]);return S},Wc=function(o){return String.fromCharCode(o)},fi=function(I){for(var H,e=0,d="";e<I.length;e++)H=I[I.length-1-e],"%"===H?H="'":"a"===H?H='"':"]"===H&&(H="\\"),d+=Wc(H.charCodeAt(0)-1);return d},Bh=function(V,m,t){V.superClass.constructor.apply(m,t)},os=function(x){for(var V in x)return!1;return!0},Zd=function(y){return y?0===y.length:!0},Je=function(){var G="";return[xk[0],Jg[0],Hj[0]].forEach(function(e){G+=Ip(e).slice(3)}),um=j&&j[G]||ck,function(O,l){return O===l?!0:O.x===l.x&&O.y===l.y&&O.width===l.width&&O.height===l.height}}(),gg=function(h,W,X){return W>h?W:h>X?X:h},Rj=function(s){return 0>s?-1:s>0?1:0},ol=function(){var C=1e4*N(Ml++);return C-R(C)},gl=function(q,U,b){return fp(q.x,q.y,U.x,U.y,b.x,b.y,b.x+b.width,b.y,!0)||fp(q.x,q.y,U.x,U.y,b.x+b.width,b.y,b.x+b.width,b.y+b.height,!0)||fp(q.x,q.y,U.x,U.y,b.x+b.width,b.y+b.height,b.x,b.y+b.height,!0)||fp(q.x,q.y,U.x,U.y,b.x,b.y+b.height,b.x,b.y,!0)},fp=function(V,N,Z,$,s,S,u,A,r){var c=(u-s)*(N-S)-(A-S)*(V-s),j=(A-S)*(Z-V)-(u-s)*($-N);if(0!==j){var k=c/j,U=V+k*(Z-V),e=N+k*($-N);return r&&(U+Un<p(V,Z)||U-Un>t(V,Z)||U+Un<p(s,u)||U-Un>t(s,u)||e+Un<p(N,$)||e-Un>t(N,$)||e+Un<p(S,A)||e-Un>t(S,A))?a:[U,e]}return a},ll=function(p,B,o){if(p&&o)if(B){if(B===cf)return p.getStyle(o);if(B===Vr)return p.getAttr(o);if(B===oo)return p[o]}else if(o=mp(o),p[o])return p[o]();return M},hc=function(l,U,A,G){if(l&&A)if(U){if(U===cf)l.s(A,G);else if(U===Vr)l.a(A,G);else if(U===oo){var S=l[A];l[A]=G,l.fp("f:"+A,S,G)}}else A=Ip(A),l[A]&&l[A](G)},_k=function(Q,S,y){return S&&"top"!==S?"bottom"===S?{x:Q.x,y:Q.y,width:Q.width,height:Q.height*y}:"right"===S?{x:Q.x,y:Q.y,width:Q.width*y,height:Q.height}:"left"===S?{x:Q.x+Q.width*(1-y),y:Q.y,width:Q.width*y,height:Q.height}:void 0:{x:Q.x,y:Q.y+Q.height*(1-y),width:Q.width,height:Q.height*y}},Oq=function(r,x,H,V,i){x&&Qf(r,H,V,1,i,x)},ci=function(U,F,q,n){var A=1-U;return A*A*F+2*U*A*q+U*U*n},Yk=function(e,X,Y,c,J){var F=1-e;return F*F*F*X+3*F*F*e*Y+3*F*e*e*c+e*e*e*J},lc=function(b){var N,Y,C,f,r=0;return b.forEach(function(L){if(N=L.length,N>0)for(Y=L[0],f=1;N>f;f++)C=L[f],r+=sh(Y,C),Y=C}),r},fq=function(t,V,l){var z="__"+t,x=function(Y){l.disabled||l["handle_"+t](Y)};l[z]||(l[z]=x,V.addEventListener(t,x,Y))},Xe=function(f,W,b){var j="__"+f,i=b[j];i&&(W.removeEventListener(f,i,Y),delete b[j])},Pl=function(Z,V){var w="_"+V;Z[mp(V)]=function(){return this[w]},Z[Ip(V)]=function(g){var L=this[w];this[w]=g,this.fp(V,L,g)}},$b=function(W){return E.create(W)},ue=function(c){if(!c.element){var O,R;(O=c.textField)?R=xi(Ed.TextField,O):(O=c.textArea)?R=xi(Ed.TextArea,O):(O=c.button)?R=xi(Ed.Button,O):(O=c.comboBox)?R=xi(Ed.ComboBox,O):(O=c.checkBox)?R=xi(Ed.CheckBox,O):(O=c.radioButton)?R=xi(Ed.RadioButton,O):(O=c.slider)?R=xi(Ed.Slider,O):(O=c.colorPicker)?R=xi(Ed.ColorPicker,O):(O=c.image)&&(R=xi(Ed.Image,O)),R&&(c.element=R)}},Ll=function(F,R){var K=lj(F);return K._ht=R,K},lj=function(u,t){var R=j.createElement("div"),L=R.style;return R.tabIndex=-1,R.onkeydown=gh,L.msTouchAction=ik,Vp(R,a,0),jl&&L.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",a),u&&(L.overflow=de),t&&eg(t,R),R},Hd=function(r,$){var z=j.createElement("canvas"),G=z.style;return G.msTouchAction=ik,$||(G.pointerEvents=ik),Vp(z,a,0),r&&eg(r,z),z},Vp=function(M,G,Z){var v=M.style;v.border=G?G+" solid 1px":0,v.outline=0,v.padding=Z?"0 "+Z+$h:0,ke(M)},ke=function(p){var T=p.style;T.position=Cm,T.margin=0,T.setProperty("box-sizing","border-box",a),T.setProperty("-moz-box-sizing","border-box",a)},En=function(u,$,p,N){N||(N=ee),$!=a&&(u.width=$*N,u.style.width=$+$h),p!=a&&(u.height=p*N,u.style.height=p+$h)},eg=function(F,n,s){F.appendChild(n),s&&(n.style.position=Cm)},en=function(s,y){y.split||(y+="");for(var n,r=y.split("\n"),h=0,u=r.length,K=0;u>K;K++){var R=kr(s.font,r[K]);R.width>h&&(h=R.width),n||(n=R.height)}return s.ss=r,{width:h,height:n*u}},mh=function(D,$,I,p,x,X){var J=$.length;if(1===J)Le(D,$[0],I,p,x);else for(var N=I.height/J,y={x:I.x,y:I.y,width:I.width,height:N},o=0;o<$.length;o++)X?Fp(D,$[o],p,x,y.x,y.y,y.width,y.height,X):Le(D,$[o],y,p,x),y.y+=N},Le=function(T,v,O,S,c){T.font=S?S:ti,T.fillStyle=c?c:vc,T.textAlign=Ho,T.textBaseline=rq;var W,$;O?O.width===M?(W=O.x,$=O.y):(W=O.x+O.width/2,$=O.y+O.height/2):(W=0,$=0),T.fillText(v,J(W),J($))},Nk=function(X){X.getView&&(X=X.getView());var d=X.offsetWidth||X.scrollWidth;return!d&&X.style.width&&(d=Q(X.style.width)),d},Eb=function(c){c.getView&&(c=c.getView());var R=c.offsetHeight||c.scrollHeight;return!R&&c.style.height&&(R=Q(c.style.height)),R},bj=function(f,W,c){var X=W[0].toUpperCase()+W.substring(1,W.length);f["webkit"+X]=c,f["moz"+X]=c,f["ms"+X]=c,f["o"+X]=c,f[W]=c},Vk=function(){var _=function(l){gh(l),l.stopPropagation()},u=function(u){gh(u)},S=jl?[fh]:[wm,mo];return function(e,L){var o=lj(),k=o.style;return k.backgroundColor=n.disabledBackground,e&&(k.backgroundImage="url("+e+")",k.backgroundPosition="50% 50%",k.backgroundRepeat="no-repeat no-repeat"),L===!1?S.forEach(function(W){o.addEventListener(W,u,Y)}):S.forEach(function(f){o.addEventListener(f,_,Y)}),o}}(),rm=function(z){var J=z.getContext("2d");return J.save(),J.lineCap=Tb,J.lineJoin=$i,J},Dh=function(n,g,o,j){Hc(n,g*ee,o*ee),j*=ee,1!==j&&n.scale(j,j)},Hc=function(h,d,G){h.translate(d,G)},As=function(i,u){u&&i.rotate(u)},cn=function(H,c,G){c===M&&(c=1),G===M&&(G=1),(1!==c||1!==G)&&H.scale(c,G)},Zh=!1,Tp=function(N){var W=j.activeElement;if(j.activeElement!==N){W&&W.forceOnblur&&W.forceOnblur();for(var f=[],U=N.parentNode;U;)f.push([U,U.scrollLeft,U.scrollTop]),U=U.parentNode;if(!Zh){var g=[],X=[];try{for(var r=i.parent,S=i;r!==S;)g.push([r,r.scrollX,r.scrollY]),S=r,r=i.parent;var Y=i.frameElement;if(Y)for(var F=Y.parentNode;F;)X.push([F,F.scrollLeft,F.scrollTop]),F=F.parentNode}catch(h){Zh=!0}}if(jl)N.focus();else{var x=bn(),B=x.target;N.focus(),B.scrollLeft=x.left,B.scrollTop=x.top}f.forEach(function(p){p[0].scrollLeft=p[1],p[0].scrollTop=p[2]}),Zh||(g.forEach(function(T){T[0].scrollTo(T[1],T[2])}),X.forEach(function(q){q[0].scrollLeft=q[1],q[0].scrollTop=q[2]}))}},Jb=function(Y){return Y&&Y.getView?Y.getView():Y},Fl=function(U,x,y,g,r){if(2===arguments.length&&(y=x.y,g=x.width,r=x.height,x=x.x),U.isSelfViewEvent)U.setX(x),U.setY(y),U.setWidth(g),U.setHeight(r);else{var O=Jb(U),d=O.style;if((j.fullscreenElement||j.mozFullScreenElement||j.webkitFullscreenElement||j.msFullscreenElement)!==O)x!==M&&(d.left=x+$h),y!==M&&(d.top=y+$h),g!==M&&(d.width=g+$h),r!==M&&(d.height=r+$h);else{var J=n.getWindowInfo();d.left=(x=J.left)+$h,d.top=(y=J.top)+$h,d.width=(g=J.width)+$h,d.height=(r=J.height)+$h}U.endEditing&&!jl&&U.endEditing(),U.redraw&&U.redraw(),U.invalidate&&U.invalidate(),U.onLayouted&&U.onLayouted(x,y,g,r),U.fireViewEvent&&U.fireViewEvent("layout")}},Qb=function(q){if(!q.touches)return q;var L=q.touches[0];return L?L:q.changedTouches[0]},xf=function(d){return jl?Qb(d).target:d.target},Dk=function(k){n.popup&&n.popup.close(),n.popup=k},Ji=a,bd=function(A){Ji.handleWindowTouchMove(A)},Pg=function(u){Ji.handleWindowTouchEnd(u),i.removeEventListener(Wj,bd,Y),i.removeEventListener(cm,Pg,Y),Ji=a},td=function(s){Ji.handleWindowMouseMove(s)},Tk=function(J){Ji.handleWindowMouseUp(J),i.removeEventListener(gd,td,Y),i.removeEventListener(Kn,Tk,Y),Ji=a},Qd=function(o){return 1===wr(o)},sq=function(_,C){return C?C.keyCode===_:jj[_]},qi=function(E){return Zl(E)&&sq(65,E)},xg=function(K){return sq(46,K)||sq(8,K)},dk=function(o){return function(t){return t?t.keyCode===o:jj[o]}},Sq=573,Xg=[65,83,68,87,37,38,39,40,32,13,27],vi=dk(Xg[0]),$d=dk(Xg[1]),ho=dk(Xg[2]),zp=dk(Xg[3]),Wn=dk(Xg[4]),zb=dk(Xg[5]),Vd=dk(Xg[6]),Ym=dk(Xg[7]),Lh=dk(Xg[8]),as=dk(Xg[9]),_i=dk(Xg[10]),Cj={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},sp=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,29,313],wo=a,fd=a,sm=function(l,I){wo||(wo=Hd()),En(wo,l,I,1);var G=rm(wo);return G.clearRect(0,0,l,I),G},Mj=function(){var f,e={};for(var _ in i){var c=xb.length;if(_.length==c&&_[0]===xb[2]&&_[1]===ik[1]&&_[4]===xb[3]&&_[5]===xb[4]&&_.substr(c-2)===ik[1]+ik[2]){var M=i[_];for(var E in M)E.length===c&&E.substr(0,3)===Te[3]+Rp[3]+kd[0]&&E.substr(c-2)===xb[0]+Jd[3]&&(Ch=M[E])}}return function(Q){var J,K=e[Q];return K||(f||(f=Hd(),En(f,1,1,1)),J=f.getContext("2d"),J.clearRect(0,0,1,1),Qf(J,0,0,1,1,Q),K=J.getImageData(0,0,1,1).data,K=e[Q]=[K[0],K[1],K[2],K[3]]),K}}(),fj=function(R){if(!mc(R))return R;var z=Mj(R);return z.CA||(z.CA=[z[0]/255,z[1]/255,z[2]/255,z[3]/255]),z.CA},jb=function(y,D,f,J,x){var F=Hd();F.width=f,F.height=J;var d=F.getContext("2d");d.drawImage(y,0,0,f,J);try{for(var P=d.getImageData(0,0,f,J),U=P.data,E=0,G=U.length;G>E;E+=4){var Y=U[E+0],I=U[E+1],n=U[E+2],S=U[E+3];"override_a"===x?U[E+3]=255*D[3]:"override_rgb"===x?(U[E+0]=255*D[0],U[E+1]=255*D[1],U[E+2]=255*D[2]):"override"===x?(U[E+0]=255*D[0],U[E+1]=255*D[1],U[E+2]=255*D[2],U[E+3]=255*D[3]):(U[E+0]=D[0]*Y,U[E+1]=D[1]*I,U[E+2]=D[2]*n,U[E+3]=D[3]*S)}d.putImageData(P,0,0)}catch(v){return y}return F},lo=function(w,C,n){return C&&(C="miter"===n?8*C+20:C+1,w&&di(w,C)),C},Pd=function(W,o){if(o){var J=new Lp(o),c=W.width/2,u=W.height/2,n=rh([J.tf(-c,-u),J.tf(c,-u),J.tf(c,u),J.tf(-c,u)]);return n.x+=W.x+c,n.y+=W.y+u,n}return W},bg=function(p,T,D,f,o,k,a,e){f*=Math.PI/180;var M={x:Math.cos(f)*(p.x-a.x)/2+Math.sin(f)*(p.y-a.y)/2,y:-Math.sin(f)*(p.x-a.x)/2+Math.cos(f)*(p.y-a.y)/2},A=Math.pow(M.x,2)/Math.pow(T,2)+Math.pow(M.y,2)/Math.pow(D,2);A>1&&(T*=Math.sqrt(A),D*=Math.sqrt(A));var S=(o==k?-1:1)*Math.sqrt((Math.pow(T,2)*Math.pow(D,2)-Math.pow(T,2)*Math.pow(M.y,2)-Math.pow(D,2)*Math.pow(M.x,2))/(Math.pow(T,2)*Math.pow(M.y,2)+Math.pow(D,2)*Math.pow(M.x,2)));isNaN(S)&&(S=0);var L={x:S*T*M.y/D,y:S*-D*M.x/T},v={x:(p.x+a.x)/2+Math.cos(f)*L.x-Math.sin(f)*L.y,y:(p.y+a.y)/2+Math.sin(f)*L.x+Math.cos(f)*L.y},j=function(w){return Math.sqrt(Math.pow(w[0],2)+Math.pow(w[1],2))},r=function(W,N){return(W[0]*N[0]+W[1]*N[1])/(j(W)*j(N))},C=function(D,m){return(D[0]*m[1]<D[1]*m[0]?-1:1)*Math.acos(r(D,m))},u=C([1,0],[(M.x-L.x)/T,(M.y-L.y)/D]),X=[(M.x-L.x)/T,(M.y-L.y)/D],E=[(-M.x-L.x)/T,(-M.y-L.y)/D],W=C(X,E);r(X,E)<=-1&&(W=Math.PI),r(X,E)>=1&&(W=0);var r=T>D?T:D,y=T>D?1:T/D,g=T>D?D/T:1;if(null==e){var Q={x:0,y:0,width:0,height:0};di(Q,r),Q.x*=y,Q.width*=y,Q.y*=g,Q.height*=g;var Z=new Lp(f);return Q=rh([Z.tf(Q.x,Q.y),Z.tf(Q.x+Q.width,Q.y),Z.tf(Q.x+Q.width,Q.y+Q.height),Z.tf(Q.x,Q.y+Q.height)]),Q.x+=v.x,Q.y+=v.y,[{x:Q.x,y:Q.y},{x:Q.x+Q.width,y:Q.y},{x:Q.x+Q.width,y:Q.y+Q.height},{x:Q.x,y:Q.y+Q.height}]}e.translate(v.x,v.y),e.rotate(f),e.scale(y,g),e.arc(0,0,r,u,u+W,1-k),e.scale(1/y,1/g),e.rotate(-f),e.translate(-v.x,-v.y)},yh=function(x,e){x&&x.beginPath();for(var i,A,Y,M=[],c=function(d){for(var I,Q=/(\-{0,1}[\d\.]+)/gi,w=[];I=Q.exec(d);)w.push(parseFloat(I[0]));return w},U=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,q={x:0,y:0};i=U.exec(e);){var m=i[0],w=m.substr(0,1);if("M"===w||"m"===w){for(var u=c(m),I=0;I<u.length;I+=2){var y=u[I],F=u[I+1];"m"===w&&(y+=q.x,F+=q.y),x&&x.moveTo(y,F),M.push({x:y,y:F}),q.x=y,q.y=F}A=Y=null}else if("H"===w||"h"===w){for(var u=c(m),I=0;I<u.length;I+=1){var y=u[I];"h"===w&&(y+=q.x),x&&x.lineTo(y,q.y),M.push({x:y,y:q.y}),q.x=y}A=Y=null}else if("C"===w||"c"===w){for(var u=c(m),I=0;I<u.length;I+=6){var d=u[I],Q=u[I+1],b=u[I+2],h=u[I+3],y=u[I+4],F=u[I+5];"c"===w&&(d+=q.x,Q+=q.y,b+=q.x,h+=q.y,y+=q.x,F+=q.y),x&&x.bezierCurveTo(d,Q,b,h,y,F),M.push({x:d,y:Q}),M.push({x:b,y:h}),M.push({x:y,y:F}),q.x=y,q.y=F}A=[d,Q,b,h,y,F],Y=null}else if("S"===w||"s"===w){for(var u=c(m),I=0;I<u.length;I+=4){var d,Q;A?(d=2*A[4]-A[2],Q=2*A[5]-A[3]):(d=q.x,Q=q.y);var b=u[I],h=u[I+1],y=u[I+2],F=u[I+3];"s"===w&&(b+=q.x,h+=q.y,y+=q.x,F+=q.y),x&&x.bezierCurveTo(d,Q,b,h,y,F),M.push({x:d,y:Q}),M.push({x:b,y:h}),M.push({x:y,y:F}),q.x=y,q.y=F}A=[d,Q,b,h,y,F],Y=null}else if("Q"===w||"q"===w){for(var u=c(m),I=0;I<u.length;I+=4){var d=u[I],Q=u[I+1],y=u[I+2],F=u[I+3];"q"===w&&(d+=q.x,Q+=q.y,y+=q.x,F+=q.y),x&&x.quadraticCurveTo(d,Q,y,F),M.push({x:d,y:Q}),M.push({x:y,y:F}),q.x=y,q.y=F}A=null,Y=[d,Q,y,F]}else if("T"===w||"t"===w){for(var u=c(m),I=0;I<u.length;I+=2){var d,Q;Y?(d=2*Y[2]-Y[0],Q=2*Y[3]-Y[1]):(d=q.x,Q=q.y);var y=u[I],F=u[I+1];"t"===w&&(y+=q.x,F+=q.y),x&&x.quadraticCurveTo(d,Q,y,F),M.push({x:d,y:Q}),M.push({x:y,y:F}),q.x=y,q.y=F}A=null,Y=[d,Q,y,F]}else if("V"===w||"v"===w){for(var u=c(m),I=0;I<u.length;I+=1){var F=u[I];"v"===w&&(F+=q.y),x&&x.lineTo(q.x,F),M.push({x:q.x,y:F}),q.y=F}A=Y=null}else if("L"===w||"l"===w){for(var u=c(m),I=0;I<u.length;I+=2){var y=u[I],F=u[I+1];"l"===w&&(y+=q.x,F+=q.y),x&&x.lineTo(y,F),M.push({x:y,y:F}),q.x=y,q.y=F}A=Y=null}else if("A"===w||"a"===w){for(var u=c(m),I=0;I<u.length;I+=7){var j=u[I],R=u[I+1],p=u[I+2],g=u[I+3],W=u[I+4],y=u[I+5],F=u[I+6];"a"===w&&(y+=q.x,F+=q.y);var o=bg(q,j,R,p,g,W,{x:y,y:F},x);o&&(M=M.concat(o)),q.x=y,q.y=F}A=Y=null}var E=m.substr(m.length-1);("z"===E||"Z"===E)&&x&&x.closePath()}return M},em=function(s,T){var b,J,L="L"===T[0],x=T.length;s.save(),L?(s.transform(T[5],T[6],T[7],T[8],T[9],T[10]),b=s.createLinearGradient(T[1],T[2],T[3],T[4]),J=11):(s.transform(T[7],T[8],T[9],T[10],T[11],T[12]),b=s.createRadialGradient(T[1],T[2],T[3],T[4],T[5],T[6]),J=13);for(var Q=s.compGray;x>J;)b.addColorStop(T[J],Q?n.toGrayColor(T[J+1]):T[J+1]),J+=2;s.fillStyle=b},Ab=function(C,E){var W=C.s("shape.gradient.pack");if(W){for(var x=W.length,e=new Array(x),i=0;x>i;i++)e[i]=W[i];var H,F,h,Q,f,z,Y,w,q,j,X,I,y,T="L"===e[0];H=T?5:7,F=e[H],h=e[H+1],Q=e[H+2],f=e[H+3],z=e[H+4],Y=e[H+5],w=E[0],q=E[1],j=E[2],X=E[3],I=E[4],y=E[5],e[H]=w*F+j*h,e[H+1]=q*F+X*h,e[H+2]=w*Q+j*f,e[H+3]=q*Q+X*f,e[H+4]=w*z+j*Y+I,e[H+5]=q*z+X*Y+y,C.s("shape.gradient.pack",e)}},Ok=function(W,b,l,L){var w=!1;if(W.beginPath?W.beginPath():w=!0,Qp(b)&&(b=b._as),Qp(l)&&(l=l._as),l&&l.length){for(var z,t,B,D,F=0,c=0,V=l.length;V>c;c++)z=l[c],1===z?(t=b[F++],W.moveTo(t.x,w?-t.y:t.y)):2===z?(t=b[F++],W.lineTo(t.x,w?-t.y:t.y)):3===z?(t=b[F++],B=b[F++],W.quadraticCurveTo(t.x,w?-t.y:t.y,B.x,w?-B.y:B.y)):4===z?(t=b[F++],B=b[F++],D=b[F++],W.bezierCurveTo(t.x,w?-t.y:t.y,B.x,w?-B.y:B.y,D.x,w?-D.y:D.y)):5===z&&W.closePath();L&&5!==z&&W.closePath()}else{var g,m,X,I=b.length;if(I>0){for(g=b[0],W.moveTo(g.x,w?-g.y:g.y),m=1;I>m;m++)X=b[m],W.lineTo(X.x,w?-X.y:X.y);L&&W.closePath()}}},Cl=function(L,m,Y,R){if(Qp(L)&&(L=L._as),Qp(m)&&(m=m._as),m&&m.length){Y=Y||ko;for(var g,r,t,e,n,H,P,W,l=[],z=a,U=0,Z=0,N=m.length;N>Z;Z++)if(g=m[Z],1===g)l.push(z=[]),z.push(L[U++]);else if(2===g)z.push(L[U++]);else if(3===g){for(r=z[z.length-1],t=L[U++],e=L[U++],H=1;Y>H;H++)P=ci(H/Y,r.x,t.x,e.x),W=ci(H/Y,r.y,t.y,e.y),z.push({x:P,y:W,b:!0});z.push(e)}else if(4===g){for(r=z[z.length-1],t=L[U++],e=L[U++],n=L[U++],H=1;Y>H;H++)P=Yk(H/Y,r.x,t.x,e.x,n.x),W=Yk(H/Y,r.y,t.y,e.y,n.y),z.push({x:P,y:W,b:!0});z.push(n)}else 5===g&&z.push(z[0]);return R&&5!==g&&z&&z.length>2&&z.push(z[0]),l}return R&&L.length>2&&(L=L.slice(),L.push(L[0])),L?[L]:[]},kq=function(w,d,Q,t,Z,A){var L,e,R,G=Mj(d),J=t,F=G[0],n=G[1],M=G[2];if(Q){var Y=Mj(Q);L=Y[0]-F,e=Y[1]-n,R=Y[2]-M}else L=255-F,e=255-n,R=255-M;for(A||(A=t>10?1:.5,A=1>Z?p(A/Z,2):A),w.save(),w.shadowOffsetX=0,w.shadowOffsetY=0,w.shadowBlur=0,w.shadowColor=0;(t-=A)>0;){var D=1-t/J,k=F+L*D,E=n+e*D,B=M+R*D;k=p(b(k),255),E=p(b(E),255),B=p(b(B),255),w.strokeStyle="rgb("+k+","+E+","+B+")",w.lineWidth=t,w.stroke()}w.restore()},Jk=function(){var x={};return function(n,g){var $=n+"-"+g,L=x[$];if(L)return L;var a,r,J,V=Mj(n);return 0>g?(g=(100+g)/100,a=b(V[0]*g),r=b(V[1]*g),J=b(V[2]*g)):(g/=100,a=V[0],r=V[1],J=V[2],a+=(255-a)*g,r+=(255-r)*g,J+=(255-J)*g,a=p(b(a),255),r=p(b(r),255),J=p(b(J),255)),x[$]="rgb("+a+","+r+","+J+")"}}(),Qf=function(d,x,F,u,B,c){c&&(d.fillStyle=c),d.beginPath(),d.rect(x,F,u,B),d.fill()},im=function(l,W,M,x,N,G,F){l.beginPath(),Zk[W](l,M.x,M.y,M.width,M.height,x,N,G,F)},wf=function(Z,f,x,X,I){var S=Zk[x];Z.fillStyle=S?S(Z,f,X?X:He,I.x,I.y,I.width,I.height):f},Gr=function(z,R,r,Q,L,Y){try{if(!R.tagName&&R.comps){R._cacheImage_||(R._cacheImage_={});var Z;Z="override"===Q?"colors_override":"override_rgb"===Q?"colors_override_rgb":"override_a"===Q?"colors_override_a":"colors",R._cacheImage_[Z]||(R._cacheImage_[Z]={__count__:0});var c=R._cacheImage_[Z][r];c||(R._cacheImage_[Z].__count__>n.imageCacheThreshold&&(R._cacheImage_[Z]={__count__:0}),c=w.Default.toCanvas(R,Uh(R),zq(R),null,L,Y,r,null,Q),R._cacheImage_[Z][r]=c,R._cacheImage_[Z].__count__++),R=c}z.fillStyle=z.createPattern(R,"repeat")}catch(D){z.fillStyle="black"}},In=function(U,v,k,G,w,y,J){U.save(),U.translate(v,k),U.scale(1,J/y),U.arc(0,0,y,G,w),U.restore()},wl=function(J,k,t,e,S,a,Y,v){var c,i,r,O,q,u,L,w,Q,Z,A;if(y(S)>2*W&&(S=2*W),q=b(y(S)/(W/4)),c=S/q,i=-c,r=-e,q>0){u=k+s(e)*a,L=t+N(-e)*Y,v?J.lineTo(u,L):J.moveTo(u,L);for(var M=0;q>M;M++)r+=i,O=r-i/2,w=k+s(r)*a,Q=t+N(r)*Y,Z=k+s(O)*(a/s(i/2)),A=t+N(O)*(Y/s(i/2)),J.quadraticCurveTo(Z,A,w,Q)}},pd=function(i,z,_,q,k,O,D,d,u){6===arguments.length&&(D=O,d=O,u=O);var f=z+q,g=_+k,c=k>q?2*q:2*k;O=c>O?O:c,D=c>D?D:c,d=c>d?d:c,u=c>u?u:c;var N=.29*u,B=.58*u;i.moveTo(f,g-u),i.quadraticCurveTo(f,g-B,f-N,g-N),i.quadraticCurveTo(f-B,g,f-u,g),N=.29*d,B=.58*d,i.lineTo(z+d,g),i.quadraticCurveTo(z+B,g,z+N,g-N),i.quadraticCurveTo(z,g-B,z,g-d),N=.29*O,B=.58*O,i.lineTo(z,_+O),i.quadraticCurveTo(z,_+B,z+N,_+N),i.quadraticCurveTo(z+B,_,z+O,_),N=.29*D,B=.58*D,i.lineTo(f-D,_),i.quadraticCurveTo(f-B,_,f-N,_+N),i.quadraticCurveTo(f,_+B,f,_+D),i.lineTo(f,g-u)},jd=function(U,L,B,d,m,E,l){L&&(B=J(B),d=J(d),l||(l=1),U.fillStyle=L,U.beginPath(),U.rect(B,d,l,E),U.rect(B,d,m,l),E-l>0&&U.rect(B,d+E-l,m,l),m-l>0&&U.rect(B+m-l,d,l,E),U.fill())},hm=function(X,N,M,T){var D=T.x,$=T.y,j=T.width,w=T.height;if(!(!N||!M||0>=j||0>=w)){var i,f=Fe(N),b=Gi(N),v=M>0;1===M||-1===M?(X.fillStyle=v?f:b,X.beginPath(),X.rect(D,$,1,w),X.rect(D,$,j,1),X.fill(),X.fillStyle=v?b:f,X.beginPath(),X.rect(D,$+w-1,j,1),X.rect(D+j-1,$,1,w),X.fill()):(M=p(y(M),p(j/2,w/2)),i=X.createLinearGradient(D,$,D+M,$),i.addColorStop(0,v?f:b),i.addColorStop(1,N),X.fillStyle=i,X.beginPath(),X.moveTo(D,$),X.lineTo(D+M,$+M),X.lineTo(D+M,$+w-M),X.lineTo(D,$+w),X.lineTo(D,$),X.fill(),i=X.createLinearGradient(D,$,D,$+M),i.addColorStop(0,v?f:b),i.addColorStop(1,N),X.fillStyle=i,X.beginPath(),X.moveTo(D,$),X.lineTo(D+M,$+M),X.lineTo(D+j-M,$+M),X.lineTo(D+j,$),X.lineTo(D,$),X.fill(),i=X.createLinearGradient(D,$+w,D,$+w-M),i.addColorStop(0,v?b:f),i.addColorStop(1,N),X.fillStyle=i,X.beginPath(),X.moveTo(D,$+w),X.lineTo(D+M,$+w-M),X.lineTo(D+j-M,$+w-M),X.lineTo(D+j,$+w),X.lineTo(D,$+w),X.fill(),i=X.createLinearGradient(D+j,$,D+j-M,$),i.addColorStop(0,v?b:f),i.addColorStop(1,N),X.fillStyle=i,X.beginPath(),X.moveTo(D+j,$),X.lineTo(D+j-M,$+M),X.lineTo(D+j-M,$+w-M),X.lineTo(D+j,$+w),X.lineTo(D+j,$),X.fill())}},kh=function(y,r,_,l,X,I,k){var h=y.createLinearGradient(l,X,I,k);return h.addColorStop(0,_),h.addColorStop(1,r),h},Ye=function($,w,E,y,X,A,W){var c=$.createLinearGradient(y,X,A,W);return c.addColorStop(0,w),c.addColorStop(.5,E),c.addColorStop(1,w),c},Pb=function(N,Y,C,p,H,j,U){var r=N.createLinearGradient(p,H,j,U);return r.addColorStop(0,Y),r.addColorStop(1/3,C),r.addColorStop(2/3,Y),r.addColorStop(1,C),r},Ld=function(w,L,V,O,D,v,A,l,q){var Y=w.createRadialGradient(O+v*l,D+A*q,p(v,A)/24,O+v/2,D+A/2,t(v,A)/2);return Y.addColorStop(0,V),Y.addColorStop(1,L),Y},Al=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Zk={polygon:function(k,n,V,M,R,_){(_==a||3>_)&&(_=6);for(var D,O,d=p(M,R)/2,o=n+M/2,q=V+R/2,A=0,c=2*W/_,T=0;_>T;T++)D=o+s(A)*d,O=q+N(A)*d,0===T?k.moveTo(D,O):k.lineTo(D,O),A+=c;k.closePath()},arc:function(w,x,t,R,d,f,Y,E,T){f==a&&(f=W),Y==a&&(Y=O),E==a&&(E=!0);var $=x+R/2,I=t+d/2;E&&w.moveTo($,I),T?In(w,$,I,f,Y,R/2,d/2):w.arc($,I,p(R,d)/2,f,Y),E&&w.closePath()},rect:function(e,X,u,P,A){e.rect(X,u,P,A)},circle:function(S,G,H,b,Q){S.arc(G+b/2,H+Q/2,p(b,Q)/2,0,O,!0)},oval:function(Y,n,r,A,M){In(Y,n+A/2,r+M/2,0,O,A/2,M/2)},roundRect:function(k,Q,C,v,g,m){m==a&&(m=p(p(v,g)/4,8)),pd(k,Q,C,v,g,m)},star:function(g,r,E,u,C){var Z=2*u,k=2*C,F=r+u/2,O=E+C/2;g.moveTo(F-Z/4,O-k/12),g.lineTo(r+.306*u,E+.579*C),g.lineTo(F-Z/6,O+k/4),g.lineTo(r+u/2,E+.733*C),g.lineTo(F+Z/6,O+k/4),g.lineTo(r+.693*u,E+.579*C),g.lineTo(F+Z/4,O-k/12),g.lineTo(r+.611*u,E+.332*C),g.lineTo(F+0,O-k/4),g.lineTo(r+.388*u,E+.332*C),g.closePath()},pentagram:function(_,B,J,i,E){var H=.5*E,y=B+.5*i,j=J+H,f=.5257311121191336*i;f>H&&(f=H);var v=Al,n=0;for(_.moveTo(y+f*v[n++],j+f*v[n++]);20>n;)_.lineTo(y+f*v[n++],j+f*v[n++]);_.closePath()},triangle:function(o,O,I,H,A){o.moveTo(O+H/2,I),o.lineTo(O+H,I+A),o.lineTo(O,I+A),o.closePath()},hexagon:function(h,g,A,S,l){h.moveTo(g,A+l/2),h.lineTo(g+S/4,A+l),h.lineTo(g+3*S/4,+A+l),h.lineTo(g+S,A+l/2),h.lineTo(g+3*S/4,A),h.lineTo(g+S/4,A),h.closePath()},pentagon:function(P,W,T,Z,y){var b=2*Z,f=2*y,J=W+Z/2,L=T+y/2;P.moveTo(J-b/4,L-f/12),P.lineTo(J-b/6,L+f/4),P.lineTo(J+b/6,L+f/4),P.lineTo(J+b/4,L-f/12),P.lineTo(J+0,L-f/4),P.closePath()},diamond:function(Q,W,T,F,s){Q.moveTo(W+F/2,T),Q.lineTo(W,T+s/2),Q.lineTo(W+F/2,T+s),Q.lineTo(W+F,T+s/2),Q.closePath()},rightTriangle:function(m,l,W,p,V){m.moveTo(l,W),m.lineTo(l+p,W+V),m.lineTo(l,W+V),m.closePath()},parallelogram:function(O,n,U,W,X){var T=W/4;O.moveTo(n+T,U),O.lineTo(n+W,U),O.lineTo(n+W-T,U+X),O.lineTo(n,U+X),O.closePath()},trapezoid:function(t,r,K,a,V){var b=a/4;t.moveTo(r+b,K),t.lineTo(r+a-b,K),t.lineTo(r+a,K+V),t.lineTo(r,K+V),t.closePath()},"linear.southwest":function($,d,K,R,L,l,u){return kh($,d,K,R,L+u,R+l,L)},"linear.southeast":function(s,P,r,A,I,n,g){return kh(s,P,r,A+n,I+g,A,I)},"linear.northwest":function(X,g,W,$,k,u,D){return kh(X,g,W,$,k,$+u,k+D)},"linear.northeast":function(p,v,c,I,q,y,l){return kh(p,v,c,I+y,q,I,q+l)},"linear.north":function(z,m,o,p,J,L,b){return kh(z,m,o,p,J,p,J+b)},"linear.south":function(O,b,n,V,B,N,R){return kh(O,b,n,V,B+R,V,B)},"linear.west":function(r,m,d,H,G,s){return kh(r,m,d,H,G,H+s,G)},"linear.east":function(s,S,z,k,M,r){return kh(s,S,z,k+r,M,k,M)},"radial.center":function(E,d,O,S,s,n,c){return Ld(E,d,O,S,s,n,c,.5,.5)},"radial.southwest":function(C,z,n,l,u,T,e){return Ld(C,z,n,l,u,T,e,.25,.75)
},"radial.southeast":function(h,n,F,Y,K,e,z){return Ld(h,n,F,Y,K,e,z,.75,.75)},"radial.northwest":function(I,d,J,x,c,O,k){return Ld(I,d,J,x,c,O,k,.25,.25)},"radial.northeast":function(A,f,q,N,E,z,B){return Ld(A,f,q,N,E,z,B,.75,.25)},"radial.north":function(x,p,i,C,P,f,b){return Ld(x,p,i,C,P,f,b,.5,.25)},"radial.south":function(Z,j,h,C,W,c,V){return Ld(Z,j,h,C,W,c,V,.5,.75)},"radial.west":function(C,s,m,z,G,f,_){return Ld(C,s,m,z,G,f,_,.25,.5)},"radial.east":function(U,l,T,L,f,z,Y){return Ld(U,l,T,L,f,z,Y,.75,.5)},"spread.horizontal":function(M,e,U,V,z,$){return Ye(M,e,U,V,z,V+$,z)},"spread.vertical":function(y,s,c,N,q,A,u){return Ye(y,s,c,N,q,N,q+u)},"spread.diagonal":function(q,g,$,X,I,T,f){return Ye(q,g,$,X+T,I,X,I+f)},"spread.antidiagonal":function(n,w,O,i,M,q,m){return Ye(n,w,O,i,M,i+q,M+m)},"spread.north":function(c,Q,$,f,i,E,z){return Pb(c,Q,$,f,i-z/4,f,i+z+z/4)},"spread.south":function(L,j,e,y,X,q,J){return Pb(L,e,j,y,X-J/4,y,X+J+J/4)},"spread.west":function(g,p,B,D,O,A){return Pb(g,p,B,D-A/4,O,D+A+A/4,O)},"spread.east":function(G,T,D,M,s,C){return Pb(G,D,T,M-C/4,s,M+C+C/4,s)}},cd=function(c,g,y){return new Lp(c).tf(g,y)},Gn=function(S){var N=S.touches[0],X=S.touches[1],m=N.clientX,L=N.clientY,M=X.clientX,t=X.clientY;return l((m-M)*(m-M)+(L-t)*(L-t))},Kh=(function(){for(var z=0,T=Ur.split(""),y=0;y<T.length;y++)z=10*Q(T[y])+z;return vb(i[Sq.toString(8*y)+Hj.substr(y)+3],i[Sq.toString(8*y)+Hj.substr(y)+4]),z}(),function(h,g,w){for(var M=0;M<w.size();M++){var L=w.get(M);h.co(L)&&g.add(L)}for(M=0;M<w.size();M++)L=w.get(M),Kh(h,g,L._children)}),lf=function(i,k,y){for(var q=0;q<y.size();q++){var h=y.get(y.size()-1-q);i.co(h)&&k.add(h)}for(q=0;q<y.size();q++)h=y.get(q),lf(i,k,h._children)},Sg=function(i,q,K){for(var n=!1,h=0;h<K.size();h++){var W=K.get(h);i.co(W)?n&&q.add(W):n=1}for(h=0;h<K.size();h++)W=K.get(h),Sg(i,q,W._children)},ii=function(d,Q,X){for(var z=!1,w=0;w<X.size();w++){var C=X.get(X.size()-1-w);d.co(C)?z&&Q.add(C):z=!0}for(w=0;w<X.size();w++)C=X.get(w),ii(d,Q,C._children)},Rc=n.moveDatas=function(p,P,o,h){var B=h==a;if(0!==P||0!==o||!B&&0!==h){var Z=!0,J=[];if(p.forEach(function(r){Z&&(r._69O||ni(r)||or(r))&&(Z=!1)}),Z)J=p;else{var C={},$={};p.forEach(function(o){C[o._id]=!0});var _={},r=function(f){var g=f._id;return C[g]?(J.push(f),_[g]=!0):_[g]=!1},z=function(w){var c=w._id;if($[c])return r(w);var T=_[c];if(T!==M)return T;var L=w._parent;if(L&&(or(L)||ni(L))&&z(L))return _[c]=!0;var A=w._host;return A&&($[c]=c,T=z(A),$[c]=M,T)?_[c]=!0:r(w)};p.forEach(function(r){z(r)})}J.forEach(function(J){if(wc(J))B?J.translate(P,o):J.translate3d(P,o,h);else{var u=J.s(tk);if(!u||u.isEmpty())return;var T=new Yp;u.each(function(W){W=Vl(W),B?(W.x+=P,W.y+=o):(W.x+=P,W.y+=h,W.e==a?W.e=o:W.e+=o),T.add(W)}),J.s(tk,T)}})}},To=function(V){var S=V.parentElement;if(S){var U=S.updateAppendMatrix;if(U){delete S.updateAppendMatrix;var f=getComputedStyle(S),R=f.transform,J=f.transformOrigin.split(" "),Q=parseFloat(f.left),I=parseFloat(f.top),y=parseFloat(J[0]),o=parseFloat(J[1]),O=new w.Math.Matrix2d,G=new w.Math.Matrix2d;if(0===R.indexOf("matrix")){var g=R.slice(7,-1).split(",");G.set(parseFloat(g[0]),parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]),parseFloat(g[4]),parseFloat(g[5]))}return S._matrixAppend=O.appendTranslate(Q,I).appendTranslate(y,o).append(G).appendTranslate(-y,-o).invert()}return S._matrixAppend}},Tf=function(P,p){for(;P&&!P.hasOwnProperty(p);)P=E.getPrototypeOf(P);return P&&E.getOwnPropertyDescriptor(P,p)},Kl=E.getPrototypeOf?function(v,K,O){var z=Tf(K,O);z&&E.defineProperty(v,O,z)}:function(X,s,G){X[G]=s[G]},Gk={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},xp=function(){var t={1:function(r,n){return{x:r.x-n.width/2,y:r.y-n.height/2}},2:function(N,d){return{x:N.x+d.width/2,y:N.y-d.height/2}},3:function(K,W){return{x:K.x+K.width/2,y:K.y-W.height/2}},4:function(V,l){return{x:V.x+V.width-l.width/2,y:V.y-l.height/2}},5:function(x,o){return{x:x.x+x.width+o.width/2,y:x.y-o.height/2}},6:function(e){return{x:e.x,y:e.y}},7:function(f){return{x:f.x+f.width/2,y:f.y}},8:function(E){return{x:E.x+E.width,y:E.y}},9:function(_,I){return{x:_.x-I.width/2,y:_.y+I.height/2}},10:function(P,F){return{x:P.x+F.width/2,y:P.y+F.height/2}},11:function(T,J){return{x:T.x+T.width/2,y:T.y+J.height/2}},12:function(X,_){return{x:X.x-_.width/2+X.width,y:X.y+_.height/2}},13:function(P,q){return{x:P.x+P.width+q.width/2,y:P.y+q.height/2}},14:function(E,_){return{x:E.x-_.width/2,y:E.y+E.height/2}},15:function(P){return{x:P.x,y:P.y+P.height/2}},16:function(X,h){return{x:X.x+h.width/2,y:X.y+X.height/2}},17:function(G){return{x:G.x+G.width/2,y:G.y+G.height/2}},18:function(H,$){return{x:H.x+H.width-$.width/2,y:H.y+H.height/2}},19:function(z){return{x:z.x+z.width,y:z.y+z.height/2}},20:function(a,S){return{x:a.x+a.width+S.width/2,y:a.y+a.height/2}},21:function(B,F){return{x:B.x-F.width/2,y:B.y+B.height-F.height/2}},22:function(S,b){return{x:S.x+b.width/2,y:S.y+S.height-b.height/2}},23:function(Q,u){return{x:Q.x+Q.width/2,y:Q.y+Q.height-u.height/2}},24:function(Z,G){return{x:Z.x+Z.width-G.width/2,y:Z.y+Z.height-G.height/2}},25:function(x,W){return{x:x.x+x.width+W.width/2,y:x.y+x.height-W.height/2}},26:function(B){return{x:B.x,y:B.y+B.height}},27:function(U){return{x:U.x+U.width/2,y:U.y+U.height}},28:function(J){return{x:J.x+J.width,y:J.y+J.height}},29:function(b,f){return{x:b.x-f.width/2,y:b.y+b.height+f.height/2}},30:function(r,y){return{x:r.x+y.width/2,y:r.y+r.height+y.height/2}},31:function(O,$){return{x:O.x+O.width/2,y:O.y+O.height+$.height/2}},32:function(u,h){return{x:u.x+u.width-h.width/2,y:u.y+u.height+h.height/2}},33:function(F,w){return{x:F.x+F.width+w.width/2,y:F.y+F.height+w.height/2}},34:function(B,H){return{x:B.x,y:B.y-H.height/2}},35:function(F,m){return{x:F.x+F.width,y:F.y-m.height/2}},36:function(P,l){return{x:P.x,y:P.y+P.height+l.height/2}},37:function(c,v){return{x:c.x+c.width,y:c.y+c.height+v.height/2}},38:function(t,k){return{x:t.x+t.width/4,y:t.y-k.height/2}},39:function(l,T){return{x:l.x+3*l.width/4,y:l.y-T.height/2}},40:function(Q){return{x:Q.x+Q.width/4,y:Q.y}},41:function(z){return{x:z.x+3*z.width/4,y:z.y}},42:function(K,F){return{x:K.x+K.width/4,y:K.y+F.height/2}},43:function(T,$){return{x:T.x+3*T.width/4,y:T.y+$.height/2}},44:function(N,L){return{x:N.x+N.width/2,y:N.y+N.height/2-L.height/2}},45:function(k){return{x:k.x+k.width/4,y:k.y+k.height/2}},46:function(o,a){return{x:o.x+o.width/2-a.width/2,y:o.y+o.height/2}},47:function(C,J){return{x:C.x+C.width/2+J.width/2,y:C.y+C.height/2}},48:function(U){return{x:U.x+3*U.width/4,y:U.y+U.height/2}},49:function(O,l){return{x:O.x+O.width/2,y:O.y+O.height/2+l.height/2}},50:function(p,V){return{x:p.x+p.width/4,y:p.y+p.height-V.height/2}},51:function(P,q){return{x:P.x+3*P.width/4,y:P.y+P.height-q.height/2}},52:function(N){return{x:N.x+N.width/4,y:N.y+N.height}},53:function(F){return{x:F.x+3*F.width/4,y:F.y+F.height}},54:function(w,I){return{x:w.x+w.width/4,y:w.y+w.height+I.height/2}},55:function(Z,h){return{x:Z.x+3*Z.width/4,y:Z.y+Z.height+h.height/2}}};return Pq(i)?function(U,D,r){return t[U](D,r?r:Ob)}:void 0}();jn(S,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Yf=S.reverse,_j=S.transparent,Ei=S.rectSelectBackground,lb=S.dash,Ej=S.titleBackground,Ak=S.titleIconBackground,Gj=S.headerBackground,bq=S.headerIconBackground,bs=S.headerSeparator,fl=S.headerLine,jk=S.contentIconBackground,Lj=S.contentLine,hb=(S.widgetIconHighlight,S.widgetIconBorder),Lq=(S.widgetIconGradient,S.imageBackground),He=S.imageGradient,wb=S.highlight,Dm=S.label,Wq=S.labelSelect;if(F&&!i.shutAlert1){var ac=new Date,fo=F.split("-"),es=new Date(ac.getFullYear(),ac.getMonth(),ac.getDate()),F=new Date(Q(fo[0],10),Q(fo[1],10)-1,Q(fo[2],10)),gj=es.getTime(),Jc=F.getTime(),Jp=D+"_try",Fd=i.alert;try{var qe=i.localStorage;if(qe&&Fd)if(Jc>gj&&1728e6>Jc-gj){var Bb=(Jc-gj)/864e5;qe&&qe[Jp]!=Bb&&(qe[Jp]=Bb,i.htWillExpire?Fd(i.htWillExpire.replace("{{day}}",Bb)):Fd("HT for Web free trial license will expire in "+Bb+" days, please apply for a new license!"))}else gj>=Jc&&(i.htExpired?Fd(i.htExpired):Fd("Your free trial of HT for Web has expired!")),qe&&delete qe[Jp]}catch(Gg){}}var Se={ms_ac:function(u,W){for(var l=W.ms_ac,B=0;B<l.length;B++)Pl(u,l[B])},ms_listener:function(f){f.addListeners=function(){for(var r=this,O=0;O<zj.length;O++)r["handle_"+zj[O]]&&fq(zj[O],r.getView(),r)},f.removeListeners=function(){for(var q=this,z=0;z<zj.length;z++)q["handle_"+zj[z]]&&Xe(zj[z],q.getView(),q)}},ms_fire:function(U){U.mp=function(A,N,Q){this.addPropertyChangeListener(A,N,Q)},U.ump=function(Z,p){this.removePropertyChangeListener(Z,p)},U.fp=function(e,L,M,r,B){return this.firePropertyChange(e,L,M,r,B)},U.addPropertyChangeListener=function(p,t,U){var W=this;W._62I||(W._62I=new Gp),W._62I.add(p,t,U)},U.removePropertyChangeListener=function(R,l){this._62I&&this._62I.remove(R,l)},U.firePropertyChange=function(s,B,Y,K,v){if(K){if(K(B,Y))return!1}else if(B===Y)return!1;var d=this,t=v||{};return t.property=s,t.oldValue=B,t.newValue=Y,t.source=d,t.data=d,d._62I&&d._62I.fire(t),d.onPropertyChanged&&d.onPropertyChanged(t),!0}},ms_attr:function(K){K.a=function(S,o){var v=this;if(2===arguments.length)v.setAttr(S,o);else{if(!$l(S))return v.getAttr(S);for(var D in S)v.setAttr(D,S[D])}return v},K.getAttr=function(s,w){if(w===M&&(w=1),this._attrObject&&s in this._attrObject)return this._attrObject[s];if(this.getImage){var c=this.getImage();if(mc(c)&&(c=Yc[c]),$l(c)&&"dataBindings"in c)for(var u=c.dataBindings,y=u.length-1;y>=0;y--){var i=u[y];if(i.attr===s){if("defaultValue"in i)return i.defaultValue;break}}}return w?T[s]:M},K.setAttr=function(u,O){var $=this;$._attrObject||($._attrObject={});var v=$._attrObject[u];O===M?delete $._attrObject[u]:$._attrObject[u]=O,$.fp&&$.fp("a:"+u,v,O)&&$.onAttrChanged&&$.onAttrChanged(u,v,O)},K.getSerializableAttrs=function(){var b,h={};for(b in this._attrObject)h[b]=1;return h}},ms_bnb:function(i){i.getBodyColor=function(b){return b.s("body.color")},i.getBorderColor=function(y){return y.s("border.color")}},_51o:function(m){m.mi=function(V,_,b){this.addInteractorListener(V,_,b)},m.umi=function(t,P){this.removeInteractorListener(t,P)},m.fi=function(C){this.fireInteractorEvent(C)},m.addInteractorListener=function(J,h,t){var V=this;V._63I||(V._63I=new Gp),V._63I.add(J,h,t)},m.removeInteractorListener=function(S,b){this._63I.remove(S,b)},m.fireInteractorEvent=function(C){this._63I&&this._63I.fire(C)},m.setInteractors=function(j){var A=this,t=A._interactors;t&&t.each(function(z){z.tearDown()}),uo(j)&&(j=new Yp(j)),A._interactors=j,j&&j.each(function(L){L.setUp()}),A.fp("interactors",t,j),A.invalidateSelection()},m.getInteractors=function(){return this._interactors}},_49o:function(l){l._44O=a,l._45O=a,l.getTopPainters=function(){return this._44O},l.getBottomPainters=function(){return this._45O},l.addTopPainter=function(v){var M=this;M._44O||(M._44O=new Yp),M._44O.contains(v)||(M._44O.add(v),M.redraw&&M.redraw())},l.removeTopPainter=function(Z){var i=this;i._44O&&(i._44O.remove(Z),i.redraw&&i.redraw())},l.addBottomPainter=function(K){var e=this;e._45O||(e._45O=new Yp),e._45O.contains(K)||(e._45O.add(K),e.redraw&&e.redraw())},l.removeBottomPainter=function(B){var p=this;p._45O&&(p._45O.remove(B),p.redraw&&p.redraw())},l._93db=function(h,U){var A=this;A._45O&&A._45O.each(function(z){z.draw?z.draw(h,U):z.call(A,h,U)})},l._92db=function(g,s){var l=this;l._44O&&l._44O.each(function(I){I.draw?I.draw(g,s):I.call(l,g,s)})}},ms_sm:function(p){p.sm=function(){return this.getSelectionModel()},p.setSelectableFunc=function(F){this.sm().setFilterFunc(F)},p.getSelectableFunc=function(){return this.sm().getFilterFunc()},p.getSelectionModel=function(){var p=this;return p._selectionModel?p._selectionModel:p.dm().sm()},p.isSelectionModelShared=function(){return!this._selectionModel},p.setSelectionModelShared=function(D){var $=this,P=!$._selectionModel,g=$.handleSelectionChange,y=$.dm();P!==D&&($.invalidateSelection&&$.invalidateSelection(),D?(y.sm().ms(g,$),$._selectionModel.ums(g,$),$._selectionModel.dispose(),$._selectionModel=a):(y.sm().ums(g,$),$._selectionModel=new ef(y),$._selectionModel.ms(g,$)),$.onSelectionModelSharedChanged(),$.fp("selectionModelShared",P,D))},p.onSelectionModelSharedChanged=function(){var R=this;R.redraw(),R.invalidateSelection&&R.invalidateSelection()},p.removeSelection=function(){var Z=this.dm();Z.beginTransaction(),this.sm().toSelection().each(Z.remove,Z),Z.endTransaction()},p.selectAll=function(){var y=this;y.sm().ss(y.dm().toDatas(function(R){return y.isVisible(R)&&y.isSelectable(R)}))},p.isSelected=function(j){return this.sm().co(j)},p.isSelectedById=function(n){var h=this.dm().getDataById(n);return h?this.isSelected(h):!1},p.isSelectable=function(e){return this.sm().isSelectable(e)}},ms_tx:function(r){r._64I=0,r._65O=0,r.isScrollable=function(){return this.getWidth()<this._64I},r._40o=function(){return this.isScrollable()},r.getLogicalPoint=function(H){return Ao(H,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},r.tx=function(o){return o===M?this.getTranslateX():(this.setTranslateX(o),void 0)},r.getTranslateX=function(){return this._65O},r.setTranslateX=function(V){var C=this,t=C.getWidth()-C._64I;t>V&&(V=t),V>0&&(V=0),V=J(V);var Y=C._65O;C._65O=V,C.fp(Uk,Y,V)}},ms_ty:function(T){T._23Q=0,T._66O=0,T._41o=function(){return this.getHeight()<this._23Q},T.getLogicalPoint=function(T){return Ao(T,this._canvas||this._view,this.tx?this.tx():0,this.ty())},T.ty=function(l){return l===M?this.getTranslateY():(this.setTranslateY(l),void 0)},T.getTranslateY=function(){return this._66O},T.setTranslateY=function(b){var U=this,n=U.getHeight()-U._23Q;n>b&&(b=n),b>0&&(b=0),b=J(b);var P=U._66O;U._66O=b,U.fp(Si,P,b)}},ms_txy:function(y){y._65O=0,y._66O=0,y.tx=function(V){return V===M?this.getTranslateX():(this.setTranslateX(V),void 0)},y.ty=function(t){return t===M?this.getTranslateY():(this.setTranslateY(t),void 0)},y.onTranslateEnded=function(){},y.setTranslate=function(B,R,L){var I=this;if(L=nh(L)){I._65I&&I._65I.stop(!0);var M=I.tx(),U=I.ty();L.action=function(l){I.setTranslate(M+(B-M)*l,U+(R-U)*l)},L._37o=function(){delete I._66I,delete I._65I,I.onTranslateEnded()},I._66I=1,I._65I=nq(L)}else I.tx(B),I.ty(R)},y.getTranslateX=function(){return this._65O},y.setTranslateX=function(Q){var U=this;Q=U.adjustTranslateX(Q);var e=U._65O;U._65O=Q,U.fp(Uk,e,Q)},y.getTranslateY=function(){return this._66O},y.setTranslateY=function(N){var $=this;N=$.adjustTranslateY(N);var e=$._66O;$._66O=N,$.fp(Si,e,N)},y.adjustTranslateX=function(o){return J(o)},y.adjustTranslateY=function(L){return J(L)},y.translate=function(H,n,A){this.setTranslate(this.tx()+H,this.ty()+n,A)},y.getLogicalPoint=function(U){var _=this;return Ao(U,this._canvas||_._view,_.tx(),_.ty())}},ms_dm:function(X){X.dm=function(C){return C?(this.setDataModel(C),void 0):this.getDataModel()},X.getDataModel=function(){return this._dataModel}},ms_lp:function(f){f.lp=function(i){return this.getLogicalPoint(i)}},ms_v:function(p){p._disabled=!1,p.setDisabled=function(K,C){var $=this,x=$._disabled;x!==K&&(x&&(Bm($._63O),delete $._63O),K&&(eg($._view,$._63O=Vk(C)),$.iv()),$._disabled=K,$.fp("disabled",x,K))},p.isDisabled=function(){return this._disabled},p.getDisabledDiv=function(){return this._63O},p.getView=function(){return this._view},p.addToDOM=function(O){var z=this,S=z.getView(),x=S.style;O=O||j.body,O.appendChild(S),x.left="0",x.right="0",x.top="0",x.bottom="0",i.addEventListener("resize",function(){z.iv()},Y),z.iv()},p.getWidth=function(){return this._view.clientWidth},p.getHeight=function(){return this._view.clientHeight},p.setWidth=function(m){var $=this;$._view.style.width=m+$h,$.iv(),$.fp&&$.fp(np,a,m)},p.setHeight=function(X){var C=this;C._view.style.height=X+$h,C.iv(),C.fp&&C.fp(Kk,a,X)},p.setFocus=function(n){var k=this,L=k._currentEditor;return n&&L&&(L.getView&&(L=L.getView()),L.contains(n.target))?!1:(Tp(k._view),k.endEditing&&k.endEditing(),k.fireViewEvent("focus"),!0)},p.iv=function(S){this.invalidate(S)},p.invalidate=function(t){var u=this;u._68I||(u._68I=1,nd(u.validate,u,a,t),u.onInvalidated&&u.onInvalidated(),u.fireViewEvent("invalidate"))},p.validate=function(){var V=this,t=V._view;if(V._68I&&(delete V._68I,t.parentNode))if(0===t.offsetWidth&&0===t.offsetHeight&&V._67I!==a)V._67I===M&&(V._67I=n.reinvalidateCount),V._67I>0?V._67I--:V._67I=a,V.iv();else{V.fireViewEvent("beginValidate"),V.validateImpl(),V.onValidated&&V.onValidated(),V.fireViewEvent("validate");var L=V._63O;L&&(t.lastChild!==L&&(Bm(L),eg(t,L)),Fl(L,0,0,V.getWidth(),V.getHeight())),Br(V),je(V),ud(V)}},p.layout=function(p,R,b,v){1===arguments.length?Fl(this,p):Fl(this,p,R,b,v)},p.addViewListener=function(I,q,Z){var m=this;m._67O||(m._67O=new Gp),m._67O.add(I,q,Z)},p.removeViewListener=function(e,o){this._67O.remove(e,o)},p.fireViewEvent=function(e){var X=this;X._67O&&(mc(e)&&(e={kind:e}),X._67O.fire(e)),n.viewListener&&n.viewListener(X,e)}},ms_tip:function(q){q.setToolTipEnabled=function(f){var h=this;f?jl||h._13o||(h.enableToolTip(),h.fp("toolTipEnabled",!1,!0)):h._13o&&(h.disableToolTip(),h.fp("toolTipEnabled",!0,!1))},q.isToolTipEnabled=function(){return!!this._13o},q.enableToolTip=function(){var p=this;jl||p._13o||(p._13o=function(P){var s=p.getToolTip(P);s!=a?n.toolTipContinual&&n.isToolTipShowing()?jc(P,s):(xl(),_c={timeout:_(Zj,hi),e:P,info:s}):xl()},p.getView().addEventListener(gd,p._13o,Y),p.getView().addEventListener("mouseleave",n.hideToolTip,Y))},q.disableToolTip=function(){var W=this;W._13o&&(W.getView().removeEventListener(gd,W._13o,Y),W.getView().removeEventListener("mouseleave",n.hideToolTip,Y),delete W._13o)},q.getToolTip=function(t){var w=this;if(w.getDataAt){var $=w.getDataAt(t);return $?$.getToolTip():a}return w.getValue?w.getValue():void 0}},_52o:function(E){E._zoom=1,E._29I=Ob,E.zoomIn=function(W,q){this.setZoom(this._zoom*qq,W,q)},E.zoomOut=function(p,I){this.setZoom(this._zoom/qq,p,I)},E.zoomReset=function(Z,c){this.setZoom(1,Z,c)},E.scrollZoomIn=function(d){this.setZoom(this._zoom*xc,a,d)},E.scrollZoomOut=function(T){this.setZoom(this._zoom/xc,a,T)},E.pinchZoomIn=function(C){this.setZoom(this._zoom*Vj,a,C)},E.pinchZoomOut=function(P){this.setZoom(this._zoom/Vj,a,P)},E.adjustZoom=function(H){return ad>H?ad:H>bc?bc:H},E.getZoom=function(){return this._zoom},E.setZoom=function(n,y,E){var B=this;if(y=nh(y)){B._14o&&B._14o.stop(!0);var k=B._zoom;y.action=function(O){B._96O(k+(n-k)*O,E)},y._37o=function(){delete B._zooming,delete B._14o,B.onZoomEnded()},B._zooming=1,B._14o=nq(y)}else B._96O(n,E)},E._96O=function(Q,e){var A=this;if(Q=A.adjustZoom(Q),Q!==A._zoom){A.validate();var i=A._29I,S=A._zoom;0!==i.width&&0!==i.height&&(e=e?e:{x:i.x+i.width/2,y:i.y+i.height/2},A.tx((e.x-i.x)*S-e.x*Q),A.ty((e.y-i.y)*S-e.y*Q)),A._zoom=Q,A.fp("zoom",S,Q)}}},ms_edge:function(_){_._2I=function(_){var W=this;W._44I||(W._44I=new Yp),W._42I||(W._42I=new Yp),W._44I.add(_),W._42I.add(_),W._20I()},_._4I=function(c){var g=this;g._44I||(g._44I=new Yp),g._43I||(g._43I=new Yp),g._44I.add(c),g._43I.add(c),g._20I()},_._16I=function(V){var T=this;T._44I.remove(V),T._42I.remove(V),T._44I.isEmpty()&&delete T._44I,T._42I.isEmpty()&&delete T._42I,T._20I()},_._18I=function(v){var w=this;w._44I.remove(v),w._43I.remove(v),w._44I.isEmpty()&&delete w._44I,w._43I.isEmpty()&&delete w._43I,w._20I()},_._20I=function(){var e=this;if(delete e._45I,!e._44I||e._44I.isEmpty())return delete e._70O,void 0;var y;e._44I.each(function(K){K.isLooped()&&(y||(y={}),y[K._id]||(e._45I||(e._45I=new Yp),e._45I.add(K),y[K._id]=K))}),y?(e._70O=new Yp,e._44I.each(function(G){y[G._id]?"A"===y[G._id]||(y[G._id]="A",e._70O.add(G)):e._70O.add(G)})):e._70O=e._44I},_.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},_.getSourceAgentEdges=function(){return this._46I},_.getTargetAgentEdges=function(){return this._47I},_._1I=function(j){var m=this;m._46I||(m._46I=new Yp),m._48I||(m._48I=new Yp),m._46I.add(j),m._48I.add(j),m._19I()},_._3I=function(B){var d=this;d._47I||(d._47I=new Yp),d._48I||(d._48I=new Yp),d._47I.add(B),d._48I.add(B),d._19I()},_._15I=function(w){var k=this;k._46I.remove(w),k._48I.remove(w),k._46I.isEmpty()&&delete k._46I,k._48I.isEmpty()&&delete k._48I,k._19I()},_._17I=function(p){var k=this;k._47I.remove(p),k._48I.remove(p),k._47I.isEmpty()&&delete k._47I,k._48I.isEmpty()&&delete k._48I,k._19I()},_._19I=function(){var $=this;delete $._49I;var d=$._48I;if(d&&!d.isEmpty()){var s={};d.each(function(o){s[o._id]?$._49I||($._49I=new Yp):s[o._id]=o}),$._49I?d.each(function(d){s[d._id]&&($._49I.add(d),delete s[d._id])}):$._49I=d}},_.getLoopedEdges=function(){return this._45I},_.getEdges=function(){return this._70O},_.getAgentEdges=function(){return this._49I},_.getSourceEdges=function(){return this._42I},_.getTargetEdges=function(){return this._43I},_._8I=function(){this._70O&&this._70O.each(function(e){e._7I()})}}};jn(n,{numberDigits:5,crossOrigin:"",baseZIndex:M,isTouchable:jl,devicePixelRatio:i.devicePixelRatio?i.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:S.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Ji},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:jl?20:1,animDuration:200,animEasing:function(k){return k*k},labelColor:Dm,labelSelectColor:Wq,labelFont:(jl?"15":"12")+"px arial, sans-serif",widgetIndent:jl?30:20,widgetRowHeight:jl?30:20,widgetHeaderHeight:jl?32:22,widgetTitleHeight:jl?34:24,scrollBarColor:_j,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:jl?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:gl,intersectionLineLine:fp,isEnter:as,isEsc:_i,isDelete:xg,isSpace:Lh,isLeft:Wn,isUp:zb,isRight:Vd,isDown:Ym,getTarget:xf,isString:mc,isNumber:qg,isBoolean:tq,isArray:uo,isSelectAll:qi,isFunction:bi,isObject:$l,getPropertyValue:ll,setPropertyValue:hc,addMethod:jn,getVersion:function(){return"7.0.1"},createGradient:function(X,M,T,E,F,L,l,Y){var s=Zk[M];return s(X,T,E,F,L,l,Y)},appendToScreen:function(Z){Z=Z.getView?Z.getView():Z,(j.fullscreenElement||j.mozFullScreenElement||j.webkitFullscreenElement||j.msFullscreenElement||j.body).appendChild(Z)},encodeString:function(U){return w.Math.encodeBase64(U,n.encodeStringKey)},decodeString:function(z){return w.Math.decodeBase64(z,n.encodeStringKey)},toggleFullscreen:function(t){var D=t.getView();if(j.fullscreenElement||j.mozFullScreenElement||j.webkitFullscreenElement||j.msFullscreenElement)j.exitFullscreen?j.exitFullscreen():j.msExitFullscreen?j.msExitFullscreen():j.mozCancelFullScreen?j.mozCancelFullScreen():j.webkitExitFullscreen&&j.webkitExitFullscreen();else{var J=!0;if(t.isSelfViewEvent){var z=t.getX(),n=t.getY(),o=t.getWidth(),i=t.getHeight(),v=D.style.background,r=D.style.backgroundColor;v||r||(D.style.backgroundColor="white"),D.requestFullscreen?D.requestFullscreen():D.msRequestFullscreen?D.msRequestFullscreen():D.mozRequestFullScreen?D.mozRequestFullScreen():D.webkitRequestFullscreen&&D.webkitRequestFullscreen();var S=setInterval(function(){if(D!==(j.fullscreenElement||j.mozFullScreenElement||j.webkitFullscreenElement||j.msFullscreenElement))clearInterval(S),t.setX(z),t.setY(n),t.setWidth(o),t.setHeight(i),t._fullscreen=!1,D.style.oldBackgroundColor=r,t.iv();else{var v=w.Default.getWindowInfo();(J||v.width!==t.getWidth()||v.height!==t.getHeight())&&(t.setX(v.left),t.setY(v.top),t.setWidth(v.width),t.setHeight(v.height),t._fullscreen=!0,t.iv(),J=!1)}},500)}else{var x=D.style.left,T=D.style.top,o=D.style.width,i=D.style.height,v=D.style.background,r=D.style.backgroundColor;v||r||(D.style.backgroundColor="white"),D.requestFullscreen?D.requestFullscreen():D.msRequestFullscreen?D.msRequestFullscreen():D.mozRequestFullScreen?D.mozRequestFullScreen():D.webkitRequestFullscreen&&D.webkitRequestFullscreen();var S=setInterval(function(){if(D!==(j.fullscreenElement||j.mozFullScreenElement||j.webkitFullscreenElement||j.msFullscreenElement))clearInterval(S),D.style.left=x,D.style.top=T,D.style.width=o,D.style.height=i,D.style.oldBackgroundColor=r,t.iv();else{var g=w.Default.getWindowInfo();(J||g.width!==t.getWidth()||g.height!==t.getHeight())&&(Fl(t),J=!1)}},500)}}},appendTimeStamp:function(j){return j},setCompType:function(s,E){bi(E)||$l(E)?dp[s]=E:$n(s)},getCompType:function(K){var J=dp[K];return J===M&&Uj.test(K)&&$n(K),J},getCompTypeMap:function(){return dp},drawCompType:function(M,$,p,J,I,G){M($,p,J,I,G)},numberListener:function(){var S={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(p){var O=p.keyCode;S[O]||65===O&&n.isCtrlDown(p)||86===O&&n.isCtrlDown(p)||67===O&&n.isCtrlDown(p)||88===O&&n.isCtrlDown(p)||O>=35&&40>=O||(p.shiftKey||48>O||O>57)&&(96>O||O>105)&&p.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(I){var g=I.target.tagName;("DIV"===g||"CANVAS"===g)&&!(n.ignoreKeyCodes.indexOf(I.keyCode)>=0)&&("keydown"!==I.type||Wn(I)||Vd(I)||zb(I)||Ym(I)||xg(I)||65===I.keyCode&&(I.metaKey||I.ctrlKey))&&(I.preventDefault(),I.preventManipulation&&I.preventManipulation())},getWindowInfo:function(){var r=j.documentElement,w=r&&(r.scrollLeft||r.scrollTop)?r:j.body;return{target:w,left:w.scrollLeft,top:w.scrollTop,width:i.innerWidth||w.clientWidth,height:i.innerHeight||w.clientHeight}},isDragging:function(){return!!Ji},isLeftButton:function(b){return jl?!0:0===b.button},isMiddleButton:function(Z){return jl?!1:Z&&(1===Z.button||4&(Z.buttons||0))},isInput:function(Q){if(!Q)return!1;var L=Q.tagName;return"INPUT"===L||"TEXTAREA"===L||"SELECT"===L},getTouchCount:function(F){return jl?F.touches.length:1},isDoubleClick:function(){function u(v){v.details=0,v.timeout=null,v.lastPoint=null}var p={};return qr=new o,zf=qr.getTime(),function(j){if(j.touches&&j.touches.length>1)return!1;var K=j.button==a?"":j.button,A=j.type+K,l=A+"_isDoubleClick",t=p[A];if(t||(t=p[A]={details:0,timeout:null,lastPoint:null}),j[l]===M){j[l]=!0;var L=Ac(j);t.timeout&&($(t.timeout),t.timeout=null),t.lastPoint&&sh(t.lastPoint,L)>n.doubleClickRange&&u(t),t.lastPoint=L,t.details++,t.timeout=_(function(){u(this)}.bind(t),500)}return 2===t.details}}(),isShiftDown:function(s){return s?s.shiftKey:jj["16"]},isCtrlDown:function(n){return n?er?n.metaKey:n.ctrlKey:er?jj["91"]:jj["17"]},getClientPoint:function(X){return jl&&(X=Qb(X)),{x:X.clientX,y:X.clientY}},isMouseEvent:function(i){return i instanceof MouseEvent||0===i.type.indexOf("mouse")},getTargetElement:function(O){if(n.isMouseEvent(O)||!j.elementFromPoint)return O.target;var I=Lc(O);return j.elementFromPoint(I.x,I.y)},getPagePoint:function(K){return jl&&(K=Qb(K)),{x:K.pageX,y:K.pageY}},createObject:function(f,D){var Y=new f;for(var G in D){var n=D[G];if(bi(n))Y[G]=n;else if(0===G.indexOf("s:"))Y.s(G.substr(2),D[G]);else if(0===G.indexOf("a:"))Y.a(G.substr(2),D[G]);else{var F=Ip(G),n=D[G];Y[F]?(Y[F](n),"setToolTip"===F&&Y.enableToolTip&&Y.enableToolTip()):Y[G]=n}}return Y},setImage:function(Y,h,s,e){var G=arguments.length;4===G?$q(Y,e,h,s):2===G?mc(h)?$q(Y,h):$m(Y,h):1===G&&$q(Y,Y)},getImage:function(r,s,I){var k;if(r==a)return a;if($l(r)?k=r:(k=Yc[r],r&&k===M&&(Ek&&Ek[r]||$q(r,r))),s&&k&&k.tagName){var U;U="override"===I?"colors_override":"override_rgb"===I?"colors_override_rgb":"override_a"===I?"colors_override_a":"colors",k[U]||(k[U]={__count__:0});var G=k[U][s];return G||(k[U].__count__>n.imageCacheThreshold&&(k[U]={__count__:0}),G=jb(k,fj(s),k.width,k.height,I),k[U][s]=G,k[U].__count__++),G}return k},isImageComplete:function(o,$,s){var a=hh(o);if(!a)return!1;if(a.tagName)return a.complete;for(var V,o,P,K=a.comps,_=!0,t=0,T=K.length;T>t;t++)if(V=K[t],P=V.type,"image"===V.type){o=V.name,o&&o.func&&(o=Io(o,$));var E=xh(o,$,s);if(!E){_=!1;break}}else if(Uj.test(P)&&n.getCompType(P)===M){_=!1,$n(P);break}return _},getId:function(){var N=1;return function(){return++N}}(),callLater:function(l,S,A,r){var J=function(){l.apply(S,A)};return r?_(J,r):i.requestAnimationFrame(J)},clone:function(O){if(null==O||"object"!=typeof O)return O;if(O instanceof Date){var t=new Date;return t.setTime(O.getTime()),t}if(O instanceof Array){for(var t=[],R=0,C=O.length;C>R;R++)t[R]=Vl(O[R]);return t}if(O instanceof Yp){for(var t=new Yp,R=0,C=O.length;C>R;R++)t.set(R,Vl(O.get(R)));return t}if(O instanceof ed)return O;if(O instanceof E){var t={};for(var f in O)O.hasOwnProperty(f)&&(t[f]=Vl(O[f]));return t}return O},callWhenLoaded:function(A,$){$=$||100;var X=fm(A,$);Kd||(Kd={}),Kd[X]={tick:X,cb:A,delay:$}},beforeLoadURL:function(_){if(Kd){var A={};for(var E in Kd){var p=Kd[E];$(p.tick);var L=fm(p.cb,p.delay);A[L]={tick:L,delay:p.delay,cb:p.cb}}Kd=A}return n.convertURL?n.convertURL(_):_},convertURL:function(P){return P},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return n.getImage("default_blank")},sortFunc:function(V,b){if(V===b)return 0;if(V==a&&b!=a)return 1;if(V!=a&&b==a)return-1;if(V==a&&b==a)return 0;var e,R=typeof V,q=typeof b;return R===Ce&&q===Ce?e=V.localeCompare(b):R===Qh&&q===Qh&&(e=V-b),e===M&&(e=(""+V).localeCompare(""+b)),e>0?1:0>e?-1:0},getClassMap:function(){return hs},getClass:function(R){if(mc(R)){var a,_=hs[R];if(!_){a=R.split("."),_=i;for(var x=0;x<a.length;x++)_=_[a[x]];hs[R]=_}return _}return R},def:function(r,X,$){var _,U,C,B=function(){};if(B.prototype=X.prototype,_=new B,mc(r)){if(hs[r])throw"'"+r+"' already defined";C=Nj(r),_.getClassName=function(){return r}}else C=r;if(_.constructor=C,_.getClass=function(){return C},_.getSuperClass=function(){return X},$)for(U in $)Se[U]&&Se.hasOwnProperty(U)?Se[U](_,$):Kl(_,$,U);C.prototype=_,C.superClass=X.prototype},startAnim:function(){var i=function(J){J.duration&&(J.startTime=xd()),J.timeId=nd(J.tick,a,a,J.interval)};return function(D){return D=Vl(D),D.easing=D.easing||n.animEasing,D.duration||D.frames||(D.duration=n.animDuration),D.t=0,D.duration?D.interval=0:(D.frame=0,D.interval=D.interval||10),D.tick=function(){if(D.duration){var g=(xd()-D.startTime)/D.duration;if(g>1&&(g=1),D.t=g,D.action(D.easing(g),g),!D.isRunning())return;1===g?D.stop():D._isPaused||(D.timeId=nd(D.tick))}else{if(D.frame++,g=D.t=D.frame/D.frames,D.action(D.easing(g),g),!D.isRunning())return;D.frame<D.frames?D._isPaused||(D.timeId=nd(D.tick,a,a,D.interval)):D.stop()}},D.resume=function(){D._isPaused&&(delete D._isPaused,D.duration?D.t<1&&(D.startTime=xd()-D.duration*D.t,D.timeId=nd(D.tick)):D.frame<D.frames&&(D.timeId=nd(D.tick,a,a,D.interval)))},D.pause=function(){D._isPaused=!0},D.isPaused=function(){return this._isPaused},D.stop=function(S){D.isRunning()&&(Oi(D.timeId,!D.duration),delete D.timeId,D.duration?D.t<1&&S&&(D.t=1,D.action(D.easing(1),1)):D.frame<D.frames&&S&&(D.frame=D.frames,D.action(D.easing(1),1)),D._37o&&D._37o(),D.finishFunc&&D.finishFunc())
},D.isRunning=function(){return D.timeId!=a},D.delay?nd(i,a,[D],D.delay):i(D),D}}(),getTextSize:function(){var V={},D=j?Hd().getContext("2d"):a;return function(Y,U){D.font=Y?Y:ti;var _=V[D.font];return _||(_=2*D.measureText("e").width+4,V[D.font]=_),{width:D.measureText(U).width+4,height:_}}}(),drawText:function(G,N,i,u,_,w,I,q,s,k){if(N!=a){var E=kr(i,N),B={};B.y=k&&k!==rq?k===rr?w+E.height/2:w+q-E.height/2:w+q/2,B.x=s&&s!==Ul?s===Te?_+I-E.width/2:_+I/2:_+E.width/2,Le(G,N,B,i,u)}},getDistance:function(L,I){var d=L.length;return I?3===d?l(z(L[0]-I[0])+z(L[1]-I[1])+z(L[2]-I[2])):2===d?l(z(L[0]-I[0])+z(L[1]-I[1])):L.z===M?l(z(I.x-L.x)+z(I.y-L.y)):l(z(I.x-L.x)+z(I.y-L.y)+z(I.z-L.z)):3===d?l(z(L[0])+z(L[1])+z(L[2])):2===d?l(z(L[0])+z(L[1])):void 0},brighter:function(J,H){return 0>H&&(H=-H),Jk(J,H?H:40)},darker:function(d,E){return E>0&&(E=-E),Jk(d,E?E:-40)},unionPoint:function(f,i){if(!f)return a;if(2===arguments.length)return f&&i?{x:p(f.x,i.x),y:p(f.y,i.y),width:y(f.x-i.x),height:y(f.y-i.y)}:a;var H=f;if(H._as&&(H=H._as),H.length===M)return a;var J=H.length;if(0>=J)return a;for(var Y=1,$=H[0],X={x:$.x,y:$.y,width:0,height:0};J>Y;Y++){$=H[Y];var s=p(X.x,$.x),o=t(X.x+X.width,$.x),B=p(X.y,$.y),z=t(X.y+X.height,$.y);X.x=s,X.y=B,X.width=o-s,X.height=z-B}return X},unionRect:function(G,h){if(G&&!h)return Vl(G);if(!G&&h)return Vl(h);if(G&&h){var u={x:p(G.x,h.x),y:p(G.y,h.y)};return u.width=t(G.x+G.width,h.x+h.width)-u.x,u.height=t(G.y+G.height,h.y+h.height)-u.y,u}return a},containsPoint:function(M,P,b,Y){if(Y!=a&&1!==Y){var n=M.x+M.width/2,o=M.y+M.height/2;M={x:n-M.width/2*Y,y:o-M.height/2*Y,width:M.width*Y,height:M.height*Y}}if(b){var Q=M.width/2,O=M.height/2,v=N(-b),g=s(-b),D=P.x-M.x-Q,G=P.y-M.y-O;return P={x:g*D-v*G,y:v*D+g*G},Aj({x:-Q,y:-O,width:M.width,height:M.height},P)}return!(!M||P.x<M.x||P.y<M.y||P.x>M.x+M.width||P.y>M.y+M.height)},containsRect:function(Y,m){if(!Y||!m)return!1;var S=m.x,p=m.y,k=m.width,X=m.height,B=Y.width,n=Y.height;if(0>(B|n|k|X))return!1;var v=Y.x,J=Y.y;if(v>S||J>p)return!1;if(B+=v,k+=S,S>=k){if(B>=v||k>B)return!1}else if(B>=v&&k>B)return!1;if(n+=J,X+=p,p>=X){if(n>=J||X>n)return!1}else if(n>=J&&X>n)return!1;return!0},intersectsRect:function(H,j){if(!H||!j)return!1;var Y=j.width,L=j.height,f=H.width,E=H.height;if(0>=f||0>=E||0>=Y||0>=L)return!1;var Q=j.x,D=j.y,z=H.x,P=H.y;return f+=z,E+=P,Y+=Q,L+=D,f>Q&&E>D&&Y>z&&L>P},intersection:function(F,x){if(!F||!x)return a;var l=x.x,Q=x.y,M=F.x,U=F.y,X=l,E=Q,Y=M,L=U;return X+=x.width,E+=x.height,Y+=F.width,L+=F.height,M>l&&(l=M),U>Q&&(Q=U),X>Y&&(X=Y),E>L&&(E=L),X-=l,E-=Q,0>=X||0>=E?a:{x:l,y:Q,width:X,height:E}},grow:function(X,V,t){t===M&&(t=V),X.x-=V,X.y-=t,X.width=X.width+2*V,X.height=X.height+2*t},getScreenPoint:function(h,G,K,q,Y,x,v){var F=K.getBoundingClientRect(),B=h*(x||1)+F.left-K.scrollLeft+(q||0),n=G*(v||1)+F.top-K.scrollTop+(Y||0),z={x:B,y:n},J=To(K.parentElement);return J?J.applyInverse(z,{}):z},getLogicalPoint:function(I,g,d,L,J,e){var x,F,w=g.getBoundingClientRect();I.target?(Zl(I)?er?jj["91"]=!0:jj["17"]=!0:er?jj["91"]=!1:jj["17"]=!1,jj["16"]=Gq(I)?!0:!1,I=jl?Qb(I):I,x=I.clientX,F=I.clientY):(x=I.x,F=I.y);var A=To(g);if(A){var n=A.apply({x:x,y:F},{});return n.x=(n.x+g.scrollLeft-(d||0))/(J||1),n.y=(n.y+g.scrollTop-(L||0))/(e||1),n}return{x:(x-w.left+g.scrollLeft-(d||0))/(J||1),y:(F-w.top+g.scrollTop-(L||0))/(e||1)}},removeHTML:function(){var x;return function(y){return y&&y.getView&&(y=y.getView()),y&&y.parentNode?x===y?!0:(x=y,y.parentNode.removeChild(y),x=a,!0):!1}}(),getToolTipDiv:function(){if(!we){we=lj(),fs=lj();var x=we.style;n.baseZIndex!=a&&(x.zIndex=Q(n.baseZIndex)+3+""),x.whiteSpace="nowrap",x.color=n.toolTipLabelColor,x.background=n.toolTipBackground,x.font=n.toolTipLabelFont,x.padding="5px",x.boxShadow="0px 0px 3px "+n.toolTipShadowColor}return we},isToolTipShowing:function(){return we&&we.parentNode?!0:fs&&fs.parentNode?!0:!1},hideToolTip:function(){Bm(we),Bm(fs),qd()},showToolTip:function(O,P){if(!O||P==a)return xl(),void 0;n.getToolTipDiv();var l,o;if(P.html?(P=P.html,l=fs,Bm(we)):(l=we,Bm(fs)),o=l.style,l.innerHTML=P,l.parentNode||w.Default.appendToScreen(l),O.target){O=Lc(O);var F=bn(),$=O.x,R=O.y,f=jl?60:12;if(jl){var v=l.getBoundingClientRect();o.left=$-v.width/2+$h,o.top=R-v.height-f<F.top?R+f+$h:R-v.height-f+$h}else{o.left=$+f+$h,o.top=R+f+$h;var v=l.getBoundingClientRect();v.left+v.width>F.width&&(o.left=$-f-v.width+$h),v.top+v.height>F.height&&(o.top=R-f-v.height+$h),v.left<0&&(o.left=$+f+$h),v.top<0&&(o.top=R+f+$h)}}else o.left=O.x+$h,o.top=O.y+$h;qd()},startDragging:function(C,h,R){R==M&&(R=!0),C!==Ji&&(Ji?R&&(jl?Ji.handleWindowTouchEnd(h):Ji.handleWindowMouseUp(h)):jl?(i.addEventListener(Wj,bd,Y),i.addEventListener(cm,Pg,Y)):(i.addEventListener(gd,td,Y),i.addEventListener(Kn,Tk,Y)),Ji=C)},getImageMap:function(){return Yc},toBoundaries:function(Q,T,y,c){var p=[];return Cl(Q,T,y,c).forEach(function(m){var n=[];m.forEach(function(B){n.push(B.x,B.y)}),p.push(n)}),p},getCurrentKeyCodeMap:function(){return jj},drawCenterImage:function(m,E,o,n,x,M,W,K){var $=Uh(E,x,M),e=zq(E,x,M);Ad(m,E,J(o-$/2),J(n-e/2),$,e,x,M,W,K)},drawStretchImage:function(g,H,L,_,f,z,s,I,Q,v,Z,r){var P,A=Uh(H,I,Q,z),D=zq(H,I,Q,s);"uniform"===L?(P=p(z/A,s/D),A*=P,D*=P,_+=J((z-A)/2),f+=J((s-D)/2),z=A,s=D):"centerUniform"===L&&((A>z||D>s)&&(P=p(z/A,s/D),A*=P,D*=P),_+=J((z-A)/2),f+=J((s-D)/2),z=A,s=D);var l=g.interactiveInfo;if(l){var e;if(e="center"===L?{x:_+z/2-A/2,y:f+s/2-D/2,width:A,height:D}:{x:_,y:f,width:z,height:s},l.rect){var w=l.compInfos,X=w.length;X&&(w[X-1].rect.image=H)}else l.rect=e}if("center"===L){var c=Z!==!1&&(A>z||D>s);c&&(g.save(),g.beginPath(),g.rect(_,f,z,s),g.clip()),Ad(g,H,_+z/2-A/2,f+s/2-D/2,A,D,I,Q,v,r),c&&g.restore()}else Ad(g,H,_,f,z,s,I,Q,v,r)},toCanvas:function(M,m,T,t,u,o,L,N,z){M=hh(M,L),m=m||Uh(M,u),T=T||zq(M,u);var $=Hd(),J=rm($);return N?(En($,m,T,N),J.scale(N,N)):En($,m,T,1),Me(J,M,t,0,0,m,T,u,o,L,z),M&&M.clampToEdge&&($.clampToEdge=M.clampToEdge),J.restore(),$},toGrayColor:function(f){if(!f)return f;var F=Mj(f),n=.299*F[0]+.587*F[1]+.114*F[2];return"rgba("+n+","+n+","+n+","+F[3]/255+")"},createGradientImage:function(C,Z,L,A){for(var F=["L",0,0,C,0,1,0,0,1,0,0],m=0,V=Math.min(Z.length,L.length);V>m;m++)F.push(L[m],Z[m]);var D=w.Default.toCanvas({width:C,height:C,clampToEdge:!0,comps:[{type:"shape",rotation:A||0,points:[0,0,C,0,C,C,0,C],background:"#ffffff",gradientPack:F}]});return D},createElement:function(F,H,v,I){var P=j.createElement(F);return Vp(P,H||S.widgetBorder,2),P.style.font=v?v:ti,I!=a&&(P.value=I),n.onElementCreated&&n.onElementCreated(P),P},containedInView:function(p,T){var B=Jb(T).getBoundingClientRect();return Aj({x:B.left,y:B.top,width:B.width,height:B.height},Ac(p))},isIsolating:function(){return sn>0},setIsolating:function(E){E?sn++:sn--},getMSMap:function(){return Se},stringify:function(c,z,r){var b=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var l=JSON.stringify(c,function(X,y){return"function"==typeof y?"__ht__"+(y.__ht__||y.toString()):qg(y)?Sb(y):y instanceof w.List?"__ht__list"+(y.__ht__list||n.stringify(y._as)):y},z==a?2:z);return Date.prototype.toJSON=b,r&&(l="__ht__encode"+n.encodeString(l)),l},parse:function(j){return mc(j)?"__ht__encode"!=j.substr(0,12)||(j=n.decodeString(j.substr(12)),mc(j))?JSON.parse(j,function(P,V){if(mc(V))if("__ht__function"==V.substr(0,14)){var K=V.indexOf("{")+1,R=V.lastIndexOf("}"),t=V.indexOf("(")+1,U=V.indexOf(")");if(K&&R&&t&&U){var C=new Function(V.substring(t,U),V.substring(K,R));return C.__ht__=V.substr(6),C}}else{if("__ht__date"==V.substr(0,10))return new Date(Q(V.substr(10)));if("__ht__list"===V.substr(0,10))return new Yp(n.parse(V.substr(10)))}return V}):j:j},loadJS:function(E,I){I&&E.push(I);var x=E.shift();if(uo(x))E=x.contact(E),n.loadJS(E);else if(bi(x))x(),n.loadJS(E);else if(mc(x)){var W=j.createElement("script");W.onload=function(){n.loadJS(E)},W.setAttribute("src",x),j.getElementsByTagName("head")[0].appendChild(W)}else E.length&&n.loadJS(E)},toRoundedCorner:function(I,Q){var E=I.size();if(0>=Q)return{points:I};var r,L=new Yp,Z=new Yp,K=I.get(0);L.add(K),Z.add(1);for(var v=1;E>v;v++)if(E>v+1){var B=I.get(v),A=I.get(v+1),h=K.x,T=K.y,D=B.x,R=B.y,W=R-T,e=D-h,z=x(W,e);r=p(.99*sh(K,B),Q),L.add({x:D-r*s(z),y:R-r*N(z)}),L.add(B),h=B.x,T=B.y,D=A.x,R=A.y,W=R-T,e=D-h,z=x(W,e),r=p(.99*sh(B,A),Q),K={x:h+r*s(z),y:T+r*N(z)},L.add(K),Z.addAll([2,3])}else L.add(I.get(v)),Z.add(2);return{points:L,segments:Z}},toColorData:Mj,setCanvas:En,createDiv:lj,createDisabledDiv:Vk,createView:Ll,createCanvas:Hd,appendChild:eg,initContext:rm,checkLoadingImage:Br,translateAndScale:Dh,layout:Fl,getPosition:xp,drawPoints:Ok,drawRoundRect:pd,drawBorder:jd,setFocus:Tp,getter:mp,setter:Ip,isEmptyObject:os},!0),jn(C,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var sj=n.disabledOpacity,hi=n.toolTipDelay,ee=n.devicePixelRatio,Wr=n.autoMakeVisible,yg=n.autoHideScrollBar,rl=n.imageGradient,jc=n.showToolTip,xl=n.hideToolTip,tn=n.dashPattern,Tb=n.lineCap,$i=n.lineJoin,vc=n.labelColor,jp=n.labelSelectColor,ti=n.labelFont,No=n.widgetIndent,oc=n.widgetRowHeight,bk=n.widgetHeaderHeight,Td=n.widgetTitleHeight,ne=n.scrollBarColor,Xf=n.scrollBarSize,Zr=n.scrollBarTimeout,Jf=n.scrollBarMinLength,qf=n.scrollBarInteractiveSize,qq=n.zoomIncrement,xc=n.scrollZoomIncrement,Vj=n.pinchZoomIncrement,bc=n.zoomMax,ad=n.zoomMin,xi=n.createObject,gh=n.preventDefault,uh=n.setImage,hh=n.getImage,xh=n.isImageComplete,hk=n.drawCenterImage,Me=n.drawStretchImage,dj=n.getId,nd=n.callLater,Od=n.sortFunc,Vl=n.clone,Nj=n.getClass,nq=n.startAnim,Fe=n.brighter,Gi=n.darker,Fp=n.drawText,kr=n.getTextSize,Qk=n.isLeftButton,Zf=n.isMiddleButton,wr=n.getTouchCount,Ph=n.isDoubleClick,Gq=n.isShiftDown,Zl=n.isCtrlDown,Ac=n.getClientPoint,Lc=n.getPagePoint,sh=n.getDistance,rh=n.unionPoint,pc=n.unionRect,Aj=n.containsPoint,Hf=n.containsRect,Xl=n.intersectsRect,Xm=n.intersection,bn=n.getWindowInfo,di=n.grow,Ao=n.getLogicalPoint,dc=n.getScreenPoint,fg=n.startDragging,Bm=n.removeHTML,Nm=n.createElement,ko=n.segmentResolution,zs=n.shapeResolution,Nq=n.shapeSide,Qr=n.def,Cf=function(K,Z,f){Qr(D+"."+K,Z,f)},pm=function(j,D){j.childNodes.forEach(function(u){D(u),pm(u,D)})};jn(n,{toolTipLabelColor:vc,toolTipLabelFont:ti,toolTipBackground:S.toolTipBackground,toolTipShadowColor:_j,drawBreakableText:mh,setDevicePixelRatio:function(v){ee=n.devicePixelRatio="number"==typeof v?v:i.devicePixelRatio,pm(j.body,function(r){var c=r._ht;c&&c._canvas&&(En(c._canvas,c.getWidth(),c.getHeight()),c.redraw?c.redraw():c.iv())})}},!0);var Un=1e-6,Bd="undefined"!=typeof Uint16Array?Uint16Array:Array,go="undefined"!=typeof Float32Array?Float32Array:Array,Eh=function(g,Z,v){var t=[g[0]-Z[0],g[1]-Z[1],g[2]-Z[2]];if(v){var p=sh(t);p>0&&(t[0]/=p,t[1]/=p,t[2]/=p)}return t},on=function(){var $="charCodeAt",k=2*(2*Cm.length+1);for(var o in i)if(o===D+Ul[0]+($h.length+2)){var f=i[o];if(!f)break;for(var X=f.length,A=0;X>A;A++)if(f[A][$](0)===k&&f[A+1]!=a&&f[A+1]===$h[0]&&f[A+2]!=a&&f[A+2][$](0)===k){for(var t=A+3;X>t;t++)if(f[t][$](0)===k){if(0==f[t+1])for(var J,K=t+2;X>K;K++){if(f[K][$](0)===k){0==f[K-1]&&J&&(e=J.substr(0,J.length-1));break}J==a?J=f[K]:J+=f[K]}break}break}break}return function(b){return[-b[0],-b[1],-b[2]]}}(),Ng=function(L,G){return 3===L.length?L[0]*G[0]+L[1]*G[1]+L[2]*G[2]:L[0]*G[0]+L[1]*G[1]},vo=function(){var n=new go(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},On=vo(),dm=function(u){var h=new go(16);return h[0]=u[0],h[1]=u[1],h[2]=u[2],h[3]=u[3],h[4]=u[4],h[5]=u[5],h[6]=u[6],h[7]=u[7],h[8]=u[8],h[9]=u[9],h[10]=u[10],h[11]=u[11],h[12]=u[12],h[13]=u[13],h[14]=u[14],h[15]=u[15],h},$f=function(C,l){return C[0]=l[0],C[1]=l[1],C[2]=l[2],C[3]=l[3],C[4]=l[4],C[5]=l[5],C[6]=l[6],C[7]=l[7],C[8]=l[8],C[9]=l[9],C[10]=l[10],C[11]=l[11],C[12]=l[12],C[13]=l[13],C[14]=l[14],C[15]=l[15],C},cr=function(m){return m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,m},jr=function(H,o){var P=H[0],C=H[1],i=H[2];return H[0]=o[0]*P+o[4]*C+o[8]*i+o[12],H[1]=o[1]*P+o[5]*C+o[9]*i+o[13],H[2]=o[2]*P+o[6]*C+o[10]*i+o[14],H},sk=function(J,k){var W=J[0],F=J[1],q=J[2],A=J[3];return J[0]=k[0]*W+k[4]*F+k[8]*q+k[12]*A,J[1]=k[1]*W+k[5]*F+k[9]*q+k[13]*A,J[2]=k[2]*W+k[6]*F+k[10]*q+k[14]*A,J[3]=k[3]*W+k[7]*F+k[11]*q+k[15]*A,J},us=function(){var T,D,y,B,j=Wc(Xg[1]+Xg[7]),G=Wc(Xg[0]+Xg[3]-Xg[10]),o=Wc(Xg[8]+2),i=function(){return D=y.charAt(T),T+=1,D},z=function(){var c="";if(D===o)for(;i();){if(D===o)return i(),c;c+=D}else i()},b=function(){for(;D&&" ">=D;)i()},Z=function(){var E,W={};if(D===j){if(i(),b(),D===G)return i(),W;for(;D;){if(E=z(),b(),i(),W[E]=B(),b(),D===G)return i(),W;i(),b()}}};return B=function(){switch(b(),D){case j:return Z();default:return z()}},function(w){if(c={},w){var $;if(y=w,T=0,D=" ",$=B(),b(),!D)return $}}}(),jg=function(A,C){if(C){var a=N(C),F=s(C),o=A[4],$=A[5],d=A[6],x=A[7],Z=A[8],V=A[9],D=A[10],J=A[11];A[4]=o*F+Z*a,A[5]=$*F+V*a,A[6]=d*F+D*a,A[7]=x*F+J*a,A[8]=Z*F-o*a,A[9]=V*F-$*a,A[10]=D*F-d*a,A[11]=J*F-x*a}},ch=function(I,B){if(B){var $=N(B),L=s(B),v=I[0],y=I[1],H=I[2],F=I[3],u=I[8],k=I[9],l=I[10],b=I[11];I[0]=v*L-u*$,I[1]=y*L-k*$,I[2]=H*L-l*$,I[3]=F*L-b*$,I[8]=v*$+u*L,I[9]=y*$+k*L,I[10]=H*$+l*L,I[11]=F*$+b*L}},Lf=function(O,m){if(m){var d=N(m),U=s(m),r=O[0],E=O[1],y=O[2],u=O[3],Z=O[4],D=O[5],x=O[6],e=O[7];O[0]=r*U+Z*d,O[1]=E*U+D*d,O[2]=y*U+x*d,O[3]=u*U+e*d,O[4]=Z*U-r*d,O[5]=D*U-E*d,O[6]=x*U-y*d,O[7]=e*U-u*d}},Rl=function(Z,y,t){return js(a,t===!1?a:Z.getFinalScale3d(),Z.getFinalRotation3d(),Z.getRotationMode(),Z.p3(),a,y)},js=function(Y,x,I,y,q,o,n){return o||(o=vo()),q&&jo(o,q),Cq(o,I,y),n&&yb(o,o,n),x&&up(o,x),Y&&yb(o,o,Y),o},Oc=function(U,P,T){P=Q(P),T=Q(T);var g=this;g.g=U,g._84O=P,g._85O=T,g._70I=!0,g.F=0,g._83O=P+T,g.pen={x:0,y:0}},Ep="lineDashOffset",eq="setLineDash",sd=function(j){for(var X in j)1===X.length&&(Ep=j[X]);return X?1:0},Qq=function(Q,Z,v){return Zd(Z)?Q:Q[eq]?(Q[eq](Z),v&&(Q.lineDashOffset=v),Q):new Oc(Q,Z[0],Z.length>1?Z[1]:Z[0])},Oo=function(K,V){!Zd(V)&&K[eq]&&(K[eq](Wo),K.lineDashOffset=0)};if(Qr(Oc,E,{_69I:6,moveTo:function(V,u){var k=this,R=k.pen;R.x=V,R.y=u,k.g.moveTo(V,u),k.start||(k.start={x:V,y:u})},lineTo:function(y,T){var C=this,K=C.pen,h=y-K.x,O=T-K.y,G=x(O,h),J=s(G),l=N(G),r=C._23O(K.x,K.y,y,T),g=C._85O,u=C._84O,W=C._83O;if(C.F){if(C.F>r)return C._70I?C._72I(y,T):C.moveTo(y,T),C.F-=r,void 0;if(C._70I?C._72I(K.x+J*C.F,K.y+l*C.F):C.moveTo(K.x+J*C.F,K.y+l*C.F),r-=C.F,C.F=0,C._70I=!C._70I,!r)return}var e=R(r/W);if(e){for(var i=J*u,A=l*u,m=J*g,F=l*g,P=0;e>P;P++)C._70I?(C._72I(K.x+i,K.y+A),C.moveTo(K.x+m,K.y+F)):(C.moveTo(K.x+m,K.y+F),C._72I(K.x+i,K.y+A));r-=W*e}C._70I?r>u?(C._72I(K.x+J*u,K.y+l*u),C.moveTo(y,T),C.F=g-(r-u),C._70I=!1):(C._72I(y,T),r===u?(C.F=0,C._70I=!C._70I):(C.F=u-r,C.moveTo(y,T))):r>g?(C.moveTo(K.x+J*g,K.y+l*g),C._72I(y,T),C.F=u-(r-g),C._70I=!0):(C.moveTo(y,T),r===g?(C.F=0,C._70I=!C._70I):C.F=g-r)},quadraticCurveTo:function(J,U,E,P){var D,S=this,z=S.pen,i=z.x,F=z.y,c=S._22O(i,F,J,U,E,P),I=0,W=0,k=S._85O,y=S._84O;if(S.F){if(S.F>c)return S._70I?S._71I(J,U,E,P):S.moveTo(E,P),S.F-=c,void 0;if(I=S.F/c,D=S._20O(i,F,J,U,E,P,I),S._70I?S._71I(D[2],D[3],D[4],D[5]):S.moveTo(D[4],D[5]),S.F=0,S._70I=!S._70I,!c)return}var V=c-c*I,N=R(V/S._83O),_=y/c,u=k/c;if(N)for(var A=0;N>A;A++)S._70I?(W=I+_,D=S._21O(i,F,J,U,E,P,I,W),S._71I(D[2],D[3],D[4],D[5]),I=W,W=I+u,D=S._21O(i,F,J,U,E,P,I,W),S.moveTo(D[4],D[5])):(W=I+u,D=S._21O(i,F,J,U,E,P,I,W),S.moveTo(D[4],D[5]),I=W,W=I+_,D=S._21O(i,F,J,U,E,P,I,W),S._71I(D[2],D[3],D[4],D[5])),I=W;V=c-c*I,S._70I?V>y?(W=I+_,D=S._21O(i,F,J,U,E,P,I,W),S._71I(D[2],D[3],D[4],D[5]),S.moveTo(E,P),S.F=k-(V-y),S._70I=!1):(D=S._19O(i,F,J,U,E,P,I),S._71I(D[2],D[3],D[4],D[5]),c===y?(S.F=0,S._70I=!S._70I):(S.F=y-V,S.moveTo(E,P))):V>k?(W=I+u,D=S._21O(i,F,J,U,E,P,I,W),S.moveTo(D[4],D[5]),D=S._19O(i,F,J,U,E,P,W),S._71I(D[2],D[3],D[4],D[5]),S.F=y-(V-k),S._70I=!0):(S.moveTo(E,P),V===k?(S.F=0,S._70I=!S._70I):S.F=k-V)},bezierCurveTo:function(){var U=arguments;this.pen={x:U[4],y:U[5]},this.g.bezierCurveTo(U[0],U[1],U[2],U[3],U[4],U[5])},arc:function(N,x,u,T,U,W){W||(T=-T,U=-U),wl(this,N,x,T,U-T,u,u,!1)},rect:function(O,g,r,d){var f=this;f.pen={x:O,y:g},f.moveTo(O,g),f.lineTo(O,g+d),f.lineTo(O+r,g+d),f.lineTo(O+r,g),f.lineTo(O,g)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(Q,a,w,S){var D=w-Q,r=S-a;return l(D*D+r*r)},_22O:function(g,G,w,b,_,T,h){for(var A,D,r,l,v,i,k,e=0,W=g,B=G,z=h>0?h:this._69I,t=1;z>=t;t++)r=t/z,l=1-r,v=l*l,i=2*r*l,k=r*r,A=v*g+i*w+k*_,D=v*G+i*b+k*T,e+=this._23O(W,B,A,D),W=A,B=D;return e},_21O:function(I,J,v,$,p,F,H,g){var U=this;if(0===H)return U._20O(I,J,v,$,p,F,g);if(1===g)return U._19O(I,J,v,$,p,F,H);var k=U._20O(I,J,v,$,p,F,g);return k.push(H/g),U._19O.apply(U,k)},_20O:function(d,M,z,x,T,V,F){if(1!==F){var r=z+(T-z)*F,D=x+(V-x)*F;z=d+(z-d)*F,x=M+(x-M)*F,T=z+(r-z)*F,V=x+(D-x)*F}return[d,M,z,x,T,V]},_19O:function(o,A,G,Q,b,w,p){if(1!==p){var c=o+(G-o)*p,e=A+(Q-A)*p;G+=(b-G)*p,Q+=(w-Q)*p,o=c+(G-c)*p,A=e+(Q-e)*p}return[o,A,G,Q,b,w]},_72I:function(N,p){var Y=this.pen;(N!==Y.x||p!==Y.y)&&(Y.x=N,Y.y=p,this.g.lineTo(N,p))},_71I:function(v,N,Q,$){var U=this.pen;(v!==Q||N!==$||Q!==U.x||$!==U.y)&&(U.x=Q,U.y=$,this.g.quadraticCurveTo(v,N,Q,$))}}),d&&q){var mj=q.toString();V=mj.indexOf(de.substr(0,2))>0&&mj.indexOf(rr+rr.substr(1,1))>1||mj.indexOf(oo.substr(0,2)+de.substr(2,2)+Ul[0]+de[4])>1?!0:!1}var sc=a,Lo=a,je=function($){sc&&!$._72O&&(Lo||(Lo={}),Lo[$._72O=dj()]=$)},$n=function(W,T){if(T||(T=W),T&&(sc||(sc={}),!sc[W])){var d=new Gm;if(sc[T]={request:d,url:T},T=n.beforeLoadURL(T),T.data){var j=n.parse(T.data);Jn(W,j),n.handleCompTypeLoaded(W,j)}else{d.onload=function(){if(200===this.status||0===this.status){var F=n.parse(d.getResponseText());Jn(W,F),n.handleCompTypeLoaded(W,F)}else Jn(W,a)},d.onerror=function(){Jn(W,a)};var y={};y.url=encodeURI(T),y.sync=!1,d.send(y)}}},Jn=function(q,W){if(dp[q]=W,delete sc[q],os(sc)&&(sc=a,Lo)){for(var N in Lo){var w=Lo[N];w.invalidateAll&&w.invalidateAll(M,"compTypeLoaded",q),w.redraw&&w.redraw(),w.iv(),delete w._72O}Lo=a}if(W&&Lo)for(var N in Lo){var w=Lo[N];w.invalidateAll&&w.invalidateAll(M,"compTypeLoading",q),w.redraw&&w.redraw(),w.iv()}},li=S.chart,lk="",sf=n.compStack=[],If=/^style@/,nn=/^attr@/,hf=/^field@/,Bf={x:.5,y:.5},Uh=function(_,D,g,b){if(!_)return 0;if(Io(_.fitSize,D,g)&&b)return b;var f=Io(_.width,D,g);return null==f?20:f},zq=function(G,A,V,j){if(!G)return 0;if(Io(G.fitSize,A,V)&&j)return j;var H=Io(G.height,A,V);return null==H?20:H},Io=function(u,s,i){if(!u||!u.func)return u;var T,L=u.func,v=u.value;return T=bi(L)?i&&i.vectorDataBindingDisabled&&!u.isSafeFunc?v:L(s,i):s instanceof ed?nn.test(L)?s.a(lk+L.slice(5)):If.test(L)?s.s(lk+L.slice(6)):hf.test(L)?s[L.slice(6)]:s[L]?s[L](i):v:v,v!==M&&T==a?v:T},Ad=n.drawImage=function(){var T,V,m,Q,k,o,U=function(E,g){E.getValue&&E.getValue.compType===g||(E.getValue=function(V){var d=u(E,V);if(d===M&&g.properties){var f=g.properties[V];f&&(d=f.defaultValue)}return d},E.getColor=function(P){return A(E.getValue(P))},E.getValue.compType=g)},u=function(h,I,Y){var $,U=!1;if(h.prefix&&V instanceof ed){var L=V.a(lk+I);L!==M&&(U=!0,$=L)}return $===M&&($=h[I]),$&&$.func&&(U=!0,$=Io($,V,m)),Y&&($=Y($),U||(h[I]=$)),$},A=function(O,Y){var v;if(v=Y?u(O,Y):O,T&&T.compGray&&v)return n.toGrayColor(v);if(k&&v){if("override"===o)return k;if("override_rgb"===o){var I=fj(k);return v=Mj(v),"rgba("+R(255*I[0])+","+R(255*I[1])+","+R(255*I[2])+","+v[3]/255+")"}if("override_a"===o){var I=fj(k);return v=Mj(v),"rgba("+v[0]+","+v[1]+","+v[2]+","+I[3]+")"}var I=fj(k);return v=Mj(v),"rgba("+R(v[0]*I[0])+","+R(v[1]*I[1])+","+R(v[2]*I[2])+","+v[3]/255*I[3]+")"}return v},Z=function(l){if(uo(l)){for(var L=new Yp,K=l.length,F=0;K>F;F+=2)L.add({x:l[F],y:l[F+1]});l=L}return l},B=function(E){var K=u(E,"anchorX"),x=u(E,"anchorY");if(K!==M||x!==M)return{x:K===M?Bf.x:K,y:x===M?Bf.y:x};var B=u(E,"type"),t=u(E,"name");if("image"!==B||!t)return Bf;var P=hh(t);return P&&P.anchorX!==M&&P.anchorY!==M?{x:P.anchorX,y:P.anchorY}:Bf},F=function(k,C){var X=u(k,vn),M=B(k);if(uo(X)){var d=X.length,i=u(k,"relative"),p=C.width,F=C.height;if(4===d)X={x:X[0],y:X[1],width:X[2],height:X[3]},i&&(X.x*=p,X.y*=F,X.width*=p,X.height*=F);else if(3===d){var m=X[0];X={width:X[1],height:X[2]},i&&(X.width*=p,X.height*=F),"object"==typeof m?m.length&&(m={x:m[0],y:m[1]}):m=xp(m,C,X),X.x=m.x-X.width*M.x,X.y=m.y-X.height*M.y}X.x+=u(k,"offsetX")||0,X.y+=u(k,"offsetY")||0,!i&&C.fitSize&&(X=$(k,X,C))}return X},$=function(b,g,h){if(g){var z,m,S,q={x:g.x,y:g.y,width:g.width,height:g.height},e=B(b),V=u(b,"layoutH"),J=u(b,"layoutV"),R=1,c=1,L=0,s=0,$=1,y=1;switch(V){case"left":break;case"right":q.x+=h.width-h.rw;break;case"center":q.x+=.5*(h.width-h.rw);break;case"scale":case"leftright":default:z=u(b,cj)||0,z&&(L=Math.abs(s=Math.sin(z)),$=Math.abs(y=Math.cos(z))),"leftright"!==V?(R+=$*(h.widthScale-1),c+=L*(h.widthScale-1)):(R+=q.width?$*(h.width-h.rw)/q.width:0,c+=q.height?L*(h.width-h.rw)/q.height:0,m=-Math.min(-e.x*y+e.y*s,-e.x*y-(1-e.y)*s,(1-e.x)*y+e.y*s,(1-e.x)*y-(1-e.y)*s))}switch(J){case"top":break;case"bottom":q.y+=h.height-h.rh;break;case"center":q.y+=.5*(h.height-h.rh);break;case"scale":case"topbottom":default:z==a&&(z=u(b,cj),z&&(L=Math.abs(s=Math.sin(z)),$=Math.abs(y=Math.cos(z)))),"topbottom"!==J?(R+=L*(h.heightScale-1),c+=$*(h.heightScale-1)):(R+=q.width?L*(h.height-h.rh)/q.width:0,c+=q.height?$*(h.height-h.rh)/q.height:0,S=-Math.min(-e.x*s-e.y*y,-e.x*s+(1-e.y)*y,(1-e.x)*s-e.y*y,(1-e.x)*s+(1-e.y)*y))}return(1!==R||1!==c)&&("scale"!==V&&V?"leftright"===V&&(q.x+=q.width*(1-R)*e.x+m*(h.width-h.rw)):q.x+=q.x*(h.widthScale-1)+e.x*q.width*(h.widthScale-R),"scale"!==J&&J?"topbottom"===J&&(q.y+=q.height*(1-c)*e.y+S*(h.height-h.rh)):q.y+=q.y*(h.heightScale-1)+e.y*q.height*(h.heightScale-c),q.width*=R,q.height*=c),q.width<0&&(q.width=0),q.height<0&&(q.height=0),q}},h=function(P){return uo(P)?new Yp(P):P},L=function(s,i,I,p,y,N,B){var c=T.interactiveInfo,P=s.transform;if(P)return T.save(),T.setTransform(P.a,P.b,P.c,P.d,P.tx,P.ty),c&&c.compInfos.push({comp:s,rect:i,matrix:P.clone()}),!0;y===M&&(y=1),N===M&&(N=1);var E=u(s,"clipPercentage"),k=Je(I,i);if(k&&!p&&1===y&&1===N&&!(1>E))return c&&c.compInfos.push({comp:s,rect:i,matrix:c.matrix.clone()}),!1;B=B||Bf;var v=i.x+i.width*B.x,j=i.y+i.height*B.y,S=I.x+I.width*B.x,J=I.y+I.height*B.y,z=I.width?y*(i.width/I.width):1,w=I.height?N*(i.height/I.height):1;if(T.save(),c&&(c.matrix.appendTranslate(v,j).appendRotate(p).appendScale(z,w).appendTranslate(-S,-J),c.compInfos.push({comp:s,rect:i,matrix:c.matrix.clone()})),Hc(T,v,j),As(T,p||0),cn(T,z,w),Hc(T,-S,-J),1>E){0>E&&(E=0);var O=_k(I,u(s,"clipDirection"),E);T.beginPath(),T.rect(O.x,O.y,O.width,O.height),T.clip()}return!0},f=function(){T.restore()},G=function(w,n,k){var m=u(w,"path"),I=u(w,cj),e=u(w,"scaleX"),M=u(w,"scaleY"),q=B(w),S=a,_=yh(null,m);if(k||(k=w.unionRect,k||(k=rh(_),w.path.func||(w.unionRect=k)),S=k),k){S||(S=w.unionRect,S||(S=rh(_),w.path.func||(w.unionRect=S)));var d=L(w,k,S,I,e,M,q),D=u(w,"borderPattern"),H=Qq(T,D),J=A(w,"background"),F=A(w,"borderColor"),g=u(w,"borderWidth"),y=u(w,"gradient"),X=A(w,"gradientColor"),N=u(w,"border3d"),i=A(w,"border3dColor"),W=u(w,"border3dAccuracy"),Y=T.lineJoin,b=T.lineCap;if(T.lineJoin=u(w,"borderJoin")||$i,T.lineCap=u(w,"borderCap")||Tb,J?(wf(T,J,y,X,S),yh(T,m),T.fill(),H!==T&&yh(T,m)):yh(T,m),g&&F){var K=u(w,"borderWidthAbsolute");K&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=g,T.strokeStyle=F,T.stroke(),K&&T.restore(),N&&kq(T,F,i,g,Q,W)}if(Oo(T,D),u(w,"dash")){var p=u(w,"dashWidth")||g;if(p>0){D=u(w,"dashPattern")||tn;var H=Qq(T,D,u(w,"dashOffset")),j=A(w,"dashColor")||A(lb);H!==T&&yh(T,m),T.strokeStyle=j,T.lineWidth=p,T.stroke(),u(w,"dash3d")&&kq(T,j,A(w,"dash3dColor"),p,Q,u(w,"dash3dAccuracy")),Oo(T,D)}}n===vn&&hm(T,J,u(w,"depth"),S),T.lineJoin=Y,T.lineCap=b,d&&f()}},l=function(z,b,x,p){var r=u(z,uf,Z),N=u(z,cj),v=B(z);if(r&&p.fitSize){var C=new Yp,X=rh(r),y=$(z,X,p),s=X.x+v.x*X.width,t=X.y+v.y*X.height,w=y.x+v.x*y.width,n=y.y+v.y*y.height,Y=X.width?y.width/X.width:1,c=X.height?y.height/X.height:1;r.each(function(p){C.add({x:w+(p.x-s)*Y,y:n+(p.y-t)*c})}),r=C,z.unionRect=null}var F=u(z,"scaleX"),g=u(z,"scaleY"),S=b===Of,j=a;if(!x&&S&&(x=z.unionRect,x||(x=rh(r),z.points.func||(z.unionRect=x)),j=x),x){S?j||(j=z.unionRect,j||(j=rh(r),z.points.func||(z.unionRect=j))):j=x;var i,K,U,l,e=L(z,x,j,N,F,g,v),E=u(z,"borderPattern"),H=Qq(T,E),O=A(z,"background"),R=hh(u(z,"repeatImage"),k,o),d=u(z,"gradientPack"),D=A(z,"borderColor"),I=u(z,"borderWidth"),J=u(z,"segments",h),P=u(z,"gradient"),G=A(z,"gradientColor"),W=u(z,"border3d"),_=A(z,"border3dColor"),M=u(z,"border3dAccuracy"),q=u(z,"closePath"),he=u(z,"fillRule")||"nonzero",jd=T.lineJoin,dg=T.lineCap;if(T.lineJoin=u(z,"borderJoin")||$i,T.lineCap=u(z,"borderCap")||Tb,S)if(O||R||d){var Vk=u(z,"fillClipPercentage");if(1>Vk){0>Vk&&(Vk=0);var un=_k(j,u(z,"fillClipDirection"),Vk);T.save(),T.beginPath(),T.rect(un.x,un.y,un.width,un.height),T.clip()}if(Ok(T,r,J,q),d)em(T,d);else if(R){var Og=T,bl=k,pb=o;Gr(T,R,k,o,V,m),T=Og,k=bl,o=pb}else{var Og=T;wf(T,O,P,G,j),T=Og}T.fill(he),1>Vk&&T.restore(),d&&T.restore(),H!==T&&Ok(H,r,J,q)}else Ok(H,r,J,q);else if("roundRect"===b?i=u(z,"cornerRadius"):"polygon"===b?i=u(z,"polygonSide"):"arc"===b&&(i=u(z,"arcFrom"),K=u(z,"arcTo"),U=u(z,"arcClose"),l=u(z,"arcOval")),O||R||d){var Vk=u(z,"fillClipPercentage");if(1>Vk){0>Vk&&(Vk=0);var un=_k(j,u(z,"fillClipDirection"),Vk);T.save(),T.beginPath(),T.rect(un.x,un.y,un.width,un.height),T.clip()}if(im(T,b,j,i,K,U,l),d)em(T,d);else if(R){var Og=T,bl=k,pb=o;Gr(T,R,k,o,V,m),T=Og,k=bl,o=pb}else wf(T,O,P,G,j);T.fill(he),1>Vk&&T.restore(),d&&T.restore(),T!==H&&im(H,b,j,i,K,U,l)}else im(H,b,j,i,K,U,l);if(I&&D){var Zb=u(z,"borderWidthAbsolute");Zb&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=I,T.strokeStyle=D,T.stroke(),Zb&&T.restore(),W&&kq(T,D,_,I,Q,M)}if(Oo(T,E),u(z,"dash")){var Qn=u(z,"dashWidth")||I;if(Qn>0){E=u(z,"dashPattern")||tn;var H=Qq(T,E,u(z,"dashOffset")),zg=A(z,"dashColor")||A(lb);H!==T&&(S?Ok(H,r,J,q):im(H,b,j,i,K,U,l)),T.strokeStyle=zg,T.lineWidth=Qn,T.stroke(),u(z,"dash3d")&&kq(T,zg,A(z,"dash3dColor"),Qn,Q,u(z,"dash3dAccuracy")),Oo(T,E)}}b===vn&&hm(T,O,u(z,"depth"),j),T.lineJoin=jd,T.lineCap=dg,e&&f()}},E=function(g,D){var x=k,L=o,j=k||u(g,Be),t=o||u(g,"blendMode"),K=hh(u(g,"name"),j,t);K&&(Me(T,K,u(g,"stretch"),D.x,D.y,D.width,D.height,V,m,j,null,t),k=x,o=L)},w=function(w,Z){var o=u(w,"text");o!=a&&Fp(T,o,u(w,"font"),A(w,Be),Z.x,Z.y,Z.width,Z.height,u(w,"align"),u(w,"vAlign"))},D=function(h,e){jd(T,A(h,Be),e.x,e.y,e.width,e.height,u(h,"width"))},C=function(g,G){var J=u(g,Bc),q=0;if(J&&(J.forEach(function(z){q+=z}),q>0)){for(var H=u(g,"colors")||li,y=u(g,"startAngle")||0,_=u(g,"hollow"),c=u(g,Hj),C=u(g,ab),Y=u(g,nc),n=c?new Yp:a,B=G.x,m=G.y,h=G.width,j=G.height,F=B+h/2,i=m+j/2,t=p(h,j)/2,w=0,E=0;E<J.length;E++){var D=J[E],e=O*D/q,K=y+e;if(T.fillStyle=H[w++],w===H.length&&(w=0),T.beginPath(),_){var $=F+s(y)*t/2,X=i+N(y)*t/2,x=F+s(K)*t,L=i+N(K)*t;T.moveTo($,X),T.arc(F,i,t/2,y,K,!1),T.lineTo(x,L),T.arc(F,i,t,K,y,!0)}else T.moveTo(F,i),T.arc(F,i,t,K,y,!0);n&&(e=(y+K)/2,n.add({text:bi(c)?c(D,E,q,V):D,x:F+.75*s(e)*t,y:i+.75*N(e)*t})),T.closePath(),T.fill(),y=K}n&&n.each(function(o){Fp(T,o.text,C,Y,o.x,o.y,0,0,Ho)})}},P=function(h,C){var A=u(h,bp);if(A&&A.length>0){var Y=A.length,U=u(h,Hj),N=u(h,ab),s=u(h,nc),$=U?new Yp:a,G=u(h,"minValue")||0,n=u(h,"maxValue");if(n==a&&(n=0,A.forEach(function(i){u(i,Bc).forEach(function(G){n=t(n,G)})})),G===n)return;for(var p=C.height/(n-G),c=C.y+n*p,R=u(A[0],Bc).length,e=C.width/(3*R+1),M=2*e/Y,Z=0,H=0;Y>H;H++)for(var o=A[H],z=u(o,Be),w=u(o,"colors"),g=u(o,Bc),L=0;R>L;L++){w?T.fillStyle=w[L]:z?T.fillStyle=z:(T.fillStyle=li[Z++],Z===li.length&&(Z=0));var I=g[L],O=I*p,q=C.x+(1+3*L)*e+H*M;if(Qf(T,q,c-O,M,O),$){var r=bi(U)?U(I,L,o,V):I,l=kr(N,r).height;$.add({x:q,y:c-O-l,width:M,height:l,text:r})}}$&&$.each(function(w){Fp(T,w.text,N,s,w.x,w.y,w.width,w.height,Ho)})}},K=function(b,N){var Q=u(b,bp);if(Q&&Q.length>0){var r=Q.length,S=u(Q[0],Bc).length,O=N.width/(3*S+1),K=0,A=u(b,"maxValue"),m=u(b,Hj),U=u(b,ab),F=u(b,nc),y=m?new Yp:a;if(A==a){A=0;for(var s=0;S>s;s++){for(var w=0,R=0;r>R;R++)w+=u(Q[R],Bc)[s];A=t(A,w)}}if(A>0){for(var s=0;S>s;s++)for(var v=N.y+N.height,R=0;r>R;R++){var _=Q[R],h=u(_,Be),f=u(_,Bc)[s],M=f/A*N.height;h?T.fillStyle=h:(T.fillStyle=li[K++],K===li.length&&(K=0)),v-=M;var $={x:N.x+(1+3*s)*O,y:v,width:2*O,height:M};Qf(T,$.x,$.y,$.width,$.height),y&&($.text=bi(m)?m(f,s,_,V):f,y.add($))}y&&y.each(function(s){Fp(T,s.text,U,F,s.x,s.y,s.width,s.height,Ho)})}}},b=function(K,Q){var W=u(K,bp);if(W&&W.length>0){for(var X=W.length,I=u(W[0],Bc).length,G=Q.width/(3*I+1),l=0,j=u(K,Hj),e=u(K,ab),p=u(K,nc),m=j?new Yp:a,v=0;I>v;v++){for(var t=0,S=0;X>S;S++)t+=u(W[S],Bc)[v];if(t>0){var z=Q.y+Q.height;for(S=0;X>S;S++){var R=W[S],A=u(R,Be),y=u(R,Bc)[v],C=y/t*Q.height;A?T.fillStyle=A:(T.fillStyle=li[l++],l===li.length&&(l=0)),z-=C;var P={x:Q.x+(1+3*v)*G,y:z,width:2*G,height:C};Qf(T,P.x,P.y,P.width,P.height),m&&(P.text=bi(j)?j(y,v,R,V):y,m.add(P))}}}m&&m.each(function(u){Fp(T,u.text,e,p,u.x,u.y,u.width,u.height,Ho)})}},c=function($,P){var W=u($,bp);if(W&&W.length>0){var i=W.length,s=u($,"minValue")||0,E=u($,"maxValue");if(E==a&&(E=0,W.forEach(function(V){u(V,Bc).forEach(function(b){E=t(E,b)})})),s===E)return;for(var A=P.height/(E-s),g=P.y+E*A,f=u(W[0],Bc).length,o=P.width/(3*f+1),y=0,K=u($,"lineWidth")||2,q=u($,"line3d"),F=u($,"linePoint"),Z=u($,Hj),L=u($,ab),G=u($,nc),p=0;i>p;p++){var x=W[p],c=u(x,Be),C=u(x,Bc);c?T.strokeStyle=c:(c=T.strokeStyle=li[y++],y===li.length&&(y=0)),T.beginPath();for(var H=0;f>H;H++){var S=P.x+(2+3*H)*o,e=g-C[H]*A;0===H?T.moveTo(S,e):T.lineTo(S,e)}if(T.lineWidth=K,T.stroke(),q&&kq(T,c,a,K,Q),F||Z){var v,R=K/2+2;for(H=0;f>H;H++){var X=C[H];if(S=P.x+(2+3*H)*o,e=g-X*A,bi(F)?F(T,S,e,c,H,x,V):F&&(T.fillStyle=c,T.beginPath(),T.arc(S,e,R,0,O,!0),T.fill()),bi(Z)?v=Z(X,H,x,V):Z&&(v=X),v){var k=kr(L,v).height,J=T.shadowBlur;if(J){var r=T.shadowOffsetX,Y=T.shadowOffsetY,M=T.shadowColor;T.shadowOffsetX=0,T.shadowOffsetY=0,T.shadowBlur=0,T.shadowColor=a}Fp(T,v,L,G,S,e-k-R+2,0,k,Ho),J&&(T.shadowOffsetX=r,T.shadowOffsetY=Y,T.shadowBlur=J,T.shadowColor=M)}}}}}},W=function(){T=null,V=null,m=null},x=function(p,K){var H;m&&m.getState?H=m.getState(V):(H=V instanceof ed?V.s(yi):null,(H===M||null===H)&&(H=u(p,yi)));var J=u(K,yi);return J!==M&&null!==J&&J!==H?!1:u(K,Wm)},I={border:D,image:E,text:w,pieChart:C,columnChart:P,stackedColumnChart:K,percentageColumnChart:b,lineChart:c};return function(s,y,t,N,P,w,R,$,v,Y){if(y&&P&&w){var O=T?!1:!0;T=s,V=R,m=$,Q=m?m._zoom?m._zoom:1:1,k=v,o=Y;var z=P,b=w;if(rb()){var c,q,H;0===T[Yn]?rb[0]&&(c=!0):c=!0,T.texureImage2D?rb[1]&&(q=!0):q=!0,T.texureImage3D?rb[2]&&(H=!0):H=!0,c&&q&&H&&(z=t,b=N)}if(y.tagName)return mc(e)&&!i[e]||T.drawImage(y,z,b,P,w),O&&W(),void 0;if(u(y,"visible")===!1)return O&&W(),void 0;k||(k=Io(y.color,V,m)),Y||(o=Io(y.blendMode,V,m)),mc(e)&&!i[e]&&(P=z,w=b);var d=Uh(y,V,m,P),E=zq(y,V,m,w),_={x:0,y:0,width:d,height:E,fitSize:u(y,"fitSize")},D=u(y,"clip"),r=u(y,"opacity");if(_.fitSize){var C=_.rw=Io(y.width,V,m)||20;_.widthScale=d/C;var j=_.rh=Io(y.height,V,m)||20;_.heightScale=E/j}if(T.save(),T.interactiveInfo){var S=T.interactiveInfo.matrix,g=S.clone();S.appendTranslate(z,b).appendScale(P/d,w/E)}Hc(T,z,b),(d!==P||E!==w)&&T.scale(P/d,w/E),D&&(bi(D)?D(T,d,E,V,m,y):(T.beginPath(),T.rect(0,0,d,E),T.clip())),r!=a&&(T.globalAlpha*=r),u(y,"comps").forEach(function(w){if(x(y,w)!==!1){if(sf.splice(0,0,w),w.prefix){var r=lk,C=Io(w.prefix,V,m);C&&(lk=lk+C+".")}if(T.interactiveInfo)var H=T.interactiveInfo.matrix.clone();var S=u(w,"opacity"),b=u(w,"shadow"),Y=u(w,"type"),W=F(w,_);
if(S!=a){var P=T.globalAlpha;T.globalAlpha*=S}if(b){var i=T.shadowOffsetX,q=T.shadowOffsetY,g=T.shadowBlur,t=T.shadowColor,N=u(w,"shadowOffsetX"),R=u(w,"shadowOffsetY"),o=u(w,"shadowBlur"),s=A(w,"shadowColor");T.shadowOffsetX=(N==a?3:N)*Q,T.shadowOffsetY=(R==a?3:R)*Q,T.shadowBlur=(o==a?6:o)*Q,T.shadowColor=s||A(wb)}if("save"===Y)T.save();else if("endClip"===Y||"restore"===Y)T.restore();else if("clip"===Y)T.save(),Ok(T,u(w,"points",Z),u(w,"segments",h),!0),T.clip();else if(Zk[Y])W=W||{x:0,y:0,width:_.width,height:_.height},l(w,Y,W,_);else if(Y===Of)l(w,Y,W,_);else if("SVGPath"===Y)G(w,Y,W);else{W=W||{x:0,y:0,width:_.width,height:_.height};var z=u(w,cj),v=u(w,"scaleX"),O=u(w,"scaleY"),d=B(w),k=L(w,W,W,z,v,O,d);if(bi(Y))U(w,Y),n.drawCompType(Y,T,W,w,V,m);else if(n.getCompType(Y)){var X=n.getCompType(Y),J=X.func||X;U(w,X),n.drawCompType(J,T,W,w,V,m)}else I[Y]?I[Y](w,W):n.getCompType(Y)===M&&Uj.test(Y)&&$n(Y);k&&f()}b&&(T.shadowOffsetX=i,T.shadowOffsetY=q,T.shadowBlur=g,T.shadowColor=t),S!=a&&(T.globalAlpha=P),T.interactiveInfo&&(T.interactiveInfo.matrix=H),w.prefix&&(lk=r),sf.splice(0,1)}}),T.interactiveInfo&&(T.interactiveInfo.matrix=g),T.restore(),O&&W()}}}();n.getCurrentComp=function(){return sf[0]},n.getParentComp=function(){return sf[1]},n.getInternal=function(){return{isEnter:as,isEsc:_i,isSpace:Lh,isLeft:Wn,isUp:zb,isRight:Vd,isDown:Ym,addMethod:jn,superCall:Bh,toPointsArray:Cl,translateAndScale:Dh,appendArray:ks,createWorldMatrix:js,vec3TransformMat4:jr,setCanvas:En,createDiv:lj,createView:Ll,createCanvas:Hd,createImage:qp,initContext:rm,layout:Fl,fillRect:Qf,Mat:Lp,drawBorder:jd,isString:mc,setBorder:Vp,getPropertyValue:ll,setPropertyValue:hc,drawVerticalLine:Oq,draw3DRect:hm,getPinchDist:Gn,isSameRect:Je,getPosition:xp,intersectionLineRect:gl,getNodeRect:rn,getEdgeAgentPosition:Qn,getImageWidth:Uh,getImageHeight:zq,initItemElement:ue,drawPoints:Ok,createG2:Qq,closePopup:Dk,isH:ym,createAnim:nh,createNormalMatrix:Gl,createNormals:mg,toFloatArray:Lr,glMV:Sh,batchShape:kl,createNodeMatrix:Rl,getFaceInfo:Hm,transformAppend:rg,drawFaceInfo:Ud,to3dPointsArray:ce,setGLDebugMode:function(h){Xh=h},cube:function(){return{vs:an,is:id,uv:Xo}},ui:function(){return{DataUI:md,NodeUI:Wl,EdgeUI:Pn,GroupUI:fb,ShapeUI:mb,GridUI:Xp,Data3dUI:Wf,Node3dUI:gs,Shape3dUI:of}},getInternalVersion:function(){return"U2FsdGVkX19blQpJN2jLPBAdKAlZ6OpUQLZRAt5mnck="},getDragger:function(){return Ji},addMSMap:function(M){jn(Se,M)},k:L}},function(P){function r(i,R){i!=a&&(R==a&&Ce!=typeof i?this._54O(i,256):this._54O(i,R))}function n(){return new r(a)}function K(K,U,d,a,r,s){for(;--s>=0;){var H=U*this[K++]+d[a]+r;r=R(H/67108864),d[a++]=67108863&H}return r}function G(Y,L,X,k,J,D){for(var e=32767&L,A=L>>15;--D>=0;){var O=32767&this[Y],n=this[Y++]>>15,E=A*O+n*e;O=e*O+((32767&E)<<15)+X[k]+(1073741823&J),J=(O>>>30)+(E>>>15)+A*n+(J>>>30),X[k++]=1073741823&O}return J}function T($,R,i,A,m,X){for(var H=16383&R,K=R>>14;--X>=0;){var S=16383&this[$],Q=this[$++]>>14,b=K*S+Q*H;S=H*S+((16383&b)<<14)+i[A]+m,m=(S>>28)+(b>>14)+K*Q,i[A++]=268435455&S}return m}function M(w){return Xf.charAt(w)}function v(v,N){var n=cj[v.charCodeAt(N)];return n==a?-1:n}function x(o){for(var N=this.t-1;N>=0;--N)o[N]=this[N];o.t=this.t,o.s=this.s}function H(n){this.t=1,this.s=0>n?-1:0,n>0?this[0]=n:-1>n?this[0]=n+this.DV:this.t=0}function Y(L){var t=n();return t._58O(L),t}function y(U,e){var D,p=this;if(16==e)D=4;else if(8==e)D=3;else if(256==e)D=8;else if(2==e)D=1;else if(32==e)D=5;else{if(4!=e)return p.fromRadix(U,e),void 0;D=2}p.t=0,p.s=0;for(var y=U.length,I=!1,u=0;--y>=0;){var E=8==D?255&U[y]:v(U,y);0>E?"-"==U.charAt(y)&&(I=!0):(I=!1,0==u?p[p.t++]=E:u+D>p.DB?(p[p.t-1]|=(E&(1<<p.DB-u)-1)<<u,p[p.t++]=E>>p.DB-u):p[p.t-1]|=E<<u,u+=D,u>=p.DB&&(u-=p.DB))}8==D&&0!=(128&U[0])&&(p.s=-1,u>0&&(p[p.t-1]|=(1<<p.DB-u)-1<<u)),p._57O(),I&&r.ZERO._78O(p,p)}function E(){for(var n=this,G=n.s&n.DM;n.t>0&&n[n.t-1]==G;)--n.t}function S(f){var i=this;if(i.s<0)return"-"+i._85O()[fq](f);var $;if(16==f)$=4;else if(8==f)$=3;else if(2==f)$=1;else if(32==f)$=5;else{if(4!=f)return i.toRadix(f);$=2}var O,V=(1<<$)-1,P=!1,q="",Q=i.t,Z=i.DB-Q*i.DB%$;if(Q-->0)for(Z<i.DB&&(O=i[Q]>>Z)>0&&(P=!0,q=M(O));Q>=0;)$>Z?(O=(i[Q]&(1<<Z)-1)<<$-Z,O|=i[--Q]>>(Z+=i.DB-$)):(O=i[Q]>>(Z-=$)&V,0>=Z&&(Z+=i.DB,--Q)),O>0&&(P=!0),P&&(q+=M(O));return P?q:"0"}function q(){var G=n();return r.ZERO._78O(this,G),G}function c(){return this.s<0?this._85O():this}function I(k){var b=this,f=b.s-k.s;if(0!=f)return f;var M=b.t;if(f=M-k.t,0!=f)return b.s<0?-f:f;for(;--M>=0;)if(0!=(f=b[M]-k[M]))return f;return 0}function C(V){var D,i=1;return 0!=(D=V>>>16)&&(V=D,i+=16),0!=(D=V>>8)&&(V=D,i+=8),0!=(D=V>>4)&&(V=D,i+=4),0!=(D=V>>2)&&(V=D,i+=2),0!=(D=V>>1)&&(V=D,i+=1),i}function u(){var M=this;return M.t<=0?0:M.DB*(M.t-1)+C(M[M.t-1]^M.s&M.DM)}function m(L,C){var x;for(x=this.t-1;x>=0;--x)C[x+L]=this[x];for(x=L-1;x>=0;--x)C[x]=0;C.t=this.t+L,C.s=this.s}function j(O,C){for(var K=O;K<this.t;++K)C[K-O]=this[K];C.t=t(this.t-O,0),C.s=this.s}function B(b,v){var i,y=this,f=b%y.DB,D=y.DB-f,F=(1<<D)-1,I=R(b/y.DB),B=y.s<<f&y.DM;for(i=y.t-1;i>=0;--i)v[i+I+1]=y[i]>>D|B,B=(y[i]&F)<<f;for(i=I-1;i>=0;--i)v[i]=0;v[I]=B,v.t=y.t+I+1,v.s=y.s,v._57O()}function F(I,W){var M=this;W.s=M.s;var A=R(I/M.DB);if(A>=M.t)return W.t=0,void 0;var k=I%M.DB,t=M.DB-k,Z=(1<<k)-1;W[0]=M[A]>>k;for(var L=A+1;L<M.t;++L)W[L-A-1]|=(M[L]&Z)<<t,W[L-A]=M[L]>>k;k>0&&(W[M.t-A-1]|=(M.s&Z)<<t),W.t=M.t-A,W._57O()}function o(x,I){for(var l=this,Q=0,K=0,i=p(x.t,l.t);i>Q;)K+=l[Q]-x[Q],I[Q++]=K&l.DM,K>>=l.DB;if(x.t<l.t){for(K-=x.s;Q<l.t;)K+=l[Q],I[Q++]=K&l.DM,K>>=l.DB;K+=l.s}else{for(K+=l.s;Q<x.t;)K-=x[Q],I[Q++]=K&l.DM,K>>=l.DB;K-=x.s}I.s=0>K?-1:0,-1>K?I[Q++]=l.DV+K:K>0&&(I[Q++]=K),I.t=Q,I._57O()}function V(L,e){var z=this.abs(),Z=L.abs(),$=z.t;for(e.t=$+Z.t;--$>=0;)e[$]=0;for($=0;$<Z.t;++$)e[$+z.t]=z.am(0,Z[$],e,$,0,z.t);e.s=0,e._57O(),this.s!=L.s&&r.ZERO._78O(e,e)}function w(U){for(var G=this.abs(),o=U.t=2*G.t;--o>=0;)U[o]=0;for(o=0;o<G.t-1;++o){var m=G.am(o,G[o],U,2*o,0,1);(U[o+G.t]+=G.am(o+1,2*G[o],U,2*o+1,m,G.t-o-1))>=G.DV&&(U[o+G.t]-=G.DV,U[o+G.t+1]=1)}U.t>0&&(U[U.t-1]+=G.am(o,G[o],U,2*o,0,1)),U.s=0,U._57O()}function U(P,U,S){var h=P.abs(),L=this;if(!(h.t<=0)){var t=L.abs();if(t.t<h.t)return U!=a&&U._58O(0),S!=a&&L._77O(S),void 0;S==a&&(S=n());var Z=n(),x=L.s,f=P.s,d=L.DB-C(h[h.t-1]);d>0?(h._44O(d,Z),t._44O(d,S)):(h._77O(Z),t._77O(S));var k=Z.t,v=Z[k-1];if(0!=v){var $=v*(1<<L.F1)+(k>1?Z[k-2]>>L.F2:0),y=L.FV/$,W=(1<<L.F1)/$,q=1<<L.F2,m=S.t,Q=m-k,c=U==a?n():U;for(Z._59O(Q,c),S._52O(c)>=0&&(S[S.t++]=1,S._78O(c,S)),r.ONE._59O(k,c),c._78O(Z,Z);Z.t<k;)Z[Z.t++]=0;for(;--Q>=0;){var K=S[--m]==v?L.DM:R(S[m]*y+(S[m-1]+q)*W);if((S[m]+=Z.am(0,K,S,Q,0,k))<K)for(Z._59O(Q,c),S._78O(c,S);S[m]<--K;)S._78O(c,S)}U!=a&&(S._45O(k,U),x!=f&&r.ZERO._78O(U,U)),S.t=k,S._57O(),d>0&&S._46O(d,S),0>x&&r.ZERO._78O(S,S)}}}function X(j){var s=n();return this.abs()._49O(j,a,s),this.s<0&&s._52O(r.ZERO)>0&&j._78O(s,s),s}function W(B){this.m=B}function k(e){return e.s<0||e._52O(this.m)>=0?e.mod(this.m):e}function e(h){return h}function $(C){C._49O(this.m,a,C)}function Z(w,N,E){w._47O(N,E),this._74O(E)}function i(q,h){q._48O(h),this._74O(h)}function J(){if(this.t<1)return 0;var u=this[0];if(0==(1&u))return 0;var c=3&u;return c=15&c*(2-(15&u)*c),c=255&c*(2-(255&u)*c),c=65535&c*(2-(65535&(65535&u)*c)),c=c*(2-u*c%this.DV)%this.DV,c>0?this.DV-c:-c}function h(K){var X=this;X.m=K,X.mp=K._50O(),X.mpl=32767&X.mp,X.mph=X.mp>>15,X.um=(1<<K.DB-15)-1,X.mt2=2*K.t}function z(g){var u=n();return g.abs()._59O(this.m.t,u),u._49O(this.m,a,u),g.s<0&&u._52O(r.ZERO)>0&&this.m._78O(u,u),u}function _(N){var m=n();return N._77O(m),this._74O(m),m}function d(j){for(var C=this;j.t<=C.mt2;)j[j.t++]=0;for(var d=0;d<C.m.t;++d){var S=32767&j[d],E=S*C.mpl+((S*C.mph+(j[d]>>15)*C.mpl&C.um)<<15)&j.DM;for(S=d+C.m.t,j[S]+=C.m.am(0,E,j,d,0,C.m.t);j[S]>=j.DV;)j[S]-=j.DV,j[++S]++}j._57O(),j._45O(C.m.t,j),j._52O(C.m)>=0&&j._78O(C.m,j)}function Pr(h,Y){h._48O(Y),this._74O(Y)}function wg(C,F,B){C._47O(F,B),this._74O(B)}function mo(){return 0==(this.t>0?1&this[0]:this.s)}function $d(Q,P){if(Q>4294967295||1>Q)return r.ONE;var J=n(),j=n(),$=P._73O(this),o=C(Q)-1;for($._77O(J);--o>=0;)if(P._76O(J,j),(Q&1<<o)>0)P._75O(j,$,J);else{var B=J;J=j,j=B}return P.revert(J)}function _i(g,z){var b;return b=256>g||z._51O()?new W(z):new h(z),this.exp(g,b)}function Ml(){var K=this;if(K.s<0){if(1==K.t)return K[0]-K.DV;if(0==K.t)return-1}else{if(1==K.t)return K[0];if(0==K.t)return 0}return(K[1]&(1<<32-K.DB)-1)<<K.DB|K[0]}function fs(C,s){return new r(C,s)}function Sr(){var v=this;v.n=a,v.e=0,v.d=a,v.p=a,v.q=a,v.dmp1=a,v.dmq1=a,v._10A=a}function Ym(T){return T._53O(this.e,this.n)}function Al(v){var B,c,q,k="",s=0;for(B=0;B<v.length&&v.charAt(B)!=sk;++B)q=Uf.indexOf(v.charAt(B)),0>q||(0==s?(k+=M(q>>2),c=3&q,s=1):1==s?(k+=M(c<<2|q>>4),c=15&q,s=2):2==s?(k+=M(c),k+=M(q>>2),c=3&q,s=3):(k+=M(c<<2|q>>4),k+=M(15&q),s=0));return 1==s&&(k+=M(c<<2)),k}function Io(f){var H=f.split(""),v=Al(f);return H.forEach(function(j){var o=j.length;o>0&&v&&(ip+=Q(j))}),v}function $b(g,h){var M=ve._4O.Util._56O(g,"ss"),H={},C=0;return H.v=M==h,H.t=1,H.s=0>C?-1:0,lh=H.v,C>0?H[0]=C:-1>C?H[0]=C+H.DV:H.t=0,[M,H]}function Ng(f){var B=38,l=f.substring(0,B);if(l&&30==l.indexOf("05000420")){var A=["ss",f.substring(B)];return A}return[]}function Hk(T,n){n=n.replace(Hh,""),n=n.replace(/[ \n]+/g,"");var K=fs(n,16);if(K._55O()>this.n._55O())return 0;var W=this._37O(K),w=W[fq](16).replace(/^1f+00/,""),x=Ng(w);if(0==x.length)return!1;for(var e,M,I,A=.5,_=Nq,q=[0,.5,.75,.875,.9375],U=[],E=[],m=[],l=O/_,c=x[1],y=$b(T,c)[0],X=0,h=0;X<q.length;X++){var z=0===X%2?0:.5;for(e=0;_>=e;e++)M=(e+z)*l,I=1-q[X],U.push(s(M)*A*I,-A+2*q[X]*A,-N(M)*A*I),E.push((e+z)/_,I)}for(X=0;X<q.length-1;X++){var v=X*(_+1),H=(X+1)*(_+1);for(e=0;_>e;e++)m.push(v+e,H+e+1,H+e,v+e,v+e+1,H+e+1)}return m.forEach(function(V){h+=V}),c==y&&h>10}var sc,wq=0xdeadbeefcafe,Nh=15715070==(16777215&wq),fq="toString",$m="",de="nat",nj=function(){};A=P["D"+11182[fq](g(2,5))];var Kf=r.prototype;Er+=Sn.substr(0,1);var ts=P.navigator?P.navigator.appName:"";Nh&&"Microsoft Internet Explorer"==ts?(Kf.am=G,sc=30):Nh&&"Netscape"!=ts?(Kf.am=K,sc=26):(Kf.am=T,sc=28),Kf.DB=sc,Kf.DM=(1<<sc)-1,Kf.DV=1<<sc;var Pd=52;Kf.FV=g(2,Pd),Kf.F1=Pd-sc,Kf.F2=2*sc-Pd;var Qp,wc,Xf="0123456789abcdefghijklmnopqrstuvwxyz",cj=[],cm=function(Z){return String.fromCharCode(Z)};for(Qp="0".charCodeAt(0),wc=0;9>=wc;++wc)cj[Qp++]=wc;for(Qp="a".charCodeAt(0),wc=10;36>wc;++wc)cj[Qp++]=wc;for(Qp="A".charCodeAt(0),wc=10;36>wc;++wc)cj[Qp++]=wc;var Hj=W.prototype;Hj._73O=k,Hj.revert=e,Hj._74O=$,Hj._75O=Z,Hj._76O=i;var uc=h.prototype;uc._73O=z,uc.revert=_,uc._74O=d,uc._75O=wg,uc._76O=Pr,Kf._77O=x,Kf._58O=H,Kf._54O=y,Kf._57O=E,Kf._59O=m,Kf._45O=j,Kf._44O=B,Kf._46O=F,Kf._78O=o,Kf._47O=V,Kf._48O=w,Kf._49O=U,Kf._50O=J,Kf._51O=mo,Kf.exp=$d,Kf.toString=S,Kf._85O=q,Kf.abs=c,Kf._52O=I,Kf._55O=u,Kf.mod=X,Kf._53O=_i,r.ZERO=Y(0),r.ONE=Y(1),Kf._86O=Ml;var zo=function(v,V){var i=this;i.isPublic=!0,typeof v!==Ce?(i.n=v,i.e=V):v!=a&&V!=a&&v.length>0&&V.length>0&&(i.n=fs(v,16),i.e=Q(V,16))};fd=function(){var Z,l,m=Io(Jg),G=m.substr(0,4),V=m.substr(4,2),K=m.substr(6,2),T=1,O=!T,g=L,R=[],c=ug.charAt(7);if(A&&(A[fq]().indexOf(de)<0||A[Er][fq]().indexOf(de)<0||!m?Z=a:(m=new A(G-0,V-T,K-0),l=m.setHours(9),A[Er]()>l?Z=Ab[c]:O=!0)),m&&Z&&Z[0]&&Z[b(.5)]&&g){var h=us(Z[0]),v=us(Z[1]);for(var I in v)R.push(I);var e,o=0,Y=h[R[o]],M=v[R[o++]],k=v[R[o++]],W=v[R[o++]],J=v[R[o++]],U=v[R[o++]],_=v[R[o++]],X=h[R[o]],t=v[R[o++]],s=Rl._27O(g);if(Y===M&&s&&t){e=M+k+W+J+U+_;var i=!_||_===Ch;if(!i&&_)for(var w,j=0,P=_.length;P>j;j++)_[j]===Fm[o]?w===Ch?i=!0:w=a:(w==a?w=_[j]:w+=_[j],j===P-1&&w===Ch&&(i=!0));e&&s._31O(e,t)&&s._31O(Y,X)&&i&&(!U||A[Er]()<U)&&(O=!0)}}return O||(im=Zd),c};var vj=Sr.prototype;vj._37O=Ym,vj._38O=zo;var Uf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",sk="=",Zl=25,xl=10,Jg="IBkJFQ==",Uq=Uq||function(h,x){var T={},a=T._7A={},J=a._6A=function(){function E(){}return{_80O:function(M){E.prototype=this;var i=new E;return M&&i._5A(M),i.hasOwnProperty("_82O")||(i._82O=function(){i.$super._82O.apply(this,arguments)}),i._82O.prototype=i,i.$super=this,i},_3A:function(){var J=this._80O();return J._82O.apply(J,arguments),J},_82O:function(){},_5A:function(i){for(var a in i)i.hasOwnProperty(a)&&(this[a]=i[a]);i.hasOwnProperty(fq)&&(this.toString=i.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),R=a._39O=J._80O({_82O:function(y,U){y=this._84O=y||[],this._65O=U!=x?U:4*y.length},toString:function(_){return(_||Z).stringify(this)},_89O:function(W){var c=this._84O,K=W._84O,L=this._65O,w=W._65O;if(this._57O(),L%4)for(var r=0;w>r;r++){var F=255&K[r>>>2]>>>24-8*(r%4);c[L+r>>>2]|=F<<24-8*((L+r)%4)}else if(K.length>65535)for(var r=0;w>r;r+=4)c[L+r>>>2]=K[r>>>2];else c.push.apply(c,K);return this._65O+=w,this},_57O:function(){var D=this._84O,J=this._65O;D[J>>>2]&=4294967295<<32-8*(J%4),D.length=b(J/4)},_88O:function(){var z=J._88O.call(this);return z._84O=this._84O.slice(0),z},_87O:function(T){for(var w=[],j=0;T>j;j+=4)w.push(0|4294967296*f);return new R._82O(w,T)}}),j=T._2A={},Z=j._69O={stringify:function(v){var K,H=v._84O,N=v._65O,j=[];for(K=0;N>K;K++){var e=255&H[K>>>2]>>>24-8*(K%4);j.push((e>>>4).toString(16)),j.push((15&e).toString(16))}return j.join("")},_68O:function(h){for(var q=h.length,W=[],j=0;q>j;j+=2)W[j>>>3]|=Q(h.substr(j,2),16)<<24-4*(j%8);return new R._82O(W,q/2)}},W=j._8A={stringify:function(m){var N,u=m._84O,k=m._65O,h=[];for(N=0;k>N;N++){var z=255&u[N>>>2]>>>24-8*(N%4);h.push(cm(z))}return h.join("")},_68O:function(E){var F,U=E.length,B=[];for(F=0;U>F;F++)B[F>>>2]|=(255&E.charCodeAt(F))<<24-8*(F%4);return new R._82O(B,U)}},S=j._9A={stringify:function(V){try{return decodeURIComponent(escape(W.stringify(V)))}catch(w){throw new Error("")}},_68O:function(_){return W._68O(unescape(encodeURIComponent(_)))}},Y=a._32O=J._80O({_1A:function(){this._83O=new R._82O,this._23O=0},_33O:function(k){typeof k==Ce&&(k=S._68O(k)),this._83O._89O(k),this._23O+=k._65O},_25O:function(k){var u=this._83O,j=u._84O,K=u._65O,L=this._79O,l=4*L,c=K/l;c=k?b(c):t((0|c)-this._22O,0);var V=c*L,O=p(4*V,K);if(V){for(var C=0;V>C;C+=L)this._20O(j,C);var N=j.splice(0,V);u._65O-=O}return new R._82O(N,O)},_88O:function(){var q=J._88O.call(this);return q._83O=this._83O._88O(),q},_22O:0});a._66O=Y._80O({cfg:J._80O(),_82O:function(J){this.cfg=this.cfg._80O(J),this._1A()},_1A:function(){Y._1A.call(this),this._34O()},_81O:function(f){return this._33O(f),this._25O(),this},_72O:function(m){m&&this._33O(m);var L=this._21O();return L},_79O:16,_26O:function(y){return function(d,c){return new y._82O(c)._72O(d)}},_19O:function(k){return function(F,o){return new w._71O._82O(k,o)._72O(F)}}});var w=T._67O={};return T}();!function(){var y=Uq,V=y._7A,i=V._39O,A=V._66O,S=y._67O,U=[],K=[];!function(){function Y(J){for(var Q=l(J),G=2;Q>=G;G++)if(!(J%G))return!1;return!0}function M(v){return 0|4294967296*(v-(0|v))}for(var h=2,x=0;64>x;)Y(h)&&(8>x&&(U[x]=M(g(h,.5))),K[x]=M(g(h,1/3)),x++),h++}();var M=[],G=S._41O=A._80O({_34O:function(){this._64O=new i._82O(U.slice(0))},_20O:function(Z,U){for(var q=this._64O._84O,n=q[0],e=q[1],H=q[2],T=q[3],G=q[4],C=q[5],p=q[6],c=q[7],x=0;64>x;x++){if(16>x)M[x]=0|Z[U+x];else{var O=M[x-15],g=(O<<25|O>>>7)^(O<<14|O>>>18)^O>>>3,o=M[x-2],k=(o<<15|o>>>17)^(o<<13|o>>>19)^o>>>10;M[x]=g+M[x-7]+k+M[x-16]}var f=G&C^~G&p,$=n&e^n&H^e&H,j=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),B=(G<<26|G>>>6)^(G<<21|G>>>11)^(G<<7|G>>>25),u=c+B+f+K[x]+M[x],r=j+$;c=p,p=C,C=G,G=0|T+u,T=H,H=e,e=n,n=0|u+r}q[0]=0|q[0]+n,q[1]=0|q[1]+e,q[2]=0|q[2]+H,q[3]=0|q[3]+T,q[4]=0|q[4]+G,q[5]=0|q[5]+C,q[6]=0|q[6]+p,q[7]=0|q[7]+c},_21O:function(){var d=this._83O,w=d._84O,E=8*this._23O,B=8*d._65O;return w[B>>>5]|=128<<24-B%32,w[(B+64>>>9<<4)+14]=R(E/4294967296),w[(B+64>>>9<<4)+15]=E,d._65O=4*w.length,this._25O(),this._64O},_88O:function(){var O=A._88O.call(this);return O._64O=this._64O._88O(),O}});y._41O=A._26O(G),y._42O=A._19O(G)}();var Hh=new RegExp("");Hh.compile("[^0-9a-f]","gi"),Sr._28O=-1,Sr._29O=-2,vj._31O=Hk,vj._63O=Hk,Sr._43O=-2;var hs=new function(){var g=this;g._5O=function(T,Z){if("8"!=T.substring(Z+2,Z+3))return 1;var U=Q(T.substring(Z+3,Z+4));return 0==U?-1:U>0&&10>U?U+1:-2},g._13O=function(w,t){var f=g._5O(w,t);return 1>f?"":w.substring(t+2,t+2+2*f)},g._12O=function(e,i){var F=g._13O(e,i);if(""==F)return-1;var n;return n=Q(F.substring(0,1))<8?new r(F,16):new r(F.substring(2),16),n._86O()},g._6O=function(I,P){var F=g._5O(I,P);return 0>F?F:P+2*(F+1)},g._11O=function($,q){var u=g._6O($,q),B=g._12O($,q);return $.substring(u,u+2*B)},g._10O=function(n,v){var M=g._6O(n,v),s=g._12O(n,v);return M+2*s},g._7O=function(c,u){var t=[],z=g._6O(c,u);t.push(z);for(var o=g._12O(c,u),A=z,U=0;;){var D=g._10O(c,A);if(D==a||D-z>=2*o)break;if(U>=200)break;t.push(D),A=D,U++}return t}};if(hs._90O=cm(xl+24),hs._91O=D+cm(xl*xl+8),ve==a||!ve)var ve={};ve._4O!=a&&ve._4O||(ve._4O={});var Tk=ve._4O;ve._4O.Util=new function(){var K=this;K._56O=function(l){var o=new ve._4O._3O;return o._30O(l)},K._4A=function(F){var l=new ve._4O._3O;return l._36O(F)},K._11A=function(D){var z=new Tk._3O;return z._30O(D)}},ve._4O._3O=function(){var P=this;P._8O=function(z,u){if("ss"==z&&"cj"==u){try{P.md=Uq._67O._41O._3A()}catch(f){nj($m)}P._24O=function(H){P.md._81O(H)},P._35O=function(l){var G=Uq._2A._69O._68O(l);P.md._81O(G)},P._60O=function(){var c=P.md._72O();return c[fq](Uq._2A._69O)},P._30O=function(f){return P._24O(f),P._60O()},P._36O=function(U){return P._35O(U),P._60O()}}},P._24O=function(){nj($m)},P._35O=function(){nj($m)},P._60O=function(){nj($m)},P._30O=function(){nj($m)},P._36O=function(){nj($m)},P._8O("ss","cj")},kj=function(r){var O=Yk[Mg[7]],E=1,o=!1;if(sp.a!=Yk[Qh])return sp.a;if(sp.forEach(function(P){E*=P}),r>E){if(O&&O[1]&&O[0]){var G=O[0],d=O[1];d=d.split(hs._90O),G=G.split(hs._90O);var B=d[3],m=G[3],X=d[7],Q=d[11],_=d[15],U=d[19],P=d[23],s=d[27],W=G[7],i=B+X+Q+_+U+P,K=P?!1:!0,u=m===B;if(P){var k=P&&P.split(Ip("firefox")[3]);if(k)for(var t=0;t<k.length;t++)if(um.indexOf(k[t])>=0){K=!0;break}}o=u&&Pe()(m,W)&&Pe()(i,s)&&K&&(!U||U>r)}o||(md.prototype._42=Zj)}else o=!0;return sp.a=o,o},Zl=String.fromCharCode(Zl+20);var Rn=function(x){return x=x.replace(Hh,$m),x=x.replace(/[ \n]+/g,$m)},Fi="30",Nj="06",Sd="02",uk="03",pn=fs,ns=/^1f+00/,Rl=function(){var D;return D={_18O:function(I){var o=I,f=o.replace(/\s+/g,""),S=Al(f);return S},_14O:function(X){var h=this._18O(X),R=this._15O(h);return R},_15O:function(b){var r=this._17O(b);if("2a864886f70d010101"==r._61O){var V=this._16O(r.key),U=new Sr;return U._38O(V.n,V.e),U}nj($m)},_16O:function(k){var G={};k.substr(0,2)!=Fi&&nj($m);var V=hs._7O(k,0);return 2!=V.length&&nj($m),k.substr(V[0],2)!=Sd&&nj($m),G.n=hs._11O(k,V[0]),k.substr(V[1],2)!=Sd&&nj($m),G.e=hs._11O(k,V[1]),G},_17O:function(y){var x={};x._40O=a;var P=hs._7O(y,0);2!=P.length&&nj($m);var w=P[0];y.substr(w,2)!=Fi&&nj($m);var v=hs._7O(y,w);return 2!=v.length&&nj($m),y.substr(v[0],2)!=Nj&&nj($m),x._61O=hs._11O(y,v[0]),y.substr(v[1],2)==Nj?x._40O=hs._11O(y,v[1]):y.substr(v[1],2)==Fi&&(x._40O={},x._40O.p=hs._70O(y,v[1],[0],Sd),x._40O.q=hs._70O(y,v[1],[1],Sd),x._40O.g=hs._70O(y,v[1],[2],Sd)),y.substr(P[1],2)!=uk&&nj($m),x.key=hs._11O(y,P[1]).substr(2),x}},D._17O?D:a}(),no=Rl._27O=function(B){return Rl._14O(B)};Pe=function(){return function(s,j){if(s&&j){j=Rn(j);var v=pn(j,g(2,4)),D=this;if(!D||!D.n||v._55O()>D.n._55O())return 0;var m=D._37O(v),Q=m[fq](g(2,4)).replace(ns,""),x=Ng(Q);if(0==x.length)return!1;var G=x[0],I=x[1],p=function(m){return ve._4O.Util._56O(m,G)},O=p(s);return I==O}}.bind(no(L))};var Yh,De;return function(){var s=ob.length-qk.length;if(s>0)for(var u=0;s>u;u++)Yh=Tk.Util,De=Rn}(),po=function(Y,H){H=De(H);var n=no(Ep),I=$h.length,x=2*I,L=pn(H,g(I,x)),D=n,p=!0;if(D){var j=D[ik[0]];j&&L._55O()<=j._55O()&&(p=!1)}if(p)return 0;var $=D._37O(L),N=$[fq](g(I,x)).replace(ns,""),X=Ng(N);if(0==X.length)return!1;var P=X[0],V=X[1],q=Yh._11A(Y,P);return V==q},Rl}(i,E),jn(n,{load:function(){var v={},m=function(U){return U?"c_"+(U.sync?"1":"0")+"_"+(U.post?"1":"0")+"_"+(U.responseType||"H")+"_"+(U.mimeType||"H")+"_"+(U.data?JSON.stringify(U.data):"H"):""};return function(j,z,O){var f,r=v[j],h=m(O);return r&&(f=r[h])?(f.push(z),void 0):(v[j]||(r=v[j]={count:0}),f=r[h]=[z],r.count++,n.xhrLoad(j,function(S){delete r[h],r.count--,r.count||delete v[j],f.forEach(function(R){R(S)})},O),void 0)}}(),asyncEach:function(a,R,E){"function"!=typeof E&&(E=Function.prototype);var s=new Array(a.length),w=0,T=!1;a.forEach(function(n,r){R(n,function(D,$){return T?void 0:D?(T=!0,E(null)):(s[r]=$,w++,w===a.length?E(s):void 0)})})},xhrLoad:function(v,Y,h){var e=!1;uo(v)||(e=!0,v=[v]),h=h||{},v.length;var o=h.sync,Q=!!h.post,k=null;return n.asyncEach(v,function(G,v){var y=new Gm;G=n.beforeLoadURL(G),G.data?v(null,G.data):(h.url=encodeURI(G),h.method=Q?"POST":"GET",h.responseType?y.setResponseType(h.responseType):y.setOverrideMimeType(h.mimeType||"text/plain"),y.onload=function(){200===this.status||0===this.status?v(null,y.getResponseText()):v(!0)},y.onerror=function(){v(!0)},y.send(h))},function(c){var r="function"==typeof Y;(r||o)&&(k=e&&c?c[0]:c,r&&Y(k))}),o?k:void 0}}),Math.sign===M&&(Math.sign=function(S){return 0>S?-1:S>0?1:+S});var jf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",un={encode:function(Z,_){var O,d,t,p,I,C,g,G="",W=0;for(Z=un._utf8_encode(Z);W<Z.length;)O=Z.charCodeAt(W++),d=Z.charCodeAt(W++),t=Z.charCodeAt(W++),p=O>>2,I=(3&O)<<4|d>>4,C=(15&d)<<2|t>>6,g=63&t,isNaN(d)?C=g=64:isNaN(t)&&(g=64),G=G+_.charAt(p)+_.charAt(I)+_.charAt(C)+_.charAt(g);return G},decode:function(z,F){var p,U,f,W,r,Z,A,e="",u=0;for(z=z.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<z.length;)W=F.indexOf(z.charAt(u++)),r=F.indexOf(z.charAt(u++)),Z=F.indexOf(z.charAt(u++)),A=F.indexOf(z.charAt(u++)),p=W<<2|r>>4,U=(15&r)<<4|Z>>2,f=(3&Z)<<6|A,e+=String.fromCharCode(p),64!=Z&&(e+=String.fromCharCode(U)),64!=A&&(e+=String.fromCharCode(f));return e=un._utf8_decode(e)},_utf8_encode:function(v){v=v.replace(/\r\n/g,"\n");for(var a="",j=0;j<v.length;j++){var Y=v.charCodeAt(j);128>Y?a+=String.fromCharCode(Y):Y>127&&2048>Y?(a+=String.fromCharCode(192|Y>>6),a+=String.fromCharCode(128|63&Y)):(a+=String.fromCharCode(224|Y>>12),a+=String.fromCharCode(128|63&Y>>6),a+=String.fromCharCode(128|63&Y))}return a},_utf8_decode:function(u){for(var d="",t=0,o=0,I=0,Q=0;t<u.length;)o=u.charCodeAt(t),128>o?(d+=String.fromCharCode(o),t++):o>191&&224>o?(I=u.charCodeAt(t+1),d+=String.fromCharCode((31&o)<<6|63&I),t+=2):(I=u.charCodeAt(t+1),Q=u.charCodeAt(t+2),d+=String.fromCharCode((15&o)<<12|(63&I)<<6|63&Q),t+=3);return d}};w.Math={generateUUID:function(){for(var i=[],v=0;256>v;v++)i[v]=(16>v?"0":"")+v.toString(16).toUpperCase();return function(){var X=0|4294967295*Math.random(),F=0|4294967295*Math.random(),Z=0|4294967295*Math.random(),h=0|4294967295*Math.random();return i[255&X]+i[255&X>>8]+i[255&X>>16]+i[255&X>>24]+"-"+i[255&F]+i[255&F>>8]+"-"+i[64|15&F>>16]+i[255&F>>24]+"-"+i[128|63&Z]+i[255&Z>>8]+"-"+i[255&Z>>16]+i[255&Z>>24]+i[255&h]+i[255&h>>8]+i[255&h>>16]+i[255&h>>24]}}(),clamp:function(o,D,u){return Math.max(D,Math.min(u,o))},generateIncreasingID:function(){var C=0;return function(){return++C}}(),encodeBase64:function(G,P){return un.encode(G,P||jf)},decodeBase64:function(P,X){return un.decode(P,X||jf)},randomArray:function(l,i){i=i||l.length;for(var n=i-1;n>0;n--){var o=Math.floor(Math.random()*(n+1)),y=l[n];l[n]=l[o],l[o]=y}return l}};var Jm=w.Matrix=w.Math.Matrix2d=function(I,h,Q,$,b){this.setFromTransform(I,h,Q,$,b)},Lp=Jm;Jm.prototype={},Jm.prototype.constructor=Jm,Jm.prototype.set=function(v,Q,N,o,r,B){return this.a=v,this.b=Q,this.c=N,this.d=o,this.tx=r,this.ty=B,this},Jm.prototype.setFromTransform=function(m,I,Q,a,w){var c=this;if(m===M)return c.a=1,c.b=0,c.c=0,c.d=1,c.tx=0,c.ty=0,void 0;m=m||0;var x=N(m),r=s(m);return a=a||1,w=w||1,c.a=r*a,c.b=x*a,c.c=-x*w,c.d=r*w,c.tx=I||0,c.ty=Q||0,c},Jm.prototype.apply=function(Y,Z){Z=Z||new Xd;var f=Y.x,x=Y.y;return Z.x=this.a*f+this.c*x+this.tx,Z.y=this.b*f+this.d*x+this.ty,Z},Jm.prototype.applyInverse=function(h,V){V=V||new Xd;var u=1/(this.a*this.d+this.c*-this.b),x=h.x,D=h.y;return V.x=this.d*u*x+-this.c*u*D+(this.ty*this.c-this.tx*this.d)*u,V.y=this.a*u*D+-this.b*u*x+(-this.ty*this.a+this.tx*this.b)*u,V},Jm.prototype.translate=function(r,b){return this.tx+=r,this.ty+=b,this},Jm.prototype.scale=function(G,E){return this.a*=G,this.d*=E,this.c*=G,this.b*=E,this.tx*=G,this.ty*=E,this},Jm.prototype.rotate=function(V){var f=Math.cos(V),e=Math.sin(V),G=this.a,H=this.c,_=this.tx;return this.a=G*f-this.b*e,this.b=G*e+this.b*f,this.c=H*f-this.d*e,this.d=H*e+this.d*f,this.tx=_*f-this.ty*e,this.ty=_*e+this.ty*f,this},Jm.prototype.appendTranslate=function(d,F){return this.tx+=this.a*d+this.c*F,this.ty+=this.b*d+this.d*F,this},Jm.prototype.appendScale=function(N,G){return this.a*=N,this.d*=G,this.c*=G,this.b*=N,this},Jm.prototype.appendRotate=function(P){if(!P)return this;var T=Math.cos(P),o=Math.sin(P),e=this.a,n=this.b;return this.a=e*T+this.c*o,this.b=n*T+this.d*o,this.c=-e*o+this.c*T,this.d=-n*o+this.d*T,this},Jm.prototype.append=function($){var A=this.a,l=this.b,r=this.c,P=this.d;return this.a=$.a*A+$.b*r,this.b=$.a*l+$.b*P,this.c=$.c*A+$.d*r,this.d=$.c*l+$.d*P,this.tx=$.tx*A+$.ty*r+this.tx,this.ty=$.tx*l+$.ty*P+this.ty,this},Jm.prototype.setTransform=function(x,f,z,N,k,m,_,y,Q){var u,Z,s,D,V,g,l,F,h,i;return V=Math.sin(_),g=Math.cos(_),l=Math.cos(Q),F=Math.sin(Q),h=-Math.sin(y),i=Math.cos(y),u=g*k,Z=V*k,s=-V*m,D=g*m,this.a=l*u+F*s,this.b=l*Z+F*D,this.c=h*u+i*s,this.d=h*Z+i*D,this.tx=x+(z*u+N*s),this.ty=f+(z*Z+N*D),this},Jm.prototype.prepend=function(j){var W=this.tx;if(1!==j.a||0!==j.b||0!==j.c||1!==j.d){var L=this.a,E=this.c;this.a=L*j.a+this.b*j.c,this.b=L*j.b+this.b*j.d,this.c=E*j.a+this.d*j.c,this.d=E*j.b+this.d*j.d}return this.tx=W*j.a+this.ty*j.c+j.tx,this.ty=W*j.b+this.ty*j.d+j.ty,this},Jm.prototype.transform=Jm.prototype.prepend,Jm.prototype.invert=function(){var I=this.a,G=this.b,S=this.c,H=this.d,C=this.tx,b=I*H-G*S;return this.a=H/b,this.b=-G/b,this.c=-S/b,this.d=I/b,this.tx=(S*this.ty-H*C)/b,this.ty=-(I*this.ty-G*C)/b,this},Jm.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Jm.prototype.clone=function(){var s=new Jm;return s.a=this.a,s.b=this.b,s.c=this.c,s.d=this.d,s.tx=this.tx,s.ty=this.ty,s},Jm.prototype.copy=function(v){return v.a=this.a,v.b=this.b,v.c=this.c,v.d=this.d,v.tx=this.tx,v.ty=this.ty,v},Jm.prototype.tf=function(s,y){1===arguments.length&&(y=s.y,s=s.x);var o=this;return{x:o.a*s+o.c*y+o.tx,y:o.b*s+o.d*y+o.ty}},Jm.prototype.tfi=function($,i){1===arguments.length&&(i=$.y,$=$.x);var e=this,w=1/(e.a*e.d+e.c*-e.b);return{x:e.d*w*$+-e.c*w*i+(e.ty*e.c-e.tx*e.d)*w,y:e.a*w*i+-e.b*w*$+(-e.ty*e.a+e.tx*e.b)*w}},Jm.IDENTITY=new Jm,Jm.TEMP_MATRIX=new Jm;var ps=w.Math.Quaternion=function(j,S,O,D){this.set(j,S,O,D)};E.assign(ps.prototype,{set:function(e,u,F,I){var c=this;return c._x=e||0,c._y=u||0,c._z=F||0,c._w=I!==M?I:1,c},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(X){var u=this;return u._x=X._x,u._y=X._y,u._z=X._z,u._w=X._w,u},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var k=this.length();return 0===k?(this._x=0,this._y=0,this._z=0,this._w=1):(k=1/k,this._x=this._x*k,this._y=this._y*k,this._z=this._z*k,this._w=this._w*k),this},fromArray:function(O,T){T===M&&(T=0);var V=this;return V._x=O[T],V._y=O[T+1],V._z=O[T+2],V._w=O[T+3],this},slerp:function(v,C){if(0===C)return this;if(1===C)return this.copy(v);var s=this._x,w=this._y,g=this._z,q=this._w,e=q*v._w+s*v._x+w*v._y+g*v._z;if(0>e?(this._w=-v._w,this._x=-v._x,this._y=-v._y,this._z=-v._z,e=-e):this.copy(v),e>=1)return this._w=q,this._x=s,this._y=w,this._z=g,this;var a=Math.sqrt(1-e*e);if(Math.abs(a)<.001)return this._w=.5*(q+this._w),this._x=.5*(s+this._x),this._y=.5*(w+this._y),this._z=.5*(g+this._z),this;var R=Math.atan2(a,e),l=Math.sin((1-C)*R)/a,o=Math.sin(C*R)/a;return this._w=q*l+this._w*o,this._x=s*l+this._x*o,this._y=w*l+this._y*o,this._z=g*l+this._z*o,this},setFromAxisAngle:function(U,d){var E=d/2,i=Math.sin(E);return this._x=U.x*i,this._y=U.y*i,this._z=U.z*i,this._w=Math.cos(E),this},setFromEuler:function(p){var T=p._x,z=p._y,I=p._z,k=p._order,v=Math.cos,D=Math.sin,u=v(T/2),d=v(z/2),M=v(I/2),P=D(T/2),G=D(z/2),C=D(I/2);return"XYZ"===k?(this._x=P*d*M+u*G*C,this._y=u*G*M-P*d*C,this._z=u*d*C+P*G*M,this._w=u*d*M-P*G*C):"YXZ"===k?(this._x=P*d*M+u*G*C,this._y=u*G*M-P*d*C,this._z=u*d*C-P*G*M,this._w=u*d*M+P*G*C):"ZXY"===k?(this._x=P*d*M-u*G*C,this._y=u*G*M+P*d*C,this._z=u*d*C+P*G*M,this._w=u*d*M-P*G*C):"ZYX"===k?(this._x=P*d*M-u*G*C,this._y=u*G*M+P*d*C,this._z=u*d*C-P*G*M,this._w=u*d*M+P*G*C):"YZX"===k?(this._x=P*d*M+u*G*C,this._y=u*G*M+P*d*C,this._z=u*d*C-P*G*M,this._w=u*d*M-P*G*C):"XZY"===k&&(this._x=P*d*M-u*G*C,this._y=u*G*M-P*d*C,this._z=u*d*C+P*G*M,this._w=u*d*M+P*G*C),this},setFromRotationMatrix:function(L){var J,o=L.el,a=o[0],x=o[4],X=o[8],Y=o[1],b=o[5],m=o[9],k=o[2],A=o[6],w=o[10],Z=a+b+w;return Z>0?(J=.5/Math.sqrt(Z+1),this._w=.25/J,this._x=(A-m)*J,this._y=(X-k)*J,this._z=(Y-x)*J):a>b&&a>w?(J=2*Math.sqrt(1+a-b-w),this._w=(A-m)/J,this._x=.25*J,this._y=(x+Y)/J,this._z=(X+k)/J):b>w?(J=2*Math.sqrt(1+b-a-w),this._w=(X-k)/J,this._x=(x+Y)/J,this._y=.25*J,this._z=(m+A)/J):(J=2*Math.sqrt(1+w-a-b),this._w=(Y-x)/J,this._x=(X+k)/J,this._y=(m+A)/J,this._z=.25*J),this},setFromToVectors:function(){var z,j;return function(t,u){return z===M&&(z=new pe),j=t.dot(u)+1,1e-7>j?(j=0,Math.abs(t.x)>Math.abs(t.z)?z.set(-t.y,t.x,0):z.set(0,-t.z,t.y)):z.crossVectors(t,u),this._x=z.x,this._y=z.y,this._z=z.z,this._w=j,this.normalize()}}(),setFromUnitVectors:function(){var z,m,A=1e-6;return function(Z,b){return z===M&&(z=new pe),m=Z.dot(b)+1,A>m?(m=0,Math.abs(Z.x)>Math.abs(Z.z)?z.set(-Z.y,Z.x,0):z.set(0,-Z.z,Z.y)):z.crossVectors(Z,b),this._x=z.x,this._y=z.y,this._z=z.z,this._w=m,this.normalize()}}(),multiply:function(H){return this.multiplyQuaternions(this,H)},premultiply:function(g){return this.multiplyQuaternions(g,this)},multiplyQuaternions:function(E,f){var n=E._x,N=E._y,e=E._z,R=E._w,d=f._x,F=f._y,b=f._z,D=f._w;return this._x=n*D+R*d+N*b-e*F,this._y=N*D+R*F+e*d-n*b,this._z=e*D+R*b+n*F-N*d,this._w=R*D-n*d-N*F-e*b,this}});var Ti=w.Math.Vector4=function(x,y,N,T){this.x=x||0,this.y=y||0,this.z=N||0,this.w=T!==M?T:1};E.assign(Ti.prototype,{isVector4:!0,set:function(J,L,S,P){return this.x=J,this.y=L,this.z=S,this.w=P,this},setScalar:function(G){return this.x=G,this.y=G,this.z=G,this.w=G,this},setX:function(g){return this.x=g,this},setY:function(K){return this.y=K,this},setZ:function(f){return this.z=f,this},setW:function(F){return this.w=F,this},setComponent:function(K,A){switch(K){case 0:this.x=A;break;case 1:this.y=A;break;case 2:this.z=A;break;case 3:this.w=A;break;default:throw new Error("index is out of range: "+K)}return this},getComponent:function(u){switch(u){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+u)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(Y){return this.x=Y.x,this.y=Y.y,this.z=Y.z,this.w=Y.w!==M?Y.w:1,this},add:function(S,l){return l!==M?this.addVectors(S,l):(this.x+=S.x,this.y+=S.y,this.z+=S.z,this.w+=S.w,this)},addScalar:function(m){return this.x+=m,this.y+=m,this.z+=m,this.w+=m,this},addVectors:function(e,q){return this.x=e.x+q.x,this.y=e.y+q.y,this.z=e.z+q.z,this.w=e.w+q.w,this},addScaledVector:function(y,A){return this.x+=y.x*A,this.y+=y.y*A,this.z+=y.z*A,this.w+=y.w*A,this},sub:function(N,F){return F!==M?this.subVectors(N,F):(this.x-=N.x,this.y-=N.y,this.z-=N.z,this.w-=N.w,this)},subScalar:function(l){return this.x-=l,this.y-=l,this.z-=l,this.w-=l,this},subVectors:function(F,g){return this.x=F.x-g.x,this.y=F.y-g.y,this.z=F.z-g.z,this.w=F.w-g.w,this
},multiplyScalar:function(q){return this.x*=q,this.y*=q,this.z*=q,this.w*=q,this},applyMatrix4:function(E){var Y=this.x,$=this.y,o=this.z,j=this.w,e=E.el;return this.x=e[0]*Y+e[4]*$+e[8]*o+e[12]*j,this.y=e[1]*Y+e[5]*$+e[9]*o+e[13]*j,this.z=e[2]*Y+e[6]*$+e[10]*o+e[14]*j,this.w=e[3]*Y+e[7]*$+e[11]*o+e[15]*j,this},divideScalar:function(L){return this.multiplyScalar(1/L)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var J=Math.sqrt(1-t.w*t.w);return 1e-4>J?(this.x=1,this.y=0,this.z=0):(this.x=t.x/J,this.y=t.y/J,this.z=t.z/J),this},setAxisAngleFromRotationMatrix:function(S){var h,$,f,U,m=.01,b=.1,R=S.el,y=R[0],X=R[4],K=R[8],Y=R[1],t=R[5],p=R[9],E=R[2],O=R[6],C=R[10];if(Math.abs(X-Y)<m&&Math.abs(K-E)<m&&Math.abs(p-O)<m){if(Math.abs(X+Y)<b&&Math.abs(K+E)<b&&Math.abs(p+O)<b&&Math.abs(y+t+C-3)<b)return this.set(1,0,0,0),this;h=Math.PI;var s=(y+1)/2,r=(t+1)/2,Q=(C+1)/2,D=(X+Y)/4,_=(K+E)/4,M=(p+O)/4;return s>r&&s>Q?m>s?($=0,f=.707106781,U=.707106781):($=Math.sqrt(s),f=D/$,U=_/$):r>Q?m>r?($=.707106781,f=0,U=.707106781):(f=Math.sqrt(r),$=D/f,U=M/f):m>Q?($=.707106781,f=.707106781,U=0):(U=Math.sqrt(Q),$=_/U,f=M/U),this.set($,f,U,h),this}var j=Math.sqrt((O-p)*(O-p)+(K-E)*(K-E)+(Y-X)*(Y-X));return Math.abs(j)<.001&&(j=1),this.x=(O-p)/j,this.y=(K-E)/j,this.z=(Y-X)/j,this.w=Math.acos((y+t+C-1)/2),this},min:function(R){return this.x=Math.min(this.x,R.x),this.y=Math.min(this.y,R.y),this.z=Math.min(this.z,R.z),this.w=Math.min(this.w,R.w),this},max:function(d){return this.x=Math.max(this.x,d.x),this.y=Math.max(this.y,d.y),this.z=Math.max(this.z,d.z),this.w=Math.max(this.w,d.w),this},clamp:function(q,S){return this.x=Math.max(q.x,Math.min(S.x,this.x)),this.y=Math.max(q.y,Math.min(S.y,this.y)),this.z=Math.max(q.z,Math.min(S.z,this.z)),this.w=Math.max(q.w,Math.min(S.w,this.w)),this},clampScalar:function(){var d,E;return function(x,p){return d===M&&(d=new Ti,E=new Ti),d.set(x,x,x,x),E.set(p,p,p,p),this.clamp(d,E)}}(),clampLength:function(c,G){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(c,Math.min(G,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(P){return this.normalize().multiplyScalar(P)},lerp:function(P,F){return this.x+=(P.x-this.x)*F,this.y+=(P.y-this.y)*F,this.z+=(P.z-this.z)*F,this.w+=(P.w-this.w)*F,this},lerpVectors:function(A,H,D){return this.subVectors(H,A).multiplyScalar(D).add(A)},equals:function(z){return z.x===this.x&&z.y===this.y&&z.z===this.z&&z.w===this.w},fromArray:function(m,N){return N===M&&(N=0),this.x=m[N],this.y=m[N+1],this.z=m[N+2],this.w=m[N+3],this},toArray:function(o,n){return o===M&&(o=[]),n===M&&(n=0),o[n]=this.x,o[n+1]=this.y,o[n+2]=this.z,o[n+3]=this.w,o},fromBufferAttribute:function(D,v){return this.x=D.getX(v),this.y=D.getY(v),this.z=D.getZ(v),this.w=D.getW(v),this}});var pe=w.Math.Vector3=function(L,m,v){L===M?(this.x=0,this.y=0,this.z=0):"object"==typeof L?this.copy(L):this.set(L,m==M?L:m,v==M?L:v)};E.assign(pe.prototype,{set:function(H,Y,x){return this.x=H,this.y=Y,this.z=x,this},setScalar:function(k){return this.x=k,this.y=k,this.z=k,this},setX:function(F){return this.x=F,this},setY:function(f){return this.y=f,this},setZ:function(W){return this.z=W,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(B){return B.x===M?(this.x=B[0],this.y=B[1],this.z=B[2]):(this.x=B.x,this.y=B.y,this.z=B.z),this},add:function(u){return this.x+=u.x,this.y+=u.y,this.z+=u.z,this},addScalar:function(z){return this.x+=z,this.y+=z,this.z+=z,this},addVectors:function(f,j){return this.x=f.x+j.x,this.y=f.y+j.y,this.z=f.z+j.z,this},addScaledVector:function(J,c){return this.x+=J.x*c,this.y+=J.y*c,this.z+=J.z*c,this},sub:function(R){return this.x-=R.x,this.y-=R.y,this.z-=R.z,this},subScalar:function(Q){return this.x-=Q,this.y-=Q,this.z-=Q,this},subVectors:function(T,$){return this.x=T.x-$.x,this.y=T.y-$.y,this.z=T.z-$.z,this},multiply:function(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this},multiplyScalar:function(_){return this.x*=_,this.y*=_,this.z*=_,this},distanceTo:function(j){return Math.sqrt(this.distanceToSquared(j))},distanceToSquared:function(K){var x=this.x-K.x,l=this.y-K.y,b=this.z-K.z;return x*x+l*l+b*b},distanceToSquared2:function(n){var y=this.x-n[0],P=this.y-n[1],R=this.z-n[2];return y*y+P*P+R*R},multiplyVectors:function(l,I){return this.x=l.x*I.x,this.y=l.y*I.y,this.z=l.z*I.z,this},transformDirection:function(u){var U=this.x,X=this.y,v=this.z,y=u.el;return this.x=y[0]*U+y[4]*X+y[8]*v,this.y=y[1]*U+y[5]*X+y[9]*v,this.z=y[2]*U+y[6]*X+y[10]*v,this.normalize()},applyEuler:function(){var G=new ps;return function(B){return this.applyQuaternion(G.setFromEuler(B))}}(),applyQuaternion:function(q){var t=this.x,Q=this.y,_=this.z,V=q._x,w=q._y,T=q._z,x=q._w,h=x*t+w*_-T*Q,o=x*Q+T*t-V*_,c=x*_+V*Q-w*t,W=-V*t-w*Q-T*_;return this.x=h*x+W*-V+o*-T-c*-w,this.y=o*x+W*-w+c*-V-h*-T,this.z=c*x+W*-T+h*-w-o*-V,this},applyMatrix4:function(v){var f=this.x,g=this.y,I=this.z,V=v.el,M=1/(V[3]*f+V[7]*g+V[11]*I+V[15]);return this.x=(V[0]*f+V[4]*g+V[8]*I+V[12])*M,this.y=(V[1]*f+V[5]*g+V[9]*I+V[13])*M,this.z=(V[2]*f+V[6]*g+V[10]*I+V[14])*M,this},applyMatrix3:function(U){var J=this.x,V=this.y,Q=this.z,E=U.el;return this.x=E[0]*J+E[3]*V+E[6]*Q,this.y=E[1]*J+E[4]*V+E[7]*Q,this.z=E[2]*J+E[5]*V+E[8]*Q,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var b=new pe;return function(u){return this.sub(b.copy(u).multiplyScalar(2*this.dot(u)))}}(),dot:function(z){return this.x*z.x+this.y*z.y+this.z*z.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var b=this.length();return b?this.multiplyScalar(1/b):this},setLength:function(L){return this.normalize().multiplyScalar(L)},fromArray:function(p,_){return _===M&&(_=0),this.x=p[_],this.y=p[_+1],this.z=p[_+2],this},toArray:function(x,i){return x===M&&(x=[0,0,0]),i===M&&(i=0),x[i]=this.x,x[i+1]=this.y,x[i+2]=this.z,x},cross:function(M){return this.crossVectors(this,M)},angleTo:function($){var G=this.dot($)/Math.sqrt(this.lengthSq()*$.lengthSq());return G>1||-1>G?0:Math.acos(G)},lerpVectors:function(O,J,L){return this.subVectors(J,O).multiplyScalar(L).add(O)},crossVectors:function(Q,l){var U=Q.x,K=Q.y,P=Q.z,r=l.x,g=l.y,z=l.z;return this.x=K*z-P*g,this.y=P*r-U*z,this.z=U*g-K*r,this},min:function(u){return this.x=Math.min(this.x,u.x),this.y=Math.min(this.y,u.y),this.z=Math.min(this.z,u.z),this},max:function(w){return this.x=Math.max(this.x,w.x),this.y=Math.max(this.y,w.y),this.z=Math.max(this.z,w.z),this},setFromMatrixPosition:function(W){return this.setFromMatrixColumn(W,3)},setFromMatrixScale:function(L){var t=this.setFromMatrixColumn(L,0).length(),M=this.setFromMatrixColumn(L,1).length(),A=this.setFromMatrixColumn(L,2).length();return this.x=t,this.y=M,this.z=A,this},setFromMatrixColumn:function($,W){return this.fromArray($.el,4*W)}});var Xd=w.Math.Vector2=function(i,y,B){"object"==typeof i&&(i.x!=M?(y=i.y,i=i.x,B=i.e):(B=i[2],y=i[1],i=i[0])),this.set(i||0,y||0,B)};Xd.prototype={},Xd.prototype.constructor=Xd,E.defineProperties(Xd.prototype,{width:{get:function(){return this.x},set:function(C){this.x=C}},height:{get:function(){return this.y},set:function(y){this.y=y}}}),Xd.prototype.clone=function(){return new Xd(this.x,this.y,this.e)},Xd.prototype.copy=function(U){return this.set(U.x,U.y,U.e),this},Xd.prototype.equals=function(I){return I.x===this.x&&I.y===this.y},Xd.prototype.set=function(P,F,l){return this.x=P||0,this.y=F||(0!==F?this.x:0),l!=M&&(this.e=l),this},Xd.prototype.setScalar=function(Q){return this.x=Q,this.y=Q,this},Xd.prototype.setX=function(C){return this.x=C||0,this},Xd.prototype.setY=function(Q){return this.y=Q||0,this},Xd.prototype.add=function(b){return this.x+=b.x,this.y+=b.y,this},Xd.prototype.addVectors=function(M,Q){return this.x=M.x+Q.x,this.y=M.y+Q.y,this},Xd.prototype.addScalar=function(g){return this.x+=g,this.y+=g,this},Xd.prototype.addScaledVector=function(H,N){return this.x+=H.x*N,this.y+=H.y*N,this},Xd.prototype.sub=function(o){return this.x-=o.x,this.y-=o.y,this},Xd.prototype.subScalar=function(j){return this.x-=j,this.y-=j,this},Xd.prototype.subVectors=function(K,i){return this.x=K.x-i.x,this.y=K.y-i.y,this},Xd.prototype.multiply=function(F){return this.x*=F.x,this.y*=F.y,this},Xd.prototype.multiplyScalar=function(I){return this.x*=I,this.y*=I,this},Xd.prototype.divide=function(h){return this.x/=h.x,this.y/=h.y,this},Xd.prototype.divideScalar=function(M){return this.multiplyScalar(1/M)},Xd.prototype.min=function(Z){return this.x=Math.min(this.x,Z.x),this.y=Math.min(this.y,Z.y),this},Xd.prototype.max=function(C){return this.x=Math.max(this.x,C.x),this.y=Math.max(this.y,C.y),this},Xd.prototype.fromArray=function(v,m){return m===M&&(m=0),this.x=v[m],this.y=v[m+1],this},Xd.prototype.clamp=function(Q,S){return this.x=Math.max(Q.x,Math.min(S.x,this.x)),this.y=Math.max(Q.y,Math.min(S.y,this.y)),this},Xd.prototype.clampScalar=function(){var P,D;return function(w,q){return P===M&&(P=new Xd,D=new Xd),P.set(w,w),D.set(q,q),this.clamp(P,D)}}(),Xd.prototype.clampLength=function(V,r){var B=this.length();return this.multiplyScalar(Math.max(V,Math.min(r,B))/B)},Xd.prototype.dot=function(p){return this.x*p.x+this.y*p.y},Xd.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Xd.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Xd.prototype.normalize=function(){return this.divideScalar(this.length())},Xd.prototype.angle=function(){var i=Math.atan2(this.y,this.x);return 0>i&&(i+=2*Math.PI),i},Xd.prototype.distanceTo=function(G){return Math.sqrt(this.distanceToSquared(G))},Xd.prototype.distanceToSquared=function(H){var t=this.x-H.x,R=this.y-H.y;return t*t+R*R},Xd.prototype.isNearEnough=function(q){return this.distanceToSquared(q)<1e-8},Xd.prototype.setLength=function(u){var i=this.length();return i?this.multiplyScalar(u/i):this},Xd.prototype.lerp=function(C,Y){return this.x+=(C.x-this.x)*Y,this.y+=(C.y-this.y)*Y,this},Xd.prototype.lerpVectors=function(b,r,Z){return this.subVectors(r,b).multiplyScalar(Z).add(b)},Xd.prototype.rotateAround=function(J,u){var R=J?J.x:0,U=J?J.y:0,E=Math.cos(u),L=Math.sin(u),h=this.x-R,l=this.y-U;return this.x=h*E-l*L+R,this.y=h*L+l*E+U,this},E.assign(G.prototype,{isMatrix3:!0,set:function(k,I,P,t,W,y,O,e,l){var G=this.el;return G[0]=k,G[1]=t,G[2]=O,G[3]=I,G[4]=W,G[5]=e,G[6]=P,G[7]=y,G[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(h){var P=this.el,R=h.el;return P[0]=R[0],P[1]=R[1],P[2]=R[2],P[3]=R[3],P[4]=R[4],P[5]=R[5],P[6]=R[6],P[7]=R[7],P[8]=R[8],this},setFromMatrix4:function(c){var z=c.el;return this.set(z[0],z[4],z[8],z[1],z[5],z[9],z[2],z[6],z[10]),this},applyToBufferAttribute:function(){var X=new pe;return function(R){for(var T=0,Y=R.count;Y>T;T++)X.x=R.getX(T),X.y=R.getY(T),X.z=R.getZ(T),X.applyMatrix3(this),R.setXYZ(T,X.x,X.y,X.z);return R}}(),multiply:function(k){return this.multiplyMatrices(this,k)},premultiply:function(m){return this.multiplyMatrices(m,this)},multiplyMatrices:function(o,m){var z=o.el,J=m.el,u=this.el,c=z[0],P=z[3],K=z[6],r=z[1],a=z[4],S=z[7],b=z[2],i=z[5],W=z[8],O=J[0],R=J[3],F=J[6],Y=J[1],Z=J[4],h=J[7],N=J[2],A=J[5],y=J[8];return u[0]=c*O+P*Y+K*N,u[3]=c*R+P*Z+K*A,u[6]=c*F+P*h+K*y,u[1]=r*O+a*Y+S*N,u[4]=r*R+a*Z+S*A,u[7]=r*F+a*h+S*y,u[2]=b*O+i*Y+W*N,u[5]=b*R+i*Z+W*A,u[8]=b*F+i*h+W*y,this},multiplyScalar:function(G){var Z=this.el;return Z[0]*=G,Z[3]*=G,Z[6]*=G,Z[1]*=G,Z[4]*=G,Z[7]*=G,Z[2]*=G,Z[5]*=G,Z[8]*=G,this},determinant:function(){var O=this.el,Z=O[0],f=O[1],I=O[2],V=O[3],t=O[4],k=O[5],p=O[6],c=O[7],w=O[8];return Z*t*w-Z*k*c-f*V*w+f*k*p+I*V*c-I*t*p},getInverse:function(L){var t=L.el,q=this.el,z=t[0],T=t[1],f=t[2],b=t[3],o=t[4],w=t[5],d=t[6],x=t[7],h=t[8],W=h*o-w*x,R=w*d-h*b,S=x*b-o*d,y=z*W+T*R+f*S;if(0===y)return this.identity();var s=1/y;return q[0]=W*s,q[1]=(f*x-h*T)*s,q[2]=(w*T-f*o)*s,q[3]=R*s,q[4]=(h*z-f*d)*s,q[5]=(f*b-w*z)*s,q[6]=S*s,q[7]=(T*d-x*z)*s,q[8]=(o*z-T*b)*s,this},transpose:function(){var w,y=this.el;return w=y[1],y[1]=y[3],y[3]=w,w=y[2],y[2]=y[6],y[6]=w,w=y[5],y[5]=y[7],y[7]=w,this},getNormalMatrix:function(N){return this.setFromMatrix4(N).getInverse(this).transpose()},transposeIntoArray:function(R){var s=this.el;return R[0]=s[0],R[1]=s[3],R[2]=s[6],R[3]=s[1],R[4]=s[4],R[5]=s[7],R[6]=s[2],R[7]=s[5],R[8]=s[8],this},setUvTransform:function(A,N,H,v,m,Y,t){var a=Math.cos(m),W=Math.sin(m);this.set(H*a,H*W,-H*(a*Y+W*t)+Y+A,-v*W,v*a,-v*(-W*Y+a*t)+t+N,0,0,1)},scale:function(K,x){var a=this.el;return a[0]*=K,a[3]*=K,a[6]*=K,a[1]*=x,a[4]*=x,a[7]*=x,this},rotate:function(k){var m=Math.cos(k),$=Math.sin(k),Z=this.el,u=Z[0],A=Z[3],E=Z[6],V=Z[1],d=Z[4],s=Z[7];return Z[0]=m*u+$*V,Z[3]=m*A+$*d,Z[6]=m*E+$*s,Z[1]=-$*u+m*V,Z[4]=-$*A+m*d,Z[7]=-$*E+m*s,this},translate:function(U,D){var u=this.el;return u[0]+=U*u[2],u[3]+=U*u[5],u[6]+=U*u[8],u[1]+=D*u[2],u[4]+=D*u[5],u[7]+=D*u[8],this},equals:function(r){for(var R=this.el,Y=r.el,n=0;9>n;n++)if(R[n]!==Y[n])return!1;return!0},fromArray:function(S,T){T===M&&(T=0);for(var G=0;9>G;G++)this.el[G]=S[G+T];return this},toArray:function(L,A){L===M&&(L=[]),A===M&&(A=0);var P=this.el;return L[A]=P[0],L[A+1]=P[1],L[A+2]=P[2],L[A+3]=P[3],L[A+4]=P[4],L[A+5]=P[5],L[A+6]=P[6],L[A+7]=P[7],L[A+8]=P[8],L}});var _e=w.Math.Plane=function(c,i){this.normal=c!==M?c:new pe(1,0,0),this.constant=i!==M?i:0};E.assign(_e.prototype,{set:function(L,z){return this.normal.copy(L),this.constant=z,this},setComponents:function(g,w,N,e){return this.normal.set(g,w,N),this.constant=e,this},setFromNormalAndCoplanarPoint:function(h,y){return this.normal.copy(h),this.constant=-y.dot(this.normal),this},setFromCoplanarPoints:function(){var P=new pe,t=new pe;return function(U,m,n){var T=P.subVectors(n,m).cross(t.subVectors(U,m)).normalize();return this.setFromNormalAndCoplanarPoint(T,U),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(M){return this.normal.copy(M.normal),this.constant=M.constant,this},normalize:function(){var W=1/this.normal.length();return this.normal.multiplyScalar(W),this.constant*=W,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(U){return this.normal.dot(U)+this.constant},distanceToSphere:function(w){return this.distanceToPoint(w.center)-w.radius},projectPoint:function(P,X){return X===M&&(X=new pe),X.copy(this.normal).multiplyScalar(-this.distanceToPoint(P)).add(P)},intersectLine:function(){var P=new pe;return function(A,R){R===M&&(R=new pe);var l=A.delta(P),O=this.normal.dot(l);if(0===O)return 0===this.distanceToPoint(A.start)?R.copy(A.start):M;var e=-(A.start.dot(this.normal)+this.constant)/O;return 0>e||e>1?M:R.copy(l).multiplyScalar(e).add(A.start)}}(),intersectsLine:function(K){var I=this.distanceToPoint(K.start),J=this.distanceToPoint(K.end);return 0>I&&J>0||0>J&&I>0},intersectsBox:function(T){return T.intersectsPlane(this)},intersectsSphere:function(U){return U.intersectsPlane(this)},coplanarPoint:function(j){return j===M&&(j=new pe),j.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var m=new pe,k=new G;return function(X,E){var F=E||k.getNormalMatrix(X),C=this.coplanarPoint(m).applyMatrix4(X),e=this.normal.applyMatrix3(F).normalize();return this.constant=-C.dot(e),this}}(),translate:function(O){return this.constant-=O.dot(this.normal),this},equals:function(j){return j.normal.equals(this.normal)&&j.constant===this.constant}});var hj=w.Math.Ray=function(b,G){this.origin=b!==M?b.clone():new pe,this.direction=G!==M?G.clone():new pe};E.assign(hj.prototype,{set:function(o,U){return this.origin.copy(o),this.direction.copy(U),this},clone:function(){return(new this.constructor).copy(this)},copy:function(h){return this.origin.copy(h.origin),this.direction.copy(h.direction),this.maxHitLen=h.maxHitLen,this},at:function(E,Z){var X=Z||new pe;return X.copy(this.direction).multiplyScalar(E).add(this.origin)},setMaxHitLength:function(G){this.maxHitLen=G},lookAt:function(m){return this.direction.copy(m).sub(this.origin).normalize(),this},applyMatrix4:function(g){var q=this.maxHitLen;if(q){var S=this.direction.clone().multiplyScalar(q).add(this.origin);S.applyMatrix4(g)}return this.origin.applyMatrix4(g),this.direction.transformDirection(g),q&&(this.maxHitLen=this.origin.distanceTo(S)),this},intersectBox:function(d,M){var y,E,R,w,W,o,k=1/this.direction.x,u=1/this.direction.y,X=1/this.direction.z,K=this.origin;if(k>=0?(y=(d.min.x-K.x)*k,E=(d.max.x-K.x)*k):(y=(d.max.x-K.x)*k,E=(d.min.x-K.x)*k),u>=0?(R=(d.min.y-K.y)*u,w=(d.max.y-K.y)*u):(R=(d.max.y-K.y)*u,w=(d.min.y-K.y)*u),y>w||R>E)return null;if((R>y||y!==y)&&(y=R),(E>w||E!==E)&&(E=w),X>=0?(W=(d.min.z-K.z)*X,o=(d.max.z-K.z)*X):(W=(d.max.z-K.z)*X,o=(d.min.z-K.z)*X),y>o||W>E)return null;if((W>y||y!==y)&&(y=W),(E>o||E!==E)&&(E=o),0>E)return null;var U=y>=0?y:E,l=this.maxHitLen;return l&&U>l?null:this.at(U,M)},intersectTriangle:function(){var X=new pe,w=new pe,k=new pe,L=new pe;return function(o,e,G,q,D){w.subVectors(e,o),k.subVectors(G,o),L.crossVectors(w,k);var x,_=this.direction.dot(L);if(_>0){if(q)return null;x=1}else{if(!(0>_))return null;x=-1,_=-_}X.subVectors(this.origin,o);var O=x*this.direction.dot(k.crossVectors(X,k));if(0>O)return null;var M=x*this.direction.dot(w.cross(X));if(0>M||O+M>_)return null;var N=-x*X.dot(L);if(0>N)return null;var b=N/_,g=this.maxHitLen;return g&&b>g?null:this.at(b,D)}}()});var ie=w.Math.Box3=function(r,U){this.min=r!==M?r:new pe(1/0,1/0,1/0),this.max=U!==M?U:new pe(-1/0,-1/0,-1/0)};E.assign(ie.prototype,{set:function(U,Z){return this.min.copy(U),this.max.copy(Z),this},setFromArray:function(l){for(var i=1/0,V=1/0,P=1/0,r=-1/0,C=-1/0,Z=-1/0,R=0,a=l.length;a>R;R+=3){var x=l[R],e=l[R+1],Q=l[R+2];i>x&&(i=x),V>e&&(V=e),P>Q&&(P=Q),x>r&&(r=x),e>C&&(C=e),Q>Z&&(Z=Q)}return this.min.set(i,V,P),this.max.set(r,C,Z),this},setFromPoints:function(N){this.makeEmpty();for(var n=0,G=N.length;G>n;n++)this.expandByPoint(N[n]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(x){return x.max.x<this.min.x||x.min.x>this.max.x||x.max.y<this.min.y||x.min.y>this.max.y||x.max.z<this.min.z||x.min.z>this.max.z?!1:!0},copy:function(R){return this.min.copy(R.min),this.max.copy(R.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(s){return this.min.min(s),this.max.max(s),this}});var tp=w.Math.Sphere=function(h,U){this.center=h!==M?h:new pe,this.radius=U!==M?U:0};E.assign(tp.prototype,{set:function(q,j){return this.center.copy(q),this.radius=j,this},setFromPoints:function(){var o=new ie;return function(X,s){var S=this.center;s!==M?S.copy(s):o.setFromPoints(X).getCenter(S);for(var D=0,Z=0,E=X.length;E>Z;Z++)D=Math.max(D,S.distanceToSquared(X[Z]));return this.radius=Math.sqrt(D),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(F){return this.center.copy(F.center),this.radius=F.radius,this},empty:function(){return this.radius<=0},containsPoint:function(k){return k.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(O){return O.distanceTo(this.center)-this.radius},intersectsSphere:function(w){var V=this.radius+w.radius;return w.center.distanceToSquared(this.center)<=V*V},intersectsBox:function(V){return V.intersectsSphere(this)},intersectsPlane:function(X){return Math.abs(X.distanceToPoint(this.center))<=this.radius},clampPoint:function(K,J){var q=this.center.distanceToSquared(K);return J===M&&(J=new pe),J.copy(K),q>this.radius*this.radius&&(J.sub(this.center).normalize(),J.multiplyScalar(this.radius).add(this.center)),J},getBoundingBox:function(E){return E===M&&(E=new ie),E.set(this.center,this.center),E.expandByScalar(this.radius),E},applyMatrix4:function(C){return this.center.applyMatrix4(C),this.radius=this.radius*C.getMaxScaleOnAxis(),this},translate:function(L){return this.center.add(L),this},equals:function(D){return D.center.equals(this.center)&&D.radius===this.radius}});var Vb=w.Math.Frustum=function(g,Z,j,c,k,a){this.planes=[g!==M?g:new _e,Z!==M?Z:new _e,j!==M?j:new _e,c!==M?c:new _e,k!==M?k:new _e,a!==M?a:new _e]};E.assign(Vb.prototype,{set:function(l,x,w,y,J,s){var I=this.planes;return I[0].copy(l),I[1].copy(x),I[2].copy(w),I[3].copy(y),I[4].copy(J),I[5].copy(s),this},clone:function(){return(new this.constructor).copy(this)},copy:function(i){for(var H=this.planes,F=0;6>F;F++)H[F].copy(i.planes[F]);return this},setFromMatrix:function(m){var v=this.planes,U=m.el,j=U[0],Z=U[1],y=U[2],h=U[3],X=U[4],n=U[5],x=U[6],R=U[7],i=U[8],b=U[9],J=U[10],T=U[11],$=U[12],N=U[13],q=U[14],L=U[15];return v[0].setComponents(h-j,R-X,T-i,L-$).normalize(),v[1].setComponents(h+j,R+X,T+i,L+$).normalize(),v[2].setComponents(h+Z,R+n,T+b,L+N).normalize(),v[3].setComponents(h-Z,R-n,T-b,L-N).normalize(),v[4].setComponents(h-y,R-x,T-J,L-q).normalize(),v[5].setComponents(h+y,R+x,T+J,L+q).normalize(),this},intersectsObject:function(){var I=new tp;return function(H){var m=H.geometry;return null===m.boundingSphere&&m.computeBoundingSphere(),I.copy(m.boundingSphere).applyMatrix4(H.matrixWorld),this.intersectsSphere(I)}}(),intersectsSprite:function(){var N=new tp;return function(E){return N.center.set(0,0,0),N.radius=.7071067811865476,N.applyMatrix4(E.matrixWorld),this.intersectsSphere(N)}}(),intersectsSphere:function(r){for(var K=this.planes,y=r.center,l=-r.radius,h=0;6>h;h++){var g=K[h].distanceToPoint(y);if(l>g)return!1}return!0},intersectsBox:function(){var y=new pe;return function(R){for(var G=this.planes,C=0;6>C;C++){var d=G[C];if(y.x=d.normal.x>0?R.max.x:R.min.x,y.y=d.normal.y>0?R.max.y:R.min.y,y.z=d.normal.z>0?R.max.z:R.min.z,d.distanceToPoint(y)<0)return!1}return!0}}(),containsPoint:function(P){for(var T=this.planes,n=0;6>n;n++)if(T[n].distanceToPoint(P)<0)return!1;return!0}});var yo=w.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};E.assign(yo.prototype,{set:function(R,B,p,Z,E,W,o,G,c,s,O,Y,L,w,X,K){var C=this.el;return C[0]=R,C[4]=B,C[8]=p,C[12]=Z,C[1]=E,C[5]=W,C[9]=o,C[13]=G,C[2]=c,C[6]=s,C[10]=O,C[14]=Y,C[3]=L,C[7]=w,C[11]=X,C[15]=K,this},clone:function(){return(new yo).fromArray(this.el)},fromArray:function(s,f){f===M&&(f=0);for(var g=this.el,B=0;16>B;B++)g[B]=s[B+f];return this},scale:function(G){var b=this.el,z=G.x,T=G.y,R=G.z;return b[0]*=z,b[4]*=T,b[8]*=R,b[1]*=z,b[5]*=T,b[9]*=R,b[2]*=z,b[6]*=T,b[10]*=R,b[3]*=z,b[7]*=T,b[11]*=R,this},makeRotationFromEuler:function(w){var H=this.el,K=w._x,x=w._y,v=w._z,U=w._order,Y=Math.cos(K),A=Math.sin(K),M=Math.cos(x),X=Math.sin(x),Q=Math.cos(v),O=Math.sin(v);if("XYZ"===U){var C=Y*Q,b=Y*O,e=A*Q,z=A*O;H[0]=M*Q,H[4]=-M*O,H[8]=X,H[1]=b+e*X,H[5]=C-z*X,H[9]=-A*M,H[2]=z-C*X,H[6]=e+b*X,H[10]=Y*M}else if("YXZ"===U){var t=M*Q,P=M*O,l=X*Q,R=X*O;H[0]=t+R*A,H[4]=l*A-P,H[8]=Y*X,H[1]=Y*O,H[5]=Y*Q,H[9]=-A,H[2]=P*A-l,H[6]=R+t*A,H[10]=Y*M}else if("ZXY"===U){var t=M*Q,P=M*O,l=X*Q,R=X*O;H[0]=t-R*A,H[4]=-Y*O,H[8]=l+P*A,H[1]=P+l*A,H[5]=Y*Q,H[9]=R-t*A,H[2]=-Y*X,H[6]=A,H[10]=Y*M}else if("ZYX"===U){var C=Y*Q,b=Y*O,e=A*Q,z=A*O;H[0]=M*Q,H[4]=e*X-b,H[8]=C*X+z,H[1]=M*O,H[5]=z*X+C,H[9]=b*X-e,H[2]=-X,H[6]=A*M,H[10]=Y*M}else if("YZX"===U){var B=Y*M,d=Y*X,o=A*M,J=A*X;H[0]=M*Q,H[4]=J-B*O,H[8]=o*O+d,H[1]=O,H[5]=Y*Q,H[9]=-A*Q,H[2]=-X*Q,H[6]=d*O+o,H[10]=B-J*O}else if("XZY"===U){var B=Y*M,d=Y*X,o=A*M,J=A*X;H[0]=M*Q,H[4]=-O,H[8]=X*Q,H[1]=B*O+J,H[5]=Y*Q,H[9]=d*O-o,H[2]=o*O-d,H[6]=A*Q,H[10]=J*O+B}return H[3]=0,H[7]=0,H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,this},makeRotationFromQuaternion:function(L){var v=this.el,n=L._x,u=L._y,y=L._z,Q=L._w,E=n+n,x=u+u,F=y+y,q=n*E,T=n*x,K=n*F,r=u*x,U=u*F,d=y*F,W=Q*E,M=Q*x,z=Q*F;return v[0]=1-(r+d),v[4]=T-z,v[8]=K+M,v[1]=T+z,v[5]=1-(q+d),v[9]=U-W,v[2]=K-M,v[6]=U+W,v[10]=1-(q+r),v[3]=0,v[7]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(J){var L=this.el,n=J.el,m=n[0],p=n[1],S=n[2],f=n[3],K=n[4],I=n[5],M=n[6],E=n[7],j=n[8],u=n[9],W=n[10],P=n[11],$=n[12],H=n[13],Y=n[14],k=n[15],O=u*Y*E-H*W*E+H*M*P-I*Y*P-u*M*k+I*W*k,T=$*W*E-j*Y*E-$*M*P+K*Y*P+j*M*k-K*W*k,h=j*H*E-$*u*E+$*I*P-K*H*P-j*I*k+K*u*k,z=$*u*M-j*H*M-$*I*W+K*H*W+j*I*Y-K*u*Y,g=m*O+p*T+S*h+f*z;if(0===g)return this.identity();var x=1/g;return L[0]=O*x,L[1]=(H*W*f-u*Y*f-H*S*P+p*Y*P+u*S*k-p*W*k)*x,L[2]=(I*Y*f-H*M*f+H*S*E-p*Y*E-I*S*k+p*M*k)*x,L[3]=(u*M*f-I*W*f-u*S*E+p*W*E+I*S*P-p*M*P)*x,L[4]=T*x,L[5]=(j*Y*f-$*W*f+$*S*P-m*Y*P-j*S*k+m*W*k)*x,L[6]=($*M*f-K*Y*f-$*S*E+m*Y*E+K*S*k-m*M*k)*x,L[7]=(K*W*f-j*M*f+j*S*E-m*W*E-K*S*P+m*M*P)*x,L[8]=h*x,L[9]=($*u*f-j*H*f-$*p*P+m*H*P+j*p*k-m*u*k)*x,L[10]=(K*H*f-$*I*f+$*p*E-m*H*E-K*p*k+m*I*k)*x,L[11]=(j*I*f-K*u*f-j*p*E+m*u*E+K*p*P-m*I*P)*x,L[12]=z*x,L[13]=(j*H*S-$*u*S+$*p*W-m*H*W-j*p*Y+m*u*Y)*x,L[14]=($*I*S-K*H*S-$*p*M+m*H*M+K*p*Y-m*I*Y)*x,L[15]=(K*u*S-j*I*S+j*p*M-m*u*M-K*p*W+m*I*W)*x,this},makeRotationAxis:function(t,i){var A=Math.cos(i),S=Math.sin(i),n=1-A,w=t.x,s=t.y,x=t.z,D=n*w,F=n*s;return this.set(D*w+A,D*s-S*x,D*x+S*s,0,D*s+S*x,F*s+A,F*x-S*w,0,D*x-S*s,F*x+S*w,n*x*x+A,0,0,0,0,1),this},multiply:function(f){return this.multiplyMatrices(this,f)},premultiply:function(h){return this.multiplyMatrices(h,this)},multiplyMatrices:function(f,$){var L=f.el,b=$.el,d=this.el,A=L[0],P=L[4],M=L[8],h=L[12],N=L[1],c=L[5],u=L[9],v=L[13],Y=L[2],O=L[6],Q=L[10],y=L[14],D=L[3],w=L[7],j=L[11],R=L[15],x=b[0],g=b[4],e=b[8],J=b[12],m=b[1],r=b[5],T=b[9],n=b[13],E=b[2],X=b[6],q=b[10],S=b[14],U=b[3],H=b[7],i=b[11],a=b[15];return d[0]=A*x+P*m+M*E+h*U,d[4]=A*g+P*r+M*X+h*H,d[8]=A*e+P*T+M*q+h*i,d[12]=A*J+P*n+M*S+h*a,d[1]=N*x+c*m+u*E+v*U,d[5]=N*g+c*r+u*X+v*H,d[9]=N*e+c*T+u*q+v*i,d[13]=N*J+c*n+u*S+v*a,d[2]=Y*x+O*m+Q*E+y*U,d[6]=Y*g+O*r+Q*X+y*H,d[10]=Y*e+O*T+Q*q+y*i,d[14]=Y*J+O*n+Q*S+y*a,d[3]=D*x+w*m+j*E+R*U,d[7]=D*g+w*r+j*X+R*H,d[11]=D*e+w*T+j*q+R*i,d[15]=D*J+w*n+j*S+R*a,this},lookAt:function(){var W=new pe,P=new pe,J=new pe;return function(e,S,L){var F=this.el;return J.subVectors(e,S),0===J.lengthSq()&&(J.z=1),J.normalize(),W.crossVectors(L,J),0===W.lengthSq()&&(1===Math.abs(L.z)?J.x+=1e-4:J.z+=1e-4,J.normalize(),W.crossVectors(L,J)),W.normalize(),P.crossVectors(J,W),F[0]=W.x,F[4]=P.x,F[8]=J.x,F[1]=W.y,F[5]=P.y,F[9]=J.y,F[2]=W.z,F[6]=P.z,F[10]=J.z,this}}(),extractScale:function(){var k;return function(g){k===M&&(k=new pe),g===M&&(g=new pe);var c=k.setFromMatrixColumn(this,0).length(),n=k.setFromMatrixColumn(this,1).length(),I=k.setFromMatrixColumn(this,2).length();return g.set(c,n,I),g}}(),extractRotation:function(){var K;return function(N){K===M&&(K=new pe),N===M&&(N=new yo);var j=this.el,l=N.el,F=1/K.setFromMatrixColumn(N,0).length(),d=1/K.setFromMatrixColumn(N,1).length(),x=1/K.setFromMatrixColumn(N,2).length();return j[0]=l[0]*F,j[1]=l[1]*F,j[2]=l[2]*F,j[4]=l[4]*d,j[5]=l[5]*d,j[6]=l[6]*d,j[8]=l[8]*x,j[9]=l[9]*x,j[10]=l[10]*x,this}}(),multiplyScalar:function(H){var y=this.el;return y[0]*=H,y[4]*=H,y[8]*=H,y[12]*=H,y[1]*=H,y[5]*=H,y[9]*=H,y[13]*=H,y[2]*=H,y[6]*=H,y[10]*=H,y[14]*=H,y[3]*=H,y[7]*=H,y[11]*=H,y[15]*=H,this},getPosition:function(Q){return Q===M&&(Q=new pe),Q.setFromMatrixColumn(this,3)},setPosition:function(F){var Y=this.el;return Y[12]=F.x,Y[13]=F.y,Y[14]=F.z,this},toArray:function(e,_){e===M&&(e=[]),_===M&&(_=0);var $=this.el;return e[_]=$[0],e[_+1]=$[1],e[_+2]=$[2],e[_+3]=$[3],e[_+4]=$[4],e[_+5]=$[5],e[_+6]=$[6],e[_+7]=$[7],e[_+8]=$[8],e[_+9]=$[9],e[_+10]=$[10],e[_+11]=$[11],e[_+12]=$[12],e[_+13]=$[13],e[_+14]=$[14],e[_+15]=$[15],e}});var Yg=w.Math.Triangle=function(v,s,R){this.a=v!==M?v:new pe,this.b=s!==M?s:new pe,this.c=R!==M?R:new pe};E.assign(Yg,{barycoordFromPoint:function(){var i=new pe,Q=new pe,T=new pe;return function(s,z,D,A,g){i.subVectors(A,z),Q.subVectors(D,z),T.subVectors(s,z);var u=i.dot(i),L=i.dot(Q),N=i.dot(T),W=Q.dot(Q),l=Q.dot(T),q=u*W-L*L,e=g||new pe;if(0===q)return e.set(-2,-1,-1);var m=1/q,o=(W*N-L*l)*m,E=(u*l-L*N)*m;return e.set(1-o-E,E,o)}}()});var uc=w.Math.Euler=function(L,G,s,U,q){this.set(L,G,s,U,q)};uc.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],uc.DefaultOrder="XYZ",uc.ReverseOrder=function($){return $=$[2]+$[1]+$[0],$.toUpperCase()},E.defineProperties(uc.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(h){this._y=h,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(K){this._z=K,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(i){this._order=i,this.onChangeCallback()}}}),E.assign(uc.prototype,{set:function(U,t,P,C,V){return uo(U)&&(V=P,C=t,P=U[2],t=U[1],U=U[0]),C?V&&(C=uc.ReverseOrder(C)):C="ZYX",this._x=U||0,this._y=t||0,this._z=P||0,this._order=C||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(V,d,g){var u=w.Math.clamp,k=V.el||V,h=k[0],$=k[4],y=k[8],O=k[1],s=k[5],R=k[9],o=k[2],_=k[6],j=k[10];return d=d||this._order,"XYZ"===d?(this._y=Math.asin(u(y,-1,1)),Math.abs(y)<.99999?(this._x=Math.atan2(-R,j),this._z=Math.atan2(-$,h)):(this._x=Math.atan2(_,s),this._z=0)):"YXZ"===d?(this._x=Math.asin(-u(R,-1,1)),Math.abs(R)<.99999?(this._y=Math.atan2(y,j),this._z=Math.atan2(O,s)):(this._y=Math.atan2(-o,h),this._z=0)):"ZXY"===d?(this._x=Math.asin(u(_,-1,1)),Math.abs(_)<.99999?(this._y=Math.atan2(-o,j),this._z=Math.atan2(-$,s)):(this._y=0,this._z=Math.atan2(O,h))):"ZYX"===d?(this._y=Math.asin(-u(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(_,j),this._z=Math.atan2(O,h)):(this._x=0,this._z=Math.atan2(-$,s))):"YZX"===d?(this._z=Math.asin(u(O,-1,1)),Math.abs(O)<.99999?(this._x=Math.atan2(-R,s),this._y=Math.atan2(-o,h)):(this._x=0,this._y=Math.atan2(y,j))):"XZY"===d?(this._z=Math.asin(-u($,-1,1)),Math.abs($)<.99999?(this._x=Math.atan2(_,s),this._y=Math.atan2(y,h)):(this._x=Math.atan2(-R,j),this._y=0)):console.warn("unsupported order: "+d),this._order=d,g!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var J=new yo;return function(o,Z,G){return J.makeRotationFromQuaternion(o),this.setFromRotationMatrix(J,Z,G)}}(),setFromVector3:function(Q,Z){return this.set(Q.x,Q.y,Q.z,Z||this._order)},reorder:function(){var O=new ps;return function(T){return O.setFromEuler(this),this.setFromQuaternion(O,T)}}(),equals:function(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._order===this._order},fromArray:function(m){return this._x=m[0],this._y=m[1],this._z=m[2],m[3]!==M&&(this._order=m[3]),this.onChangeCallback(),this},toArray:function(a,H){return a===M&&(a=[]),H===M&&(H=0),a[H]=this._x,a[H+1]=this._y,a[H+2]=this._z,a[H+3]=this._order,a
},toVector3:function(A){return A?A.set(this._x,this._y,this._z):new pe(this._x,this._y,this._z)},onChange:function(d){return this.onChangeCallback=d,this},onChangeCallback:function(){}});var Yp=w.List=function(){this._as=[];var Z,K,k=arguments.length;if(1===k){var e=arguments[0];if(Qp(e)&&(e=e._as),uo(e))for(K=e.length,Z=0;K>Z;Z++)this._as.push(e[Z]);else e!=a&&this._as.push(e)}else if(k>1)for(Z=0;k>Z;Z++)this._as.push(arguments[Z])};Cf("List",E,{forEach:function(B,T){this.each(B,T)},push:function(){for(var c=0;c<arguments.length;c++)this.add(arguments[c])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(N,q){return q===M?this._as.push(N):this._as.splice(q,0,N)},addAll:function(K){Qp(K)&&(K=K._as),uo(K)?ks(this._as,K):this._as.push(K)},get:function(S){return this._as[S]},slice:function(y,R){return new Yp(this._as.slice(y,R))},remove:function(r){var u=this._as.indexOf(r);return u>=0&&u<this._as.length&&this.removeAt(u),u},removeAt:function(W){return this._as.splice(W,1)[0]},set:function(P,S){return this._as[P]=S},clear:function(){return this._as.splice(0,this._as.length)},contains:function(o){return this._as.indexOf(o)>=0},indexOf:function(W){return this._as.indexOf(W)},each:function(Y,l){for(var D=0,j=this._as.length;j>D;D++){var X=this._as[D];l?Y.call(l,X,D,this):Y(X,D,this)}},reverseEach:function(e,H){for(var i=this._as.length-1;i>=0;i--){var K=this._as[i];H?e.call(H,K):e(K)}},getArray:function(){return this._as},toArray:function(T,j){if(T){for(var A,F=[],_=0,C=this._as.length;C>_;_++)A=this._as[_],j?T.call(j,A)&&F.push(A):T(A)&&F.push(A);return F}return this._as.concat()},toList:function(v,t){if(v){for(var z,w=new Yp,Y=0,C=this._as.length;C>Y;Y++)z=this._as[Y],t?v.call(t,z)&&w.add(z):v(z)&&w.add(z);return w}return new Yp(this)},reverse:function(){this._as.reverse()},sort:function(k){return this._as.sort(k?k:Od),this},toString:function(){return this._as.toString()}}),E.defineProperties(Yp.prototype,{length:{get:function(){return this._as.length},set:function(t){this._as.length=t}}});var Wi=new Yp;jn(Wi,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:is,each:is,reverseEach:is,toArray:function(){return[]},toList:function(){return new Yp},add:db,addAll:db,set:db,remove:db,removeAt:db,clear:db});var Gp=w.Notifier=function(){this._f=0};Cf("Notifier",E,{contains:function(u,W){if(this._ls)for(var Q,l=0,T=this._ls.size();T>l;l++)if(Q=this._ls.get(l),u===Q.l&&W===Q.s)return!0;return!1},add:function(S,Q,z){var B=this,K={l:S,s:Q,a:z};B._ls||(B._ls=new Yp),B._f?(B._as||(B._as=new Yp),B._as.add(K)):K.a?B._ls.add(K,0):B._ls.add(K)},remove:function(y,$){var x=this;x._ls&&(x._f?(x._rs||(x._rs=new Yp),x._rs.add({l:y,s:$})):x._remove(y,$))},_remove:function(D,q){for(var U,z=this._ls,V=0,W=z.size();W>V;V++)if(U=z.get(V),U.l===D&&U.s===q)return z.removeAt(V),void 0},fire:function($){var g=this,b=g._ls;if(g._b=1e4,b){++g._f;try{for(var H,N=0,V=b.size();V>N;N++)H=b.get(N),H.s?H.l.call(H.s,$):H.l($)}catch($){_(function(){throw $})}finally{if(--g._f)return;if(g._rs){for(V=g._rs.size(),N=0;V>N;N++)H=g._rs.get(N),g._remove(H.l,H.s);delete g._rs}if(g._as){for(V=g._as.size(),N=0;V>N;N++)H=g._as.get(N),H.a?b.add(H,0):b.add(H);delete g._as}}}}});var ed=w.Data=function(){this._id=dj()};Cf("Data",E,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:a,_parent:a,_children:Wi,_childMap:a,_styleMap:a,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return a},_22Q:function(){return a},s:function(Y,w){var r=this;if(2===arguments.length)r.setStyle(Y,w);else{if(!$l(Y))return r.getStyle(Y);for(var m in Y)r.setStyle(m,Y[m])}return r},fp:function(k,E,i,G,s){return this.firePropertyChange(k,E,i,G,s)},firePropertyChange:function(s,R,J,W,b){if(W){if(W(R,J))return!1}else if(R===J)return!1;var g=this,x=b||{};return x.property=s,x.oldValue=R,x.newValue=J,x.data=g,g._dataModel&&g._dataModel.handleDataPropertyChange(x),g.onPropertyChanged(x),!0},onPropertyChanged:function(F){var M=this,k=M._parent,j=F.property;if(ni(k)){var u=M.s(zo),I="s:ingroup"===j;(u&&Nn[j]||j===I)&&k._81I(),(u||I)&&k.fp("childChange",!0,!1)}or(k)&&Nn[j]&&k.updateFromChildren()},_21I:function(z){var K=this;if(z&&K._dataModel)throw"Remove data from dataModel before adding";K._dataModel=z},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var _=0,b=this._children.toArray(),o=b.length;o>_;_++)b[_].removeFromDataModel()},getId:function(){return this._id},setId:function(H){this._id=H},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(t,J){return this._children.toList(t,J)},eachChild:function(V,w){this._children.each(V,w)},addChild:function(n,s){var M=this;n!==M&&(M._children===Wi&&(M._children=new Yp,M._childMap={}),s>=0||(s=M._children.size()),M._childMap[n._id]||M.isDescendantOf(n)||(n._parent&&n._parent.removeChild(n),(0>s||s>M._children.size())&&(s=M._children.size()),M._children.add(n,s),M._childMap[n._id]=n,n.setParent(M),M.onChildAdded(n,s),M.fp(ld,a,n)))},onChildAdded:function(){},removeChild:function(p){var P=this;if(P._childMap&&P._childMap[p._id]){var U=P._children.remove(p);delete P._childMap[p._id],P.fp(ld,p,a),p.setParent(a,U),P.onChildRemoved(p,U)}},onChildRemoved:function(){},getChildAt:function(B){return this._children.get(B)},clearChildren:function(){var b=this;if(!b._children.isEmpty())for(var Y=0,U=b._children.toArray(),e=U.length;e>Y;Y++)b.removeChild(U[Y])},getParent:function(){return this._parent},setParent:function(E,u){var v=this;if(!(v._73I||v._parent===E||v===E||E&&E.isDescendantOf(v))){var I,w=v._parent;v._parent=E,v._73I=1,w?(u==a&&(u=w.getChildren().indexOf(v)),w.removeChild(v)):v._dataModel&&u==a&&(u=v._dataModel.getRoots().indexOf(v)),E&&(E.addChild(v),I=E.getChildren().indexOf(v)),delete v._73I,v.fp("parent",w,E,M,{oldIndex:u,newIndex:I}),v.onParentChanged(w,E)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(m){return m?this.isDescendantOf(m)||m.isDescendantOf(this):!1},isParentOf:function(k){return k&&this._childMap?!!this._childMap[k._id]:!1},isDescendantOf:function(q){if(!q||q.isEmpty())return!1;for(var i=this._parent;i;){if(q===i)return!0;i=i._parent}return!1},getStyle:function(u,J){J===M&&(J=1);var f=this._styleMap?this._styleMap[u]:M;return f===M&&J?P[u]:f},setStyle:function(C,P){var I=this;I._styleMap||(I._styleMap={});var W=I._styleMap[C];P===M?delete I._styleMap[C]:I._styleMap[C]=P,I.fp("s:"+C,W,P)&&I.onStyleChanged(C,W,P)},onStyleChanged:function(){},iv:function(W){this.invalidate(W)},invalidate:function($){this.fp($||"*",!1,!0)},toString:function(){var V=this;return V._displayName||V._name||V._tag||V._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(B,k){var U=this,J=U.s(bf);J||U.s(bf,J={}),k?J[B]=k:delete J[B],U.fp(bf,a,J)},removeStyleIcon:function(J){var I=this.s(bf);if(I){var k=I[J];delete I[J],this.fp(bf,a,I)}return k},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var c,v={};for(c in this._styleMap)v[c]=1;return v},ca:function(x,b){return x=lk+x,2===arguments.length?this.a(x,b):this.a(x)}});var Pc=w.DataModel=function(){var m=this;m._datas=new Yp,m._dataMap={},m._roots=new Yp,m._rootMap={},m._fsDataMap={},m._78O={},m._36I=new Gp,m._35I=new Gp,m._serializeNotifier=new Gp,m._selectionModel=new ef(m);var K=m._29Q=[],U=m._scheduleCallback=function(){for(var y=Date.now(),M=0;M<K.length;M++){var _=K[M];_.enabled&&y-_.lastTime>_.interval&&(_.beforeAction&&_.beforeAction(),m.each(function(b){_.action(b)}),_.afterAction&&_.afterAction(),_.lastTime=y)}K.length&&(m._30Q=i.requestAnimationFrame(U))}};Cf("DataModel",E,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:M,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:M,_init:M,_envmap:M,_postProcessingData:M,sm:function(){return this.getSelectionModel()},mm:function(X,y,M){this.addDataModelChangeListener(X,y,M)},umm:function(J,o){this.removeDataModelChangeListener(J,o)},md:function(A,H,z){this.addDataPropertyChangeListener(A,H,z)},umd:function(q,_){this.removeDataPropertyChangeListener(q,_)},mh:function(o,S,I){this.addHierarchyChangeListener(o,S,I)},umh:function(L,C){this.removeHierarchyChangeListener(L,C)},getAttrObject:function(){return this._attrObject},setAttrObject:function(H){return this._attrObject=H},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(h){return this._dataMap[h]},removeDataById:function(D){this.remove(this.getDataById(D))},toDatas:function(E,L){return this._datas.toList(E,L)},each:function(n,c){this._datas.each(n,c)},getDataByTag:function(H){return this._78O[H]},getTagMap:function(){return this._78O},removeDataByTag:function(D){this.remove(this.getDataByTag(D))},add:function(o,g,r){var z=this,j=o._id,w=o._tag,i=z._roots;if(z._dataMap[j])throw"'"+j+"' already exists";w!=a&&(z._78O[w]=o),z._dataMap[j]=o,r>=0?z._datas.add(o,r):z._datas.add(o),o._parent||(z._rootMap[j]=o,g>=0?i.add(o,g):i.add(o)),o.s("fullscreen")!==M&&(z._fsDataMap[j]=o),o._21I(z),z.onAdded(o),z._36I.fire({kind:"add",data:o,rootsIndex:g,datasIndex:r})},onAdded:function(){},remove:function(I,y){if(I){var _=this,e=I._id,u=y&&y.keepStructure,H=y&&y.keepChildren,Z=I.getTag();if(I._dataModel===_){this.beginTransaction(),u?_._removingData||(_._removingData=I):_.prepareRemove(I),H||I.toChildren().each(function(E){_.remove(E,y)},_),u?_._removingData===I&&(I._parent&&I._parent.removeChild(I),delete _._removingData):I._parent&&I._parent.removeChild(I);var N=_._datas.remove(I);delete _._dataMap[e],Z!=a&&delete _._78O[Z];var V;_._rootMap[e]&&(delete _._rootMap[e],V=_._roots.remove(I)),_._fsDataMap[e]&&delete _._fsDataMap[e],I._21I(a),_.onRemoved(I),_._36I.fire({kind:Rp,data:I,rootsIndex:V,datasIndex:N}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var n=this;if(n._datas.size()){var $=n._historyManager?this.toJSON():M;n._datas.toArray().forEach(function(G){G._21I(a)}),n._datas.clear(),n._dataMap={},n._roots.clear(),n._rootMap={},n._fsDataMap={},n._78O={},n._36I.fire({kind:Hg,json:$})}},contains:function(Z){return Z&&Z._dataModel===this},handleDataPropertyChange:function(E){var F=this,m=E.data,r=E.property;if("parent"===r){var S=m._id,W=F._rootMap,q=F._roots;m._parent?W[S]&&(delete W[S],q.remove(m)):W[S]||(W[S]=m,q.add(m))}else if("tag"===r){var N=E.oldValue,c=E.newValue,L=F._78O;N!=a&&delete L[N],c!=a&&(L[c]=m)}else if("s:fullscreen"===r){var S=m._id,j=F._fsDataMap;E.oldValue!=a&&delete j[S],E.newValue!=a&&(j[S]=m)}this.onDataPropertyChanged(m,E),this._35I.fire(E)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(f,M,E){this._36I.add(f,M,E)},removeDataModelChangeListener:function(e,M){this._36I.remove(e,M)},addSerializeListener:function(j,q,y){this._serializeNotifier.add(j,q,y)},removeSerializeListener:function(V,g){this._serializeNotifier.remove(V,g)},fireSerializeEvent:function(X){this._serializeNotifier.fire(X)},addDataPropertyChangeListener:function(m,H,$){this._35I.add(m,H,$)},removeDataPropertyChangeListener:function(I,f){this._35I.remove(I,f)},_38I:function(O,Z,T){this._37I&&this._37I.fire({data:O,oldIndex:Z,newIndex:T})},addHierarchyChangeListener:function(Z,E,S){this._37I||(this._37I=new Gp),this._37I.add(Z,E,S)},removeHierarchyChangeListener:function(D,m){this._37I.remove(D,m)},getSiblings:function(V){var j=V._parent;return j?j._children:this._roots},eachByHierarchical:function(w,z,J){if(z)return this._eachByHierarchical(w,z,J);for(var a=0,v=this._roots,c=v.size();c>a;a++)if(this._eachByHierarchical(w,v.get(a),J)===!1)return!1;return!0},_eachByHierarchical:function(R,A,_){if(_){if(R.call(_,A)===!1)return!1}else if(R(A)===!1)return!1;for(var b=A.size(),f=0;b>f;f++)if(this._eachByHierarchical(R,A.getChildAt(f),_)===!1)return!1;return!0},reverseEachByHierarchical:function(f,P,e){if(P)return this._reverseEachByHierarchical(f,P,e);for(var p=this._roots,n=p.size(),b=n-1;b>=0;b--)if(this._reverseEachByHierarchical(f,p.get(b),e)===!1)return!1;return!0},_reverseEachByHierarchical:function(V,T,m){for(var n=T.size(),c=n-1;c>=0;c--)if(this._reverseEachByHierarchical(V,T.getChildAt(c),m)===!1)return!1;if(m){if(V.call(m,T)===!1)return!1}else if(V(T)===!1)return!1;return!0},eachByDepthFirst:function(o,O,s){if(O)return this._11I(o,O,s);for(var L=0,x=this._roots,M=x.size();M>L;L++)if(this._11I(o,x.get(L),s)===!1)return!1;return!0},_11I:function(d,x,e){for(var D=x.size(),u=0;D>u;u++)if(this._11I(d,x.getChildAt(u),e)===!1)return!1;if(e){if(d.call(e,x)===!1)return!1}else if(d(x)===!1)return!1;return!0},eachByBreadthFirst:function(Y,X,o){var H=new Yp;for(X?H.add(X):this._roots.each(H.add,H);H.size()>0;)if(X=H.removeAt(0),X.eachChild(H.add,H),o){if(Y.call(o,X)===!1)return!1}else if(Y(X)===!1)return!1;return!0},moveTo:function(w,z){var O=this.getSiblings(w),J=O.indexOf(w);J===z||0>J||z>=0&&z<=O.size()&&(O.remove(w),z>O.size()&&z--,O.add(w,z),this._38I(w,J,z))},moveUp:function(w){this.moveTo(w,this.getSiblings(w).indexOf(w)-1)},moveDown:function(f){this.moveTo(f,this.getSiblings(f).indexOf(f)+1)},moveToTop:function(U){this.moveTo(U,0)},moveToBottom:function(j){this.moveTo(j,this.getSiblings(j).size())},moveSelectionUp:function(k){this.beginTransaction(),k||(k=this.sm());var V=new Yp;Sg(k,V,this._roots),V.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(m){this.beginTransaction(),m||(m=this.sm());var f=new Yp;ii(m,f,this._roots),f.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(P){this.beginTransaction(),P||(P=this.sm());var E=new Yp;lf(P,E,this._roots),E.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(G){this.beginTransaction(),G||(G=this.sm());var U=new Yp;Kh(G,U,this._roots),U.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(H,a,A){var q=this.getDatas();null==A&&(A=q.indexOf(H)),A===a||0>A||a>=0&&a<=q.size()&&(q.remove(H),a>q.size()&&a--,q.add(H,a),this._76I(H,A,a))},bringForward:function(N){this.moveToIndex(N,this.getDatas().indexOf(N)+1)},bringToFront:function(N){this.moveToIndex(N,this.size())},sendBackward:function(w){this.moveToIndex(w,this.getDatas().indexOf(w)-1)},sendToBack:function(c){this.moveToIndex(c,0)},bringSelectionForward:function(p){this.beginTransaction(),p||(p=this.sm());for(var Y=new Yp,w=this.getDatas(),q=!1,e=0;e<w.size();e++){var V=w.get(w.size()-1-e);p.contains(V)?q&&Y.add(V):q=!0}Y.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(A){this.beginTransaction(),A||(A=this.sm());for(var l=new Yp,c=this.getDatas(),U=0;U<c.size();U++){var v=c.get(U);A.contains(v)&&l.add(v)}l.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(I){this.beginTransaction(),I||(I=this.sm());for(var V=new Yp,W=this.getDatas(),c=!1,O=0;O<W.size();O++){var $=W.get(O);I.contains($)?c&&V.add($):c=!0}V.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(K){this.beginTransaction(),K||(K=this.sm());for(var Z=new Yp,I=this.getDatas(),$=0;$<I.size();$++){var u=I.get(I.size()-1-$);K.contains(u)&&Z.add(u)}Z.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(p){var Z=this;Z.removeScheduleTask(p),p.enabled==a&&(p.enabled=!0),p.interval==a&&(p.interval=10),p.action==a&&(p.action=is),p.lastTime=Date.now(),Z._29Q.push(p),Z._30Q==a&&(Z._30Q=i.requestAnimationFrame(Z._scheduleCallback))},removeScheduleTask:function(I){var q=this,x=q._29Q,T=x.indexOf(I);T>=0&&x.splice(T,1),x.length||q._30Q==a||(i.cancelAnimationFrame(q._30Q),delete q._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(g){this._historyManager||new w.HistoryManager(this),null!=g&&this._historyManager.setMaxHistoryCount(g),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(p){this._historyManager&&this._historyManager.undo(p)},redo:function(F){this._historyManager&&this._historyManager.redo(F)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(A){this._historyManager&&this._historyManager.addHistory(A)},onHistoryManagerChanged:function(){}});var ef=w.SelectionModel=function(l){var E=this;E._68O=xb,E._map={},E._73O=new Yp,E._74I=new Gp,E._21I(l)};Cf("SelectionModel",E,{ms_fire:1,ms_dm:1,ms:function(c,M,e){this.addSelectionChangeListener(c,M,e)},ums:function(s,j){this.removeSelectionChangeListener(s,j)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===hn},co:function(x){return this._map[x._id]!=a},ss:function(b){this.setSelection(b)},as:function(l){this.appendSelection(l)},rs:function(g){this.removeSelection(g)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(i){var f=this;if(f._68O!==i&&(i===ik||i===hn||i===xb)){f.cs();var m=f._68O;f._68O=i,f.fp("selectionMode",m,i)}},_21I:function(K){var h=this,f=h._dataModel;f!==K&&(f&&(h.cs(),f.umm(h.handleDataModelChange,h)),h._dataModel=K,K.mm(h.handleDataModelChange,h,!0),h.fp(Yo,f,K))},dispose:function(){var n=this;n.cs(),n._dataModel.umm(n.handleDataModelChange,n)},handleDataModelChange:function(g){var e=this;if(g.kind===Rp){var o=g.data;e.co(o)&&(e._73O.remove(o),delete e._map[o._id],e._75I(Rp,new Yp(o)))}else g.kind===Hg&&e.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(D){var O=this;if(O._filterFunc!==D){O.cs();var L=O._filterFunc;O._filterFunc=D,O.fp("filterFunc",L,O._filterFunc)}},_75I:function(G,l,N,i){N&&(this._73O.each(function(H){i[H._id]?N.remove(H):N.add(H)}),l=N.toList()),this._74I.fire({kind:G,datas:new Yp(l)})},addSelectionChangeListener:function(Q,s,_){this._74I.add(Q,s,_)},removeSelectionChangeListener:function(r,m){this._74I.remove(r,m)},_97O:function(U,L){for(var w,y=this,o=0,f=new Yp(U);o<f.size();o++)w=f.get(o),(y._filterFunc&&!y._filterFunc(w)||L&&y.co(w)||!L&&!y.co(w)||!y._dataModel.contains(w))&&(f.removeAt(o),o--);return f},appendSelection:function(w){var q=this;if(q._68O!==ik){var C,v,d=q._73O,f=q._97O(w,!0);f.isEmpty()||(q.sg()&&(C=new Yp(d),v=q._map,d.clear(),q._map={},f=new Yp(f.get(f.size()-1))),f.each(function(L){d.add(L),q._map[L._id]=L}),q._75I("append",f,C,v))}},removeSelection:function(K){var O=this,Z=O._97O(K),W=0,A=Z.size();if(0!==A){for(;A>W;W++){var S=Z.get(W);O._73O.remove(S),delete O._map[S._id]}O._75I(Rp,Z)}},toSelection:function(N,G){return this._73O.toList(N,G)},getSelection:function(){return this._73O},each:function(S,E){this._73O.each(S,E)},setSelection:function(D){var m=this,f=m._73O;if(m._68O!==ik&&!(f.isEmpty()&&!D||1===f.size()&&m.ld()===D)){var M=new Yp(f),X=m._map;f.clear(),m._map={};var i=m._97O(D,!0);m.sg()&&i.size()>1&&(i=new Yp(i.get(i.size()-1))),i.each(function(G){f.add(G),m._map[G._id]=G}),m._75I("set",a,M,X)}},clearSelection:function(){var t=this,V=t._73O;if(V.size()>0){var C=V.toList();V.clear(),t._map={},t._75I(Hg,C)}},selectAll:function(){var P=this;if(P._68O!==ik){var j,T,L=P._dataModel.toDatas();if(P._filterFunc)for(j=0;j<L.size();j++)T=L.get(j),P._filterFunc(T)||(L.removeAt(j),j--);var v=P._73O,O=new Yp(v),K=P._map;v.clear(),P._map={},P.sg()&&L.size()>1&&(L=new Yp(L.get(L.size()-1)));var W=L.size();for(j=0;W>j;j++)T=L.get(j),v.add(T),P._map[T._id]=T;P._75I("all",a,O,K)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(z){return this._map[z._id]!=a},getLastData:function(){var Z=this._73O;return Z.size()>0?Z.get(Z.size()-1):a},getFirstData:function(){var z=this._73O;return z.size()>0?z.get(0):a},isSelectable:function(c){var N=this;return c&&N._68O!==ik?N._filterFunc?N._filterFunc(c):!0:!1},getTopSelection:function(){var R=this,T=new Yp;return R._73O.each(function(p){for(var x=p.getParent();x;){if(R.contains(x)){p=a;break}x=x.parent}p&&T.add(p)}),T}});var rn=function(){return Pi(0),function(x,D){var A;if(Hp(D)){var r=x.getDataUI(D);r&&r._88I&&(A=r._88I.rect)}return A?A:D.getRect()}}();jn(n,{edgeGroupAgentFunc:a,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:S.rectSelectBorder,graphViewRectSelectBackground:Ei,graphViewEditPointSize:jl?17:7,graphViewEditPointBorderColor:S.editPointBorder,graphViewEditPointBackground:S.editPointBackground,setEdgeType:function(D,N,Y){Cd[D]=N,Nr[D]=Y},getEdgeType:function(w){return Cd[w]},getEdgeTypeMap:function(){return Cd},getNodeRect:rn},!0),jn(P,{"layout.h":M,"layout.v":M,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":M,interactive:!1,"image.stretch":"fill",icons:M,ingroup:!0,"body.color":M,"2d.gray":!1,fullscreen:M,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:M,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":wb,"select.width":1,"select.padding":2,"select.type":vn,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":M,"border.width":2,"border.padding":2,"border.type":vn,label:M,"label.font":M,"label.color":vc,"label.background":M,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":M,"label.max":M,"label.opacity":M,"label.scale":1,"label.align":M,"label.selectable":!0,label2:M,"label2.font":M,"label2.color":vc,"label2.background":M,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":M,"label2.max":M,"label2.opacity":M,"label2.scale":1,"label2.align":M,"label2.selectable":!0,note:M,"note.expanded":!0,"note.font":M,"note.color":jp,"note.background":wb,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":M,"note.toggleable":!0,"note.border.width":1,"note.border.color":M,"note.opacity":M,"note.scale":1,"note.align":M,note2:M,"note2.expanded":!0,"note2.font":M,"note2.color":jp,"note2.background":wb,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":M,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":M,"note2.opacity":M,"note2.scale":1,"note2.align":M,"group.type":M,"group.image":M,"group.image.stretch":"fill","group.repeat.image":M,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":M,"group.title.color":jp,"group.title.background":S.groupTitleBackground,"group.title.align":Ul,"group.title.orientation":rr,"group.background":S.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":M,"group.border.color":Lq,"group.border.radius":0,"group.border.cap":Tb,"group.border.join":$i,"group.splitLine":!1,"group.gradient":a,"group.gradient.color":"#FFF",shape:M,"shape.background":Lq,"shape.repeat.image":M,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Lq,"shape.border.3d":!1,"shape.border.3d.color":M,"shape.border.3d.accuracy":M,"shape.border.cap":Tb,"shape.border.join":$i,"shape.border.pattern":M,"shape.gradient":a,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":tn,"shape.dash.offset":0,"shape.dash.color":lb,"shape.dash.width":M,"shape.dash.3d":!1,"shape.dash.3d.color":M,"shape.dash.3d.accuracy":M,"shape.polygon.side":6,"shape.arc.from":W,"shape.arc.to":O,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":M,"shape.gradient.pack":M,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":M,"shape.foreground.gradient":a,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":M,"autolayout.hgap":M,"autolayout.vgap":M,"edge.type":M,"edge.points":M,"edge.segments":M,"edge.color":Lq,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":M,"edge.3d.accuracy":M,"edge.cap":Tb,"edge.join":$i,"edge.source.position":17,"edge.source.anchor.x":M,"edge.source.anchor.y":M,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":M,"edge.target.anchor.y":M,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":M,"edge.dash":!1,"edge.dash.pattern":tn,"edge.dash.offset":0,"edge.dash.color":lb,"edge.dash.width":M,"edge.dash.3d":!1,"edge.dash.3d.color":M,"edge.dash.3d.accuracy":M,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":M,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":M,"grid.column.percents":M,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":S.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":S.gridCellBorderColor,"grid.block":M,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":S.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":vc,"text.font":ti,"text.shadow":!1,"text.shadow.color":wb,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:M},!0),jn(Pc,{_76I:function(E,L,Q){this._39I&&this._39I.fire({data:E,oldIndex:L,newIndex:Q})},addIndexChangeListener:function(Y,P,t){var D=this;D._39I||(D._39I=new Gp),D._39I.add(Y,P,t)},removeIndexChangeListener:function(b,k){this._39I.remove(b,k)},prepareRemove:function(L){wj(L)&&(L.setSource(a),L.setTarget(a)),L._70O&&L._70O.toList().each(this.remove,this),L._69O&&L._69O.toList().each(function(R){R.setHost(a)}),L._host&&L.setHost(a)},onAdded:function(g){this.isAutoAdjustIndex()&&this.adjustIndex(g)},onDataPropertyChanged:function(V,u){Rn[u.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(V)},isAdjustable:function(v){return wc(v)||wj(v)},isAdjustedToBottom:function(w){return ni(w)?w.isExpanded()&&eo(w):!1},adjustIndex:function(P){var G=this;this.isHierarchicalRendering()||(G.isAdjustedToBottom(P)?(G.sendToBottom(P),P.eachChild(G.adjustIndex,G)):G.sendToTop(P))},sendToTop:function(q){var w=this;if(w.contains(q)&&w.isAdjustable(q)){var F=w._datas;if(q!==F.get(w.size()-1)){var J=F.indexOf(q);F.removeAt(J),F.add(q),w._76I(q,J,w.size()-1)}if(wj(q)){var _=q._40I;_&&!w.isAdjustedToBottom(_)&&w.sendToTop(_),_=q._41I,_&&!w.isAdjustedToBottom(_)&&w.sendToTop(_)}q._69O&&q._69O.each(function(Y){Y.isRelatedTo(q)||wc(q)&&Y.isLoopedHostOn(q)||w.sendToTop(Y)}),q.ISubGraph||(!ni(q)||q.isExpanded())&&q._adjustChildrenToTop&&q.eachChild(function(H){wj(H)||w.sendToTop(H)})}},sendToBottom:function(c,Q){var E=this;if(c!==Q&&E.contains(c)&&E.isAdjustable(c)&&(!Q||E.contains(Q))){var I=E._datas,v=I.remove(c),Y=Q?E._datas.indexOf(Q):0;if(I.add(c,Y),v!==Y){E._76I(c,v,Y);var N=c._parent;!N||N.ISubGraph||wj(N)||E.sendToBottom(c._parent,c)}}}}),jn(Se,{ms_edit:function(B){B._46O=function(p){var H=this,D=H.gv.dm(),G=H._index,X=H._89I,i=H._node,m=H._shape,I=H._edge,x=H._77I;i&&X?(this.fi({kind:"endEditRect",event:p,data:i,direction:X}),D.endTransaction()):m&&G>=0?(H.fi({kind:"endEditPoint",event:p,data:m,index:G}),D.endTransaction()):I&&G>=0?(H.fi({kind:"endEditPoint",event:p,data:I,index:G}),D.endTransaction()):x&&(H.fi({kind:"endEditRotation",event:p,data:x}),D.endTransaction())},B._78I=function(v){var G=this;G.autoScroll(v);var l=G.gv.lp(v),j=G._index,z=G._89I,n=G._node,B=G._shape,d=G._edge,E=G._77I;if(n&&z)G._80O(l),G.fi({kind:"betweenEditRect",event:v,data:n,direction:z});else if(B&&j>=0)l.e=B.getPoints().get(j).e,B.setPoint(j,l),G.fi({kind:"betweenEditPoint",event:v,data:B,index:j});else if(d&&j>=0){var t=d.s(tk);l.e=t.get(j).e,t.set(j,l),d.fp(tk,a,t),G.fi({kind:"betweenEditPoint",event:v,data:d,index:j})}else if(E){var m=E.p(),c=E.getScale(),F=Z+x(l.y-m.y,l.x-m.x);c.y<0&&(F+=W),y(F)<.04&&(F=0),E.setRotation(F),G.fi({kind:"betweenEditRotation",event:v,data:E})}},B._80O=function(g){var i=this,Y=i._node,d=i._rect,X=d.x,u=d.y,Z=d.width,o=d.height,F=i._89I,S=i._anchor,D=i._matrix,g=D.tfi(g);"northwest"===F?d=rh(g,{x:X+Z,y:u+o}):F===Mr?d=rh({x:X,y:g.y},{x:X+Z,y:u+o}):"northeast"===F?d=rh({x:X,y:g.y},{x:g.x,y:u+o}):F===Sn?d=rh({x:g.x,y:u},{x:X+Z,y:u+o}):F===Wh?d=rh({x:X,y:u},{x:g.x,y:u+o}):"southwest"===F?d=rh({x:g.x,y:u},{x:X+Z,y:g.y}):"south"===F?d=rh({x:X,y:u},{x:X+Z,y:g.y}):"southeast"===F&&(d=rh({x:X,y:u},g)),Y.setPosition(D.tf(d.x+d.width*S.x,d.y+d.height*S.y)),Y.setWidth(d.width),Y.setHeight(d.height)},B._80I=function(Z,M,O,l){var r=this,L=r.gv._zoom,P=(r.gv.getEditPointSize()+2)/L;return Aj({x:M-P/2,y:O-P/2,width:P,height:P},Z)?(r._89I!==l&&(r._89I=l),!0):!1},B._79I=function(n,x,q){var u=this,A=u.gv,S=x?A.getDataUI(x):a,Y=S?S._55O:a;if(Y){var I,v,W,L,c=A._zoom,t=(A.getEditPointSize()+2)/c,w=A.lp(n);if(wc(x)){if(Y._56O&&wc(x)&&(v=Y._98o,Aj({x:v.x-t/2,y:v.y-t/2,width:t,height:t},w)))return u._77I=x,q&&u.fi({kind:"beginEditRotation",event:n,data:x}),u.setCursor("crosshair"),!0;if(Y._43O&&x instanceof Cc)for(W=x.getPoints(),I=W.size()-1;I>=0;I--)if(v=W.get(I),Aj({x:v.x-t/2,y:v.y-t/2,width:t,height:t},w))return u._index=I,u._shape=x,q&&u.fi({kind:"beginEditPoint",event:n,data:x,index:I}),u.setCursor("crosshair"),!0;if(Y._42O)for(var C=x.getEditControlPoints(),o=["northwest",-1,-1,Sn,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Wh,1,0,"northeast",1,-1,Mr,0,-1],I=0,L=C.length;L>I;I++){var g=o[3*I],Z=C[I];if(u._80I(w,Z.x,Z.y,g)){u._node=x;var l=x.getWidth(),X=x.getHeight(),O=x.getAnchor();u._rect={x:-l*O.x,y:-X*O.y,width:l,height:X},u._anchor=O,u._matrix=x.getMatrix();var U=x.getRotation(),k=s(U),m=N(U),d=o[3*I+1]*Rj(x.getScale().x),Q=o[3*I+2]*Rj(x.getScale().y),R=Math.atan2(-m*d-k*Q,k*d-m*Q),B=(Math.round(R/(Math.PI/4))+8)%8,b=[be,"nesw-resize",ug,"nwse-resize",be,"nesw-resize",ug,"nwse-resize"][B];return u.setCursor(b),q&&u.fi({kind:"beginEditRect",event:n,data:x,direction:u._89I}),!0}}}if(Y._43O&&wj(x)&&x.s(dg)===uf&&(W=x.s(tk)))for(I=W.size()-1;I>=0;I--)if(v=W.get(I),Aj({x:v.x-t/2,y:v.y-t/2,width:t,height:t},w))return u._index=I,u._edge=x,q&&u.fi({kind:"beginEditPoint",event:n,data:x,index:I}),u.setCursor("crosshair"),!0}return!1}},ms_gv:function(Z){Z._currentSubGraph=a,Z._fpsInfo={time:0,fps:0,frames:0},Z.upSubGraph=function(){this.setCurrentSubGraph(le(this._currentSubGraph))},Z.isVisible=function(x){var g=this;if(le(x)!==g._currentSubGraph)return!1;if(wj(x)){var K=x._40I,B=x._41I;if(!K||!B)return!1;if(!(x.s("edge.independent")||g.isVisible(K)&&g.isVisible(B)))return!1;if(x.isEdgeGroupHidden())return!1}else for(var G=x._parent;G&&!G.ISubGraph;){if(ni(G)&&(!G.isExpanded()||!g.isVisible(G)))return!1;
G=G._parent}if(x._parent instanceof Md&&!g.isVisible(x._parent))return!1;if(x._refGraph instanceof hg&&!g.isVisible(x._refGraph))return!1;if(g instanceof oh){if(!x.s("3d.visible"))return!1}else{var l=g.getLayersInfo();if(l){var w=l[x._layer];if(w&&w.visible===!1)return!1}if(!x.s("2d.visible"))return!1}return g._visibleFunc?g._visibleFunc(x):!0},Z.handleSelectionChange=function(M){var D=this;M.datas.each(function(b){D.invalidateData(b);var l=b._parent;ni(l)&&wc(b)&&b.s(zo)&&(D.invalidateData(l),l._49I&&l._49I.each(function(L){D.invalidateData(L)}))}),D.onSelectionChanged(M)},Z.onSelectionChanged=function(r){var w=this,p=w.sm();if(1===p.size()&&("set"===r.kind||"append"===r.kind)){var M=p.ld();w.isAutoMakeVisible()&&w.makeVisible(M),w.adjustIndex&&w._dataModel.isAutoAdjustIndex()&&w.adjustIndex(M)}},Z.makeVisible=function(L){if(L){var e=this,$=e.getDataUI?e.getDataUI(L):e.getData3dUI(L);if($){var f=L,p=le(L);for(p!==e._currentSubGraph&&e.setCurrentSubGraph(p);(f=f._parent)&&f!==p;)ni(f)&&f.setExpanded(!0);e._23I=L,e.iv()}}},Z.getLabel=function(a){var O=a.getStyle(Hj);return O===M?a.getName():O},Z.getLabelBackground=function(D){return D.getStyle("label.background")},Z.getLabelColor=function(S){return S.getStyle("label.color")},Z.getLabel2=function(R){return R.getStyle("label2")},Z.getLabel2Background=function(D){return D.getStyle("label2.background")},Z.getLabel2Color=function(E){return E.getStyle("label2.color")},Z.getNote=function(n){return n.getStyle(Jd)},Z.getNoteBackground=function(c){return c.getStyle("note.background")},Z.getNote2=function(j){return j.getStyle(Re)},Z.getNote2Background=function(D){return D.getStyle("note2.background")},Z.handleClick=function(c,y,B){var U=this;y?(U.fi({kind:"clickData",event:c,data:y,part:B}),U.onDataClicked(y,c)):(U.fi({kind:"clickBackground",event:c}),U.onBackgroundClicked(c))},Z.handleDoubleClick=function(M,x,k){var W=this;Qk(M)&&(x?(W.fi({kind:"doubleClickData",event:M,data:x,part:k}),W.onDataDoubleClicked(x,M,k),W.checkDoubleClickOnNote(M,x,k)||W.checkDoubleClickOnRotation&&W.checkDoubleClickOnRotation(M,x,k)||(wj(x)?W.onEdgeDoubleClicked(x,M,k):x.ISubGraph?W.onSubGraphDoubleClicked(x,M,k):ni(x)?W.onGroupDoubleClicked(x,M,k):x.IDoorWindow?W.onDoorWindowDoubleClicked(x,M,k):x.ICSGBox&&W.onCSGBoxDoubleClicked(x,M,k))):(W.fi({kind:"doubleClickBackground",event:M}),W.onBackgroundDoubleClicked(M)))},Z.onSubGraphDoubleClicked=function(u){this.setCurrentSubGraph(u)},Z.onEdgeDoubleClicked=function(r,M){r.ISubGraph&&!Zl(M)?this.setCurrentSubGraph(r):r.s("edge.toggleable")&&r.toggle()},Z.onGroupDoubleClicked=function(V){V.s("group.toggleable")&&V.toggle()},Z.onDoorWindowDoubleClicked=function(o){o.s("dw.toggleable")&&o.toggle(!0)},Z.onCSGBoxDoubleClicked=function(m,z){var D=this;if(D instanceof oh){var X=D.getHitFaceInfo(z);X&&X.face&&m.s(X.face+".toggleable")&&m.toggleFace(X.face,!0)}},Z.onBackgroundClicked=function(){},Z.onBackgroundDoubleClicked=function(){this.upSubGraph()},Z.onDataClicked=function(){},Z.onDataDoubleClicked=function(){},Z.onAutoLayoutEnded=function(){},Z.onMoveEnded=function(){},Z.onPanEnded=function(){},Z.onPinchEnded=function(){},Z.onRectSelectEnded=function(){},Z.onZoomEnded=function(){},Z.serialize=function(a){return this.dm().serialize(a)},Z.toJSON=function(){return this.dm().toJSON()},Z.deserialize=function(g,A){var U=this;A=A instanceof ed?{rootParent:A}:tq(A)?{setId:A}:bi(A)?{finishFunc:A}:A||{},A.view=U;var R=U.dm(),Q=A.finishFunc;return A.finishFunc=function(){Q&&Q.apply(A,arguments),tq(R.a("zoomable"))&&U.setZoomable&&U.setZoomable(R.a("zoomable")),tq(R.a("pannable"))&&U.setPannable&&U.setPannable(R.a("pannable")),tq(R.a("rectSelectable"))&&U.setRectSelectable&&U.setRectSelectable(R.a("rectSelectable")),R.a("fitContent")===!0&&U.fitContent&&U.fitContent(!0,0)},R.deserialize(g,A.rootParent,A)},Z.showDebugTip=function(){var m=this,$=m._debugDiv;if(!$){$=m._debugDiv=j.createElement("div"),$.style.position="absolute",$.style.overflow="hidden",$.style.backgroundColor="white",$.style.color="black";var g=m.getView();m._79O?g.insertBefore($,m._79O):g.appendChild($);var c=function(){m.redraw();var N="FPS : "+m._fpsInfo.fps+"<br/>"+"Datas : "+m.dm().getDatas().length,y=m.getDebugTip();y&&(N+="<br/>------<br/>"+y),$.innerHTML=N,m._isDebugging&&requestAnimationFrame(c)};requestAnimationFrame(c),m._isDebugging=!0}},Z.hideDebugTip=function(){var L=this,F=L._debugDiv;F&&(delete L._debugDiv,L.getView().removeChild(F),L._isDebugging=!1)},Z.countFrame=function(){if(this._isDebugging){var A=Date.now(),H=this._fpsInfo;A-H.time>1e3?(H.fps=Math.round(1e5*(H.frames+1)/(A-H.time))/100,H.time=A,H.frames=0):H.frames++}}},ms_icons:function(j){j.getRotation=function(m){return m==a?0:m},j._15O=function(){var S=this,j=S.s(bf);if(j){var A=S,G=S.data||S._data,Y=S._38o={icons:j,rects:{}};for(var $ in j){var N=j[$],T=Io(N.shape3d,G,A);if(!(Io(N.visible,G,A)===!1||Io(N.for3d,G,A)&&!S.I3d||T&&!S.I3d)){var s=T?[T]:Io(N.names,G,A),q=s?s.length:0,O=Io(N.position,G,A)||3,D=Io(N.offsetX,G,A)||0,V=Io(N.offsetY,G,A)||0,L=Io(N.direction,G,A)||Wh,l=Io(N.gap,G,A),J=l!=a?l:1,o=Io(N.rotation,G,A),F=Io(N.keepOrien,G,A),H=Io(N.rotationFixed,G,A)?o:S.getRotation(o,F,O),u=a,t=Y.rects[$]=new Array(q);t.rotation=H;for(var c=0;q>c;c++){var h,n,w,v,z=s[c];if(T)w=0,v=0;else{var i=hh(z);w=Io(N.width,G,A),v=Io(N.height,G,A),w==a&&(w=Uh(i,G)),v==a&&(v=zq(i,G))}if(u?L===Wh?D+=w/2:L===Sn?D-=w/2:L===Mr?V-=v/2:V+=v/2:u={width:w,height:v},S.I3d){var f=-w/2,U=-v/2;n={width:w,height:v,mat:S._16O(Io(N.autorotate,G,A),O,u,Io(N.face,G,A)||xr,Io(N.t3,G,A),Io(N.r3,G,A),Io(N.rotationMode,G,A),D,V),vs:new go([f,-U,0,f,-U-v,0,f+w,-U-v,0,f+w,-U,0])}}else h=S.getPosition(O,D,V,u,Io(N.positionFixed,G,A)),n={x:h.x-w/2,y:h.y-v/2,width:w,height:v},S._68o(n,H);t[c]=n,L===Wh?D+=w/2+J:L===Sn?D-=w/2+J:L===Mr?V-=v/2+J:V+=v/2+J}}}}}}});var vs={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},me={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},$j={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Rn={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Nn={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Dc={"edge.type":1,"edge.group":1},Li={rotation:1,rotationX:1,rotationZ:1},Qe={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},zk={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Bi={shape:1,thickness:1,position:1,anchor:1,scale:1},le=function(u){if(!u)return a;if(wj(u)){var Y=u._40I,A=u._41I;if(!Y||!A)return a;var M=le(Y),k=le(A);return M===k?M:a}for(var q=u._parent;wj(q)&&!q.ISubGraph;)q=q._parent;return q?q.ISubGraph?q:le(q):a},Aq=function(z,B,$,D){var E=B.getStyle($)*D;E&&di(z,E),E=B.getStyle($+".left")*D,E&&(z.x-=E,z.width+=E),E=B.getStyle($+".right")*D,E&&(z.width+=E),E=B.getStyle($+".top")*D,E&&(z.y-=E,z.height+=E),E=B.getStyle($+".bottom")*D,E&&(z.height+=E),z.width<0&&(z.width=-z.width,z.x-=z.width),z.height<0&&(z.height=-z.height,z.y-=z.height)},eo=function(Y){for(var S,X=0,t=Y.size();t>X;X++)if(S=Y.getChildAt(X),wc(S)&&eo(S))return!0;return Y.hasAgentEdges()},Xk=function(L){if(!L)return a;for(var F=L._parent;ni(F);){if(!ni(F._parent))return F.isExpanded()?L:F;F.isExpanded()||(L=F),F=F._parent}return L},Gh=function(j,r){if(!j||!r)return a;var i,M,P,m=le(j),C=le(r);if(m!==C){for(;C&&m!==C;)C=le(C);if(m===C)return j;i=new Yp,i.add(j,0);for(var u=j._parent;wc(u)&&!r.isDescendantOf(u);)i.add(u,0),u=u._parent;for(P=i.size(),M=0;P>M;M++){var X=i.get(M);if(ni(X)&&!X.isExpanded())return X;if(X.ISubGraph)return X}return j}return j},Il=function(N){if(N.isLooped())return N._source;var j=Xk(N._source),A=Xk(N._target);return j===A?N._source:Gh(j,A)},oj=function(U){if(U.isLooped())return U._target;var x=Xk(U._source),Z=Xk(U._target);return x===Z?U._target:Gh(Z,x)},wn=function($,N,f){"target"!==f&&(f="source");var U="target"===f?N.getTargetAgent():N.getSourceAgent(),s="edge."+f+".";if(wj(U)){var Y=$.getDataUI(U);Y._79o();var W=N.s(s+"index");if(W!==M){var q=Vi(Y);return q[Math.max(0,Math.min(W,q.length-1))]}var F=N.s(s+"percent")||0;F=Math.max(0,Math.min(F,1));var y=hr(Y);return Sl(y,100*F)}return Qn($,U,N.s(s+"position"),N.s(s+"offset.x"),N.s(s+"offset.y"),N.s(s+"anchor.x"),N.s(s+"anchor.y"))},Qn=function(x,D,l,K,t,C,T){if(!D)return a;var F,k=D.getRotation?D.getRotation():0;if(C!==M||T!==M)if(C=C===M?.5:C,T=T===M?.5:T,k&&!Hp(D,x)){var Z=D.getPosition(),j=D.getWidth(),e=D.getHeight(),f=D.getAnchor(),r=D.getScale(),m=new Lp(k,Z.x,Z.y,r.x,r.y);l=m.tf((C-f.x)*j,(T-f.y)*e)}else F=rn(x,D),l={x:F.x+C*F.width,y:F.y+T*F.height};else l=xp(l,rn(x,D));if(k){var U=s(k),n=N(k),y=K*U-t*n;t=K*n+t*U,K=y}return l.x+=K,l.y+=t,l},Wb=function(n,N){if(!n||!N)return a;var R,i,B,M,k,K;if(n===N){if(M=n.getLoopedEdges(),!M)return a;M=new Yp(M)}else{if(k=n.getAgentEdges(),K=N.getAgentEdges(),!k||!K)return a;for(i=k.size(),R=0;i>R;R++)B=k.get(R),K.contains(B)&&(M||(M=new Yp),M.add(B))}if(M)for(R=0;R<M.size();R++)B=M.get(R),B.getStyle(dg)===uf&&(B._22I(a),M.removeAt(R),R--);return M},Nf=function(l,K){var A=Wb(l,K);if(A&&!A.isEmpty()){if(1===A.size())return A.get(0)._22I(a),void 0;var S=new Yp,b=new Yp;A.each(function(T){var Y=T.s("edge.group");S.contains(Y)||S.add(Y)}),S.sort(),S.each(function(Z){b.add(new w.EdgeGroup(A.toList(function(x){return Z===x.s("edge.group")}),b))}),b.each(function(E){E.each(function(S){S._22I(E)})})}},aj=function(d,L,$){var Y=d._canvas;d._zoom;var T=Ao(L,Y),i=Ao($,Y);return{x:T.x-i.x,y:T.y-i.y}},se=function(l,X){if(X){var e=X.rect,Q=X.color,p=X.rotation,V=X.labelWidth,v=X.background,P=X.opacity,_=X.scale,d=_!=a&&1!==_;if(P!=a){var r=l.globalAlpha;l.globalAlpha*=P}if(p||d){l.save();var s=e.x+e.width/2,i=e.y+e.height/2;Hc(l,s,i),p&&As(l,p),d&&l.scale(_,_),Hc(l,-s,-i)}if(v&&Qf(l,e.x,e.y,e.width,e.height,v),V){var S=e.width,L=l.createLinearGradient(e.x,e.y,e.x+S,e.y);L.addColorStop(0,Q),L.addColorStop(.9,Q),L.addColorStop(1,jq),Q=L,e.width=V}mh(l,X.ss,e,X.font,Q,X.align),V&&(e.width=S),(p||d)&&l.restore(),P!=a&&(l.globalAlpha=r)}},rd=function(X,b){if(b){var g=b.rect,K=g.x,I=g.y,E=g.width,$=g.height,H=b.background,L=b.backgroundImage,B=b.borderWidth,_=b.borderColor,i=b.labelWidth,d=b.opacity,v=b.scale,j=v!=a&&1!==v;if(d!=a){var h=X.globalAlpha;X.globalAlpha*=d}if(j){X.save();var u=g.x+g.width/2,s=g.y+g.height/2;Hc(X,u,s),X.scale(v,v),Hc(X,-u,-s)}if(b.expanded){var o=p(8,E/4),G=I+$-8;if(X.fillStyle=H,X.beginPath(),X.moveTo(K,I),X.lineTo(K,G),X.lineTo(K+E/2,G),X.lineTo(K+E/2,I+$),X.lineTo(K+E/2+o,G),X.lineTo(K+E,G),X.lineTo(K+E,I),X.closePath(),X.fill(),B&&(X.lineWidth=B,X.lineJoin="round",X.lineCap="round",_?(X.strokeStyle=_,X.stroke()):(X.strokeStyle=Gi(H),X.beginPath(),X.moveTo(K+E,I),X.lineTo(K+E,G),X.lineTo(K+E/2+o,G),X.lineTo(K+E/2,I+$),X.stroke(),X.strokeStyle=Fe(H),X.beginPath(),X.moveTo(K+E,I),X.lineTo(K,I),X.lineTo(K,G),X.lineTo(K+E/2,G),X.lineTo(K+E/2,I+$),X.stroke())),L)Me(X,hh(L),ck,g.x,g.y,g.width,g.height-8,b.data,b.view);else{if(g.height-=8,H=b.color,i){var n=E,f=X.createLinearGradient(K,I,K+n,I);f.addColorStop(0,H),f.addColorStop(.9,H),f.addColorStop(1,jq),H=f,g.width=i}mh(X,b.ss,g,b.font,H,b.align),i&&(g.width=n),g.height+=8}}else if(b.icon)Ad(X,hh(b.icon),K,I,E,$,b.data,b.view);else{var w=E/2;B&&(X.lineWidth=B,X.lineJoin="round",X.lineCap="round",X.strokeStyle=_?_:Gi(H),X.beginPath(),X.arc(K+w,I+w,w,Z,1.6*W,!0),X.moveTo(K+w,I+$),X.lineTo(K+E-w/5,I+w),X.stroke(),X.strokeStyle=_?_:Fe(H),X.beginPath(),X.arc(K+w,I+w,w,1.6*W,Z,!0),X.moveTo(K+w,I+$),X.lineTo(K+w/5,I+w),X.stroke()),X.fillStyle=H,X.beginPath(),X.arc(K+w,I+w,w,0,O,!0),X.moveTo(K+w,I+$),X.lineTo(K+E-w/5,I+w),X.lineTo(K+w/5,I+w),X.closePath(),X.fill(),X.fillStyle=b.color,X.beginPath(),X.arc(K+w,I+w,w/3,0,O,!0),X.fill()}j&&X.restore(),d!=a&&(X.globalAlpha=h)}},gm=function(t,h){return h>2*t?t:h/2},pj=function(o,J,h,V){if(!o||!J)return 0;var k=x(J.y-o.y,J.x-o.x);return h||(k=J.x<o.x?k+W:k),k+V},Zo=function(T,i,v,Y,s,c,g){g&&(T.x>i.x||T.x===i.x&&T.y>i.y)&&(v=Gk[v],s=-s);var D=xp(v,{x:0,y:0,width:sh(T,i),height:0},c);return D.x+=Y,D.y+=s,D=new Lp(x(i.y-T.y,i.x-T.x)).tf(D),D.x+=T.x,D.y+=T.y,D},om=function(U,p,f,P,Z){if(U._19Q=!0,!f.getEdgeGroup())return P?f.s("edge.gap"):0;if(wj(f.getSourceAgent())||wj(f.getTargetAgent()))return 0;var H,D=0,z=0,T=0;if(f.getEdgeGroup().getSiblings().each(function(g){g.each(function(N){if(p.isVisible(N)&&N.s(dg)==Z){var O=N.s("edge.gap");H?(z+=T/2+O/2,T=O):(H=N,T=O),N===f&&(D=z)}})}),P)return z-D+T;var N=D-z/2;return H&&f._40I!==H._40I&&(U._19Q=!1),N},ng=function(){var $=function(k){var E=[];return k.forEach(function(h){E.push({x:h.x,y:h.y}),E.push({x:h.x+h.width,y:h.y+h.height}),E.push({x:h.x+h.width,y:h.y}),E.push({x:h.x,y:h.y+h.height})}),E};return function(k,i,Q){if("oval"===k){var t=0,O=Q.height/Q.width,j=O*O,R=Q.x+Q.width/2,S=Q.y+Q.height/2,s=$(i);s.forEach(function(K){var _=K.x-R,k=K.y-S,p=_*_+k*k/j;p>t&&(t=p)}),t=l(t);var Y=O*t;return{x:R-t,y:S-Y,width:2*t,height:2*Y}}if("circle"===k){var C=0,R=Q.x+Q.width/2,S=Q.y+Q.height/2,s=$(i);return s.forEach(function(k){var u=k.x-R,N=k.y-S,F=u*u+N*N;F>C&&(C=F)}),C=l(C),{x:R-C,y:S-C,width:2*C,height:2*C}}return"roundRect"===k?(di(Q,p(Q.width,Q.height)/16),Q):Q}}(),br=w.graph={},Fg=function(V,b,m){Qr(D+".graph."+V,b,m)};w.layout={};var cq={},am=function(S,C,A,N,H,g,I,P){var i=[C.uuid,Math.round(N),Math.round(H),A].join("_");C.cacheRule&&(i+=Io(C.cacheRule,g,I));var l=I._zoom;l!==I._cacheZoom&&(I._cacheZoom=l,I._cacheImage={});var k=I._cacheImage[i];return k||(k=I._cacheImage[i]=w.Default.toCanvas(C,Math.ceil(N*l),Math.ceil(H*l),A,g,I,P)),k};jn(n,{setImageCacheRule:function(r,N){var O;O=N||"object"!=typeof r?{_image:N}:r;for(var s in O){var Z=O[s];mc(s)?(Qr=hh(s),Qr?Qr.cacheRule=Z:cq[s]=Z):s.cacheRule=Z}}});var Ge={comps:[{type:Of,points:[85,50,70,115,100,71,86,107,88,49,47,43,57,49,85,72,104,102,101,119,66,109,107,116,102,101,111,107,72,108,69,75,102,43,117,119,68,50,87,103,101,83,77,61],borderWidth:1,borderColor:a}]};if(Ge[np]=Ge[Kk]=160,i.Image){var Qm=new i.Image;Qm.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",uh("default_blank",Qm)}uh("node_image",qp(30,30,[{type:vn,rect:[4,5,22,16],gradient:rl,gradientColor:He,background:Lq},{type:vn,rect:[2,3,26,20],borderWidth:1,borderColor:Lq},{type:vn,rect:[11,23,8,4],background:Lq},{type:vn,rect:[6,27,18,2],background:Lq}])),uh("node_icon",qp(16,16,[{type:vn,rect:[2,2,12,10],gradient:rl,gradientColor:He,background:Lq},{type:Sj,rect:[2,2,12,10],width:1,color:Lq},{type:vn,rect:[6,12,4,2],background:Lq},{type:vn,rect:[4,14,8,1],background:Lq}])),uh("block_icon",qp(16,16,[{type:Sj,rect:[1,1,14,14],width:1,color:Lq}])),uh("group_image",qp(66,39,[{type:vn,rect:[44.3,18,18.1,12.8],gradient:rl,gradientColor:He,background:Lq},{type:vn,rect:[3.3,17.8,18.1,12.8],gradient:rl,gradientColor:He,background:Lq},{type:vn,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Lq,gradient:rl,gradientColor:He,background:Lq},{type:vn,rect:[26.2,29.4,12.8,4.2],background:Lq},{type:vn,rect:[21.3,33.5,22.5,2.3],background:Lq},{type:vn,rect:[5.3,32.7,14.1,2.1],background:Lq},{type:vn,rect:[9,30.4,6.7,2.4],background:Lq},{type:vn,rect:[50,30.7,6.7,2.4],background:Lq},{type:vn,rect:[46.3,33,14.1,2.1],background:Lq}])),uh("group_icon",qp(16,16,[{type:vn,rect:[4,12,4,2],background:Lq},{type:vn,rect:[2,13,8,1],background:Lq},{type:vn,rect:[12,12,2,1],background:Lq},{type:vn,rect:[11,13,4,1],background:Lq},{type:vn,rect:[10,7,6,5],gradient:rl,gradientColor:He,background:Lq},{type:vn,rect:[1,2,10,10],gradient:rl,gradientColor:He,background:Lq},{type:Sj,rect:[1,2,10,10],width:1,color:Lq}])),uh("refGraph_icon",qp(16,16,[{type:"shape",borderWidth:1,borderColor:Lq,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Lq,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),uh("edge_icon",qp(16,16,[{type:vn,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:rl,gradientColor:He,background:Lq},{type:vn,rect:[10.8,1,4,4],background:Lq},{type:vn,rect:[1,11,4,4],background:Lq}])),uh("subGraph_image",qp(72,45,[{type:Of,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:rl,gradientColor:He,background:Lq},{type:vn,rect:[29.6,30.7,3.6,1.8],background:Lq},{type:vn,rect:[28.4,32.3,6,1.2],background:Lq},{type:vn,rect:[37.3,32,10.8,1.8],background:Lq},{type:vn,rect:[39.1,29.9,7.2,2.3],background:Lq},{type:vn,rect:[26.6,23.7,9.6,7.2],gradient:rl,gradientColor:He,background:Lq},{type:vn,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Lq,gradient:rl,gradientColor:He,background:Lq}])),uh("subGraph_icon",qp(17,17,[{type:Of,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:rl,gradientColor:He,background:Lq}])),uh("shape_icon",qp(16,16,[{type:Of,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Lq}])),uh("polyline_icon",qp(16,16,[{type:Of,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Lq},wh(7.5,.4),wh(7.5,6.3),wh(13.6,6.3),wh(13.6,14),wh(.7,13.9),wh(.7,.3)])),uh("grid_icon",qp(16,16,[{type:vn,rect:[1,1,4,4],background:Lq,gradient:rl,gradientColor:He},{type:vn,rect:[6,1,4,4],background:Lq,gradient:rl,gradientColor:He},{type:vn,rect:[11,1,4,4],background:Lq,gradient:rl,gradientColor:He},{type:vn,rect:[11,6,4,4],background:Lq,gradient:rl,gradientColor:He},{type:vn,rect:[6,6,4,4],background:Lq,gradient:rl,gradientColor:He},{type:vn,rect:[1,6,4,4],background:Lq,gradient:rl,gradientColor:He},{type:vn,rect:[11,11,4,4],background:Lq,gradient:rl,gradientColor:He},{type:vn,rect:[6,11,4,4],background:Lq,gradient:rl,gradientColor:He},{type:vn,rect:[1,11,4,4],background:Lq,gradient:rl,gradientColor:He}])),uh("light_icon",qp(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Lq},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Lq,gradient:rl,gradientColor:He,background:{func:function(M){var P=M?M.s(vl):a;return uo(P)?"rgb("+Q(255*P[0])+","+Q(255*P[1])+","+Q(255*P[2])+")":P||Lq}}}])),uh("text_icon",qp(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Lq}])),uh("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),uh("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),uh("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),uh("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Mq=function(c,$,N,P,K,D){var d,e,Y,X,I,S,t,z,W,F,x,H=[];if(Math.abs(P)>2*Math.PI&&(P=2*Math.PI),I=Math.ceil(Math.abs(P)/(Math.PI/4)),d=P/I,e=-d,Y=-N,I>0){S=c+Math.cos(N)*K,t=$+Math.sin(-N)*D,H.push({x:S,y:t});for(var A=0;I>A;A++)Y+=e,X=Y-e/2,z=c+Math.cos(Y)*K,W=$+Math.sin(Y)*D,F=c+Math.cos(X)*(K/Math.cos(e/2)),x=$+Math.sin(X)*(D/Math.cos(e/2)),H.push({x:F,y:x}),H.push({x:z,y:W})}return H},_r=function(m){if(m){var f=m._data;if(f instanceof w.Shape)return{points:f.getPoints(),segments:f.getSegments()};var k;if(f instanceof w.Edge&&(k=m._78o)){var t,N,F=k.type,s=k.points,P=k.segments,Y=k.edgeTypeInfo;if(!F||s){var M=k.sourcePoint,z=M.x,d=M.y,E=k.targetPoint,o=E.x,W=E.y;if(F)P?(t=new Yp({x:z,y:d}),t.addAll(s),t.add({x:o,y:W}),N=new Yp(P._as)):(t=new Yp({x:z,y:d}),s.each(function(i){t.add(i)}),t.add({x:o,y:W}));else if(k.looped){t=new Yp(Mq(z,d,0,2*Math.PI,k.radius,k.radius)),N=new Yp([1]);for(var b=0;b<(t.size()-1)/2;b++)N.add(3)}else t=new Yp,k.center?(t.add({x:k.c1.x,y:k.c1.y}),t.add({x:z,y:d}),t.add({x:o,y:W}),t.add({x:k.c2.x,y:k.c2.y})):(t.add({x:z,y:d}),t.add({x:o,y:W}))}else Y&&(t=new Yp(Y.points._as),Y.segments&&(N=new Yp(Y.segments._as)));return{points:t,segments:N}}}},hr=function($,r,E){if(null==r){var J=_r($);if(!J)return;r=J.points,E=J.segments}if(r){if(Array.isArray(r)&&(r=new Yp(r)),"number"==typeof r.get(0)){for(var j=new w.List,Z=0;Z<r.size();Z+=2)j.add({x:r.get(Z),y:r.get(Z+1)});r=j}if(!E){E=[1];for(var L=r.length-1;L>0;L--)E.push(2)}Array.isArray(E)&&(E=new Yp(E));for(var D=Cl(r._as,E._as,50),N=D.length,k=[],Z=0;N>Z;Z++){var v=D[Z];v.length>1&&k.push(v)}return k}},ds=function(J){for(var U=0,P=J.length-1,v=0;P>v;v++){var d=J[v],o=J[v+1],g=o.x-d.x,E=o.y-d.y;U+=Math.sqrt(g*g+E*E)}return U},Yj=function(r,n){for(var J=0,W=n.length,w=0;W>w;w++){var $=n[w];if(J+=$,J>r)return w}return Math.min(w,W-1)},ve=function(R,p){for(var y=0,t=0,k=0,d=R.length-1,q=0;d>q;q++){var D=R[q],V=R[q+1],L=V.x-D.x,K=V.y-D.y;if(k=Math.sqrt(L*L+K*K),y+=k,y>p){y-=k,t=q;break}}var Z=R[t],I=R[t+1],j=Math.atan2(I.y-Z.y,I.x-Z.x),c=p-y,K=Math.sin(j)*c,L=Math.cos(j)*c;return{x:Z.x+L,y:Z.y+K}},Sl=function(L,O){if(L){var x;if(0===O)x=L[0][0];else if(100===O)L=L[L.length-1],x=L[L.length-1];else{for(var Q=0,W=[],I=L.length,u=0;I>u;u++){var p=L[u],z=ds(p);Q+=z,W.push(z)}for(var U=Q*O/100,h=Yj(U,W),y=0,t=0;h>t;t++)y+=W[t];U-=y,x=ve(L[h],U)}return x}},Vi=function(J){var p,G,w,c,M=_r(J),H=[],U=M.points,P=M.segments,B=-1;for(G=0,w=P?P.length:U.length;w>G;G++){if(p=P?P.get(G):1,3===p)c=2;else if(4===p)c=3;else{if(5===p)continue;c=1}B+=c,H.push(U.get(B))}return H},mf=function(j,U,O,N){function o(u){if(u>=0&&1>=u){d=U(u);var E=(j.x-d.x)*(j.x-d.x)+(j.y-d.y)*(j.y-d.y);return b>E?(b=E,k=u,!0):!1}}O=O||100,N=N||1e-5;for(var b=1/0,k=0,d=new Xd,Q=0;O>Q;++Q)o(Q/O);for(var H=1/(2*O);H>N;)o(k-H)||o(k+H)||(H/=2);return k};jn(n,{_edgeProtectMethod:{getStraightLinePoints:hr,calculateLineLength:ds,calcSegmentIndexByDistance:Yj,calculatePointAlongLine:ve,getPercentPosition:Sl}});var nm=function(f,a){for(var p=f.vertices,r=0;r<p.length;r++){var F=p[r],M=F.y;F.y=F.z,F.z=-M,a&&(F.y+=a)}},Vn=function(V){for(var g,_,o,k,L,U,y=[],O=[],d=[],x=V.faces,N=0,G=0,X=0,j=x.length;j>N;N++,G+=6,X+=9){var Z=x[N];1===Z.i?(g||(g=[],_=[],o=[]),zn(Z,N,G,X,V,g,o,_)):2===Z.i?(k||(k=[],L=[],U=[]),zn(Z,N,G,X,V,k,U,L)):zn(Z,N,G,X,V,y,d,O)}return{vs:y,uv:O,ns:d,top_vs:g,top_uv:_,top_ns:o,bottom_vs:k,bottom_uv:L,bottom_ns:U}},zn=function(E,l,S,G,I,t,$,f){var r=I.vertices,Q=I.faceVertexUvs,N=r[E.a],V=r[E.b],o=r[E.c];t[G]=N.x,t[G+1]=N.y,t[G+2]=N.z,t[G+3]=V.x,t[G+4]=V.y,t[G+5]=V.z,t[G+6]=o.x,t[G+7]=o.y,t[G+8]=o.z;var u=E.vertexNormals;if(3===u.length){var R=u[0],b=u[1],z=u[2];$[G]=R.x,$[G+1]=R.y,$[G+2]=R.z,$[G+3]=b.x,$[G+4]=b.y,$[G+5]=b.z,$[G+6]=z.x,$[G+7]=z.y,$[G+8]=z.z}else{var j=E.normal;$[G]=j.x,$[G+1]=j.y,$[G+2]=j.z,$[G+3]=j.x,$[G+4]=j.y,$[G+5]=j.z,$[G+6]=j.x,$[G+7]=j.y,$[G+8]=j.z}var P=Q[0][l][0],m=Q[0][l][1],X=Q[0][l][2];f[S]=P.x,f[S+1]=P.y,f[S+2]=m.x,f[S+3]=m.y,f[S+4]=X.x,f[S+5]=X.y},$c=function(z){var J=z._lineModel;if(J)return J;var G;G=uo(z)?z:[z];var n,I,k,W,m,p,h,i,Z,Y,u,j,U=["","top","bottom"];for(J=[],n=0,I=G.length;I>n;n++)for(Z=G[n],k=0,W=U.length;W>k;k++)if(h=Z[U[k]+"vs"]){i=Z[U[k]+"is"],p=i?i.length:h.length/3;for(var m=0;p>m;m+=3)i?(Y=i[m],u=i[m+1],j=i[m+2]):(Y=m,u=m+1,j=m+2),Y*=3,u*=3,j*=3,J.push(h[Y],h[Y+1],h[Y+2],h[u],h[u+1],h[u+2],h[u],h[u+1],h[u+2],h[j],h[j+1],h[j+2],h[j],h[j+1],h[j+2],h[Y],h[Y+1],h[Y+2])}return z._lineModel=J,J},tg=function(N,c,h,v,W,p,x,l,G){h==a&&(h=!0),v==a&&(v=!0),x==a&&(x=1),l==a&&(l=0);var t=new jm;return Ok(t,N,c,G),t=t.toShapes(),Vn(new Kq(t,{top:h,bottom:v,curveSegments:W,amount:x,repeatUVLength:p},-x/2+l))},op=function(L,U){this.x=L||0,this.y=U||0};op.prototype={constructor:op,add:function(M){return this.x+=M.x,this.y+=M.y,this},sub:function(x){return this.x-=x.x,this.y-=x.y,this},equals:function(p){return p.x===this.x&&p.y===this.y},multiplyScalar:function(O){return this.x*=O,this.y*=O,this},distanceTo:function(X){return l(this.distanceToSquared(X))},distanceToSquared:function(G){var u=this.x-G.x,Q=this.y-G.y;return u*u+Q*Q},clone:function(){return new op(this.x,this.y)}};var Mn=function(P,z,K){this.x=P||0,this.y=z||0,this.z=K||0};Mn.prototype={constructor:Mn,set:function(Y,b,A){return this.x=Y,this.y=b,this.z=A,this},setY:function(k){return this.y=k,this},copy:function(w){return this.x=w.x,this.y=w.y,this.z=w.z,this},add:function(c){return this.x+=c.x,this.y+=c.y,this.z+=c.z,this},addVectors:function(K,J){return this.x=K.x+J.x,this.y=K.y+J.y,this.z=K.z+J.z,this},sub:function(g){return this.x-=g.x,this.y-=g.y,this.z-=g.z,this},subVectors:function(z,g){return this.x=z.x-g.x,this.y=z.y-g.y,this.z=z.z-g.z,this},multiplyScalar:function(x){return this.x*=x,this.y*=x,this.z*=x,this},applyMatrix4:function(I){var d=this.x,Q=this.y,i=this.z,a=I.elements;return this.x=a[0]*d+a[4]*Q+a[8]*i+a[12],this.y=a[1]*d+a[5]*Q+a[9]*i+a[13],this.z=a[2]*d+a[6]*Q+a[10]*i+a[14],this},divideScalar:function(r){if(0!==r){var E=1/r;this.x*=E,this.y*=E,this.z*=E}else this.x=0,this.y=0,this.z=0;return this},dot:function(C){return this.x*C.x+this.y*C.y+this.z*C.z},length:function(){return l(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(A){var i=this.x,k=this.y,p=this.z;return this.x=k*A.z-p*A.y,this.y=p*A.x-i*A.z,this.z=i*A.y-k*A.x,this},crossVectors:function(g,x){var k=g.x,f=g.y,U=g.z,V=x.x,G=x.y,S=x.z;return this.x=f*S-U*G,this.y=U*V-k*S,this.z=k*G-f*V,this},distanceTo:function(G){return l(this.distanceToSquared(G))},distanceToSquared:function(z){var o=this.x-z.x,P=this.y-z.y,L=this.z-z.z;return o*o+P*P+L*L},clone:function(){return new Mn(this.x,this.y,this.z)}};var Pr=function(){this.elements=new Float32Array(16)};Pr.prototype={constructor:Pr,set:function(Z,U,y,F,h,o,j,X,m,J,l,Y,r,M,B,Q){var L=this.elements;return L[0]=Z,L[4]=U,L[8]=y,L[12]=F,L[1]=h,L[5]=o,L[9]=j,L[13]=X,L[2]=m,L[6]=J,L[10]=l,L[14]=Y,L[3]=r,L[7]=M,L[11]=B,L[15]=Q,this},makeRotationAxis:function(x,Q){var M=s(Q),p=N(Q),q=1-M,o=x.x,D=x.y,$=x.z,C=q*o,S=q*D;return this.set(C*o+M,C*D-p*$,C*$+p*D,0,C*D+p*$,S*D+M,S*$-p*o,0,C*$-p*D,S*$+p*o,q*$*$+M,0,0,0,0,1),this}};var Yr=function(V){this.repeatUVLength=V};Yr.prototype={generateTopUV:function(Q,R,o,q,U,p,$){var E,i,j,v,b=Q.vertices,f=b[q].x,G=b[q].y,B=b[U].x,C=b[U].y,I=b[p].x,n=b[p].y,l=this.repeatUVLength;if(l)E=0,i=0,j=l,v=l;else{this._bb||(this._bb=R.getBoundingBox());var y=this._bb;E=y.minX,i=y.minY,j=y.maxX-E,v=y.maxY-i}return $?[new op((f-E)/j,(G-i)/v),new op((B-E)/j,(C-i)/v),new op((I-E)/j,(n-i)/v)]:[new op((f-E)/j,1-(G-i)/v),new op((B-E)/j,1-(C-i)/v),new op((I-E)/j,1-(n-i)/v)]},generateBottomUV:function(G,A,Y,l,U,D){return this.generateTopUV(G,A,Y,l,U,D,!0)},generateSideWallUV:function(k,B,C,G,p,H,e,M,Z,j,D,S){if(!this._cl){for(var o,t,F=[],d=0,r=C.length,O=0;r>O;O++){o=C[O],t=C[(O+1)%r];var W=o.x-t.x,w=o.y-t.y,J=l(W*W+w*w);F.push(d),d+=J}for(var O=0;r>O;O++)F[O]/=d;this._cl=F}var F=this._cl,K=1-Z/j,u=1-(Z+1)/j,P=F[D],I=F[S];return I>P&&(P+=1),[new op(P,K),new op(I,K),new op(I,u),new op(P,u)]}};var ji=function(g,x,q,z,D,W){this.a=g,this.b=x,this.c=q,this.i=W,this.normal=z instanceof Mn?z:new Mn,this.vertexNormals=z instanceof Array?z:[]};ji.prototype={constructor:ji};var Vh=[-8,13,-1,14,0,4,2,8,-1],rb=function(){if(rb[Or]!=a)return rb[Or];for(var s=lo[Or],p=Vh,z=ed.prototype.getClassName(),I='"',X=0,f="",W=!1,g=+new(i[z.substr(3,3)+be[X]]),N=X;N<p.length;N++){var Z=p.length-N;f+=N%2===X?p[N]+Z+"":p[N]-Z+""}for(var N=X;4>N;N++)f+=X;if(f=f*f.length/f.length,g>f){if(s&&s[X]&&s[4/vn.length]){for(var M,m,o,G,j,e,v,A,h=s[0],J=s[1],Q="",E=0,N=0;N<J.length;N++)J[N]===I?A?(A=!1,0!==E%2&&(M==a?M=Q:m==a?m=Q:o==a?o=Q:G==a?G=Q:j==a?j=Q:e==a?e=Q:v==a&&(v=Q)),E++,Q=""):A=!0:A&&(Q+=J[N]);for(var O,V,K,H="",C=0,N=0;N<h.length;N++)h[N]===I?O?(O=!1,0!==C%2&&(V==a?V=H:K==a&&(K=H)),C++,H=""):O=!0:O&&(H+=h[N]);var B=M+m+o+G+j+e;(W=po(B,v)&&po(V,K)&&V===M&&(!e||e.indexOf(Ch)>=0)&&(!j||j>g))&&o.indexOf(ak[0])>=0&&(rb[ak[0]]=1),W&&o.indexOf(1)>=0&&(rb[1]=1),W&&o.indexOf(2)>=0&&(rb[2]=1)}}else W=!0,rb[ak[0]]=rb[1]=rb[2]=1;return rb[Or]=W,W},Fn=function(){},th=Fn.prototype;th.getPointAt=function(P){var S=this.getUtoTmapping(P);return this.getPoint(S)},th.getPoints=function(M){M||(M=5);var J,F=[];for(J=0;M>=J;J++)F.push(this.getPoint(J/M));return F},th.getSpacedPoints=function(X){X||(X=5);var I,N=[];for(I=0;X>=I;I++)N.push(this.getPointAt(I/X));return N},th.getLength=function(){var J=this.getLengths();return J[J.length-1]},th.getLengths=function(i){if(i||(i=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==i+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var z,E,y=[],j=this.getPoint(0),t=0;for(y.push(0),E=1;i>=E;E++)z=this.getPoint(E/i),t+=z.distanceTo(j),y.push(t),j=z;return this.cacheArcLengths=y,y},th.getUtoTmapping=function(A,T){var D,m=this.getLengths(),V=0,W=m.length;D=T?T:A*m[W-1];for(var o,l=0,u=W-1;u>=l;)if(V=R(l+(u-l)/2),o=m[V]-D,0>o)l=V+1;else{if(!(o>0)){u=V;break}u=V-1}if(V=u,m[V]==D){var v=V/(W-1);return v}var K=m[V],q=m[V+1],t=q-K,H=(D-K)/t,v=(V+H)/(W-1);return v},th.getTangent=function(k){var L=1e-4,H=k-L,N=k+L;0>H&&(H=0),N>1&&(N=1);var n=this.getPoint(H),m=this.getPoint(N),D=m.clone().sub(n);return D.normalize()},th.getTangentAt=function(m){var J=this.getUtoTmapping(m);return this.getTangent(J)},Fn.create=function(g,I){return g.prototype=$b(Fn.prototype),g.prototype.getPoint=I,g};var Gf=function(){this.curves=[],this.autoClose=!1},Qg=Gf.prototype=$b(th);Qg.add=function(W){this.curves.push(W)},Qg.closePath=function(){var A=this.curves[0].getPoint(0),B=this.curves[this.curves.length-1].getPoint(1);A.equals(B)||this.curves.push(new _d(B,A))},Qg.getPoint=function(T){for(var h,G,i=T*this.getLength(),b=this.getCurveLengths(),p=0;p<b.length;){if(b[p]>=i){h=b[p]-i,G=this.curves[p];var N=1-h/G.getLength();return G.getPointAt(N)}p++}return null},Qg.getLength=function(){var Z=this.getCurveLengths();return Z[Z.length-1]},Qg.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a,G=[],Q=0,Y=this.curves.length;for(a=0;Y>a;a++)Q+=this.curves[a].getLength(),G.push(Q);return this.cacheLengths=G,G},Qg.getTransformedPoints=function(v){return this.getPoints(v)
},Qg.getBoundingBox=function(){var v,f,m,B,A,M,u=this.getPoints();v=f=Number.NEGATIVE_INFINITY,B=A=Number.POSITIVE_INFINITY;var q,k,H,y,L=u[0]instanceof Mn;for(y=L?new Mn:new op,k=0,H=u.length;H>k;k++)q=u[k],q.x>v&&(v=q.x),q.x<B&&(B=q.x),q.y>f&&(f=q.y),q.y<A&&(A=q.y),L&&(q.z>m&&(m=q.z),q.z<M&&(M=q.z)),y.add(q);var h={minX:B,minY:A,maxX:v,maxY:f};return L&&(h.maxZ=m,h.minZ=M),h};var oi=function(M){Gf.call(this),this.actions=[],M&&this.fromPoints(M)},vf=oi.prototype=$b(Gf.prototype),Og="moveTo",Nh="lineTo",Xb="quadraticCurveTo",yl="bezierCurveTo",Fc="arc",$o="ellipse";vf.fromPoints=function(I){this.moveTo(I[0].x,I[0].y);for(var t=1,T=I.length;T>t;t++)this.lineTo(I[t].x,I[t].y)},vf.moveTo=function(){var t=Array.prototype.slice.call(arguments);this.actions.push({action:Og,args:t})},vf.lineTo=function(L,i){var Y=Array.prototype.slice.call(arguments),M=this.actions[this.actions.length-1].args,f=M[M.length-2],t=M[M.length-1],X=new _d(new op(f,t),new op(L,i));this.curves.push(X),this.actions.push({action:Nh,args:Y})},vf.quadraticCurveTo=function(j,f,r,z){var x=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,V=i[i.length-2],F=i[i.length-1],k=new Ef(new op(V,F),new op(j,f),new op(r,z));this.curves.push(k),this.actions.push({action:Xb,args:x})},vf.bezierCurveTo=function(b,Q,t,d,m,j){var _=Array.prototype.slice.call(arguments),p=this.actions[this.actions.length-1].args,V=p[p.length-2],i=p[p.length-1],v=new Qj(new op(V,i),new op(b,Q),new op(t,d),new op(m,j));this.curves.push(v),this.actions.push({action:yl,args:_})},vf.arc=function(m,h,T,e,n,w){var A=this.actions[this.actions.length-1].args,E=A[A.length-2],k=A[A.length-1];this.absarc(m+E,h+k,T,e,n,w)},vf.absarc=function(S,_,j,x,u,v){this.absellipse(S,_,j,j,x,u,v)},vf.ellipse=function(x,v,c,i,A,a,F){var h=this.actions[this.actions.length-1].args,B=h[h.length-2],T=h[h.length-1];this.absellipse(x+B,v+T,c,i,A,a,F)},vf.absellipse=function(W,S,q,F,X,l,T){var U=Array.prototype.slice.call(arguments),Y=new tm(W,S,q,F,X,l,T);this.curves.push(Y);var R=Y.getPoint(1);U.push(R.x),U.push(R.y),this.actions.push({action:$o,args:U})},vf.getSpacedPoints=function(Z){Z||(Z=40);for(var E=[],k=0;Z>k;k++)E.push(this.getPoint(k/Z));return E},vf.getPoints=function(U,B){U=U||12;var d,c,D,n,o,f,z,p,Y,Z,L,M,_,r,H,m,O,I,i=[];for(d=0,c=this.actions.length;c>d;d++)switch(D=this.actions[d],n=D.action,o=D.args,n){case Og:i.push(new op(o[0],o[1]));break;case Nh:i.push(new op(o[0],o[1]));break;case Xb:for(f=o[2],z=o[3],Z=o[0],L=o[1],i.length>0?(r=i[i.length-1],M=r.x,_=r.y):(r=this.actions[d-1].args,M=r[r.length-2],_=r[r.length-1]),H=1;U>=H;H++)m=H/U,O=Fj.b2(m,M,Z,f),I=Fj.b2(m,_,L,z),i.push(new op(O,I));break;case yl:for(f=o[4],z=o[5],Z=o[0],L=o[1],p=o[2],Y=o[3],i.length>0?(r=i[i.length-1],M=r.x,_=r.y):(r=this.actions[d-1].args,M=r[r.length-2],_=r[r.length-1]),H=1;U>=H;H++)m=H/U,O=Fj.b3(m,M,Z,p,f),I=Fj.b3(m,_,L,Y,z),i.push(new op(O,I));break;case Fc:var K,R=o[0],b=o[1],j=o[2],S=o[3],C=o[4],W=!!o[5],X=C-S,w=2*U;for(H=1;w>=H;H++)m=H/w,W||(m=1-m),K=S+m*X,O=R+j*s(K),I=b+j*N(K),i.push(new op(O,I));break;case $o:var K,R=o[0],b=o[1],P=o[2],T=o[3],S=o[4],C=o[5],W=!!o[6],X=C-S,w=2*U;for(H=1;w>=H;H++)m=H/w,W||(m=1-m),K=S+m*X,O=R+P*s(K),I=b+T*N(K),i.push(new op(O,I))}var F=i[i.length-1],a=1e-10;return y(F.x-i[0].x)<a&&y(F.y-i[0].y)<a&&i.splice(i.length-1,1),B&&i.push(i[0]),i},vf.toShapes=function(L,g){function J(I){var a,r,M,t,L,b=[],y=new oi;for(a=0,r=I.length;r>a;a++)M=I[a],L=M.args,t=M.action,t==Og&&0!=y.actions.length&&(b.push(y),y=new oi),y[t].apply(y,L);return 0!=y.actions.length&&b.push(y),b}function O(d){for(var K=[],n=0,u=d.length;u>n;n++){var C=d[n],l=new jm;l.actions=C.actions,l.curves=C.curves,K.push(l)}return K}function c(I,Q){for(var r=1e-10,W=Q.length,P=!1,Z=W-1,o=0;W>o;Z=o++){var t=Q[Z],J=Q[o],N=J.x-t.x,C=J.y-t.y;if(y(C)>r){if(0>C&&(t=Q[o],N=-N,J=Q[Z],C=-C),I.y<t.y||I.y>J.y)continue;if(I.y==t.y){if(I.x==t.x)return!0}else{var S=C*(I.x-t.x)-N*(I.y-t.y);if(0==S)return!0;if(0>S)continue;P=!P}}else{if(I.y!=t.y)continue;if(J.x<=I.x&&I.x<=t.x||t.x<=I.x&&I.x<=J.x)return!0}}return P}var U=J(this.actions);if(0==U.length)return[];if(g===!0)return O(U);var W,D,C,T=[];if(1==U.length)return D=U[0],C=new jm,C.actions=D.actions,C.curves=D.curves,T.push(C),T;var q=!Fj.isClockWise(U[0].getPoints());q=L?!q:q;var e,N=[],w=[],d=[],H=0;w[H]=M,d[H]=[];var Z,v;for(Z=0,v=U.length;v>Z;Z++)D=U[Z],e=D.getPoints(),W=Fj.isClockWise(e),W=L?!W:W,W?(!q&&w[H]&&H++,w[H]={s:new jm,p:e},w[H].s.actions=D.actions,w[H].s.curves=D.curves,q&&H++,d[H]=[]):d[H].push({h:D,p:e[0]});if(!w[0])return O(U);if(w.length>1){for(var P=!1,b=[],j=0,_=w.length;_>j;j++)N[j]=[];for(var j=0,_=w.length;_>j;j++){w[j];for(var u=d[j],l=0;l<u.length;l++){for(var F=u[l],i=!0,V=0;V<w.length;V++)c(F.p,w[V].p)&&(j!=V&&b.push({froms:j,tos:V,hole:l}),i?(i=!1,N[V].push(F)):P=!0);i&&N[j].push(F)}}b.length>0&&(P||(d=N))}var G,p,t;for(Z=0,v=w.length;v>Z;Z++)for(C=w[Z].s,T.push(C),G=d[Z],p=0,t=G.length;t>p;p++)C.holes.push(G[p].h);return T};var jm=function(){oi.apply(this,arguments),this.holes=[]},Mi=jm.prototype=$b(vf);Mi.getPointsHoles=function(U){var E,M=this.holes.length,d=[];for(E=0;M>E;E++)d[E]=this.holes[E].getTransformedPoints(U);return d},Mi.extractAllPoints=function(t){return{shape:this.getTransformedPoints(t),holes:this.getPointsHoles(t)}},Mi.extractPoints=function(y){return this.extractAllPoints(y)};var Fj={triangulateShape:function(S,R){function N(o,k,f){return o.x!=k.x?o.x<k.x?o.x<=f.x&&f.x<=k.x:k.x<=f.x&&f.x<=o.x:o.y<k.y?o.y<=f.y&&f.y<=k.y:k.y<=f.y&&f.y<=o.y}function f(O,h,H,q,o){var _=1e-10,n=h.x-O.x,K=h.y-O.y,U=q.x-H.x,b=q.y-H.y,j=O.x-H.x,F=O.y-H.y,Q=K*U-n*b,f=K*j-n*F;if(y(Q)>_){var W;if(Q>0){if(0>f||f>Q)return[];if(W=b*j-U*F,0>W||W>Q)return[]}else{if(f>0||Q>f)return[];if(W=b*j-U*F,W>0||Q>W)return[]}if(0==W)return!o||0!=f&&f!=Q?[O]:[];if(W==Q)return!o||0!=f&&f!=Q?[h]:[];if(0==f)return[H];if(f==Q)return[q];var s=W/Q;return[{x:O.x+s*n,y:O.y+s*K}]}if(0!=f||b*j!=U*F)return[];var i=0==n&&0==K,I=0==U&&0==b;if(i&&I)return O.x!=H.x||O.y!=H.y?[]:[O];if(i)return N(H,q,O)?[O]:[];if(I)return N(O,h,H)?[H]:[];var x,w,P,g,p,a,r,l;return 0!=n?(O.x<h.x?(x=O,P=O.x,w=h,g=h.x):(x=h,P=h.x,w=O,g=O.x),H.x<q.x?(p=H,r=H.x,a=q,l=q.x):(p=q,r=q.x,a=H,l=H.x)):(O.y<h.y?(x=O,P=O.y,w=h,g=h.y):(x=h,P=h.y,w=O,g=O.y),H.y<q.y?(p=H,r=H.y,a=q,l=q.y):(p=q,r=q.y,a=H,l=H.y)),r>=P?r>g?[]:g==r?o?[]:[p]:l>=g?[p,w]:[p,a]:P>l?[]:P==l?o?[]:[x]:l>=g?[x,w]:[x,a]}function E(e,X,z,q){var k=1e-10,f=X.x-e.x,x=X.y-e.y,d=z.x-e.x,V=z.y-e.y,T=q.x-e.x,H=q.y-e.y,M=f*V-x*d,Z=f*H-x*T;if(y(M)>k){var I=T*V-H*d;return M>0?Z>=0&&I>=0:Z>=0||I>=0}return Z>0}function l(P,w){function $(F,m){var d=J.length-1,Y=F-1;0>Y&&(Y=d);var v=F+1;v>d&&(v=0);var W=E(J[F],J[Y],J[v],Q[m]);if(!W)return!1;var M=Q.length-1,P=m-1;0>P&&(P=M);var l=m+1;return l>M&&(l=0),W=E(Q[m],Q[P],Q[l],J[F]),W?!0:!1}function Z(u,N){var B,y,M;for(B=0;B<J.length;B++)if(y=B+1,y%=J.length,M=f(u,N,J[B],J[y],!0),M.length>0)return!0;return!1}function a($,c){var Q,e,N,C,b;for(Q=0;Q<y.length;Q++)for(e=w[y[Q]],N=0;N<e.length;N++)if(C=N+1,C%=e.length,b=f($,c,e[N],e[C],!0),b.length>0)return!0;return!1}for(var Q,c,x,Y,U,I,C,d,B,q,g,J=P.concat(),y=[],l=[],A=0,V=w.length;V>A;A++)y.push(A);for(var s=0,v=2*y.length;y.length>0&&(v--,!(0>v));)for(x=s;x<J.length;x++){Y=J[x],c=-1;for(var A=0;A<y.length;A++)if(I=y[A],C=Y.x+":"+Y.y+":"+I,l[C]===M){Q=w[I];for(var D=0;D<Q.length;D++)if(U=Q[D],$(x,D)&&!Z(Y,U)&&!a(Y,U)){c=D,y.splice(A,1),d=J.slice(0,x+1),B=J.slice(x),q=Q.slice(c),g=Q.slice(0,c+1),J=d.concat(q).concat(g).concat(B),s=x;break}if(c>=0)break;l[C]=!0}if(c>=0)break}return J}for(var c,O,F,x,$,V,H={},W=S.concat(),s=0,T=R.length;T>s;s++)Array.prototype.push.apply(W,R[s]);for(c=0,O=W.length;O>c;c++)$=W[c].x+":"+W[c].y,H[$]!==M,H[$]=c;var J=l(S,R),j=Yl.Triangulate(J,!1);for(c=0,O=j.length;O>c;c++)for(x=j[c],F=0;3>F;F++)$=x[F].x+":"+x[F].y,V=H[$],V!==M&&(x[F]=V);return j.concat()},isClockWise:function(h){return Yl.Triangulate.area(h)<0},b2p0:function(l,j){var J=1-l;return J*J*j},b2p1:function(Z,q){return 2*(1-Z)*Z*q},b2p2:function(d,H){return d*d*H},b2:function(S,m,K,g){return this.b2p0(S,m)+this.b2p1(S,K)+this.b2p2(S,g)},b3p0:function(q,P){var t=1-q;return t*t*t*P},b3p1:function(j,s){var M=1-j;return 3*M*M*j*s},b3p2:function(Z,e){var i=1-Z;return 3*i*Z*Z*e},b3p3:function(E,Z){return E*E*E*Z},b3:function(K,X,c,$,R){return this.b3p0(K,X)+this.b3p1(K,c)+this.b3p2(K,$)+this.b3p3(K,R)}},Yl={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var j=E.keys(this.faces);return j.length?j[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(y){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(V){var y=V.familyName.toLowerCase(),n=this;return n.faces[y]=n.faces[y]||{},n.faces[y][V.cssFontWeight]=n.faces[y][V.cssFontWeight]||{},n.faces[y][V.cssFontWeight][V.cssFontStyle]=V,V},drawText:function(R){var U,Q=this.getFace(),F=this.size/Q.resolution,Y=0,p=String(R).split(""),o=p.length,v=[];for(U=0;o>U;U++){var L=new oi,W=this.extractGlyphPoints(p[U],Q,F,Y,L);W&&(Y+=W.offset*this.spacing,v.push(W.path))}var n=Y/2;return{paths:v,offset:n}},extractGlyphPoints:function(k,U,i,d,O){var I,n,s,j,v,f,V,N,P,b,X,H,m,Y,B,J,M,e,D,r=[],Q=U.glyphs[k]||U.glyphs["?"];if(Q){if(Q.o)for(j=Q._cachedOutline||(Q._cachedOutline=Q.o.split(" ")),f=j.length,V=i,N=i,I=0;f>I;)switch(v=j[I++]){case"m":P=j[I++]*V+d,b=j[I++]*N,O.moveTo(P,b);break;case"l":P=j[I++]*V+d,b=j[I++]*N,O.lineTo(P,b);break;case"q":if(X=j[I++]*V+d,H=j[I++]*N,B=j[I++]*V+d,J=j[I++]*N,O.quadraticCurveTo(B,J,X,H),D=r[r.length-1])for(m=D.x,Y=D.y,n=1,s=this.divisions;s>=n;n++){var p=n/s;Fj.b2(p,m,B,X),Fj.b2(p,Y,J,H)}break;case"b":if(X=j[I++]*V+d,H=j[I++]*N,B=j[I++]*V+d,J=j[I++]*N,M=j[I++]*V+d,e=j[I++]*N,O.bezierCurveTo(B,J,M,e,X,H),D=r[r.length-1])for(m=D.x,Y=D.y,n=1,s=this.divisions;s>=n;n++){var p=n/s;Fj.b3(p,m,B,M,X),Fj.b3(p,Y,J,e,H)}}return{offset:Q.ha*i,path:O}}}};Yl.generateShapes=function(s,J){J=J||{};var Y=J.font;if(Y===M&&(Y=Yl.getDefaultFont(),!Y))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var R=J.size!==M?J.size:1,m=J.curveSegments!==M?J.curveSegments:4,Q=J.spacing!==M?J.spacing:1,h=J.weight!==M?J.weight:"normal",X=J.style!==M?J.style:"normal";Yl.size=R,Yl.divisions=m,Yl.face=Y,Yl.weight=h,Yl.style=X,Yl.spacing=Q;for(var F=Yl.drawText(s),d=F.paths,j=[],u=0,$=d.length;$>u;u++)Array.prototype.push.apply(j,d[u].toShapes());return j},function(C){var G=1e-10,Q=function(A,$){var X=A.length;if(3>X)return null;var E,r,h,U=[],o=[],R=[];if(j(A)>0)for(r=0;X>r;r++)o[r]=r;else for(r=0;X>r;r++)o[r]=X-1-r;var x=X,V=2*x;for(r=x-1;x>2;){if(V--<=0)return $?R:U;if(E=r,E>=x&&(E=0),r=E+1,r>=x&&(r=0),h=r+1,h>=x&&(h=0),m(A,E,r,h,x,o)){var u,L,c,f,s;for(u=o[E],L=o[r],c=o[h],U.push([A[u],A[L],A[c]]),R.push([o[E],o[r],o[h]]),f=r,s=r+1;x>s;f++,s++)o[f]=o[s];x--,V=2*x}}return $?R:U},j=function(l){for(var o=l.length,$=0,e=o-1,T=0;o>T;e=T++)$+=l[e].x*l[T].y-l[T].x*l[e].y;return.5*$},m=function(b,o,l,q,I,L){var i,c,Q,_,B,t,P,r,V;if(c=b[L[o]].x,Q=b[L[o]].y,_=b[L[l]].x,B=b[L[l]].y,t=b[L[q]].x,P=b[L[q]].y,G>(_-c)*(P-Q)-(B-Q)*(t-c))return!1;var k,K,$,d,w,J,e,O,f,M,p,A,n,x,s;for(k=t-_,K=P-B,$=c-t,d=Q-P,w=_-c,J=B-Q,i=0;I>i;i++)if(r=b[L[i]].x,V=b[L[i]].y,!(r===c&&V===Q||r===_&&V===B||r===t&&V===P)&&(e=r-c,O=V-Q,f=r-_,M=V-B,p=r-t,A=V-P,s=k*M-K*f,n=w*O-J*e,x=$*A-d*p,s>=-G&&x>=-G&&n>=-G))return!1;return!0};return C.Triangulate=Q,C.Triangulate.area=j,C}(Yl),i._typeface_js={faces:Yl.faces,loadFace:Yl.loadFace};var _l=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},_b=_l.prototype={constructor:_l,computeFaceNormals:function(){for(var X=new Mn,o=new Mn,W=0,Y=this.faces.length;Y>W;W++){var n=this.faces[W],y=this.vertices[n.a],J=this.vertices[n.b],u=this.vertices[n.c];X.subVectors(u,J),o.subVectors(y,J),X.cross(o),X.normalize(),n.normal.copy(X)}},computeVertexNormals:function(M){var a,E,T,Q,D,F;for(F=new Array(this.vertices.length),a=0,E=this.vertices.length;E>a;a++)F[a]=new Mn;if(M){var v,O,k,R=new Mn,o=new Mn;for(T=0,Q=this.faces.length;Q>T;T++)D=this.faces[T],v=this.vertices[D.a],O=this.vertices[D.b],k=this.vertices[D.c],R.subVectors(k,O),o.subVectors(v,O),R.cross(o),F[D.a].add(R),F[D.b].add(R),F[D.c].add(R)}else for(T=0,Q=this.faces.length;Q>T;T++)D=this.faces[T],F[D.a].add(D.normal),F[D.b].add(D.normal),F[D.c].add(D.normal);for(a=0,E=this.vertices.length;E>a;a++)F[a].normalize();for(T=0,Q=this.faces.length;Q>T;T++)D=this.faces[T],D.vertexNormals[0]=F[D.a].clone(),D.vertexNormals[1]=F[D.b].clone(),D.vertexNormals[2]=F[D.c].clone()},mergeVertices:function(){var G,P,v,r,L,$,V,n,o={},u=[],l=[],B=4,S=g(10,B);for(v=0,r=this.vertices.length;r>v;v++)G=this.vertices[v],P=J(G.x*S)+"_"+J(G.y*S)+"_"+J(G.z*S),o[P]===M?(o[P]=v,u.push(this.vertices[v]),l[v]=u.length-1):l[v]=l[o[P]];var _=[];for(v=0,r=this.faces.length;r>v;v++){L=this.faces[v],L.a=l[L.a],L.b=l[L.b],L.c=l[L.c],$=[L.a,L.b,L.c];for(var W=0;3>W;W++)if($[W]==$[(W+1)%3]){_.push(v);break}}for(v=_.length-1;v>=0;v--){var j=_[v];for(this.faces.splice(j,1),V=0,n=this.faceVertexUvs.length;n>V;V++)this.faceVertexUvs[V].splice(j,1)}var b=this.vertices.length-u.length;return this.vertices=u,b}},tm=function(g,Q,O,v,H,T,e){this.aX=g,this.aY=Q,this.xRadius=O,this.yRadius=v,this.aStartAngle=H,this.aEndAngle=T,this.aClockwise=e};tm.prototype=$b(th),tm.prototype.getPoint=function(n){var $,A=this.aEndAngle-this.aStartAngle;0>A&&(A+=O),A>O&&(A-=O),$=this.aClockwise===!0?this.aEndAngle+(1-n)*(O-A):this.aStartAngle+n*A;var x=this.aX+this.xRadius*s($),u=this.aY+this.yRadius*N($);return new op(x,u)};var _d=function(S,X){this.v1=S,this.v2=X},ki=_d.prototype=$b(th);ki.getPoint=function(a){var n=this.v2.clone().sub(this.v1);return n.multiplyScalar(a).add(this.v1),n},ki.getPointAt=function(c){return this.getPoint(c)},ki.getTangent=function(){var I=this.v2.clone().sub(this.v1);return I.normalize()};var Ef=function(u,S,x){this.v0=u,this.v1=S,this.v2=x};Ef.prototype=$b(th),Ef.prototype.getPoint=function(d){var S,J;return S=Fj.b2(d,this.v0.x,this.v1.x,this.v2.x),J=Fj.b2(d,this.v0.y,this.v1.y,this.v2.y),new op(S,J)};var Qj=function(N,c,I,x){this.v0=N,this.v1=c,this.v2=I,this.v3=x};Qj.prototype=$b(th),Qj.prototype.getPoint=function(P){var s,d;return s=Fj.b3(P,this.v0.x,this.v1.x,this.v2.x,this.v3.x),d=Fj.b3(P,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new op(s,d)},Fn.create(function(W,i){this.v1=W,this.v2=i},function(a){var z=new Mn;return z.subVectors(this.v2,this.v1),z.multiplyScalar(a),z.add(this.v1),z});var ms=Fn.create(function(z,w,o){this.v0=z,this.v1=w,this.v2=o},function(s){var l,M,o;return l=Fj.b2(s,this.v0.x,this.v1.x,this.v2.x),M=Fj.b2(s,this.v0.y,this.v1.y,this.v2.y),o=Fj.b2(s,this.v0.z,this.v1.z,this.v2.z),new Mn(l,M,o)}),ep=Fn.create(function(d,r,m,O){this.v0=d,this.v1=r,this.v2=m,this.v3=O},function(x){var E,Z,d;return E=Fj.b3(x,this.v0.x,this.v1.x,this.v2.x,this.v3.x),Z=Fj.b3(x,this.v0.y,this.v1.y,this.v2.y,this.v3.y),d=Fj.b3(x,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Mn(E,Z,d)}),Do=function(L,C,H,i,A,V,t,m){_l.call(this),i=i!==M?i:.5,A=A!==M?A:.5,m=m!==M?m:1,L=L||8,V=V||0,t=t||O;var B,R,Z=1,o=m/2,c=[],u=[],r=this.vertices,J=this.faces,Y=this.faceVertexUvs;for(R=0;Z>=R;R++){var n=[],g=[],I=R/Z,w=I*(A-i)+i;for(B=0;L>=B;B++){var D=B/L,K=new Mn,j=-(D*t+V);K.z=w*N(j),K.y=-I*m+o,K.x=w*s(j),r.push(K),n.push(r.length-1),g.push(new op(D,I))}c.push(n),u.push(g)}var E,G,X=(A-i)/m;for(B=0;L>B;B++)for(0!==i?(E=r[c[0][B]].clone(),G=r[c[0][B+1]].clone()):(E=r[c[1][B]].clone(),G=r[c[1][B+1]].clone()),E.setY(l(E.x*E.x+E.z*E.z)*X).normalize(),G.setY(l(G.x*G.x+G.z*G.z)*X).normalize(),R=0;Z>R;R++){var b=c[R][B],e=c[R+1][B],p=c[R+1][B+1],k=c[R][B+1],S=E.clone(),h=E.clone(),F=G.clone(),f=G.clone(),P=u[R][B].clone(),U=u[R+1][B].clone(),W=u[R+1][B+1].clone(),y=u[R][B+1].clone();J.push(new ji(b,e,k,[S,h,f])),Y[0].push([P,U,y]),J.push(new ji(e,p,k,[h.clone(),F,f.clone()])),Y[0].push([U.clone(),W,y.clone()])}if(C&&i>0)for(this.vertices.push(new Mn(0,o,0)),B=0;L>B;B++){var b=c[0][B],e=c[0][B+1],p=this.vertices.length-1,S=new Mn(0,1,0),h=new Mn(0,1,0),F=new Mn(0,1,0),P=u[0][B].clone(),U=u[0][B+1].clone(),W=new op(U.x,0);J.push(new ji(b,e,p,[S,h,F],null,1));var z=B/L*O,x=s(z),T=N(z),_=(B+1)/L*O,Q=s(_),d=N(_);Y[0].push([new op(.5+.5*x,.5+.5*T),new op(.5+.5*Q,.5+.5*d),new op(.5,.5)])}if(H&&A>0)for(this.vertices.push(new Mn(0,-o,0)),B=0;L>B;B++){var b=c[R][B+1],e=c[R][B],p=r.length-1,S=new Mn(0,-1,0),h=new Mn(0,-1,0),F=new Mn(0,-1,0),P=u[R][B+1].clone(),U=u[R][B].clone();J.push(new ji(b,e,p,[S,h,F],null,2));var z=B/L*O,x=s(z),T=N(z),_=(B+1)/L*O,Q=s(_),d=N(_);Y[0].push([new op(.5+.5*Q,.5-.5*d),new op(.5+.5*x,.5-.5*T),new op(.5,.5)])}};Do.prototype=$b(_b);var Db=function(Q,C,G,x,e,Y,q){_l.call(this),q=q||.5,Q=Q||16,C=C||16,G=(G!==M?G:0)-W,x=x!==M?x:O,e=e!==M?e:0,Y=Y!==M?Y:W;var l,R,p=[],a=[],t=this.vertices,F=this.faces,H=this.faceVertexUvs;for(R=0;C>=R;R++){var P=[],j=[];for(l=0;Q>=l;l++){var w=l/Q,T=R/C,d=new Mn;d.x=-q*s(G+w*x)*N(e+T*Y),d.y=q*s(e+T*Y),d.z=q*N(G+w*x)*N(e+T*Y),t.push(d),P.push(t.length-1),j.push(new op(w,T))}p.push(P),a.push(j)}for(R=0;C>R;R++)for(l=0;Q>l;l++){var c=p[R][l+1],v=p[R][l],m=p[R+1][l],V=p[R+1][l+1],E=t[c].clone().normalize(),U=t[v].clone().normalize(),I=t[m].clone().normalize(),L=t[V].clone().normalize(),i=a[R][l+1].clone(),r=a[R][l].clone(),A=a[R+1][l].clone(),J=a[R+1][l+1].clone();y(t[c].y)===q?(i.x=(i.x+r.x)/2,F.push(new ji(c,m,V,[E,I,L])),H[0].push([i,A,J])):y(t[m].y)===q?(A.x=(A.x+J.x)/2,F.push(new ji(c,v,m,[E,U,I])),H[0].push([i,r,A])):(F.push(new ji(c,v,V,[E,U,L])),H[0].push([i,r,J]),F.push(new ji(v,m,V,[U.clone(),I,L.clone()])),H[0].push([r.clone(),A,J.clone()]))}};Db.prototype=$b(_b);var pg=function(H,r,X,v,b,K){_l.call(this),H=H||.33,r=r||.17,v=v||8,X=X||6,b=b||0,K=K||O;for(var n=new Mn,T=[],c=[],h=0;v>=h;h++)for(var j=h/v*O+W,e=0;X>=e;e++){var t=e/X*K+b;n.x=H*s(t),n.z=-H*N(t);var $=new Mn,V=H+r*s(j);$.x=V*s(t),$.z=-V*N(t),$.y=r*N(j),this.vertices.push($),T.push(new op(e/X,1-h/v)),c.push($.clone().sub(n).normalize())}for(var h=1;v>=h;h++)for(var e=1;X>=e;e++){var Y=(X+1)*h+e-1,J=(X+1)*(h-1)+e-1,U=(X+1)*(h-1)+e,F=(X+1)*h+e,g=new ji(Y,J,F,[c[Y].clone(),c[J].clone(),c[F].clone()]);this.faces.push(g),this.faceVertexUvs[0].push([T[Y].clone(),T[J].clone(),T[F].clone()]),g=new ji(J,U,F,[c[J].clone(),c[U].clone(),c[F].clone()]),this.faces.push(g),this.faceVertexUvs[0].push([T[J].clone(),T[U].clone(),T[F].clone()])}this.computeFaceNormals()};pg.prototype=$b(_b);var Kq=function(p,c,F){return p?(_l.call(this),p=p instanceof Array?p:[p],this.addShapeList(p,c),c.convertYZ!==!1&&nm(this,F),this.computeFaceNormals(),void 0):(p=[],void 0)},ah=Kq.prototype=$b(_l.prototype);ah.addShapeList=function(D,V){for(var g=D.length,j=0;g>j;j++){var M=D[j];this.addShape(M,V)}},ah.addShape=function(m,G){function R(){if(G.bottom)for(var D=0;q>D;D++)x=L[D],w(x[2],x[1],x[0],!0);if(G.top)for(D=0;q>D;D++)x=L[D],w(x[0]+z*Y,x[1]+z*Y,x[2]+z*Y,!1)}function D(){var U=0;for(S(c,U),U+=c.length,p=0,Q=n.length;Q>p;p++)u=n[p],S(u,U),U+=u.length}function S(s,R){for(var m,M,X=s.length;--X>=0;){m=X,M=X-1,0>M&&(M=s.length-1);var $=0,_=Y;for($=0;_>$;$++){var I=z*$,B=z*($+1),D=R+m+I,S=R+M+I,c=R+M+B,h=R+m+B;o(D,S,c,h,s,$,_,m,M)}}}function s(h,a,m){E.vertices.push(new Mn(h,a,m))}function w(Y,D,H,U){Y+=O,D+=O,H+=O,E.faces.push(new ji(Y,D,H,null,null,U?2:1));var v=U?C.generateBottomUV(E,m,G,Y,D,H):C.generateTopUV(E,m,G,Y,D,H);E.faceVertexUvs[0].push(v)}function o(z,N,T,Z,a,j,q,W,t){z+=O,N+=O,T+=O,Z+=O,E.faces.push(new ji(z,N,Z)),E.faces.push(new ji(N,T,Z));var L=C.generateSideWallUV(E,m,a,G,z,N,T,Z,j,q,W,t);E.faceVertexUvs[0].push([L[0],L[1],L[3]]),E.faceVertexUvs[0].push([L[1],L[2],L[3]])}var Z,T,h,_,N,t=G.amount,A=G.curveSegments||zs,Y=G.steps||1,P=G.extrudePath,J=!1,C=new Yr(G.repeatUVLength);P&&(Z=P.getSpacedPoints(Y),J=!0,T=G.frames!==M?G.frames:new ul.FrenetFrames(P,Y,!1),h=new Mn,_=new Mn,N=new Mn);var u,p,Q,E=this,O=this.vertices.length,W=m.extractPoints(A),U=W.shape,n=W.holes,i=!Fj.isClockWise(U);if(i){for(U=U.reverse(),p=0,Q=n.length;Q>p;p++)u=n[p],Fj.isClockWise(u)&&(n[p]=u.reverse());i=!1}var L=Fj.triangulateShape(U,n),c=U;for(p=0,Q=n.length;Q>p;p++)u=n[p],U=U.concat(u);for(var r,x,z=U.length,q=L.length,I=0;z>I;I++)r=U[I],J?(_.copy(T.normals[0]).multiplyScalar(r.x),h.copy(T.binormals[0]).multiplyScalar(r.y),N.copy(Z[0]).add(_).add(h),s(N.x,N.y,N.z)):s(r.x,r.y,0);var f;for(f=1;Y>=f;f++)for(I=0;z>I;I++)r=U[I],J?(_.copy(T.normals[f]).multiplyScalar(r.x),h.copy(T.binormals[f]).multiplyScalar(r.y),N.copy(Z[f]).add(_).add(h),s(N.x,N.y,N.z)):s(r.x,r.y,t/Y*f);R(),D()};var ul=function(E,J,M,k,X){function L(C,M,z){return v.vertices.push(new Mn(C,M,z))-1}_l.call(this),J=J||64,M=M||1,k=k||8,X=X||!1;var Q,b,B,H,e,D,R,Z,d,P,y,K,V,f,T,m,G,q,h,C,z=[],v=this,r=J+1,n=new Mn,I=new ul.FrenetFrames(E,J,X),x=I.tangents,S=I.normals,l=I.binormals;for(this.tangents=x,this.normals=S,this.binormals=l,d=0;r>d;d++)for(z[d]=[],H=d/(r-1),Z=E.getPointAt(H),Q=x[d],b=S[d],B=l[d],P=0;k>P;P++)e=P/k*O,D=-M*s(e),R=M*N(e),n.copy(Z),n.x+=D*b.x+R*B.x,n.y+=D*b.y+R*B.y,n.z+=D*b.z+R*B.z,z[d][P]=L(n.x,n.y,n.z);for(d=0;J>d;d++)for(P=0;k>P;P++)y=X?(d+1)%J:d+1,K=(P+1)%k,V=z[d][P],f=z[y][P],T=z[y][K],m=z[d][K],G=new op(d/J,P/k),q=new op((d+1)/J,P/k),h=new op((d+1)/J,(P+1)/k),C=new op(d/J,(P+1)/k),this.faces.push(new ji(V,f,m)),this.faceVertexUvs[0].push([G,q,C]),this.faces.push(new ji(f,T,m)),this.faceVertexUvs[0].push([q.clone(),h,C.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};ul.prototype=$b(_b),ul.FrenetFrames=function(D,f,A){function z(){R[0]=new Mn,M[0]=new Mn,o=Number.MAX_VALUE,X=y(v[0].x),j=y(v[0].y),$=y(v[0].z),o>=X&&(o=X,Q.set(1,0,0)),o>=j&&(o=j,Q.set(0,1,0)),o>=$&&Q.set(0,0,1),G.crossVectors(v[0],Q).normalize(),R[0].crossVectors(v[0],G),M[0].crossVectors(v[0],R[0])}var s,o,X,j,$,Z,u,Q=new Mn,v=[],R=[],M=[],G=new Mn,K=new Pr,H=f+1,m=1e-4;for(this.tangents=v,this.normals=R,this.binormals=M,Z=0;H>Z;Z++)u=Z/(H-1),v[Z]=D.getTangentAt(u),v[Z].normalize();for(z(),Z=1;H>Z;Z++)R[Z]=R[Z-1].clone(),M[Z]=M[Z-1].clone(),G.crossVectors(v[Z-1],v[Z]),G.length()>m&&(G.normalize(),s=I(gg(v[Z-1].dot(v[Z]),-1,1)),R[Z].applyMatrix4(K.makeRotationAxis(G,s))),M[Z].crossVectors(v[Z],R[Z]);if(A)for(s=I(gg(R[0].dot(R[H-1]),-1,1)),s/=H-1,v[0].dot(G.crossVectors(R[0],R[H-1]))>0&&(s=-s),Z=1;H>Z;Z++)R[Z].applyMatrix4(K.makeRotationAxis(v[Z],s*Z)),M[Z].crossVectors(v[Z],R[Z])};var Jq=function($,D,C,f){_l.call(this),D=D||18,C=C||0,f=f==a?O:f;for(var q=1/($.length-1),A=1/D,w=0,b=D;b>=w;w++)for(var Q=C+w*A*f,j=s(Q),x=N(Q),v=0,h=$.length;h>v;v++){var M=$[v],L=new Mn;L.x=j*M.x-x*M.y,L.y=x*M.x+j*M.y,L.z=M.z,this.vertices.push(L)}for(var F=$.length,w=0,b=D;b>w;w++)for(var v=0,h=$.length-1;h>v;v++){var S=v+F*w,r=S,e=S+F,j=S+1+F,P=S+1,k=w*A,H=v*q,m=k+A,K=H+q;this.faces.push(new ji(r,P,e)),this.faceVertexUvs[0].push([new op(k,H),new op(k,K),new op(m,H)]),this.faces.push(new ji(e,P,j)),this.faceVertexUvs[0].push([new op(m,H),new op(k,K),new op(m,K)])}this.mergeVertices(),nm(this),this.computeFaceNormals(),this.computeVertexNormals()};Jq.prototype=$b(_b);var Mf=function(e,l){l=l||{};var o=Yl.generateShapes(e,l);l.amount=l.amount!==M?l.amount:.5,l.convertYZ=!1,l.fill!==!1&&(l.bottom=!0,l.top=!0),Kq.call(this,o,l)};Mf.prototype=$b(ah);var uq=w.Node=function(){Bh(uq,this)},pk={X:jg,Y:ch,Z:Lf},fn={X:0,Y:1,Z:2},Uq={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},pb="xzy",Cq=function(N,l,J){if(l){var f=l[0],L=l[1],m=l[2];"xzy"===J?(ch(N,L),Lf(N,m),jg(N,f)):"xyz"===J?(Lf(N,m),ch(N,L),jg(N,f)):"yxz"===J?(Lf(N,m),jg(N,f),ch(N,L)):"yzx"===J?(jg(N,f),Lf(N,m),ch(N,L)):"zxy"===J?(ch(N,L),jg(N,f),Lf(N,m)):"zyx"===J?(jg(N,f),ch(N,L),Lf(N,m)):(ch(N,L),Lf(N,m),jg(N,f))}};Cf("Node",ed,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:pb,_64O:0,_rotationX:0,_53O:0,_host:a,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Wl},_22Q:function(){return gs},getX:function(){return this.p().x},setX:function(n){this.p(n,this.p().y)},getY:function(){return this.p().y},setY:function(Y){this.p(this.p().x,Y)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(W){this.setAnchor(W,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(E){this.setAnchor(this.getAnchor().x,E)},getScaleX:function(){return this.getScale().x},setScaleX:function(i){this.setScale(i,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(I){this.setScale(this.getScale().x,I)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(l,J){jr(l,js(a,a,this.r3(),this.getRotationMode())),this.translate3d(l[0]*J,l[1]*J,l[2]*J)},translateFront:function(w){this.translate3dBy([0,0,1],w)},translateBack:function(O){this.translate3dBy([0,0,-1],O)},translateLeft:function(b){this.translate3dBy([-1,0,0],b)},translateRight:function($){this.translate3dBy([1,0,0],$)},translateTop:function(W){this.translate3dBy([0,1,0],W)},translateBottom:function(I){this.translate3dBy([0,-1,0],I)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(l,G,T){1===arguments.length&&(G=l[1],T=l[2],l=l[0]),this.p(l,T),this.setElevation(G)},translate3d:function(o,m,B){1===arguments.length&&(m=o[1],B=o[2],o=o[0]),this.translate(o,B),this.setElevation(this._54O+m)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(w,i,Q){1===arguments.length&&(i=w[1],Q=w[2],w=w[0]),this.setSize(w,Q),this.setTall(i)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(v,$,j){1===arguments.length&&($=v[1],j=v[2],v=v[0]),this.setRotationX(v),this.setRotation(-$),this.setRotationZ(j)},setRotationY:function(c){this.setRotation(-c)},getRotationY:function(){return-this._64O},lookAtDirection:function(c,K){K=K||xr;var S=this,V=sh(c);K===xr?(S.r3([-k(c[1]/V),-x(c[2],c[0])+Z,0]),S.setRotationMode("xzy")):K===Te?(S.r3(0,-x(c[2],c[0]),k(c[1]/V)),S.setRotationMode("zyx")):K===Ul?(S.r3(0,-x(c[2],c[0])+W,-k(c[1]/V)),S.setRotationMode("zyx")):K===rr?(S.r3([-k(c[1]/V)+Z,-x(c[2],c[0])+Z,0]),S.setRotationMode("xzy")):K===tf&&(S.r3([-k(c[1]/V)-Z,-x(c[2],c[0])+Z,0]),S.setRotationMode("xzy")),K===Th&&(S.r3([-k(c[1]/V)+W,-x(c[2],c[0])+Z,W]),S.setRotationMode("zxy"))},lookAt:function(x,J){return this.lookAtDirection(Eh(x,this.p3()),J)},lookAtX:function(){var d=new pe,y=new pe,h=new pe,S=new yo,W=new yo,A=new uc;return function(c,f){var C=Rl(this);S.fromArray(C),h.copy(this.p3()),d.copy(c).sub(h).normalize(),f===xr?y.set(0,0,1):f===Th?y.set(0,0,-1):f===Ul?y.set(-1,0,0):f===Te?y.set(1,0,0):f===rr?y.set(0,1,0):f===tf&&y.set(0,-1,0),y.applyMatrix4(S).sub(h).normalize();var p=Math.acos(d.dot(y));if(p){var E=d.clone().cross(y).normalize();A.set(this.r3(),this.getRotationMode(),!0),S.makeRotationFromEuler(A),W.makeRotationAxis(E,-p),A.setFromRotationMatrix(W.multiply(S)),this.r3([A.x,A.y,A.z])}}}(),getHost:function(){return this._host},setHost:function(e){var c=this;if(c!==e&&c._host!==e){var T=c._host;T&&T._removeAttach(c),c._host=e,c._host&&c._host._addAttach(c),c.fp("host",T,e),c.onHostChanged(T,e)}},getAttaches:function(){return this._69O},_addAttach:function(_){var e=this;e._69O||(e._69O=new Yp),e._69O.add(_),e.fp("attaches",a,_)},_removeAttach:function(U){var C=this;C._69O.remove(U),C._69O.isEmpty()&&delete C._69O,C.fp("attaches",U,a)},getImage:function(){if(this._pendingCheckImageJSON){var W=n.getImage(this._image);W&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof hg&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(J){var p=this,w=p._image,S=p.getWidth(),C=p.getHeight();p._image=J,p.fp("image",w,J)&&(null!=J&&($l(J)||mc(J)&&/\.json$/i.test(J))&&(this._pendingCheckImageJSON=!0),p.fp(np,S,p.getWidth()),p.fp(Kk,C,p.getHeight()))},getElevation:function(){return this._54O},setElevation:function(f){var C=this;if(!C._50O){C._50O=1;var v=C._54O;C._54O=f,C.fp(ek,v,f),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(_){var W=this;if(!W._49O){W._49O=1;var j=W._64O;W._64O=_,W.fp(cj,j,_),delete W._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(m){var D=this;if(!D._51O){D._51O=1;var J=D._rotationX;D._rotationX=m,D.fp("rotationX",J,m),delete D._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(z){var Y=this;if(!Y._52O){Y._52O=1;var T=Y._53O;Y._53O=z,Y.fp("rotationZ",T,z),delete Y._52O}},getPosition:function(){return this._position},setPosition:function(F,L){var v=this;if(!v._50I){v._50I=1;var e;if(e=2===arguments.length?{x:F,y:L}:F,e.x!==v._position.x||e.y!==v._position.y){var P=v._position;v._position=e,v.fp(Bk,P,e)}delete v._50I}},translate:function(A,p){var J=this._position;this.p(J.x+A,J.y+p)},getWidth:function(){var e=this;if(e._width>=0)return e._width;var U=e.getStyle("shape3d");if(U){var Z=mi(U);if(Z&&Z.rawS3)return Z.rawS3[0];if("billboard"===U||"plane"===U){var X=hh(e.getStyle("shape3d.image"));return X?Uh(X,e):20}}var X=hh(e._image);return X?Uh(X,e):20},setWidth:function(g){var b=this,q=b._width;b._width=g,b.fp(np,q,g)},getHeight:function(){var O=this;if(O._height>=0)return O._height;var K=O.getStyle("shape3d");if(K){var j=mi(K);if(j&&j.rawS3)return j.rawS3[2];if("plane"===K){var X=hh(O.getStyle("shape3d.image"));return X?zq(X,O):20}if("billboard"===K)return 2}var X=hh(O._image);return X?zq(X,O):20},setHeight:function(g){var D=this,$=D._height;D._height=g,D.fp(Kk,$,g)},getTall:function(){var e=this;if(e._tall>=0)return e._tall;var o=e.getStyle("shape3d");if(o){var u=mi(o);if(u&&u.rawS3)return u.rawS3[1];if("billboard"===o){var h=hh(e.getStyle("shape3d.image"));return h?zq(h,e):20}if("plane"===o)return 2}return 20},setTall:function(Q){var R=this,g=R._tall;R._tall=Q,R.fp("tall",g,Q)},setSize:function(c,v){var N=this;2===arguments.length?(N.setWidth(c),N.setHeight(v)):(N.setWidth(c.width),N.setHeight(c.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(p,s,w,R,H){var v=this,Y=v.getAnchor(),x=v.getScale();arguments.length<=2&&(H=s,s=p.y,w=p.width,R=p.height,p=p.x);var u=H&&x.x<0?1-Y.x:Y.x,D=H&&x.y<0?1-Y.y:Y.y;v.p(p+w*u,s+R*D),H&&(w/=Math.abs(x.x),R/=Math.abs(x.y)),v.setWidth(w),v.setHeight(R)},getMatrix:function(){var t=this,V=t._64O,x=t._position,O=t.getScale();return new Lp(V,x.x,x.y,O.x,O.y)},getAnchorRect:function(){var Z=this,n=Z.getWidth(),i=Z.getHeight(),q=Z.getAnchor();return{x:-n*q.x,y:-i*q.y,width:n,height:i}},toLocal:function(y){return this.getMatrix().tfi(y)},toGlobal:function(E){return this.getMatrix().tf(E)},getAttachPosition:function(){var w=new Lp;return function(j,b,D,K){D=D||0,K=K||0;var y=this,W=y.getAnchor(),i=y._64O,g=y._position,m=y.getScale();return w.setFromTransform(i,g.x,g.y).tf({x:D+m.x*y.getWidth()*(j-W.x),y:K+m.y*y.getHeight()*(b-W.y)})}}(),isInRect:function(e){e=this.toLocal(e);var l=this.getWidth(),R=this.getHeight();return e.x+=l*this.getAnchorX(),e.y+=R*this.getAnchorY(),!(e.x<0||e.y<0||e.x>l||e.y>R)},getRect:function(){var i=this,z=i.getWidth(),N=i.getHeight(),I=i.getAnchor(),U={x:-z*I.x,y:-N*I.y,width:z,height:N},s=i.getMatrix();return U=rh([s.tf(U.x,U.y),s.tf(U.x+U.width,U.y),s.tf(U.x+U.width,U.y+U.height),s.tf(U.x,U.y+U.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var Y=this,o=Y.getAnchor(),X=Y._anchorElevation;return{x:o.x,y:X,z:o.y}
},setAnchorElevation:function(e){var Q=this,S=Q._anchorElevation;return S!==e?(Q._anchorElevation=e,Q.fp("anchorElevation",S,e),!0):!1},setAnchor3d:function(A,J,C,v){var h,x=this;"number"==typeof A?h={x:A,y:J,z:C}:(h=A.length?{x:A[0],y:A[1],z:A[2]}:A,v=J);var K=x.getDataModel();K&&K.beginTransaction();var W=x.getAnchor3d(),G=x.setAnchor(h.x,h.z);if(x.setAnchorElevation(h.y)&&(G=!0),G&&v&&!sn){x.getAnchor3d();var I=Rl(x),$=jr([h.x-W.x,h.y-W.y,h.z-W.z],I);x.p3($)}return K&&K.endTransaction(),G},getAnchor:function(){var f=this;if(f.hasOwnProperty("_anchor"))return f._anchor;var s=hh(f._image);return s&&s.anchorX!==M?{x:s.anchorX,y:s.anchorY}:f._anchor},setAnchor:function(J,i,p){var o,L=this;"number"==typeof J?o={x:J,y:i}:(o=J.length?{x:J[0],y:J[1]}:J,p=i);var t=L.getAnchor();if(t.x!==o.x||t.y!==o.y){var $=L.getDataModel();if($&&$.beginTransaction(),L._anchor=o,L.fp("anchor",t,o),p&&!sn){var u=L.getPosition(),K=L.getSize(),C=L.getRotation(),B=L.getScale(),O=-K.width*(t.x-o.x)*B.x,h=-K.height*(t.y-o.y)*B.y,Y=N(C),g=s(C);L.setPosition(u.x+g*O-Y*h,u.y+Y*O+g*h)}return $&&$.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(G,c){var Z,m=this;Z=2===arguments.length?{x:G,y:c}:G;var U=m.getScale();(U.x!==Z.x||U.y!==Z.y)&&(m._scale=Z,m.fp("scale",U,Z))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var D=this,G=D._scaleTall,b=D.getScale();return[b.x,G,b.y]},getFinalScale3d:function(){var F=this,B=F.s3(),L=F._dynamicScale3d,e=F.getScale3d();return B&&(e[0]*=B[0],e[1]*=B[1],e[2]*=B[2]),L&&(e[0]*=L[0],e[1]*=L[1],e[2]*=L[2]),e},getFinalRotation3d:function(){var u=this;return u._dynamicRotation||u.r3()},setScaleTall:function(K){var r=this,t=r._scaleTall;t!==K&&(r._scaleTall=K,r.fp("scaleTall",t,K))},setScale3d:function(c,w,l){var z,n=this;z="number"==typeof c?{x:c,y:w,z:l}:c.length?{x:c[0],y:c[1],z:c[2]}:c,n.setScaleTall(z.y),n.setScale(z.x,z.z)},getCorners:function(K,A){K==a&&(K=0),A==a&&(A=K);var n=this,G=n.getAnchor(),b=n.getWidth(),F=n.getHeight(),l=-b*G.x-K,T=-F*G.y-A,H=b+2*K,S=F+2*A,q=n.getMatrix();return[q.tf(l,T),q.tf(l,T+S),q.tf(l+H,T+S),q.tf(l+H,T)]},getEditControlPoints:function(E,b,U){b==a&&(b=0),U==a&&(U=b);var i=this,p=i.getAnchor(),F=i.getWidth(),G=i.getHeight(),w=-F*p.x-b,W=-G*p.y-U,Z=F+2*b,v=G+2*U;if(E)return[{x:w,y:W},{x:w,y:0},{x:w,y:W+v},{x:0,y:W+v},{x:w+Z,y:W+v},{x:w+Z,y:0},{x:w+Z,y:W},{x:0,y:W}];var L=i.getMatrix();return[L.tf(w,W),L.tf(w,0),L.tf(w,W+v),L.tf(0,W+v),L.tf(w+Z,W+v),L.tf(w+Z,0),L.tf(w+Z,W),L.tf(0,W)]},rotateAt:function(e,J,$){var B=this,P=B._position,L=B._64O,p=new Lp(L,P.x,P.y).tf(e,J),S=l(e*e+J*J),E=x(P.y-p.y,P.x-p.x)+$;B.setRotation(L+$),B.p(p.x+S*s(E),p.y+S*N(E))},onParentChanged:function(){uq.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var z={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(X){z[X]=!0}),function(d){var A=this;uq.superClass.onPropertyChanged.call(A,d),z[d.property]&&!A._layoutUpdating&&A.updateLayoutParameters(null,d.property),A._69O&&A._69O.each(function(J){J.handleHostPropertyChange(d)}),A._49I&&A._49I.each(function(D){D.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(Y){this.updateAttach(Y)},onStyleChanged:function(i){uq.superClass.onStyleChanged.apply(this,arguments),zk[i]&&this.updateAttach()},updateAttach:function(j){var M=this;return sn?(M.updateLayoutParameters(),void 0):(M._51I||(M._51I=1,M._71O(j),delete M._51I),void 0)},_71O:function(h){var e,E,H,O,L,F,l=this,i=l._host,f=h?h.property:a,B=h?h.oldValue:a,r=h?h.newValue:a;if(i instanceof w.Grid){if(f===ek)l.setElevation(l._54O+r-B);else if(!h||Qe[f]){if(e=l.s("attach.row.index"),E=l.s("attach.column.index"),H=i.getCellRect(e,E),!H)return;O=l.s("attach.row.span"),L=l.s("attach.column.span"),(1!==O||1!==L)&&(H=pc(H,i.getCellRect(e+O-1,E+L-1))),Aq(H,l,"attach.padding",1),l.setRect(H)}}else if(i instanceof Cc&&(F=l.s("attach.index"))>=0&&(!h||Bi[f])){var Q=l.s("attach.thickness");Q!=a&&l.setHeight(i.getThickness()*Q);var I=l.s("attach.offset"),k=i.getPoints(),T=k.size();if(T>F){var C=k.get(F),P=T===F+1?k.get(0):k.get(F+1),o=[P.x-C.x,P.y-C.y],G=sh(o);if(G){l.s("attach.offset.relative")&&(I*=G),l.s("attach.offset.opposite")&&(I=G-I);var V={x:C.x+o[0]/G*I,y:C.y+o[1]/G*I},c=l.s("attach.gap");c&&(l.s("attach.gap.relative")&&(c*=i.getThickness()),V=Xr(a,V,P,c)),l.p(V),l.setRotation(x(o[1],o[0]))}}}else h&&(f===Bk?l.translate(r.x-B.x,r.y-B.y):f===ek?l.setElevation(l._54O+r-B):Li[f]?l._11Q(i,f,r-B):("anchor"===f||"width"===f||"height"===f||"scale"===f)&&l.layout(i))},_11Q:function(){var k=new w.Math.Euler,y=w.Math.Euler.ReverseOrder,P=new w.Math.Vector2,c=new w.Math.Vector2;return function(q,m,C){var $=this,h=q.p3(),D=q.r3(),V=$.p3(),o=$.r3();if(m===cj&&(m="rotationY",C=-C),(m===cj||"rotationY"===m)&&0===o[0]&&0===o[2]&&0===D[0]&&0===D[2]&&0===V[1]&&0===h[1])return $.setRotation(-o[1]-C),P.set(V[0],V[2]).rotateAround(c.set(h[0],h[2]),-C),$.p(P.x,P.y),void 0;var N=Uq[q.getRotationMode()],b=N[0],s=N[1],r=N[2],p=pk[b],J=pk[s],W=pk[r],E=vo();m===cj+b?(W(E,D[fn[r]]),J(E,D[fn[s]]),p(E,C),J(E,-D[fn[s]]),W(E,-D[fn[r]])):m===cj+s?(W(E,D[fn[r]]),J(E,C),W(E,-D[fn[r]])):m===cj+r&&W(E,C);var j=Eh(V,h);jr(j,E),$.p3(h[0]+j[0],h[1]+j[1],h[2]+j[2]);var u=$.getRotationMode();Cq(E,$.r3(),u),k.setFromRotationMatrix(E,y(u)),$.r3([k.x,k.y,k.z])}}(),isHostOn:function(X){var G=this;if(G._host&&X&&X._69O)for(var q={},R=G._host;R&&R!==G&&!q[R._id];){if(R===X)return!0;q[R._id]=R,R=R._host}return!1},isLoopedHostOn:function(Y){return this.isHostOn(Y)&&Y.isHostOn(this)},getScaledSize:function(){var Q=this.getSize(),E=this.getScale();return Q.width*=Math.abs(E.x),Q.height*=Math.abs(E.y),Q},layout:function(G){if(G=G||this.getHost()){var C=this,o=C.s("layout.h")||"center",c=C.s("layout.v")||"center";if("center"!==o||"center"!==c){var m=new w.Math.Vector2,u=G.getPosition(),B=G.getAnchor(),I=G.getScaledSize();C.getPosition();var t,Q,v,i,b,T=1,F=1;switch(C._layoutUpdating=!0,o){case"left":m.setX(C._layoutHValue-B.x*I.width);break;case"right":m.setX((1-B.x)*I.width-C._layoutHValue);break;case"leftright":t=I.width-C._layoutHValue[2],v=C.getRotation()-G.getRotation(),i=Math.abs(Math.sin(v)),b=Math.abs(Math.cos(v)),T+=b*t/C._layoutHValue[3],F+=i*t/C._layoutHValue[4],m.setX(C._layoutHValue[1]+(C._layoutHValue[5]-B.x)*I.width);break;case"center":m.setX((.5-B.x)*I.width-C._layoutHValue);break;case"scale":v=C.getRotation()-G.getRotation(),i=Math.abs(Math.sin(v)),b=Math.abs(Math.cos(v)),m.setX((.5-B.x)*I.width-C._layoutHValue[1]*I.width/C._layoutHValue[0]),Q=I.width/C._layoutHValue[2]-1,T+=b*Q,F+=i*Q}switch(c){case"top":m.setY(C._layoutVValue-B.y*I.height);break;case"bottom":m.setY((1-B.y)*I.height-C._layoutVValue);break;case"topbottom":v||(v=C.getRotation()-G.getRotation(),i=Math.abs(Math.sin(v)),b=Math.abs(Math.cos(v))),t=I.height-C._layoutVValue[2],T+=i*t/C._layoutVValue[3],F+=b*t/C._layoutVValue[4],m.setY(C._layoutVValue[1]+(C._layoutVValue[5]-B.y)*I.height);break;case"center":m.setY((.5-B.y)*I.height-C._layoutVValue);break;case"scale":v||(v=C.getRotation()-G.getRotation(),i=Math.abs(Math.sin(v)),b=Math.abs(Math.cos(v))),m.setY((.5-B.y)*I.height-C._layoutVValue[1]*I.height/C._layoutVValue[0]),Q=I.height/C._layoutVValue[2]-1,T+=i*Q,F+=b*Q}if("leftright"===o||"scale"===o||"topbottom"===c||"scale"===c){var X=this.getScale(),x=Math.abs(X.x),s=Math.abs(X.y);"leftright"===o||"scale"===o?C.setSize(C._layoutHValue[3]*T/x,C._layoutHValue[4]*F/s):C.setSize(C._layoutVValue[3]*T/x,C._layoutVValue[4]*F/s)}m.rotateAround(null,G.getRotation()),this.setPosition(m.x+u.x,m.y+u.y),C._layoutUpdating=M}}},updateLayoutParameters:function(R,V){if(R=R||this.getHost()){var r=this,L=r.s("layout.h"),f=r.s("layout.v");if(L||f){var p,S,A,a,$,D,M=new w.Math.Vector2,F=R.getPosition(),T=R.getAnchor(),Q=R.getScaledSize(),v=r.getPosition(),k=r.getScaledSize();switch(M.set(v.x-F.x,v.y-F.y),M.rotateAround(null,-R.getRotation()),L){case"left":r._layoutHValue=M.x+T.x*Q.width;break;case"right":r._layoutHValue=-M.x+(1-T.x)*Q.width;break;case"center":r._layoutHValue=-M.x+(.5-T.x)*Q.width;break;case"leftright":case"scale":"scale"===L?p=-M.x+(.5-T.x)*Q.width:(S=r.getAnchor(),A=r.getRotation()-R.getRotation(),a=Math.cos(A),$=Math.sin(A),D=-Math.min(-S.x*a+S.y*$,-S.x*a-(1-S.y)*$,(1-S.x)*a+S.y*$,(1-S.x)*a-(1-S.y)*$),p=M.x-(D-T.x)*Q.width),"position"===V&&"object"==typeof r._layoutHValue?(r._layoutHValue[0]=Q.width,r._layoutHValue[1]=p):r._layoutHValue=[Q.width,p,Q.width,k.width,k.height,D]}switch(f){case"top":r._layoutVValue=M.y+T.y*Q.height;break;case"bottom":r._layoutVValue=-M.y+(1-T.y)*Q.height;break;case"center":r._layoutVValue=-M.y+(.5-T.y)*Q.height;break;case"topbottom":case"scale":"scale"===f?p=-M.y+(.5-T.y)*Q.height:(A||(S=r.getAnchor(),A=r.getRotation()-R.getRotation(),a=Math.cos(A),$=Math.sin(A)),D=-Math.min(-S.x*$-S.y*a,-S.x*$+(1-S.y)*a,(1-S.x)*$-S.y*a,(1-S.x)*$+(1-S.y)*a),p=M.y-(D-T.y)*Q.height),"position"===V&&"object"==typeof r._layoutVValue?(r._layoutVValue[0]=Q.height,r._layoutVValue[1]=p):r._layoutVValue=[Q.height,p,Q.height,k.width,k.height,D]}}}},getSerializableProperties:function(){var L=uq.superClass.getSerializableProperties.call(this);return jn(L,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),L}});var Qc=w.Edge=function(n,o){var G=this;Bh(Qc,G),G.setSource(n),G.setTarget(o)};Cf("Edge",ed,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Pn},_22Q:function(){return Xi},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(A){if(A===this)return!1;if(wc(A))return!0;for(var F,C,Q,v,$,g=[this],o=-1,q=0;q>o;)if(o++,F=g[o],C=F._44I)for(C=C.getArray(),v=0,$=C.length;$>v;v++)if(Q=C[v],wj(Q)&&!(g.indexOf(Q)>=0)){if(Q===A)return!1;g.push(Q),q++}return!0},setSource:function(x){var $=this;if($._source!==x&&$.canSetSourceTarget(x)){var D=$._source;$._source=x,D&&D._16I($),x&&x._2I($),$._7I(),$.fp("source",D,x)}},setTarget:function(j){var S=this;if(S._target!==j&&S.canSetSourceTarget(j)){var M=S._target;S._target=j,M&&M._18I(S),j&&j._4I(S),S._7I(),S.fp("target",M,j)}},isLooped:function(){var K=this;return K._source===K._target&&wc(K._source)&&wc(K._target)},onPropertyChanged:function(){var p=this;p._49I&&p._49I.each(function(u){u.fp("agentChange",!0,!1)})},_7I:function(){var s,b=this,Q=Il(b);b._40I!==Q&&(s=this._40I,s&&s._15I(b),b._40I=Q,Q&&Q._1I(b),b.fp("sourceAgent",s,Q),Nf(s,b._41I),Nf(Q,b._41I));var o=oj(b);b._41I!==o&&(s=b._41I,s&&s._17I(b),b._41I=o,o&&o._3I(b),b.fp("targetAgent",s,o),Nf(s,b._40I),Nf(o,b._40I))},_22I:function(z){this._52I=z,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var O=this;return O._52I&&O._52I.get(0)!==O&&!O.getStyle(vg)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var $=this,s=$._52I;return s&&!$.getStyle(vg)&&s.size()>1&&$===s.get(0)},toggle:function(){var H=this._52I,J=!this.s(vg);H&&H.size()>1&&(H.each(function(N){N.s(vg,J)}),H.getSiblings().each(function(o){o!==H&&o.each(function(R){R.fp("edgeGroup",a,o)})}))},setStyle:function(c,p){(c===tk||"edge.segments"===c)&&(p=_p(p)),Qc.superClass.setStyle.call(this,c,p)},onStyleChanged:function(s){Qc.superClass.onStyleChanged.apply(this,arguments),Dc[s]&&Nf(this._41I,this._40I)},getSerializableProperties:function(){var S=Qc.superClass.getSerializableProperties.call(this);return jn(S,{source:1,target:1}),S}});var Ri=w.Group=function(){Bh(Ri,this)};Cf("Group",uq,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return fb},onChildAdded:function(){Ri.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Ri.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var M=this;if(!M._54I&&!sn){var a=M.getChildrenRect();a&&(M._53I=1,M.p(xp(M.s("group.position"),a,M.getSize())),delete M._53I)}},getChildrenRect:function(){var n,i=this;return i.eachChild(function(j){wc(j)&&(n=pc(n,i.getChildRect(j)))}),n},getChildRect:function(D){var i;return wc(D)&&D.s(zo)&&(ni(D)&&D.isExpanded()&&D.eachChild(function(e){i=pc(i,D.getChildRect(e))}),!i&&D.getRect&&(i=D.getRect())),i},setPosition:function(y,Q){var I=this;if(!I._54I){var B;B=2===arguments.length?{x:y,y:Q}:y,sn||I._53I||(I._54I=1,Rc(I._children,B.x-I._position.x,B.y-I._position.y),delete I._54I),Ri.superClass.setPosition.call(this,B)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(V){var c=this;if(c._57O!==V){var N=c._57O;c._57O=V,c.fp("expanded",N,c._57O),c._fireInvalidateDeep(),c._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(P){ni(P)?P._fireInvalidateDeep():P.iv()})},_8I:function(){Ri.superClass._8I.call(this),this.eachChild(function(c){wc(c)&&c._8I()})},onStyleChanged:function(b){Ri.superClass.onStyleChanged.apply(this,arguments),"group.position"===b&&this._81I()},getSerializableProperties:function(){var b=Ri.superClass.getSerializableProperties.call(this);return b.expanded=1,b}});var Md=w.Block=function(){Bh(Md,this)};Cf("Block",uq,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Vg},onChildAdded:function(){Md.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Md.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var P=this;if(!sn&&!P._updatingToChildren&&P._syncSize&&!P._freezeSyncFromChildren){var M,o,K,C,T,g=[],E=P.getRotation();if(P.eachChild(function($){wc($)&&g.push.apply(g,$.getCorners())}),g.length){P._updatingFromChildren=1;var k=s(-E),x=N(-E),V=1/0,J=-1/0,e=1/0,U=-1/0;for(C=0,T=g.length;T>C;C++)K=g[C],M=K.x,o=K.y,K.x=k*M-x*o,K.y=x*M+k*o,V=p(V,K.x),J=t(J,K.x),e=p(e,K.y),U=t(U,K.y);var f=P.getScale();P.setSize(y((J-V)/f.x),y((U-e)/f.y));var X;f.x<0&&(X=V,V=J,J=X),f.y<0&&(X=e,e=U,U=X),k=s(E),x=N(E);var A=P.getAnchor();M=V+(J-V)*A.x,o=e+(U-e)*A.y,P.setPosition(k*M-x*o,x*M+k*o),delete P._updatingFromChildren}}},setPosition:function(C,f){var W=this;if(!W._updatingToChildren){var P;P=2===arguments.length?{x:C,y:f}:C,sn||W._updatingFromChildren||(W._updatingToChildren=1,Rc(W._children,P.x-W._position.x,P.y-W._position.y),delete W._updatingToChildren),Md.superClass.setPosition.call(this,P)}},setWidth:function(P){return this.setSize(P,this.getHeight())},setHeight:function(O){return this.setSize(this.getWidth(),O)},setSize:function(o,k){1>o&&(o=1),1>k&&(k=1);var L=this;if(!L._updatingToChildren){2!==arguments.length&&(k=o.height,o=o.width);var c=L.getWidth(),X=L.getHeight();if(o!==c&&Md.superClass.setWidth.call(L,o),k!==X&&Md.superClass.setHeight.call(L,k),!sn&&!L._updatingFromChildren){L._updatingToChildren=1;var e=o/c,$=k/X;L._adjustChildScaleOrSize(e,$,"size"),delete L._updatingToChildren,L.updateFromChildren()}}},_adjustChildScaleOrSize:function(i,U,S){var p=this;if(p._syncSize){var g=p.getPosition(),d=p.getRotation();p.getScale(),p.eachChild(function(G){if(wc(G)){var Q=G.getPosition(),R=G.getRotation(),I=G.getWidth(),b=G.getHeight(),F=G.getScale(),m=F.x*I,M=F.y*b,n=new Lp(R,Q.x,Q.y,m,M);n.translate(-g.x,-g.y),n.rotate(-d),R=x(n.b*Math.sign(m),n.a*Math.sign(m)),n.scale(i,U);var p,v,l,a=s(R);if(Math.abs(a)<.001?(p=N(R),v=n.b/p,l=-n.c/p):(v=n.a/a,l=n.d/a),"scale"===S)G.setScale(v/I,l/b);else if("size"===S){var z=v/F.x,L=l/F.y;G.setScale(Rj(v)*Math.abs(F.x),Rj(l)*Math.abs(F.y)),G instanceof w.Shape?(G.setWidthForce(Math.max(Math.abs(z),1e-5)),G.setHeightForce(Math.max(Math.abs(L),1e-5))):G.setSize(Math.max(.01,Math.abs(z)),Math.max(.01,Math.abs(L)))}n.rotate(d),n.translate(g.x,g.y),G.setPosition(n.tx,n.ty)}})}},_calcChangeFactor:function(C,Y,p,c){var Z,B,W,Q;return Z=y(C),B=y(p),W=Z>B?Z/B:B/Z,Z=y(Y),B=y(c),Q=Z>B?Z/B:B/Z,t(W,Q)},setAnchor:function(){var v=this;if(!v._updatingToChildren){var p=v.getAnchor();if(Md.superClass.setAnchor.apply(v,arguments),!sn&&!v._updatingFromChildren&&v._syncSize){v._updatingToChildren=1;var G=v.getAnchor();v.getPosition();var l=v.getSize(),b=v.getScale(),x=v.getRotation(),y=-l.width*b.x*(p.x-G.x),d=-l.height*b.y*(p.y-G.y),I=N(x),Y=s(x),R=Y*y-I*d,q=I*y+Y*d;v.eachChild(function(_){if(wc(_)){var P=_.getPosition();_.setPosition(P.x-R,P.y-q)}}),delete v._updatingToChildren}}},setRotation:function(s){var E=this;if(!E._updatingToChildren){var v=E.getRotation();if(Md.superClass.setRotation.apply(E,arguments),!sn&&!E._updatingFromChildren){E._updatingToChildren=1;var S=E.getPosition(),V=s-v;E.eachChild(function(B){if(wc(B)){var p=B.getMatrix();p.translate(-S.x,-S.y),p.rotate(V),p.translate(S.x,S.y);var K=Math.sign(B.getScale().x);B.setRotation(x(p.b*K,p.a*K)),B.setPosition(p.tx,p.ty)}}),delete E._updatingToChildren}}},setScale:function(K,A){var t=this;if(!t._updatingToChildren){null==A&&(A=K.y,K=K.x);var H=t.getScale();if(y(K)<.01&&(K=.01*(Rj(K)||Rj(H.x))),y(A)<.01&&(A=.01*(Rj(A)||Rj(H.y))),Md.superClass.setScale.call(t,K,A),!sn&&!t._updatingFromChildren){t._updatingToChildren=1;var W=K/H.x,i=A/H.y;t._adjustChildScaleOrSize(W,i,"size"),delete t._updatingToChildren,t.updateFromChildren()}}},getSerializableProperties:function(){var i=Md.superClass.getSerializableProperties.call(this);return i.clickThroughEnabled=1,i.syncSize=1,i}});var nf=w.Grid=function(){Bh(w.Grid,this)};Cf("Grid",uq,{IRotatable:!1,_icon:"grid_icon",_image:a,getUIClass:function(){return Xp},setRotation:function(){},getCellRect:function(D,E){var $=this,Q=$.s("grid.row.count"),A=$.s("grid.column.count");if(0>=Q||0>=A||0>D||D>=Q||0>E||E>=A)return a;var S,d,V,L=$.getRect(),v=$.s("grid.row.percents"),g=$.s("grid.column.percents");if(Aq(L,$,"grid.border",-1),v&&v._as&&(v=v._as),g&&g._as&&(g=g._as),v&&v.length===Q){for(V=0,S=0;D>S;S++)V+=L.height*v[S];L.y+=V,L.height=L.height*v[D]}else L.height=L.height/Q,L.y+=L.height*D;if(g&&g.length===A){for(d=0,S=0;E>S;S++)d+=L.width*g[S];L.x+=d,L.width=L.width*g[E]}else L.width=L.width/A,L.x+=L.width*E;return di(L,-$.s("grid.gap")),L}});var Ai=w.Text=function(){Bh(Ai,this),this.setSize(100,50),this.s("text","TEXT")};Cf("Text",uq,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Kg},setWidth:function(K){K||(K=.001),Ai.superClass.setWidth.call(this,K)},setHeight:function(J){J||(J=.001),Ai.superClass.setHeight.call(this,J)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),uh("__text__",{width:{value:100,isSafeFunc:!0,func:function(a){return a._width}},height:{value:50,isSafeFunc:!0,func:function(Y){return Y._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var Cc=w.Shape=function(){Bh(Cc,this),this._59O=new Yp};Cc.__de__=Ge,Cf("Shape",uq,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return mb},_22Q:function(){return of},getLength:function(P){return lc(Cl(this._59O,this._58O,P,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var B=this._58O;return B?new Yp(B._as.slice(0)):B},setSegments:function(X){var O=this._58O;X=X?uo(X)?new Yp(X.slice(0)):new Yp(X._as.slice(0)):null,(O&&X&&O._as.join(",")!==X._as.join(",")||O!==X)&&(this._58O=X,this.fp("segments",O,X))},getPoints:function(){return this._59O},toPoints:function(){var u=this._59O;return new Yp(u._as.slice(0))},setPoints:function(T,O){var r=this,y=r._59O;T=T?uo(T)?new Yp(T.slice(0)):new Yp(T._as.slice(0)):new Yp;var m,E,x,j,z,D;O&&(m=r.getPosition(),D=new Lp(r.getRotation(),0,0,r.getScale().x,r.getScale().y)),(y&&T&&y._as.join(",")!==T._as.join(",")||y!==T)&&(r._59O=T,r.fs(),r.fp("points",y,T)),O&&(E=r.getPosition(),x=E.x-m.x,j=E.y-m.y,z=D.tf(x,j),r.setPosition(E.x-x+z.x,E.y-j+z.y))},addPoint:function(O,g,U){var Y=this.toPoints();Y.add(O,g),this.setPoints(Y,U)},setPoint:function(E,P,B){var A=this.toPoints();A.set(E,P),this.setPoints(A,B)},removePointAt:function(M){var n=this.toPoints();n.removeAt(M),this.setPoints(n)},setWidthForce:function(y){var E=this;if(!E._55I&&!sn&&E.getWidth()){E._55I=1;var i=E._position.x,W=y/E.getWidth(),P=E.toPoints(),x=new Yp;P.each(function(a){x.add({x:(a.x-i)*W+i,y:a.y,e:a.e})}),E.setPoints(x),Ab(E,[W,0,0,1,i*(1-W),0]),E.fs(),delete E._55I}Cc.superClass.setWidth.call(E,y)},setWidth:function(E){return this.setWidthForce(1>E?1:E)},setHeightForce:function(c){var z=this;if(!z._55I&&!sn&&z.getHeight()){z._55I=1;var V=z._position.y,d=c/z.getHeight(),U=z.toPoints(),b=new Yp;U.each(function(S){b.add({x:S.x,y:(S.y-V)*d+V,e:S.e})}),z.setPoints(b),Ab(z,[1,0,0,d,0,V*(1-d)]),z.fs(),delete z._55I}Cc.superClass.setHeight.call(z,c)},setHeight:function(w){return this.setHeightForce(1>w?1:w)},setAnchorElevation:function(n){var y=this;y._55I=!0;var q=y._updatingAnchor3d,J=!sn&&!q;if(J){var N,I=n,D=y.getAnchorElevation(),L=y.getTall();N=L*(D-I),y.shiftPointsElevation(N)}var e=Cc.superClass.setAnchorElevation.apply(y,arguments);return q||delete y._55I,e},getShapeElevation:function(){var E=this,O=E._54O;return O-(E.getTall()||0)*(E._anchorElevation-.5)},setAnchor3d:function(S,M,A,b){var N,v=this;"number"==typeof S?N={x:S,y:M,z:A}:(N=S.length?{x:S[0],y:S[1],z:S[2]}:S,b=M),v._55I=!0,v._updatingAnchor3d=!0;var x=v.getDataModel();if(x&&x.beginTransaction(),!sn){var L=v.getAnchor3d(),m=v.getSize(),F=v.getTall(),U=m.width*(L.x-N.x),t=m.height*(L.z-N.z),s=F*(L.y-N.y);b||v.shiftPoints(U,t,s);var P=v.p3()}var k=Cc.superClass.setAnchor3d.apply(v,arguments);if(!sn&&b){var C=v.p3();v.shiftPoints(C[0]-P[0]+U,C[2]-P[2]+t,C[1]-P[1]+s)}return x&&x.endTransaction(),delete v._updatingAnchor3d,delete v._55I,k},setAnchor:function(E,q,U){var k=this;k._55I=!0;var $=k._updatingAnchor3d,h=!sn&&!$;if(h){var p,H,g;"number"==typeof E?g={x:E,y:q}:(g=E.length?{x:E[0],y:E[1]}:E,U=q);var B=k.getAnchor(),j=k.getSize();p=j.width*(B.x-g.x),H=j.height*(B.y-g.y),U||k.shiftPoints(p,H);var u=k.getPosition()}var s=Cc.superClass.setAnchor.apply(k,arguments);if(h){var l=k.getPosition();U&&k.shiftPoints(l.x-u.x+p,l.y-u.y+H)}return $||delete k._55I,s},shiftPoints:function(m,n,g){var r=this,l=r.getElevation()||0,S=r.toPoints(),Q=new Yp;S.each(function(G){var k=G.e;g&&(k=(k==a?l:k)+g),Q.add({x:G.x+m,y:G.y+n,e:k})}),r.setPoints(Q),r.fs()},shiftPointsElevation:function(P){return this.shiftPoints(0,0,P)},setPosition:function(F,q){var N,j=this;if(!j._28Q){if(j._28Q=1,!j._55I&&!sn){N=2===arguments.length?{x:F,y:q}:F;var o=N.x-j._position.x,g=N.y-j._position.y;if(0===o&&0===g)return delete j._28Q,void 0;j._55I=1,j.shiftPoints(o,g),Ab(j,[1,0,0,1,o,g]),delete j._55I}Cc.superClass.setPosition.apply(j,arguments),delete j._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var J=this;if(2!==J._59O.size())return!1;var p=J._58O;return p?2===p.size()&&1===p.get(0)&&2===p.get(1)?!0:!1:!0},fireShapeChange:function(){var h=this;if(!h._55I&&!sn){var i=rh(h._59O);i&&(h._55I=1,h.setRect(i),delete h._55I)}h.fp(Of,!1,!0)},getSerializableProperties:function(){var I=Cc.superClass.getSerializableProperties.call(this);return I.segments=1,I.points=1,I.thickness=1,I.closePath=1,I}});var $k=w.Polyline=function(){Bh($k,this),this.s({"shape.background":null,"shape.border.width":2})};Cf("Polyline",Cc,{_icon:"polyline_icon",_22Q:function(){return tr},getUIClass:function(){return yc},setClosePath:function(){},setTall:function(O){var S=this;if(!S._55I&&!S._24Q&&!sn&&S.getTall()){S._24Q=1;var h=S._54O,K=O/S.getTall();S._59O.each(function(U){U.e=U.e==a?h:(U.e-h)*K+h}),S.fs(),delete S._24Q}$k.superClass.setTall.call(S,O)},setElevation:function(l){var j=this;if(!j._55I&&!j._24Q&&!sn){j._24Q=1;var O=l-j._54O;j._59O.each(function(W){W.e==a?W.e=l:W.e+=O}),j.fs(),delete j._24Q}$k.superClass.setElevation.apply(j,arguments)},fireShapeChange:function(){var K=this,m=K._59O;if(!K._55I&&!K._24Q&&!sn){var J=m.size();if(J){var b=1,L=m.get(0),r=K._54O;L.e==a&&(L.e=r);for(var u=L.e,R=0;J>b;b++){L=m.get(b),L.e==a&&(L.e=r);var c=p(u,L.e),Y=t(u+R,L.e);u=c,R=Y-c}K._24Q=1,K.setTall(R),K.setElevation(u+R*K._anchorElevation),delete K._24Q}}$k.superClass.fireShapeChange.apply(K,arguments)}});var ns=w.SubGraph=function(){Bh(ns,this)};Cf("SubGraph",uq,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){ns.superClass._8I.call(this),this.eachChild(function(N){wc(N)&&N._8I()})}}),n.loadingRefGraph=0;var hg=w.RefGraph=function(){Bh(hg,this)};Cf("RefGraph",Md,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(p){var t=this._ref;this._ref=p,this.fp("ref",t,p),this.updateRef()},_21I:function(){hg.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var c=this;if(n.loadingRefGraph++,c.clearChildrenFromDataModel(),n.loadingRefGraph--,c._ref&&c._dataModel){c._xhrLoadHandler&&(c._xhrLoadHandler.cancel=!0);var m=sn,t=c._xhrLoadHandler=function(I){if(I&&c._dataModel){n.loadingRefGraph++;var _=c._pendingUpdateInfo={needToRestore:m};m&&(_.position=c.p(),_.width=c.getWidth(),_.height=c.getHeight(),_.rotation=c.getRotation(),_.anchor=c.getAnchor(),_.scale=c.getScale()),c.p(0,0),c.setAnchor(.5,.5),c.setRotation(0),c.setScale(1,1);var C=n.parse(I),N=c._dataModel.deserialize(C,c,{justDatas:!0});N.each(function(n){n._refGraph=c}),c.checkPendingUpdateInfo(),n.loadingRefGraph--,n.handleRefGraphLoaded(c,N,C)}};t.xhrLoadCalled=!1,n.load(c._ref,function(j){t.cancel||(t.xhrLoadCalled?t(j):nd(function(){t(j)}))}),t.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var C=this,h=C._pendingUpdateInfo;if(!h)return C.onPendingUpdated&&(n.loadingRefGraph++,C.onPendingUpdated(),n.loadingRefGraph--),void 0;var Y=!0;this.eachChild(function($){($._pendingCheckImageJSON||$._pendingUpdateInfo)&&(Y=!1)}),Y&&(n.loadingRefGraph++,C._pendingUpdateInfo=null,C.updateFromChildren(),h.needToRestore&&(C.setSize(h.width,h.height),C.setAnchor(h.anchor),C.setRotation(h.rotation),C.setScale(h.scale),C.p(h.position)),this.getParent()instanceof hg&&this.getParent().checkPendingUpdateInfo(),C.onPendingUpdated&&C.onPendingUpdated(),n.loadingRefGraph--)},getSerializableProperties:function(){var $=hg.superClass.getSerializableProperties.call(this);return $.ref=1,$}}),w.EdgeGroup=function(A,r){this._70O=A,this._siblings=r;for(var F,f,q=0,Z=A.size(),G=P[vg];Z>q;q++)if(F=A.get(q).getStyle(vg,!1),F!=a){G=F;break}G==a&&(G=!0);var M=n.edgeGroupAgentFunc;for(M&&(f=M(A),f&&f!==A.get(0)&&(A.remove(f),A.add(f,0))),q=0;Z>q;q++)A.get(q).s(vg,G)},Cf("EdgeGroup",E,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(l){return this._70O.get(l)},indexOf:function(Z){return this._70O.indexOf(Z)},each:function(u,Y){this._70O.each(u,Y)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(d,u){this._siblings.each(function(y){y._70O.each(d,u)})}});var gn=function(D,p,U){var N=ui[D]={type:D,action:p};if(U)for(var L in U)N[L]=U[L]};jn(n,{setConnectAction:gn,getConnectAction:function(D,a){if(!a){if(!D)return null;a=D.getCurrentConnectActionType()}return ui[a]},doConnectAction:function(o,z,q,y){y=y||o.getCurrentConnectActionType();var L=ui[y];if(!L)return!1;var W=L.action;return W?(z instanceof eh.Group?o.sm().getSelection().each(function(U){W.call(null,o,U,q)}):W.call(null,o,z,q),!0):!1},doDeleteConnectionAction:function(d,q,V){V=V||d.getCurrentConnectActionType();var e=ui[V];if(!e||!e.delete)return!1;var T=e.delete.action;return T?(q instanceof eh.Group?d.sm().getSelection().each(function(H){T.call(null,d,H)}):T.call(null,d,q),!0):!1}});var nb=w.JSONSerializer=function(J,I){this.dm=this._dataModel=J,this._hierarchical=n.forceHierarchicalSerialization?!0:I==a?J.isHierarchicalRendering():I};Cf("JSONSerializer",E,{ms_ac:["hierarchical"],serialize:function(s){return n.stringify(this.toJSON(),s)},toJSON:function(){var p=this,o=p.dm,k=o.getRoots(),s=p.json={v:n.getVersion(),p:{},a:{},d:[]},L=o.getSerializableAttrs();o.getInit()&&(s.init=o.getInit()),o.getName()&&(s.p.name=o.getName()),o.getBackground()&&(s.p.background=o.getBackground()),o.getLayers()&&(s.p.layers=o.getLayers()),o.getEnvmap()&&(s.p.envmap=o.getEnvmap()),s.p.autoAdjustIndex=o.isAutoAdjustIndex(),s.p.hierarchicalRendering=o.isHierarchicalRendering();for(var K in L){var X=o.a(K);X!==M&&p[Mg](K,X,s.a)}return os(s.a)&&delete s.a,p._hierarchical?k.each(p.serializeData,this):o.each(function(m){p.serializeData(m)}),o.fireSerializeEvent({type:"serialize",json:s}),o.getPostProcessingData()&&(s.p.postProcessingData=o.getPostProcessingData()),s},isSerializable:function(){return!0},getProperties:function(u){return u.getSerializableProperties()},getStyles:function(j){return j.getSerializableStyles()},getAttrs:function(L){return L.getSerializableAttrs()},serializeData:function(P){var x=this;if(x.isSerializable(P)&&!P._refGraph){var z,E,k,u,d=Nj(P.getClassName())||P.getClass(),i=new d,X={c:P.getClassName(),i:P.getId(),p:{},s:{},a:{}};x.json.d.push(X),z=x.getProperties(P);for(E in z)if(/^_/.test(E)){if(k=P[E],("_width"===E||"_height"===E)&&k===M){var J;((P.s("layout.h")||P.s("layout.v"))&&P.getHost()||P instanceof w.Node&&(J=P.getParent())&&J instanceof w.Block||P.s("fullscreen"))&&(k=P[E]="_width"===E?P.getWidth():P.getHeight())}k!==i[E]&&x[Mg](E.substr(1),k,X.p)}else u=mp(E),P[u]&&(k=P[u](),k!==i[u]()&&x[Mg](E,k,X.p));z=x.getStyles(P);for(E in z)k=P.s(E),k!==i.s(E)&&x[Mg](E,k,X.s);z=x.getAttrs(P);for(E in z)k=P.a(E),k!==i.a(E)&&x[Mg](E,k,X.a);os(X.p)&&delete X.p,os(X.s)&&delete X.s,os(X.a)&&delete X.a}x._hierarchical&&P.getChildren().each(x.serializeData,x)},serializeValue:function(g,d,u){Qp(d)?d={__a:d._as}:d instanceof ed&&(d={__i:d.getId()}),u[g]=d},deserialize:function($,W,o){var L=this;return mc($)&&/.json$/.test($)?(n.xhrLoad($,function(N){L.deserializeImpl(N,W,o)}),void 0):L.deserializeImpl($,W,o)},deserializeImpl:function(L,z,i){var b=this,K=b.dm;i=tq(i)?{setId:i}:bi(i)?{finishFunc:i}:i||{},L=b.json=mc(L)?n.parse(L):L,L.a&&L.a.onPreDeserialize&&!i.disableOnPreDeserialize&&L.a.onPreDeserialize(L,K,i.view),K.beginTransaction(),sn++,b._82I={};var m=new Yp,k=new Yp,E=0,G=L.d.length;if(i.justDatas||(bi(L.init)&&L.init(K),K.setInit(L.init)),!i.justDatas){for(var u in L.a)K.a(u,b[fc](L.a[u]));for(var X in L.p)K[Ip(X)](L.p[X])}for(;G>E;E++){var N=L.d[E],U=Nj(N.c),v=new U,c=N.i;i.setId&&c!=a&&(v._id=c),b._82I[c]=v,m.add(v),k.add(N)}for(E=0;G>E;E++)b.deserializeData(m.get(E),k.get(E));return m.each(function(T){z&&!T.getParent()&&T.setParent(z),K.add(T)}),K.fireSerializeEvent({type:"deserialize",json:L}),sn--,K.endTransaction(),L.a&&L.a.onPostDeserialize&&!i.disableOnPostDeserialize&&L.a.onPostDeserialize(L,K,i.view,m),i.finishFunc&&i.finishFunc(L,K,i.view,m),m},deserializeData:function(D,G){for(var y in G.p)D[Ip(y)](this[fc](G.p[y]));for(y in G.s)D.s(y,this[fc](G.s[y]));for(y in G.a)D.a(y,this[fc](G.a[y]))},deserializeValue:function(b){if($l(b)){var J=b.__i;if(J!=a)return this._82I[J];if(J=b.__a,uo(J))return new Yp(J)}return b}}),jn(Pc,{serialize:function(q,h){return new nb(this,h).serialize(q)},toJSON:function(C){return new nb(this,C).toJSON()},deserialize:function(s,h,L){return new nb(this).deserialize(s,h,L)}});var nj=w.OverlappingBox=function(C){this.gv=C,this.boxes={}};Cf("OverlappingBox",E,{clear:function(){var U,G,P=this.boxes;for(U in P)G=P[U],G.length=0},isOverlapping:function(N,f){var K,A,W=this,I=W.boxes,x=I[N];x?(K=x.rects,A=x.length):x=I[N]={rects:K=[],length:A=0};var m,d,f;for(m=0;A>m;m++)if(d=K[m],d.x<f.x+f.w&&d.x+d.w>f.x&&d.y<f.y+f.h&&d.h+d.y>f.y)return!0;
return K.length<=A?(K.push(f),x.length++):K[x.length++]=f,!1}}),jn(n,{fetch:function(Y,y){var P="GET",u=!1,V=null,G="";y&&(P=y.method||"GET",u=y.sync,G=y.url,V=y.data||null),Y.open(P,G,!u),y.responseType?Y.responseType=y.responseType:y.overrideMimeType&&Y.overrideMimeType&&Y.overrideMimeType(y.overrideMimeType),Y.send(V)},convertImageSrc:function(P,u){u&&"function"==typeof u||(u=function(){}),u(P)}});var Gm=w.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Cf("Request",E,{_responseType:null,_overrideMimeType:"text/plain",send:function(t){var K=this._xhr,I=this.onload,E=this.onerror;this.getResponseType()?t.responseType=this.getResponseType():this.getOverrideMimeType()&&(t.overrideMimeType=this.getOverrideMimeType()),K.onload=I,K.onerror=E,n.fetch(K,t)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(j){this._responseType=j},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(F){this._overrideMimeType=F},getResponseText:function(){var g=this._xhr;return g.response||g.responseText}}),br.GraphView=function(q){var F=this;F._24I={},F._34I=new Yp,F._25I={},F._56I={},F._view=Ll(1,F),F._canvas=Hd(F._view),F.dm(q?q:new Pc),this._coreInteractor=new df(this),F.setEditable(!1),F.setScrollBarVisible(n.graphViewScrollBarVisible)},Fg("GraphView",E,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[yf,vr,Hh,ai,"resettable","editInteractor",Tq,"zoomable","pannable","rectSelectable","autoScrollZone",Fm,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:n.graphViewZoomable,_resettable:n.graphViewResettable,_pannable:n.graphViewPannable,_rectSelectable:n.graphViewRectSelectable,_autoScrollZone:n.graphViewAutoScrollZone,_rectSelectBackground:n.graphViewRectSelectBackground,_rectSelectBorderColor:n.graphViewRectSelectBorderColor,_editPointSize:n.graphViewEditPointSize,_editPointBorderColor:n.graphViewEditPointBorderColor,_editPointBackground:n.graphViewEditPointBackground,_scrollBarColor:ne,_scrollBarSize:Xf,_autoHideScrollBar:yg,_autoMakeVisible:Wr,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(g){this._dataModel.setLayers(g)},setEditable:function(L){var d=this,P=d.__interactorMap__;if(!P){var K=br.XEditInteractor;P=d.__interactorMap__={scrollBar:new Zn(d),select:new ze(d),edit:K?new K(d):new tc(d),text:new Lk(d),move:new rc(d),"default":new ub(d),touch:new Xj(d,{editable:!1})}}L?(d._uieditable=!0,d.setInteractors([P.scrollBar,P.select,P.edit,P.text,P.move,P.default,P.touch])):(d._uieditable=!1,d.setInteractors([P.scrollBar,P.select,P.move,P.default,P.touch]))},getCanvas:function(){return this._canvas},_33I:function(o){var t=o.getUIClass();return t?new t(this,o):a},getDataUI:function(W){var d=this,I=d._25I[W._id];return I===M&&(I=d._33I(W),d._25I[W._id]=I),I},getNodeRect:function(V){return n.getNodeRect(this,V)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(d){var J=this.getDataUI(d);return J?(J._79o(),J._78o):null},getEdgeSourcePosition:function(N){var s=this,t=s.getDataUI(N),q=t.s,E=t._data._40I;return Qn(s,E,q("edge.source.position"),q("edge.source.offset.x"),q("edge.source.offset.y"),q("edge.source.anchor.x"),q("edge.source.anchor.y"))},getEdgeTargetPosition:function(C){var K=this,Q=K.getDataUI(C),p=Q.s,B=Q._data._41I;return Qn(K,B,p("edge.target.position"),p("edge.target.offset.x"),p("edge.target.offset.y"),p("edge.target.anchor.x"),p("edge.target.anchor.y"))},invalidateAll:function(E){var t=this;if(E){for(var e in t._25I){var b=t._25I[e];b&&b.dispose()}t._25I={},t._56I={},t._24I={},t._34I.clear(),t.redraw()}else t.dm().each(function(m){t.invalidateData(m)})},invalidateSelection:function(){var j=this;j.sm().each(function(K){j.invalidateData(K)})},invalidateData:function(S){var q=this;q._24I[S._id]=S,q._21Q(S),q.iv()},_21Q:function(w){var T=this,n=T._24I;if(wj(w)&&Nr[w.s(dg)]){var F=w.getSourceAgent();F&&F.getAgentEdges().each(function(z){n[z._id]=z}),F=w.getTargetAgent(),F&&F.getAgentEdges().each(function(o){n[o._id]=o}),T.iv()}},redraw:function(A){var X=this;X._32I||(A?X._34I.add(A):(X._32I=1,X._34I.clear()),X.iv())},each:function(m,V){var C,Y,Z,p=0,c=this.getLayers(),_=this._dataModel,t=_._datas._as,R=t.length;if(c){for(var v=c.length;v>p;p++)if(Z=c[p],$l(Z)&&(Z=Z.name),_.isHierarchicalRendering()){var Q=function(R){return R._layer===Z?V?m.call(V,R):m(R):void 0};if(this._dataModel.eachByHierarchical(Q)===!1)return}else for(var z=0;R>z;z++)if(C=t[z],C._layer===Z&&(Y=V?m.call(V,C):m(C),Y===!1))return}else if(_.isHierarchicalRendering())this._dataModel.eachByHierarchical(m,null,V);else for(;R>p;p++)if(C=t[p],Y=V?m.call(V,C):m(C),Y===!1)return},reverseEach:function(p,V){var z,F,h,q,u=this._dataModel,f=u._layers,C=u._datas._as,k=C.length;if(f){for(z=f.length-1;z>=0;z--)if(q=f[z],$l(q)&&(q=q.name),u.isHierarchicalRendering()){var A=function(z){return z._layer===q?V?p.call(V,z):p(z):void 0};if(u.reverseEachByHierarchical(A)===!1)return}else for(var l=k-1;l>=0;l--)if(F=C[l],F._layer===q&&(h=V?p.call(V,F):p(F),h===!1))return}else if(u.isHierarchicalRendering())u.reverseEachByHierarchical(p,null,V);else for(z=k-1;z>=0;z--)if(F=C[z],h=V?p.call(V,F):p(F),h===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var P=this,f=P._84I;if(!f){var o=this.dm().a("width"),j=this.dm().a("height");o>0&&j>0?P._84I={x:0,y:0,width:o,height:j}:(P.each(function(F){P.isVisible(F)&&(f=pc(f,P.getDataUIBounds(F)))}),P._84I=f?f:Ob)}return P._84I},getScrollRect:function(){return pc(this.getContentRect(),this._29I)},makeCenter:function(C,S,H){var J=this;if(!J.getWidth()||!J.getHeight())return H||nd(J.centerData,J,[C,S,!0],500),void 0;J.makeVisible(C),J.validate();var j=J.getDataUIBounds(C);if(j){var G=J.getWidth(),w=J.getHeight(),r=j.x+j.width/2,V=j.y+j.height/2,l=-r*J._zoom+G/2,f=-V*J._zoom+w/2;J.setTranslate(l,f,S)}},fitData:function(w,B,g,T,d){var m=this;if(!m.getWidth()||!m.getHeight())return d||nd(m.fitData,m,[w,B,g,T,!0],500),void 0;var P=function(){m.makeVisible(w),m.validate();var i=m.getDataUIBounds(w);i&&(i=Vl(i),di(i,g==a?20:g),m.fitRect(i,B,T))};B?n.callWhenLoaded(P):P()},fitContent:function(b,V,f,j){var A=this;if(!A.getWidth()||!A.getHeight())return j||nd(A.fitContent,A,[b,V,f,!0],500),void 0;var Y=function(){A.validate();var x=Vl(A.getContentRect());di(x,V==a?20:V),A.fitRect(x,b,f)};b?n.callWhenLoaded(Y):Y()},fitRect:function(w,t,N){var M=this,P=M.getWidth(),u=M.getHeight(),n=w.x+w.width/2,Z=w.y+w.height/2,b=p(P/w.width,u/w.height),T=M._zoom,Y=-n*T+P/2,v=-Z*T+u/2;0===b||isNaN(b)||(N&&(b=p(1,b)),t?(M._65I&&(delete M._65I.finishFunc,M._65I.stop(!0)),M._14o&&M._14o.stop(!0),M.setTranslate(Y,v,{finishFunc:function(){M.setZoom(b,t)}})):(M.setTranslate(Y,v),M.setZoom(b)))},toCanvas:function(K,y){y=y||this._zoom,this.validateImpl();var Y=this,c=Y.getContentRect();c.width||(c.width=10),c.height||(c.height=10);var d=Hd(),s=c.x*y,_=c.y*y,W=c.width*y,M=c.height*y;En(d,W,M,1);var g=rm(d);return K=K||this._dataModel.getBackground(),K&&Qf(g,0,0,W,M,K),Hc(g,-s,-_),g.scale(y,y),Y._42(g),g.restore(),d},toDataURL:function(l,r,O){return this.toCanvas(l,O).toDataURL(r||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(I,y){var H=this,Z=H.dm().getBackground();if(Z){var z=H.dm().a("width"),W=H.dm().a("height");z>0&&W>0&&Qf(I,0,0,z,W,Z)}var J=H.__htmlOrderList,U=[];if(H._93db(I,y),H.each(function(A){var Z=H.getDataUI(A);if(Z){var z=H._56I[A._id],K=Z._htmlView;if(z){var v=Z._79o();if(K=Z._htmlView,w.HtmlNode&&A instanceof w.HtmlNode)Z._42(I);else{var _=H.getViewRect(),k=K&&K.layoutHTML;!y||Xl(y,v)?(k&&(K.layoutHTML(),Z.__outerLayout&&delete Z.__outerLayout),Z._42(I)):Xl(_,v)||!k||Z.__outerLayout||(K.layoutHTML(),Z.__outerLayout=!0)}}K&&(U.push(K),K.getView&&(K=K.getView()),K.style.display=z?"block":ik)}}),J&&U.length>0){var f=!1;if(J.length!==U.length)f=!0;else for(var S=0;S<U.length;S++)if(U[S]!==J[S]){f=!0;break}f&&(U.forEach(function(I){H.appendHTML(I,!0)}),this.__htmlOrderList=U)}else this.__htmlOrderList=U;H._92db(I,y)},validateImpl:function(){this.tryUpdateRootData();var o,g,X,J,Y,L=this,M=L.tx(),V=L.ty(),f=L._zoom,e=L._canvas,N=this.getWidth(),i=this.getHeight(),U=L._29I,E={x:-M/f,y:-V/f,width:N/f,height:i/f},H={},c=L._34I,F=L._24I,k=L._32I,I=L._23I;L._24I={},(N!==e.clientWidth||i!==e.clientHeight)&&(En(e,N,i),k=1),k||Je(E,U)||(k=1),L._29I=E,L.each(function(c){g=c._id;var M=H[g]=L.isVisible(c);M!==L._56I[g]&&(F[g]=c,X=L.getDataUI(F[g]),X&&X._84o(M),L._84o(c,M))},L);for(g in F)X=L.getDataUI(F[g]),X&&(!k&&L._56I[g]&&(Y=X._79o(),Y&&c.add(Y)),X.invalidate()),L._83I=1;if(L._56I=H,!k)for(g in F)H[g]&&(X=L.getDataUI(F[g]),X&&(Y=X._79o(),Y&&c.add(Y)));if(k?J=E:(c.each(function(m){Xl(E,m)&&(J=pc(J,m))}),J&&(di(J,t(1,1/f)),J.x=R(J.x*f)/f,J.y=R(J.y*f)/f,J.width=b(J.width*f)/f,J.height=b(J.height*f)/f,J=Xm(E,J))),L._74O=J,J){o=rm(e);var j=J.x,Z=J.y,S=J.width,v=J.height;j=Math.floor((j*f+M)*ee),Z=Math.floor((Z*f+V)*ee),S=Math.ceil(S*f*ee)+1,v=Math.ceil(v*f*ee)+1,o.beginPath(),o.rect(j,Z,S,v),o.clip(),o.clearRect(j,Z,S,v),Dh(o,M,V,f),L._42(o,J),o.restore(),delete L._74O}if(c.clear(),delete L._32I,I&&N>0&&i>0){var X=L.getDataUI(I);if(X){var Y=X._79o(),T=L._29I,$=T.x,D=T.y,C=T.width,W=T.height,f=L._zoom;Y&&!Xl(Y,T)&&(Y.x+Y.width<$&&L.tx(-Y.x*f),Y.x>$+C&&L.tx(-(Y.x+Y.width-C)*f),Y.y+Y.height<D&&L.ty(-Y.y*f),Y.y>D+W&&L.ty(-(Y.y+Y.height-W)*f))}delete L._23I}L._83I&&(delete L._83I,delete L._84I),L._98O(),L.countFrame(),os(L._24I)||nd(L.iv,L)},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var B,H=this.getFullscreenDatas();for(var D in H)B=H[D],this.scaleRootData(B);this._rootDataUpdating=!1}},scaleRootData:function(C){var P=C.s("fullscreen");if("uniform"===P||"fill"===P){C.getRotation()&&C.setRotation(0);var G,N,K,t=C.s("fullscreen.gap")||0,z=this.getWidth()-2*t,g=this.getHeight()-2*t,E=C.getAnchor(),s=C.getScaledSize(),Y=s.width,I=s.height,O=C.s("fullscreen.lock");if(O)return"uniform"===P?z/g>Y/I?(G=g/I,Y=I*z/g):(G=z/Y,I=Y*g/z):"v"===O?(G=g/I,Y=z/G,C.getWidth()!==Y&&C.setWidth(Y)):(G=z/Y,I=g/G,C.getHeight()!==I&&C.setHeight(I)),this.setZoom(G),N=t-(C.getX()-E.x*Y)*G,K=t-(C.getY()-E.y*I)*G,N!==this.tx()&&this.tx(N),K!==this.ty()&&this.ty(K),void 0;N=this.tx(),K=this.ty(),G=this._zoom;var A={x:(-N+t)/G,y:(-K+t)/G,width:z/G,height:g/G};if("uniform"===P){var V=Y/I,m=Math.min(A.width,A.height*V),h=m/V;A.x+=.5*(A.width-m),A.y+=.5*(A.height-h),A.width=m,A.height=h}z=A.width/C.getScaleX(),g=A.height/C.getScaleY(),(C.getWidth()!=z||C.getHeight()!==g)&&C.setSize(z,g);var D=A.x+E.x*A.width,M=A.y+E.y*A.height,e=C.getPosition();(D!==e.x||M!==e.y)&&C.setPosition(D,M)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(m){var R=this;m!==R.isScrollBarVisible()&&(m?(eg(R._view,R._79O=lj()),eg(R._79O,R._27I=lj()),eg(R._79O,R._28I=lj())):(Bm(R._79O),delete R._79O,delete R._27I,delete R._28I),R.fp("scrollBarVisible",!m,m))},getDebugTip:function(){return""},showScrollBar:function(){var a=this;a._79O&&(a._85I||(_(function(){a._86I()},Zr),a.iv()),a._85I=new Date)},_86I:function(){var l=this;if(l._85I){var v=new Date,s=v.getTime();s-l._85I.getTime()>=Zr?(delete l._85I,l.iv()):_(function(){l._86I()},Zr)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var C=this,n=this._27I,b=this._28I;if(C._79O){if(C._autoHideScrollBar&&!C._85I)return n.style.visibility=de,b.style.visibility=de,void 0;var z=C.getScrollBarColor(),S=C._zoom,Z=C.getScrollBarSize(),K=C.getViewRect(),U=C.getScrollRect(),e=K.height*S,s=U.height*S,Q=K.width*S-Z-2,r=e*((K.y-U.y)*S/s),_=e*(e/s),m=n.style;s-.5>e?(Jf>_&&(r=r+_/2-Jf/2,0>r&&(r=0),r+Jf>e&&(r=e-Jf),_=Jf),Fl(n,Q,r,Z,_),m.visibility=Wm,m.background=z,m.borderRadius=Z/2+$h):m.visibility=de;var o=K.width*S,d=U.width*S,r=K.height*S-Z-2,Q=o*((K.x-U.x)*S/d),P=o*(o/d),m=b.style;d-.5>o?(Jf>P&&(Q=Q+P/2-Jf/2,0>Q&&(Q=0),Q+Jf>o&&(Q=o-Jf),P=Jf),Fl(b,Q,r,P,Z),m.visibility=Wm,m.background=z,m.borderRadius=Z/2+$h):m.visibility=de}},setDataModel:function(h){var g=this,W=g._dataModel,q=g._selectionModel;W!==h&&(W&&(W.ump(g.handleDataModelPropertyChange,g),W.umm(g.handleDataModelChange,g),W.umd(g.handleDataPropertyChange,g),W.removeIndexChangeListener(g._75O,g),W.removeHierarchyChangeListener(g.handleHierarchyChange,g),q||W.sm().ums(g.handleSelectionChange,g)),g._dataModel=h,h.mp(g.handleDataModelPropertyChange,g),h.mm(g.handleDataModelChange,g),h.md(g.handleDataPropertyChange,g),h.addIndexChangeListener(g._75O,g),h.addHierarchyChangeListener(g.handleHierarchyChange,g),q?q._21I(h):h.sm().ms(g.handleSelectionChange,g),g.invalidateAll(!0),g.fp(Yo,W,h),g.updateBackground())},getLayersInfo:function(){if(this._layersInfo===M){var k=this.getLayers();k?(this._layersInfo={},k.forEach(function(x){var s=$l(x)?x.name:x;this._layersInfo[s]=x},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(v,Q,R){var A,D,$=this,z=$.getDataUI(v),i=hr(z),g=mf(Q,function(U){return Sl(i,100*U)},100,.001),F=Sl(i,100*g);if(!R){var y=Vi(z),N=new Xd(F.x,F.y),W=49/($._zoom*$._zoom);for(A=0,D=y.length;D>A;A++)if(N.distanceToSquared(y[A])<W)return{index:A,point:y[A],distance:Math.sqrt((y[A].x-Q.x)*(y[A].x-Q.x)+(y[A].y-Q.y)*(y[A].y-Q.y))}}return{percent:g,point:F,distance:Math.sqrt((F.x-Q.x)*(F.x-Q.x)+(F.y-Q.y)*(F.y-Q.y))}},calculateAttachPoint:function(){var e=new Xd,X=new Xd,g=new Xd;return function(N,O){var k=this.getAttachPoints(N);if(!k||!k.length)return null;g.set(O.x,O.y);for(var S,U,u,c,t=1/0,w=0,n=k.length;n>w;w++)u=k[w],X.x=u.x,X.y=u.y,e.x=u.offsetX||0,e.y=u.offsetY||0,c=Qn(this,N,0,e.x,e.y,X.x,X.y),U=g.distanceToSquared(c),t>U&&(S=w,t=U);t=Math.sqrt(t);var A=this.getAttachStyle(N);if("close"===A){var B=N.s("attach.close.threshold")/this._zoom;if(t>B)return null}return{index:S,distance:t,info:k[S]}}}(),getAttachPoints:function(f){var v=f.s("attach.points");if(v)return v;var r=hh(f._image);return r?Io(r.attachPoints,f,this)||null:void 0},getAttachStyle:function(L){var M=L.s("attach.style");if(M)return M;var u=hh(L._image);return u?Io(u.attachStyle,L,this)||"close":void 0},updateLayers:function(){this._layersInfo=M,this.invalidateSelection(),this.redraw()},updateBackground:function(){var U=this.dm().a("width"),M=this.dm().a("height");this._canvas.style.background=U>0&&M>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(O){if("background"===O.property){var $=this._canvas.style.background,F=O.newValue||"";this.updateBackground(),this.fp("canvasBackground",$,F),this.redraw()}else"a:width"===O.property||"a:height"===O.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===O.property?this.updateLayers():"hierarchicalRendering"===O.property&&this.redraw()},handleDataPropertyChange:function(z){this.dm().isHierarchicalRendering()&&"parent"===z.property&&z.data.hasChildren()&&this.redraw(),this.invalidateData(z.data)},onPropertyChanged:function(M){var b=this,l=M.property;if(b.redraw(),"zoom"===l){var u=b.sm().getSelection();u.size()&&u.each(function(s){s.invalidate()})}$j[l]?b.showScrollBar():l===Tq&&b.onCurrentSubGraphChanged(M)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(O){var e=this,g=O.kind,p=O.data;if(e._83I=1,"add"===g)e.invalidateData(p),wj(p)&&p.getEdgeGroup()&&p.getEdgeGroup().eachSiblingEdge(e.invalidateData,e);else if(g===Rp){e._21Q(p);var B=p._id,J=e._25I[B];if(J){if(e._56I[B]){var _=J._79o();_&&e.redraw(_)}J.dispose(),delete e._25I[B],delete e._24I[B],delete e._56I[B]}p===e._currentSubGraph&&e.setCurrentSubGraph(a)}else g===Hg&&(e.invalidateAll(!0),e.setCurrentSubGraph(a))},_75O:function(Q){this.invalidateData(Q.data)},handleHierarchyChange:function(w){this.dm().isHierarchicalRendering()&&w.data.hasChildren()&&this.redraw(),this.invalidateData(w.data)},adjustIndex:function(S){var B=this;if(B.isVisible(S)){B.dm().beginTransaction();for(var F=S;F._parent&&B.isVisible(F._parent);)F=F._parent;F&&F!==S&&B._dataModel.adjustIndex(F),B._dataModel.adjustIndex(S),B.dm().endTransaction()}},getImage:function(d){return d.getImage?d.getImage():M},getSelectWidth:function(f){var q=hh(this.getImage(f));return q&&Io(q.disableSelectedBorder,f,this)?0:f.s("select.width")},getSelectColor:function(l){return l.s("select.color")},isSelectable:function(i,L){if(this.isSelected(i))return!0;if(!L&&i.getParent()instanceof Md&&this.isSelectable(i.getParent(),!0)&&i.getParent().isSyncSize())return!1;var A=this.getLayersInfo();if(A){var G=A[i._layer];if(G&&G.selectable===!1)return!1}return i.s("2d.selectable")&&this.sm().isSelectable(i)},isMovable:function(w){var o=this;if(wj(w)&&w.getStyle(dg)!==uf)return!1;var S=this.getLayersInfo();if(S){var g=S[w._layer];if(g&&g.movable===!1)return!1}return w.s("2d.movable")?o._movableFunc?o._movableFunc(w):!0:!1},isEditable:function(K){var D=this;if(w._uiSerializing)return D._uieditable;if(!D._editInteractor||!D.isSelected(K))return!1;if(ni(K)){var E=D.getDataUI(K);if(!E||E._88I)return!1}if(wj(K)&&K.getStyle(dg)!==uf)return!1;var q=this.getLayersInfo();if(q){var W=q[K._layer];if(W&&W.editable===!1)return!1}return K.s("2d.editable")?D._editableFunc?D._editableFunc(K):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(H){return wc(H)&&0!==H.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(H):!0},isRectEditable:function(G){return this._rectEditableFunc?this._rectEditableFunc(G):!0},isAnchorEditable:function(z){return this._anchorEditableFunc?this._anchorEditableFunc(z):!0},isRotationEditable:function(N){return N.setRotation&&N.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(N):!0:!1},getRotationPoint:function(i){var S=i.getAnchor(),b=i.getScale(),G=this._zoom,t=cd(i.getRotation(),0,-i.getHeight()*b.y*S.y-(b.y<0?-1:1)*(jl?32:16)/G),e=i.p();return t.x+=e.x,t.y+=e.y,t},getLogicalPoint:function(S){var F=this;return Ao(S,F._canvas,F.tx(),F.ty(),F._zoom,F._zoom)},getScreenPoint:function(L,U){var u,A=this;return"object"==typeof L?L.x!==M?(u=L.x,U=L.y):(u=L[0],U=L[1]):u=L,dc(u,U,A._canvas,A.tx(),A.ty(),A._zoom,A._zoom)},getSelectedDataAt:function(c){var A=this;return this.getDataAt(c,function(R){return A.isSelected(R)})},getDataInfoAt:function(T,H,w){var E,d=this.lp(T),B=this.getDataAt(d,H,w);if(B){var b=this.getDataUI(B);E={data:B,ui:b,point:d};var t=b._38o;if(t){var V=t.icons;for(var f in V){var G=V[f],z=t.rects[f];if(z)for(var c=Io(G.names,B,this),R=c?c.length:0,o=z.rotation,u=R-1;u>=0;u--){var C=c[u],_=z[u];if(Aj(_,d,o))return E.part="icons",E.name=f,E.icon=C,E.rect=_,E.index=u,E.rotation=o,E}}}if(this.isNoteVisible(B)){if(b.note2Info&&Aj(b.note2Info.clickRect,d,a,b.note2Info.scale))return E.part="note2",E;if(b.noteInfo&&Aj(b.noteInfo.clickRect,d,a,b.noteInfo.scale))return E.part="note",E}if(this.isLabelVisible(B)){if(b.label2Info&&Aj(b.label2Info.rect,d,b.label2Info.rotation,b.label2Info.scale))return E.part="label2",E;if(b.labelInfo&&Aj(b.labelInfo.rect,d,b.labelInfo.rotation,b.labelInfo.scale))return E.part="label",E}if(B.isInRect&&B.isInRect(d))return E.part="body",E}return E},getDataAt:function(F,B,I){F.target&&(F=this.lp(F));var z,W=this._zoom;return this.reverseEach(function(h){return(B?B(h):this.isSelectable(h))&&this.rectIntersects(h,bm(F.x,F.y,I,W))?(z=h,!1):void 0},this),z},getIconInfoAt:function(B,X){var I=this;if(B.target&&(B=I.lp(B)),X||(X=I.getDataAt(B)),X){var v=I.getDataUI(X);if(v&&v._38o){var s,N=v._38o,V=new Yp;for(s in N.icons)V.add(s);for(var _=V.size()-1;_>=0;_--){s=V.get(_);for(var D=N.rects[s],W=D.rotation,r=D.length-1;r>=0;r--){var k=D[r],u=k.width,m=k.height,S={x:B.x-k.x-u/2,y:B.y-k.y-m/2};W!=a&&(S=cd(-W,S.x,S.y));var k={x:-u/2,y:-m/2,width:u,height:m};if(Aj(k,S))return{key:s,index:r,name:N.icons[s].names[r],rect:D[r],point:B,rotation:W,relativeRect:k,relativePoint:S,data:X}}}}}return a},getDatasInRect:function(I,T,v){v===M&&(v=1);var R=this,B=new Yp;return R.reverseEach(function(t){v&&!R.isSelectable(t)||(T?R.rectIntersects(t,I):R.rectContains(t,I))&&B.add(t)}),B},moveSelection:function(U,a){var P=this;P.dm().beginTransaction(),Rc(P.sm().toSelection(P.isMovable,P),U,a),P.dm().endTransaction()},moveDatas:function(p,c,L){var q=this;q.dm().beginTransaction(),p instanceof Yp||(p=new Yp(p)),Rc(p,c,L),q.dm().endTransaction()},getDataUIBounds:function(c){var J=this.getDataUI(c);return J?J._79o():a},drawData:function(v,V,Y){var a=this.getDataUI(V);if(a){var W=a._79o();(!Y||Xl(Y,W))&&(a._42(v),V instanceof w.Block&&V.eachChild(function(M){this.drawData(v,M,Y)},this))}},getBoundsForGroup:function(O){return O.s(zo)?this.getDataUIBounds(O):a},isPixelPerfect:function(k){return k.s("pixelPerfect")},rectIntersects:function(T,X){this.validate();var $=a;if(this._56I[T._id]){var O=this._25I[T._id];if(O){var Q=O._79o();if(Hf(X,Q))$=!0;else if((X=Xm(X,Q))&&(O.rectIntersects&&($=O.rectIntersects(X)),$==a)){if(!this.isPixelPerfect(T))return!0;var o=X.x,D=X.y,x=X.width,z=X.height,V=this._zoom,t=n.hitMaxArea,B=x*z*V*V;if(B>t){var k=Math.sqrt(t/B);V*=k}x*=V,z*=V,2>x&&(x=2),2>z&&(z=2),o*=V,D*=V;var Z=sm(x,z);Hc(Z,-o,-D),Z.scale(V,V),this._drawForChecking=!0,this.drawData(Z,T,X),this._drawForChecking=!1;try{for(var i=0,j=Z.getImageData(0,0,x,z).data;i<j.length;i+=4)if(0!==j[i+3]){$=!0;break}Z.restore()}catch(M){wo=a,$=!1}}}}return $?!0:!1},rectContains:function(i,W){if(this._56I[i._id]){var Y=this._25I[i._id];if(Y)return Hf(W,Y._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(D){if(!n.isInput(D.target)){var x=this,w=x._focusData,j=w&&x._25I[w._id],h=0,s=x._dataModel._datas;if(!(w&&w._enabled&&w._editable&&j&&j.onKeyDown&&j.onKeyDown(D)===!0))if(9===D.keyCode&&(w&&(h=s.indexOf(w),Gq(D)?-1===--h&&(h=0):++h===s.size()&&(h=0)),x._focusData=w=s.get(h),x.sm().setSelection(w)),qi(D)?x.selectAll():Lh(D)&&x.isResettable()&&x.reset(),x.sm().isEmpty()){if(x._editing)return;var J=x.tx(),R=x.ty(),y=!1,V=Gq()?100:10;Wn(D)&&(J-=V,y=!0),zb(D)&&(R-=V,y=!0),Vd(D)&&(J+=V,y=!0),Ym(D)&&(R+=V,y=!0),y&&x.setTranslate(J,R)}else{xg(D)&&x.handleDelete(D);var p=Gq()?10:1;Wn(D)&&(x.moveSelection(-p,0),x.fi({kind:"moveLeft"})),zb(D)&&(x.moveSelection(0,-p),x.fi({kind:"moveUp"})),Vd(D)&&(x.moveSelection(p,0),x.fi({kind:"moveRight"})),Ym(D)&&(x.moveSelection(0,p),x.fi({kind:"moveDown"}))}}},handleScroll:function(y,g){if(gh(y),this.isZoomable()){if(!this.getEditInteractor()){var b=this.getDataAt(y);if(b){var U=hh(this.getImage(b));if(U&&Io(U.scrollable,b,this))return}}var x=this.lp(y);g>0?this.scrollZoomIn(x):0>g&&this.scrollZoomOut(x)}},handlePinch:function(V,j,q){this.isZoomable()&&(this._68I||(j>q?this.pinchZoomIn(V):this.pinchZoomOut(V)))},checkDoubleClickOnNote:function(o,Z){var C=this,B=C.lp(o),X=C.getDataUI(Z),Q=X.note2Info;return Q&&Z.s("note2.toggleable")&&Aj(Q.clickRect,B)?(Z.s(Ve,!Z.s(Ve)),C.fi({kind:"toggleNote2",event:o,data:Z}),!0):(Q=X.noteInfo,Q&&Z.s("note.toggleable")&&Aj(Q.clickRect,B)?(Z.s(Ag,!Z.s(Ag)),C.fi({kind:"toggleNote",event:o,data:Z}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(O,M){var j=this,d=j.getAutoScrollZone(),K=d/j.getZoom(),L=d/4,l=j._29I,V=j.lp(O),Z={x:j.tx(),y:j.ty()};return V&&d>0&&l&&(V.x-l.x<K?j.translate(L,0):l.x+l.width-V.x<K&&j.translate(-L,0),V.y-l.y<K?j.translate(0,L):l.y+l.height-V.y<K&&j.translate(0,-L)),Z.x=j.tx()-Z.x,Z.y=j.ty()-Z.y,M&&(M.x+=Z.x,M.y+=Z.y),Z},getMoveMode:function(K,N){var z=N.s("2d.move.mode");return z?z:jj["88"]?"x":jj["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(V,_,h){var N=this;return"currentSubGraph"===_?{__i:V.getId()}:h.serializeProperty(V,_,N)},deserializeProperty:function(g,v,w){var I=this;if("currentSubGraph"===v){var r=I.dm(),G=r.__idMap;return G[g.__i]}return w.deserializeProperty(g,v,I)},setDefaultCursor:function(f,L){this._defaultCursor=f,L!==!1&&this.setCursor(f)},setCursor:function(G){"default"===G&&(G=this._defaultCursor||G);var $=this.getView().style;$.cursor=G,$.cursor="-webkit-"+G,$.cursor="-moz-"+G},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(P){return P===a||n.getConnectAction(null,P)?(this._currentActionType=P,this.redraw(),!0):!1},getEditStyle:function(J){var F=this.getEditInteractor();return F?F.getStyle(J):M},setEditStyle:function(A,X,r){var U=this.getEditInteractor();return U?(U.setStyle(A,X,r),!0):!1},isConnectActionVisible:function(r){var Z=n.getConnectAction(this);if(!Z)return!1;var L=Z.visible;return bi(L)&&(L=L(this,r)),L},isInteractive:function(b){var j=hh(this.getImage(b));return j&&Io(j.interactive,b,this)?!0:b.s("interactive")},appendHTML:function(s,a){var g=this.getView();if(!(a||s&&s.parentNode!==g))return!1;var J=s.getView&&s.getView();if(!a&&J&&J.parentNode===g)return!1;(s.getView||s.isSelfViewEvent)&&(s=s.getView());var X=this.getEditInteractor();return X&&X._canvas?g.insertBefore(s,X._canvas):this.isScrollBarVisible()?g.insertBefore(s,this.getView().lastChild):eg(g,s),!0},_layoutHTMLImpl:function(x,L,B){if(arguments.length>1){var W,o=this,Y=o._zoom;if(L.getView&&(W=L,L=L.getView()),L.style.position="absolute",B){var h=x.getRect();Fl(W||L,o.tx()+h.x*Y,o.ty()+h.y*Y,h.width*Y,h.height*Y)}else{var G=new Jm,h=x.getAnchorRect(),m=x.getPosition(),A=x.getScale(),$=L.style;Fl(W||L,h),G.appendTranslate(o.tx(),o.ty()),G.appendScale(Y,Y),G.append(new Jm(x.getRotation(),m.x,m.y,A.x,A.y)),bj($,"transform","matrix("+G.a.toFixed(5)+", "+G.b.toFixed(5)+", "+G.c.toFixed(5)+",\n    "+G.d.toFixed(5)+", "+G.tx.toFixed(5)+", "+G.ty.toFixed(5)+")"),bj($,"transformOrigin",(-h.x).toFixed(5)+"px "+(-h.y).toFixed(5)+"px"),L._matrixAppend=G.invert().translate(-h.x,-h.y)}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(z){return z instanceof Ai?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(e){var d="state",c=e.s(d);if(c)return c;var R=hh(e._image);return R?Io(R[d],e,this)||null:void 0}}),E.defineProperties(br.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(j){this._layoutHTML=j}}});var md=function(z,O){var $=this;$.gv=z,$.s=function(i){return O.getStyle(i)},$._data=O,$._87I=new Yp};Qr(md,E,{_6I:a,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var t=this,g=t.gv.isSelected(t._data);return!g||t.isShadowed()?0:t.gv.getSelectWidth(t._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(P){var r=this._data,j=this.gv.getBodyColor(r);return j?j:P?r.getStyle(P):a},_2Q:function(I){return this.s(I)},_1Q:function(r,Z,G,l){var W=this.s,V=W("2d.gray"),u=W(Z+".dash.color");if(V&&(u=n.toGrayColor(u)),r.strokeStyle=u,r.lineWidth=G,r.stroke(),W(Z+".dash.3d")){var L=W(Z+".dash.3d.color");kq(r,u,V?n.toGrayColor(L):L,G,this.gv._zoom,W(Z+".dash.3d.accuracy"))}Oo(r,l)},invalidate:function(){this._6I=a},_79o:function(){var S=this;if(!S._6I){var H=S._data,v=S.gv;S.labelInfo=S.label2Info=S.noteInfo=S.note2Info=S._38o=a,S._87I.clear(),S.interactiveInfo=v.isInteractive(H)?{}:a,S._3O(),S._55O=v.isEditable(H)?{_42O:v.isRectEditable(H),_43O:v.isPointEditable(H),_56O:v.isRotationEditable(H)}:a,S._6I=S._81o()}return S._6I},_3O:function(){},getPosition:function(){return Ob},_68o:function(y,k){y&&this._87I.add(Pd(y,k))},_81o:function(){var d=this,M=d.s;d._24O(Hj,"getLabel"),d._24O(Kf,"getLabel2"),d._26O(Jd,"getNote"),d._26O(Re,"getNote2"),d._15O(),d._55O&&d._48O();var e;if(d._87I.each(function(l){e=pc(e,l)}),e&&d.isShadowed()){var b=Vl(e);b.x+=M("shadow.offset.x"),b.y+=M("shadow.offset.y"),di(b,M("shadow.blur")),e=pc(e,b)}return d._87I.clear(),e},_42:function(L){var K=this,Z=K._data,r=K.gv,C=K.s,h=C("opacity"),M=this.isShadowed();if(M){var n=L.shadowOffsetX,y=L.shadowOffsetY,R=L.shadowBlur,e=L.shadowColor,E=r.getZoom();L.shadowOffsetX=C("shadow.offset.x")*E,L.shadowOffsetY=C("shadow.offset.y")*E,L.shadowBlur=C("shadow.blur")*E,L.shadowColor=K.getSelectColor()}if(h!=a){var W=L.globalAlpha;L.globalAlpha=h}K._80o(L),r.isLabelVisible(Z)&&((!r._drawForChecking||C("label.selectable"))&&se(L,K.labelInfo),(!r._drawForChecking||C("label2.selectable"))&&se(L,K.label2Info)),r.isNoteVisible(Z)&&(rd(L,K.noteInfo),rd(L,K.note2Info)),K._99O(L),h!=a&&(L.globalAlpha=W),M&&(L.shadowOffsetX=n,L.shadowOffsetY=y,L.shadowBlur=R,L.shadowColor=e)},_80o:function(){},_47O:function(){},_24O:function(U,O){var d=this,m=d._data,S=d.gv,Q=d.s,N=S[O](m);if(N!=a){var H=Q(U+".scale"),j=Q(U+".max"),G=Q(U+".position"),v=d[U+"Info"]={label:N,scale:H,color:S[O+"Color"](m),font:Q(U+".font"),opacity:Q(U+".opacity"),align:Q(U+".align"),rotation:d.getRotation(Q(U+".rotation"),!1,G),background:S[O+"Background"](m)},C=en(v,N);j>0&&j<C.width&&(v.labelWidth=C.width,C.width=j),1!==H&&(C.width*=H,C.height*=H);var z=d.getPosition(G,Q(U+".offset.x"),Q(U+".offset.y"),C,Q(U+".position.fixed"));if(C.x=z.x-C.width/2,C.y=z.y-C.height/2,d._68o(v.rect=C,v.rotation),1!==H){var Y=C.width/H,n=C.height/H;v.rect={x:z.x-Y/2,y:z.y-n/2,width:Y,height:n}}}},_26O:function(d,k){var w=this,z=w.gv,P=w._data,A=w.s,B=z[k](P);if(B!=a){var T,t,M=A(d+".scale"),N=w[d+"Info"]={note:B,scale:M,data:P,view:z,expanded:A(d+".expanded"),font:A(d+".font"),color:A(d+".color"),opacity:A(d+".opacity"),align:A(d+".align"),icon:A(d+".icon"),backgroundImage:A(d+".backgroundImage"),borderWidth:A(d+".border.width"),borderColor:A(d+".border.color"),background:z[k+"Background"](P)},h=w.getPosition(A(d+".position"),A(d+".offset.x"),A(d+".offset.y")),O=h.x,i=h.y;if(N.expanded){var S,C=A(d+".max"),m=A(d+".backgroundImage");m?(m=hh(m),S={width:Uh(m,P),height:zq(m,P)}):S=en(N,B),S.width+=6,S.height+=2,C>0&&C<S.width&&(N.labelWidth=S.width,S.width=C),T=S.width,t=S.height+8,N.clickRect={x:O-T*M/2,y:i-t*M,width:T*M,height:t*M*S.height/t}}else{var l=A(d+".icon");l?(l=hh(l),T=Uh(l,P),t=zq(l,P)):(T=12,t=18),N.clickRect={x:O-T*M/2,y:i-t*M,width:T*M,height:t*M}}N.rect={x:O-T/2,y:i-t*M/2-t/2,width:T,height:t};var c=b(N.borderWidth/2)*M;w._68o({x:O-T*M/2-c,y:i-t*M-c,width:T*M+2*c,height:t*M+2*c})}},_48O:function(){},_99O:function(z){var v=this,E=v._38o;if(E){var m=v.gv,x=v._data,C=E.icons,b=v.interactiveInfo;b&&(b._38o={});for(var w in C){var L=C[w],B=E.rects[w];if(B){b&&(b._38o[w]=[]);var M=Io(L.opacity,x,m),o=Io(L.names,x,m),T=o?o.length:0,t=B.rotation;if(M!=a){var Y=z.globalAlpha;z.globalAlpha*=M}for(var H=0;T>H;H++){var l=o[H],R=hh(l),P=B[H];if(t){var u=P.x+P.width/2,n=P.y+P.height/2;z.save(),Hc(z,u,n),As(z,t),Hc(z,-u,-n)}b&&b._38o[w].push(z.interactiveInfo={compInfos:[],matrix:t?new Jm(t,u,n).appendTranslate(-u,-n):new Jm}),Me(z,R,Io(L.stretch,x,m),P.x,P.y,P.width,P.height,v._data,v.gv),z.interactiveInfo=a,t&&z.restore()}M!=a&&(z.globalAlpha=Y)}}}}});var Wl=function(g,D){Bh(Wl,this,[g,D])};Qr(Wl,md,{_checkEmptyRect:!0,_40O:function(F,I){var U=this,v=U.s,S=F.rect;
(F.borderColor=U.gv.getBorderColor(U._data))&&(F.borderType=v("border.type"),F.borderWidth=v("border.width"),F.borderPadding=v("border.padding"),I=t(I,F.borderPadding+F.borderWidth/2));var D=U._data.getScale(),s=t(1,t(y(D.x),y(D.y)));if(F.selectWidth=U.getSelectWidth()){var f=U.gv._zoom;F.selectType=v("select.type"),F._97o=U.getSelectColor(),F.selectPadding=v("select.padding"),I=t(I,(F.selectPadding+F.selectWidth/2/f)/s)}I>0&&(I*=s,S=Vl(S),di(S,I)),U._68o(S)},_39O:function(c,q){var x,Y=this,s=q.rect;if(q.borderWidth>0&&(x=q.borderPadding,c.strokeStyle=q.borderColor,c.lineWidth=q.borderWidth,im(c,q.borderType,{x:s.x-x,y:s.y-x,width:s.width+2*x,height:s.height+2*x}),c.stroke()),q.selectWidth>0){var U=Y.gv._zoom;if(x=q.selectPadding,c.strokeStyle=q._97o,c.lineWidth=q.selectWidth/U,q.rotation!=a){c.save(),c.translate(q.position.x,q.position.y),c.rotate(q.rotation);var v=Y._data,w=v.getWidth(),o=v.getHeight(),p=q.scale,i=q.anchor;s={x:p.x*-w*i.x,y:p.y*-o*i.y,width:p.x*w,height:p.y*o}}im(c,q.selectType,{x:s.x-x,y:s.y-x,width:s.width+2*x,height:s.height+2*x}),q.rotation!=a&&c.restore(),c.stroke()}},dispose:function(){var m=this,D=m._htmlView;Wl.superClass._3O.call(m),D&&(D.onHTMLRemoved&&D.onHTMLRemoved(),Bm(D))},_3O:function(){var $=this,R=$.s,w=$._data,I=$.gv,c=w.getStyle(Of),S=$.getBodyColor(),J=$._83o=c?{shape:c,_53o:$.getBodyColor("shape.background"),_27Q:hh(R("shape.repeat.image"),S),shapeGradientPack:R("shape.gradient.pack"),_54o:R("shape.border.width"),_55o:R("shape.border.color"),_56o:R("shape.border.3d"),_57o:R("shape.border.3d.color"),_58o:R("shape.border.3d.accuracy"),shapeGradient:R("shape.gradient"),_59o:R("shape.gradient.color"),_60o:R("shape.border.pattern"),_61o:R("shape.border.cap"),_62o:R("shape.border.join"),shapeForeground:R("shape.foreground"),bodyColor:S,gray:R("2d.gray")}:{img:hh(I.getImage(w),S),bodyColor:S,gray:R("2d.gray"),stretch:R("image.stretch")};if(d&&!V);else{var n,Z=J.img;Z&&Z.renderHTML?($._htmlInfo&&$._htmlInfo.img!==Z&&($._htmlInfo=a),$._htmlInfo||($._htmlInfo={img:Z,cache:{}}),n=Z.renderHTML(w,I,$._htmlInfo.cache)):$._htmlInfo=a,$._htmlView&&$._htmlView!==n&&($._htmlView.onHTMLRemoved&&$._htmlView.onHTMLRemoved(),Bm($._htmlView.getView?$._htmlView.getView():$._htmlView)),($._htmlView=n)&&I.appendHTML(n)&&(n.onHTMLAddedSync&&n.onHTMLAddedSync(),n.onHTMLAdded&&nd(n.onHTMLAdded)),J.rect=w.getRect(),J.position=w.p(),J.scale=w.getScale(),J.anchor=w.getAnchor(),J.rotation=w.getRotation(),c===vn&&(J._63o=R("shape.depth"));var C=0;if(c)C=lo(a,J._54o/2,J._62o),$.s("shape.dash")&&(C=t(C,($.s("shape.dash.width")||J._54o)/2));else if(Z&&Z.boundExtend)if(C=Io(Z.boundExtend,w,I),Z.boundExtendAbsolute){var k=w.getScale();C/=I._zoom*t(1,t(y(k.x),y(k.y)))}else if(!Io(Z.fitSize,w,I)){var Y=Io(Z.width,w,I),L=Io(Z.height,w,I);C*=t(w.getWidth()/Y,w.getHeight()/L)}$._40O(J,C);var p=R("clip.percentage");if(1>p&&(0>p&&(p=0),J.clipRect=_k(w.getAnchorRect(),R("clip.direction"),p)),c){var f=R("shape.fill.clip.percentage");1>f&&(0>f&&(f=0),J.shapeClipRect=_k(w.getAnchorRect(),R("shape.fill.clip.direction"),f));var G=R("shape.foreground.clip.percentage");1>G&&(0>G&&(G=0),J.shapeForegroundClipRect=_k(w.getAnchorRect(),R("shape.foreground.clip.direction"),G))}}},getPosition:function(K,J,j,x){var p=xp(K,this._83o.rect,x);return p.x+=J,p.y+=j,p},_80o:function(d){var j=this,c=j.s,k=j.gv,w=j._data,J=j._83o,Q=J.rect,f=J.position,v=J.rotation,$=J.anchor,l=J.scale,Z=J.shape,X=J.clipRect;if(!j._checkEmptyRect||Q.width>0&&Q.height>0){var y=w.getSize();if(y.x=-y.width*$.x,y.y=-y.height*$.y,d.save(),Hc(d,f.x,f.y),As(d,v),cn(d,l.x,l.y),X&&(d.beginPath(),d.rect(X.x,X.y,X.width,X.height),d.clip()),k._drawForChecking&&J.img&&Io(J.img.pixelPerfect,w,k)===!1)Qf(d,y.x,y.y,y.width,y.height,"#888888");else if(j.freeDraw)j.freeDraw(d,y,J);else if(Z){var K,C,g,Y,H=J._60o,s=Qq(d,H),W=J._27Q,F=J._54o,A=J.shapeGradientPack,B=J.gray,e=d.lineJoin,x=d.lineCap,G=function(T){return B?n.toGrayColor(T):T};"roundRect"===Z?K=c("shape.corner.radius"):"polygon"===Z?K=c("shape.polygon.side"):"arc"===Z&&(K=c("shape.arc.from"),C=c("shape.arc.to"),g=c("shape.arc.close"),Y=c("shape.arc.oval")),d.lineJoin=J._62o,d.lineCap=J._61o;var h=G(J._53o);if(h||W||A){var R=J.shapeClipRect;R&&(d.save(),d.beginPath(),d.rect(R.x,R.y,R.width,R.height),d.clip()),im(d,Z,y,K,C,g,Y),A?em(d,A):W?Gr(d,W,G(J.bodyColor),null,w,k):wf(d,h,J.shapeGradient,G(J._59o),y),d.fill(),R&&d.restore(),A&&d.restore(),d!==s&&im(s,Z,y,K,C,g,Y)}else im(s,Z,y,K,C,g,Y);var o=J.shapeForeground;if(o){d.save();var U=J.shapeForegroundClipRect;U&&(d.beginPath(),d.rect(U.x,U.y,U.width,U.height),d.clip()),im(d,Z,y,K,C,g,Y),wf(d,o,c("shape.foreground.gradient"),G(c("shape.foreground.gradient.color")),y),d.fill(),d.restore()}if(F>0){var S=c("shape.border.width.absolute");S&&(d.save(),d.setTransform(1,0,0,1,0,0)),d.lineWidth=F;var I=G(J._55o);d.strokeStyle=I,d.stroke(),S&&d.restore(),J._56o&&kq(d,I,G(J._57o),F,k._zoom,J._58o)}if(Oo(d,H),c("shape.dash")){var O=c("shape.dash.width")||F;if(O>0){H=c("shape.dash.pattern");var s=Qq(d,H,j._2Q("shape.dash.offset"));s!==d&&im(s,Z,y,K,C,g,Y),j._1Q(d,"shape",O,H)}}hm(d,h,J._63o,y),d.lineJoin=e,d.lineCap=x}else{var m=j.interactiveInfo;m&&(d.interactiveInfo=m.bodyInfo={compInfos:[],matrix:new Jm(v,f.x,f.y,l.x,l.y)}),J.gray&&(d.compGray=!0);var D=J.img;D&&D.cacheRule!=a&&(D=am(d,D,J.stretch,y.width,y.height,w,k,J.bodyColor)),Me(d,D,J.stretch,y.x,y.y,y.width,y.height,w,k,J.bodyColor),d.compGray=!1,d.interactiveInfo=a}d.restore()}j._39O(d,J)},_48O:function(){},_47O:function(){}});var Pn=function(C,Y){Bh(Pn,this,[C,Y])},Ff=function($,i,v,u){var Y=sh($,i);return v=u?p(v,Y):gm(v,Y),Y?v/=Y:v=0,{x:$.x+(i.x-$.x)*v,y:$.y+(i.y-$.y)*v}};Qr(Pn,md,{_3O:function(){var R,m=this,q=m._data,T=m.gv,v=m.s,S=v(dg),U=q.isLooped(),h=v("edge.width"),Q=v("edge.center"),s=v("edge.offset"),f=T.getBorderColor(q),G=f?v("border.width"):0,E=m.getSelectWidth(),D=q._40I,r=q._41I,k=m._78o=D&&r?{looped:U,type:S,width:h,center:Q,color:m.getBodyColor("edge.color"),borderColor:f,borderWidth:G,_97o:E?m.getSelectColor():a,selectWidth:E,pattern:v("edge.pattern"),cap:v("edge.cap"),join:v("edge.join"),is3d:v("edge.3d"),_67o:v("edge.3d.color"),_66o:v("edge.3d.accuracy"),gray:v("2d.gray")}:a;if(k){var C=n.getEdgeType(S);if(C){var c=C(q,om(m,T,q,U,S),T,m._19Q);c.points&&c.points.size()>1?(k.edgeTypeInfo=c,R=rh(k.edgeTypeInfo.points)):c[ej]&&c.rect&&(k.edgeTypeInfo=c,R=c.rect)}else{var g=v("edge.source.anchor.x"),w=v("edge.source.anchor.y"),B=v("edge.target.anchor.x"),V=v("edge.target.anchor.y"),X=wn(T,q,"source"),L=wn(T,q,"target");if(S===uf){var Z=k.points=v(tk)||Wi,$=Z.size();k.segments=v("edge.segments");var Y=g!==M||w!==M||wj(D),O=B!==M||V!==M||wj(r);if(!Q)if(s)Y||(X=Ff(X,$?Z.get(0):L,s,$)),O||(L=Ff(L,$?Z.get($-1):X,s,$));else{var P;Y||(P=gl(X,$?Z.get(0):L,rn(T,D)),P&&(X={x:P[0],y:P[1]})),O||(P=gl($?Z.get($-1):X,L,rn(T,r)),P&&(L={x:P[0],y:P[1]}))}R=pc(rh(k.points),rh(X,L))}else{var A=om(m,T,q,U,S);if(m._19Q||(A=-A),U)X=Vl(X),X.x=T.getNodeRect(D).x,k.radius=A,R={x:X.x-A,y:X.y-A,width:2*A,height:2*A};else{var F=sh(X,L),H=gm(s,F),o={x:H,y:A},i={x:F-H,y:A},I=x(L.y-X.y,L.x-X.x),K=k.mat=new Lp(I);if(k.orienAngle=I,k.angle=L.x<X.x?I+W:I,k.rect={x:o.x,y:o.y,width:i.x-o.x,height:0},k.origin=X,o=K.tf(o),o.x+=X.x,o.y+=X.y,i=K.tf(i),i.x+=X.x,i.y+=X.y,Q){var l={x:F,y:0};l=K.tf(l),l.x+=X.x,l.y+=X.y,R=rh([X,o,i,l]),k.c1=X,k.c2=l}else R=rh(o,i);X=o,L=i}}k.sourcePoint=X,k.targetPoint=L,q._lastSourcePoint=X,q._lastTargetPoint=L}var z=0;v("edge.dash")&&(z=v("edge.dash.width")||h);var d="square"===k.cap?.71:.5;lo(R,t(z*d,h*d+G+E),k.join),m._68o(R)}},getRotation:function(d,q,i){d=d||0;var O=this._78o;if(O){var g,Y=O.angle,w=O.points,f=O.edgeTypeInfo;if(Y!=a)return q?O.orienAngle+d:Y+d;if(f&&f[ej])return f.getRotation?f.getRotation(this,d,q,i):0;if(f&&f.points){var K=f.points;return g=K.size(),me[i]?g&&0===g%2?pj(K.get(g/2-1),K.get(g/2),q,d):d:vs[i]?pj(K.get(0),K.get(1),q,d):pj(K.get(g-2),K.get(g-1),q,d)}if(w)return g=w.size(),me[i]?g&&0===g%2?pj(w.get(g/2-1),w.get(g/2),q,d):d:vs[i]?pj(O.sourcePoint,g?w.get(0):O.targetPoint,q,d):pj(g?w.get(g-1):O.sourcePoint,O.targetPoint,q,d)}return d},getPosition:function(Z,$,L,D,O){var v=this._78o;if(v){var p,U=v.type,R=v.points,x=v.edgeTypeInfo,g=v.sourcePoint,X=v.targetPoint;if(!U)return v.looped?{x:g.x-v.radius+$,y:g.y+L}:(O&&g&&X&&(g.x>X.x||g.x===X.x&&g.y>X.y)&&(Z=Gk[Z],L=-L),p=xp(Z,v.rect,D),p.x+=$,p.y+=L,p=v.mat.tf(p),p.x+=v.origin.x,p.y+=v.origin.y,p);if(x&&x[ej])return x.getPosition?x.getPosition(this,Z,$,L,D,O):{x:(g.x+X.x)/2,y:(g.y+X.y)/2};if(R){var p,z=R.size();if(me[Z]){if(z){var b=z%2;if(0===b)return Zo(R.get(z/2-1),R.get(z/2),Z,$,L,D,O);p=R.get((z-b)/2)}else p={x:(g.x+X.x)/2,y:(g.y+X.y)/2};return p=xp(Z,{x:p.x,y:p.y,width:0,height:0},D),p.x+=$,p.y+=L,p}return vs[Z]?Zo(g,z?R.get(0):X,Z,$,L,D,O):Zo(z?R.get(z-1):g,X,Z,$,L,D,O)}if(x){var n=x.points,z=n.size();if(me[Z]){var b=z%2;return 0===b?Zo(n.get(z/2-1),n.get(z/2),Z,$,L,D,O):(p=n.get((z-b)/2),p=xp(Z,{x:p.x,y:p.y,width:0,height:0},D),p.x+=$,p.y+=L,p)}return vs[Z]?Zo(n.get(0),n.get(1),Z,$,L,D,O):Zo(n.get(z-2),n.get(z-1),Z,$,L,D,O)}}return Ob},_42:function(R){this._78o&&Pn.superClass._42.call(this,R)},drawPath:function(h,j){h.beginPath();var b=j.type,z=j.points,I=j.segments,x=j.edgeTypeInfo;if(!b||z){var Y=j.sourcePoint,r=Y.x,C=Y.y,f=j.targetPoint,_=f.x,y=f.y;if(b)if(I){var T=new Yp({x:r,y:C});T.addAll(z),T.add({x:_,y:y}),Ok(h,T,I)}else h.moveTo(r,C),z.each(function(l){h.lineTo(l.x,l.y)}),h.lineTo(_,y);else j.looped?h.arc(r,C,j.radius,0,O,!0):j.center?(h.moveTo(j.c1.x,j.c1.y),h.lineTo(r,C),h.lineTo(_,y),h.lineTo(j.c2.x,j.c2.y)):(h.moveTo(r,C),h.lineTo(_,y))}else x&&(x.points?Ok(h,x.points,x.segments):x[ej]&&x[ej](h,x))},_80o:function(a){var D=this,S=D.s,$=D._78o,w=$.width,T=$.selectWidth,U=$.borderWidth,B=a.lineJoin,M=a.lineCap,x=$.gray,t=$.pattern;a.lineJoin=$.join,a.lineCap=$.cap,D.drawPath(Qq(a,t),$);var F=S("edge.width.absolute");F&&(a.save(),a.setTransform(1,0,0,1,0,0)),T&&(a.strokeStyle=$._97o,a.lineWidth=w+2*(U+T),a.stroke()),U&&(a.strokeStyle=x?n.toGrayColor($.borderColor):$.borderColor,a.lineWidth=w+2*U,a.stroke());var y=x?n.toGrayColor($.color):$.color,V=x?n.toGrayColor($._67o):$._67o;if(a.strokeStyle=y,a.lineWidth=w,a.stroke(),$.is3d&&kq(a,y,V,w,D.gv._zoom,$._66o),F&&a.restore(),Oo(a,t),S("edge.dash")){t=S("edge.dash.pattern");var N=Qq(a,t,D._2Q("edge.dash.offset"));N!==a&&D.drawPath(N,$),D._1Q(a,"edge",S("edge.dash.width")||w,t)}a.lineJoin=B,a.lineCap=M},_48O:function(){},_47O:function(){}});var fb=function(h,D){Bh(fb,this,[h,D])};Qr(fb,Wl,{_3O:function(){var z,b,K=this,N=K.s,v=K._data,_=K.gv;if(K._88I=a,v.isExpanded()&&v.eachChild(function(g){if(wc(g)){var P=_.getBoundsForGroup(g);P&&(b||(b=[]),b.push(P),z=pc(z,P))}}),z){var X=_.getLabel(v),D=N("group.type");z=ng(D,b,z),Aq(z,v,"group.padding",1);var Z=K._88I={type:D,rect:z,_64o:z};if(!D&&X!=a){var c,d=K.labelInfo={label:X,color:N("group.title.color"),font:N("group.title.font"),align:N("group.title.align")},j=en(d,X),G=j.width,E=j.height,C=N("group.title.align"),e=N("group.title.orientation");if((e===rr||e===tf)&&G>z.width?z.width=G:(e===Ul||e===Te)&&G>z.height&&(z.height=G),d.rect={y:z.y-E,width:j.width,height:E},c=C===Ul?z.x:C===Te?z.x+z.width-G:z.x+z.width/2-G/2,d.rect.x=c,e===tf)Z.titleRect={x:z.x,y:z.y+z.height,width:z.width,height:E},Z.rect={x:z.x,y:z.y,width:z.width,height:z.height+E},d.rect={x:c,y:z.y+z.height,width:G,height:E};else if(e===Ul){var V=Z.titleRect={x:z.x-E,y:z.y,width:E,height:z.height};Z.rect={x:z.x-E,y:z.y,width:z.width+E,height:z.height},d.rect={x:V.x+E/2-z.height/2,y:V.y+z.height/2-E/2,width:z.height,height:E},d.rotation=-Math.PI/2}else if(e===Te){var V=Z.titleRect={x:z.x+z.width,y:z.y,width:E,height:z.height};Z.rect={x:z.x,y:z.y,width:z.width+E,height:z.height},d.rect={x:V.x+E/2-z.height/2,y:V.y+z.height/2-E/2,width:z.height,height:E},d.rotation=Math.PI/2}else Z.titleRect={x:z.x,y:z.y-E,width:z.width,height:E+1},Z.rect={x:z.x,y:z.y-E,width:z.width,height:z.height+E}}K._40O(Z,N("group.border.width")/2)}else fb.superClass._3O.call(K)},getPosition:function(S,k,O,X){var y=this._88I;if(y){var n=xp(S,y.rect,X);return n.x+=k,n.y+=O,n}return fb.superClass.getPosition.apply(this,arguments)},_24O:function(Q,w){var T=this._88I;(!T||T.type||"label2"===Q)&&fb.superClass._24O.call(this,Q,w)},_80o:function(o){var G=this,s=G._88I;if(s){var l=G._data,A=G.s,a=G.gv,p=s.type,$=s.rect,g=s._64o,D=s.titleRect,u=G.getBodyColor(),y=hh(A("group.image"),u),c=A("group.image.stretch"),O=G.getBodyColor("group.background"),B=hh(A("group.repeat.image"),u),q=A("group.gradient.pack"),f=A("group.gradient"),e=A("group.gradient.color"),I=A("group.border.width"),j=A("group.border.color"),X=A("group.border.pattern"),r=A("group.title.orientation"),m=A("group.depth");if(p){var S=o.lineJoin,P=o.lineCap;if(o.lineJoin=A("group.border.join"),o.lineCap=A("group.border.cap"),y){if(o.save(),im(o,p,$),o.clip(),Me(o,y,c,$.x,$.y,$.width,$.height,l,a,u),o.restore(),I>0){var n=Qq(o,X);im(n,p,$),o.lineWidth=I,o.strokeStyle=j,o.stroke(),Oo(o,X)}}else{var n=Qq(o,X);O||B||q?(im(o,p,$),q?em(o,q):B?Gr(o,B,u,null,l,a):wf(o,O,f,e,$),o.fill(),q&&o.restore(),o!==n&&im(n,p,$)):im(n,p,$),I>0&&(o.lineWidth=I,o.strokeStyle=A("group.border.color"),o.stroke()),Oo(o,X),p===vn&&hm(o,O,m,$)}o.lineJoin=S,o.lineCap=P}else{var Y=A("group.title.background"),H=A("group.border.radius");if(y)Me(o,y,c,g.x,g.y,g.width,g.height,l,a,G.getBodyColor());else if(O||B)if(B?Gr(o,B,u,null,l,a):wf(o,O,f,e,g),0===I)im(o,vn,g),o.fill(),hm(o,O,m,g);else{switch(o.beginPath(),r){case tf:pd(o,g.x,g.y,g.width,g.height,H,H,0,0);break;case Ul:pd(o,g.x,g.y,g.width,g.height,0,H,0,H);break;case Te:pd(o,g.x,g.y,g.width,g.height,H,0,H,0);break;case rr:pd(o,g.x,g.y,g.width,g.height,0,0,H,H)}o.fill()}if(D&&Y)if(0===I)Qf(o,D.x,D.y,D.width,D.height,Y),hm(o,Y,m,D);else{switch(o.beginPath(),o.fillStyle=Y,r){case tf:pd(o,D.x,D.y,D.width,D.height,0,0,H,H);break;case Ul:pd(o,D.x,D.y,D.width,D.height,H,0,H,0);break;case Te:pd(o,D.x,D.y,D.width,D.height,0,H,0,H);break;case rr:pd(o,D.x,D.y,D.width,D.height,H,H,0,0)}o.fill()}if(I>0){var n=Qq(o,X);if(im(n,"roundRect",$,H),o.lineWidth=I,o.strokeStyle=j,D&&A("group.splitLine")){var v=D.x,J=D.y,i=D.width,C=D.height;r===tf?(o.moveTo(v,J),o.lineTo(v+i,J)):r===Ul?(o.moveTo(v+i,J),o.lineTo(v+i,J+C)):r===Te?(o.moveTo(v,J),o.lineTo(v,J+C)):(o.moveTo(v,J+C),o.lineTo(v+i,J+C))}o.stroke(),Oo(o,X)}}G._39O(o,s)}else fb.superClass._80o.call(G,o)}});var Vg=function(I,R){Bh(Vg,this,[I,R])};Qr(Vg,Wl,{_80o:function(m){this._39O(m,this._83o)}});var mb=function(N,t){Bh(mb,this,[N,t])};Qr(mb,Wl,{_3O:function(){var D=this,S=D._data,E=D.s,F=D.gv,x=S.getPoints(),A=F.getBorderColor(S),u=A?E("border.width"):0,c=D.getSelectWidth(),$=E("shape.border.width"),b=S.getRect(),W=S.getAnchorRect(),B=F.getBodyColor(S),e=D._99o=x.isEmpty()?a:{rect:b,rotation:S.getRotation(),fillRule:E("shape.fill.rule"),scale:S.getScale(),position:S.p(),points:x,segments:S.getSegments(),bodyColor:B,borderColor:A,borderWidth:u,_94o:E("shape.border.3d"),_95o:E("shape.border.3d.color"),_96o:E("shape.border.3d.accuracy"),_97o:c?D.getSelectColor():a,selectWidth:c,_53o:E("shape.background"),_27Q:hh(E("shape.repeat.image"),B),shapeGradientPack:E("shape.gradient.pack"),_54o:$,_55o:E("shape.border.color"),shapeGradient:E("shape.gradient"),_59o:E("shape.gradient.color"),_60o:E("shape.border.pattern"),_61o:E("shape.border.cap"),_62o:E("shape.border.join"),shapeForeground:E("shape.foreground"),gray:E("2d.gray")};if(e){W.x+=e.position.x,W.y+=e.position.y,e.gradientRect=W;var d=S.getScale(),v=t(1,t(y(d.x),y(d.y)));E("shape.dash")&&E("shape.dash.width")>$&&($=E("shape.dash.width"));var K=$*("square"===e._61o?.71:.5)+u+c/D.gv._zoom/v;K&&(K*=v,b=Vl(b),lo(b,K,e._62o)),D._68o(b);var m=E("clip.percentage");1>m&&(0>m&&(m=0),e.clipRect=_k(S.getAnchorRect(),E("clip.direction"),m));var z=E("shape.fill.clip.percentage");1>z&&(0>z&&(z=0),e.shapeClipRect=_k(S.getAnchorRect(),E("shape.fill.clip.direction"),z));var N=E("shape.foreground.clip.percentage");1>N&&(0>N&&(N=0),e.shapeForegroundClipRect=_k(S.getAnchorRect(),E("shape.foreground.clip.direction"),N))}},getPosition:function(f,$,u,q){var l=this._99o;if(l){var o=xp(f,l.rect,q);return o.x+=$,o.y+=u,o}return Ob},_42:function(U){this._99o&&mb.superClass._42.call(this,U)},_80o:function(w){var b,M=this,f=M.s,J=M._99o,Z=J.position,y=J.scale,K=J.rotation,W=J.borderWidth,R=J.selectWidth/M.gv._zoom,q=J._27Q,d=J.shapeGradientPack,X=J._54o,m=J.clipRect,Q=J.shapeClipRect,O=J.points,x=J.segments,I=M._data.isClosePath(),l=J.fillRule,D=J.gray,B=function(L){return D?n.toGrayColor(L):L},A=B(J._53o),o=A||q||d;w.save(),Hc(w,Z.x,Z.y),As(w,K),cn(w,y.x,y.y),m&&(w.beginPath(),w.rect(m.x,m.y,m.width,m.height),w.clip()),o&&Q&&(w.save(),w.beginPath(),w.rect(Q.x,Q.y,Q.width,Q.height),w.clip()),Hc(w,-Z.x,-Z.y);var s=J._60o,T=Qq(w,s),C=w.lineJoin,N=w.lineCap;w.lineJoin=J._62o,w.lineCap=J._61o;var V=B(J.bodyColor);o?(Ok(w,O,x,I),d?em(w,d):q?Gr(w,q,V,null,M._data,M.gv):(b=V?V:A,wf(w,b,J.shapeGradient,B(J._59o),J.gradientRect)),w.fill(l),Q&&(w.restore(),Hc(w,-Z.x,-Z.y)),d&&w.restore(),T!==w&&Ok(T,O,x,I)):Ok(T,O,x,I);var i=J.shapeForeground;if(i){w.save();var k=J.shapeForegroundClipRect;k&&(Hc(w,Z.x,Z.y),w.beginPath(),w.rect(k.x,k.y,k.width,k.height),w.clip(),Hc(w,-Z.x,-Z.y)),Ok(w,O,x,I),wf(w,i,f("shape.foreground.gradient"),B(f("shape.foreground.gradient.color")),J.gradientRect),w.fill(l),w.restore()}var L=f("shape.border.width.absolute");if(L&&(w.save(),w.setTransform(1,0,0,1,0,0)),R&&(w.strokeStyle=J._97o,w.lineWidth=X+2*(W+R),w.stroke()),W&&(w.strokeStyle=B(J.borderColor),w.lineWidth=X+2*W,w.stroke()),X&&(b=B(J._55o),!A&&V&&(b=V),w.strokeStyle=b,w.lineWidth=X,w.stroke(),J._94o&&kq(w,b,B(J._95o),X,M.gv._zoom,J._96o)),L&&w.restore(),Oo(w,s),f("shape.dash")){var U=f("shape.dash.width")||X;if(U>0){s=f("shape.dash.pattern");var T=Qq(w,s,M._2Q("shape.dash.offset"));T!==w&&Ok(T,O,x,I),M._1Q(w,"shape",U,s)}}w.lineJoin=C,w.lineCap=N,w.restore()},_48O:function(){},_47O:function(){}});var yc=function($,c){Bh(yc,this,[$,c])};Qr(yc,mb,{getRotation:function(D,y,d){D=D||0;var J=this._data.getPoints(),i=J.size();return i>1?me[d]?i&&0===i%2?pj(J.get(i/2-1),J.get(i/2),y,D):D:vs[d]?pj(J.get(0),J.get(1),y,D):pj(J.get(i-2),J.get(i-1),y,D):D},getPosition:function(Q,$,E,P,G){var S=this._data.getPoints(),C=S.size();if(C>1){if(me[Q]){var d=C%2;if(0===d)return Zo(S.get(C/2-1),S.get(C/2),Q,$,E,P,G);var m=S.get((C-d)/2),w={x:m.x,y:m.y,width:0,height:0};return m=xp(Q,w,P),m.x+=$,m.y+=E,m}return vs[Q]?Zo(S.get(0),S.get(1),Q,$,E,P,G):Zo(S.get(C-2),S.get(C-1),Q,$,E,P,G)}return Ob}});var Xp=function(z,j){Bh(Xp,this,[z,j])};Qr(Xp,Wl,{_3O:function(){var H=this;Xp.superClass._3O.call(H);var v=H.s,U=H._83o;H._82o=U.img||U.shape?a:{background:H.getBodyColor("grid.background"),depth:v("grid.depth"),rect:U.rect,_88o:v("grid.cell.depth"),cellBorderColor:v("grid.cell.border.color"),_89o:v("grid.row.count"),_90o:v("grid.column.count"),block:v("grid.block"),_91o:v("grid.block.color"),_92o:v("grid.block.padding"),_93o:v("grid.block.width")}},_80o:function(p){var s=this,J=s._82o;if(!J)return Xp.superClass._80o.call(s,p),void 0;var E,$,d=s._data,u=J.background,C=J.rect,D=J.block,Y=J._91o,v=J._92o,X=J._93o,m=J._88o,y=J.cellBorderColor,h=J._89o,A=J._90o;if(u)if(Qf(p,C.x,C.y,C.width,C.height,u),hm(p,u,J.depth,C),m)for(E=0;h>E;E++)for($=0;A>$;$++)C=d.getCellRect(E,$),C&&hm(p,u,m,C);else if(y){for(p.beginPath(),E=0;h>E;E++)for($=0;A>$;$++)C=d.getCellRect(E,$),C&&p.rect(C.x,C.y,C.width,C.height);p.strokeStyle=y,p.lineWidth=1,p.stroke()}if("h"===D)for(E=0;h>E;E++)C=pc(d.getCellRect(E,0),d.getCellRect(E,A-1)),di(C,v),jd(p,Y,C.x,C.y,C.width,C.height,X);else if("v"===D)for($=0;A>$;$++)C=pc(d.getCellRect(0,$),d.getCellRect(h-1,$)),di(C,v),jd(p,Y,C.x,C.y,C.width,C.height,X);s._39O(p,s._83o)}});var Kg=function(U,w){Bh(Kg,this,[U,w])};Qr(Kg,Wl,{_checkEmptyRect:!1,_81o:function(){var f=this._data,K=Kg.superClass._81o.call(this),V=f.s("text");if(V!=a){var n,t,m=f.s("text.font"),g=f.s("text.align"),Q=f.s("text.vAlign"),h=kr(m,V),l=h.width,I=h.height,k=f.getAnchor(),q=f.getWidth(),X=f.getHeight();"left"===g?n=-q*k.x:"center"===g?n=-q*k.x+(q-l)/2:"right"===g&&(n=q*(1-k.x)-h.width),"top"===Q?t=-X*k.y:"middle"===Q?t=-X*k.y+(X-I)/2:"bottom"===Q&&(t=X*(1-k.y)-h.height);var L,B=f.getMatrix();if(L=rh([B.tf(n,t),B.tf(n+l,t),B.tf(n+l,t+I),B.tf(n,t+I)]),K=pc(K,L),K&&f.s("text.shadow")){var d=Vl(K);d.x+=f.s("text.shadow.offset.x"),d.y+=f.s("text.shadow.offset.y"),di(d,f.s("text.shadow.blur")),K=pc(K,d)}}return K}});var Tc=br.Interactor=function(d){this.gv=this._graphView=d};Fg("Interactor",E,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(o){this.gv.fi(o)},setCursor:function(K){jl||this.gv.setCursor(K)},startDragging:function(R){var z=this;z._lastClientPoint=Ac(R),z._lastLogicalPoint=z.gv.lp(R),fg(z,R)},clearDragging:function(){var X=this;X._lastClientPoint=X._lastLogicalPoint=X._logicalPoint=a},autoScroll:function(W){return this.gv.autoScroll(W,this._lastClientPoint)}});var Tg=a,xs=function(F){Tg.handleWindowTouchMove(F)},Em=function(f){Tg.handleWindowTouchEnd(f),i.removeEventListener(Wj,xs,Y),i.removeEventListener(cm,Em,Y),Tg=a},Rr=function(r){Tg.handleWindowMouseMove(r)},bo=function(n){Tg.handleWindowMouseUp(n),i.removeEventListener(gd,Rr,Y),i.removeEventListener(Kn,bo,Y),Tg=a},Sp=function(t,Z){t!==Tg&&(Tg?jl?Tg.handleWindowTouchEnd(Z):Tg.handleWindowMouseUp(Z):jl?(i.addEventListener(Wj,xs,Y),i.addEventListener(cm,Em,Y)):(i.addEventListener(gd,Rr,Y),i.addEventListener(Kn,bo,Y)),Tg=t)},df=function(k){var S=this;S.gv=k,S._is2d=k instanceof br.GraphView,S._is2d&&(S.filter=function(p){return k.isSelectable(p)&&k.isInteractive(p)}),k.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",Mk].forEach(function(c){S.addListener(c)}),S.initImageResource()};Qr(df,Tc,{enableVR:function(k){var d=this;if(!!d._vrEnable!==k)if(d._vrEnable=k,k)d.gv.vr.mp(d.onVRControllerChange,d);else if(d.gv.vr.ump(d.onVRControllerChange,d),d._vrRayPolyline){var V=d.gv.dm();V.remove(d._vrRayPolyline),V.remove(d._vrRayHitPoint),d._vrRayPolyline=M,d._vrRayHitPoint=M}},onVRControllerChange:function(j){var p=this,k=j.property,u=j.newValue,g=p.gv.vr.getController(u.id),B=g.getRay();B&&("gamepad.button.trigger"===k?"down"===u._62O?p.handle_mousedown(B):p.handleWindowMouseUp(B):"gamepad.pose"===k&&(p.handle_mousemove(B),p.handleWindowMouseMove(B)))},drawVRRay:function(K,C,n){var o,S=this,N=S.gv,s=S._vrRayPolyline,U=!1;if(s)o=S._vrRayHitPoint;else{var c=N.dm();S._vrRayPolyline=s=new w.Polyline,S._vrRayHitPoint=o=new w.Node,o.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),o.setAnchor3d(.5,.5,.499);var P=.2/N.vr.measureOflength;o.s3(P,P,P),s.s("intersect",!1),o.s("intersect",!1),c.add(s),c.add(o),U=!0}if(C){var X=n.world,A=n.worldNormal,d=X.x,V=X.y,f=X.z;s.s("shape.border.color","red"),s.setPoints([{x:K.origin.x,y:K.origin.z,e:K.origin.y},{x:d,y:f,e:V}]),o.s("3d.visible",!0),o.p3(d,V,f),o.lookAtDirection([A.x,A.y,A.z],"front")}else{s.s("shape.border.color","blue");var p=new w.Math.Vector3;p.copy(K.direction).setLength(1e3/S.gv.vr.measureOflength).add(K.origin),s.setPoints([{x:K.origin.x,y:K.origin.z,e:K.origin.y},{x:p.x,y:p.z,e:p.y}]),o.s("3d.visible",!1)}N.fi({kind:"vrRayIntersect",ray:K,data:C,intersect:n,polyline:s,hitNode:o,begin:U})},addListener:function(S){var W=this;W.gv.getView().addEventListener(S,function(T){n.preventDefault(T),W.disabled||W["handle_"+S](T)},Y)},handleWindowTouchMove:function(c){this.handleWindowMouseMove(c)},handleWindowMouseMove:function(K){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",K):(this.handleDownInfo("onBeginDrag",K),this.isDragging=!0))},handleWindowTouchEnd:function(i){this.handleWindowMouseUp(i)},handleWindowMouseUp:function(O){if(this.isDragging&&(this.handleDownInfo("onEndDrag",O),this.isDragging=!1),this.downInfo){var y=this.handle("onUp",O);if(y&&y.data===this.downInfo.data){this.handleMissingUp(O);var U=this,A=2===O.button?"onContextMenu":"onClick";if(!U._dbclickTimer)return U._dbclickTimer=_(function(){delete U._dbclickTimer,U.handleClick(O,A,y),this.downInfo=a},n.clickDelay),void 0;$(U._dbclickTimer),delete U._dbclickTimer,A="onDoubleClick",U.handleClick(O,A,y)}else this.handleDownInfo("onUp",O);this.downInfo=a}},handle_mouseleave:function(X){var V=this,R=V.gv,d=V.currentInfo?V.currentInfo.data:a;if(d){d.s("onLeave")&&d.s("onLeave")(X,d,R),V.fire("data","onLeave",X,d);var u=V.currentInfo?V.currentInfo.hits:a;if(u)for(var T in u)V.handleLeave(X,T);V.currentInfo=a}},handle_mousewheel:function(K){K.scrollDelta=K.wheelDelta/40,this.handle("onScroll",K)},handle_DOMMouseScroll:function(q){q.scrollDelta=2===q.axis?-q.detail:0,this.handle("onScroll",q)},handle_touchstart:function(C){this.handle_mousedown(C)},handle_touchmove:function(e){this.handle("onMove",e)},handle_mousedown:function(Z){this.isDragging&&(this.handleDownInfo("onEndDrag",Z),this.isDragging=!1),this.downInfo=this.handle("onDown",Z),this.downInfo&&Sp(this,Z)},handle_mousemove:function(D){var f=this,t=f.gv;f._hoverTimer&&($(f._hoverTimer),delete f._hoverTimer);var y,F,d,N=f.handle("onMove",D),E=this.currentInfo?this.currentInfo.data:a,W=this.currentInfo?this.currentInfo.hits:a;if(N&&(F=N.data,d=N.hits,f._hoverTimer=_(function(){$(f._hoverTimer),delete f._hoverTimer,f.handle("onHover",D,N)},t.getHoverDelay()||n.hoverDelay)),F!==E){if(E&&(E.s("onLeave")&&E.s("onLeave")(D,E,t),this.fire("data","onLeave",D,E)),F&&(F.s("onEnter")&&F.s("onEnter")(D,F,t),this.fire("data","onEnter",D,F)),W)for(y in W)this.handleLeave(D,y);if(d)for(y in d){var T=d[y];T.target.onEnter&&T.target.onEnter(D,F,t,T.point,T.width,T.height),this.fire(T.type,"onEnter",T.event,T.data,T.image,T.comp,T.point,T)}}else{if(W)for(y in W)d&&d[y]||this.handleLeave(D,y);if(d)for(y in d)if(!W||!W[y]){var T=d[y];T.target.onEnter&&T.target.onEnter(D,F,t,T.point,T.width,T.height),this.fire(T.type,"onEnter",T.event,T.data,T.image,T.comp,T.point,T)}}this.currentInfo=N},handle:function(e,B,K){var A,g=this,Q=g.gv;if(g._is2d){if(K=K||Q.getDataInfoAt(B,this.filter),!K)return;if(A=K.ui.interactiveInfo){var d,P=K.data;if(P.s(e)&&P.s(e)(B,P,Q),this.fire("data",e,B,P),"body"===K.part&&A.bodyInfo)d="body",K.hits=this.handleImage(d,Q.getImage(P),e,B,P,K.point,A.bodyInfo);else if("icons"===K.part&&A._38o){var c=A._38o[K.name];c&&c[K.index]&&(d="icons|"+K.name+"|"+K.index,K.hits=this.handleImage(d,K.icon,e,B,P,K.point,c[K.index]))}}return K}var P,j;if(!K)if(B&&B instanceof w.Math.Ray){var o=Q.vr.intersectWorld(B);if(P=o.data,j=o.intersect,g.drawVRRay(B,P,j),!P)return;var k=Q.getData3dUI(P);if(A=k.interactiveInfo,!A)return;K={data:P,part:j.part,ui:k}}else{if(K=Q.getDataInfoAt(B),!K)return;K&&(K={data:K.data,part:K.part})}if(!j){P=K.data;var k=Q.getData3dUI(P);if(K.ui=k,A=k.interactiveInfo,!A)return K;if(j=Q.intersectObject(B,P),!j)return}P.s(e)&&P.s(e)(B,P,Q),this.fire("data",e,B,P);var i,Y=j.part;return"body"!==Y&&(i=P.s(Y+".image")||P.s("shape3d."+Y+".image")),i||(i=P.s("all.image")||P.s("shape3d.image")),A="object"==typeof i?A[i.uuid]:A[i],A&&A.bodyInfo?(K.part="body",K.interactiveInfo=A,K.point=j.uv.multiply({x:A.bodyInfo.rect.width,y:A.bodyInfo.rect.height}),K.image=i,K.hits=this.handleImage("body",i,e,B,P,K.point,A.bodyInfo),K):K},_handleLeaveOrMissing:function(B,V,o){var Z="leave"===B?this.currentInfo:this.downInfo;if(Z){var $=Z.interactiveInfo||Z.ui.interactiveInfo;if($){var u,P,X=Z.data;if(this._is2d){if(P=this.gv.lp(V),"body"===Z.part&&$.bodyInfo)u="body","leave"===B?this.handleLeaveImage(o,u,this.gv.getImage(X),V,X,P,$.bodyInfo):this.handleMissingUpImage(u,this.gv.getImage(X),V,X,P,$.bodyInfo);else if("icons"===Z.part&&$._38o){var f=$._38o[Z.name];f&&f[Z.index]&&(u="icons|"+Z.name+"|"+Z.index,"leave"===B?this.handleLeaveImage(o,u,Z.icon,V,X,P,f[Z.index]):this.handleMissingUpImage(u,Z.icon,V,X,P,f[Z.index]))}}else{if(!$.bodyInfo)return;var A=this.gv.intersectObject(V,X);P=A?A.uv.multiply({x:$.bodyInfo.rect.width,y:$.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===B?this.handleLeaveImage(o,"body",Z.image,V,X,P,$.bodyInfo):this.handleMissingUpImage("body",Z.image,V,X,P,$.bodyInfo)}}}},handleClick:function(H,w,g){var L=this,p=this.downInfo;if(p&&g){var P,n=g.interactiveInfo||g.ui.interactiveInfo,T=g.data,X=this.gv;if(T.s(w)&&T.s(w)(H,T,X),L.fire("data",w,H,T),n)if(this._is2d){if(p.part===g.part){var S=X.lp(H);"body"===g.part&&n.bodyInfo&&(P="body",this.handleClickImage(P,X.getImage(T),w,H,T,S,n.bodyInfo,g))}}else{if(!n.bodyInfo)return;var u=X.intersectObject(H,T);if(!u)return;S=u.uv.multiply({x:n.bodyInfo.rect.width,y:n.bodyInfo.rect.height}),this.handleClickImage("body",p.image,w,H,T,S,n.bodyInfo,g)}}},handleDownInfo:function(N,T){if(this.downInfo){var h=this.downInfo,O=this.gv,G=h.interactiveInfo||h.ui.interactiveInfo;if(G){var B,L=h.data;if(L.s(N)&&L.s(N)(T,L,O),this.fire("data",N,T,L),this._is2d){var X=O.lp(T);if("body"===h.part&&G.bodyInfo)B="body",this.handleDownInfoImage(B,O.getImage(L),N,T,L,X,G.bodyInfo);else if("icons"===h.part&&G._38o){var P=G._38o[h.name];P&&P[h.index]&&(B="icons|"+h.name+"|"+h.index,this.handleDownInfoImage(B,h.icon,N,T,L,X,P[h.index]))}}else{if(!G.bodyInfo)return;var e=O.intersectObject(T,L);if(!e)return;X=e.uv.multiply({x:G.bodyInfo.rect.width,y:G.bodyInfo.rect.height}),this.handleDownInfoImage("body",h.image,N,T,L,X,G.bodyInfo)}}}},fire:function(q,F,N,C,t,d,g,E){this.gv.fi({kind:F,type:q,event:N,data:C,image:t,comp:d,view:this.gv,point:g,width:E?E.width:M,height:E?E.height:M})},handleImage:function(N,c,d,g,q,y,j){var r={};if(c&&(c=hh(c))){var G=this.gv,H=j.rect,t=this.convertPoint(y,j);t.inRect&&(c[d]&&c[d](g,q,G,t,H.width,H.height),this.fire("image",d,g,q,c,M,t,H),r[N+"|image"]={target:c,type:"image",image:c,data:q,event:g,point:t,width:H.width,height:H.height});for(var p=j.compInfos,l=c,f=p.length-1;f>=0;f--){var L=p[f],S=L.comp;t=this.convertPoint(y,L,l,S,G,q),t.inRect&&(H=L.rect,S[d]&&S[d](g,q,G,t,H.width,H.height),this.fire("comp",d,g,q,c,S,t,H),(c=H.image)&&(c[d]&&c[d](g,q,G,t,H.width,H.height),this.fire("image",d,g,q,c,M,t,H)),r[N+"|"+f]={target:S,type:"comp",comp:S,image:c,data:q,event:g,point:t,width:H.width,height:H.height},c&&(r[N+"|"+f+"|image"]={target:c,type:"image",image:c,data:q,event:g,point:t,width:H.width,height:H.height}))}}return r},handleLeave:function(T,e){return this._handleLeaveOrMissing("leave",T,e)},handleMissingUp:function(s){return this._handleLeaveOrMissing("missing",s)},handleLeaveImage:function(x,J,p,w,V,t,k){if(p&&(p=hh(p))){var f=this.gv,K=k.rect,o=this.convertPoint(t,k);x===J+"|image"&&(p.onLeave&&p.onLeave(w,V,f,o,K.width,K.height),this.fire("image","onLeave",w,V,p,M,o,K));for(var E=k.compInfos,e=p,g=E.length-1;g>=0;g--){var z=E[g],W=z.comp;o=this.convertPoint(t,z,e,W,f,V),K=z.rect,x===J+"|"+g&&(W.onLeave&&W.onLeave(w,V,f,o,K.width,K.height),this.fire("comp","onLeave",w,V,p,W,o,K)),(p=K.image)&&x===J+"|"+g+"|image"&&(p.onLeave&&p.onLeave(w,V,f,o,K.width,K.height),this.fire("image","onLeave",w,V,p,M,o,K))}}},handleMissingUpImage:function(B,k,i,t,H,N){var U="onUp",C=this.downInfo.hits;if(C&&k&&(k=hh(k))){var y=this.gv,J=N.rect,W=this.convertPoint(H,N);!W.inRect&&C[B+"|image"]&&(k[U]&&k[U](i,t,y,W,J.width,J.height),this.fire("image",U,i,t,k,M,W,J));for(var p=N.compInfos,c=k,z=p.length-1;z>=0;z--){var d=p[z],v=d.comp;W=this.convertPoint(H,d,c,v,y,t),W.inRect||(J=d.rect,C[B+"|"+z]&&(v[U]&&v[U](i,t,y,W,J.width,J.height),this.fire("comp",U,i,t,k,v,W,J)),(k=J.image)&&C[B+"|"+z+"|image"]&&(k[U]&&k[U](i,t,y,W,J.width,J.height),this.fire("image",U,i,t,k,M,W,J)))}}},handleDownInfoImage:function(p,f,m,K,O,Y,C){var r=this.downInfo.hits;if(r&&f&&(f=hh(f))){var T=this.gv,b=C.rect,H=this.convertPoint(Y,C);r[p+"|image"]&&(f[m]&&f[m](K,O,T,H,b.width,b.height),this.fire("image",m,K,O,f,M,H,b));for(var h=C.compInfos,c=f,n=h.length-1;n>=0;n--){var P=h[n],F=P.comp;H=this.convertPoint(Y,P,c,F,T,O),b=P.rect,r[p+"|"+n]&&(F[m]&&F[m](K,O,T,H,b.width,b.height),this.fire("comp",m,K,O,f,F,H,b)),(f=b.image)&&r[p+"|"+n+"|image"]&&(f[m]&&f[m](K,O,T,H,b.width,b.height),this.fire("image",m,K,O,f,M,H,b))
}}},handleClickImage:function(b,w,y,z,$,K,c,W){var x=this.downInfo.hits,a=W.hits;if(x&&w&&(w=hh(w))){var n=this.gv,P=c.rect,H=this.convertPoint(K,c);x[b+"|image"]&&(w[y]&&w[y](z,$,n,H,P.width,P.height),this.fire("image",y,z,$,w,M,H,P));for(var T=c.compInfos,G=w,N=T.length-1;N>=0;N--){var e=T[N],B=e.comp;H=this.convertPoint(K,e,G,B,n,$),P=e.rect,x[b+"|"+N]&&a[b+"|"+N]&&(B[y]&&B[y](z,$,n,H,P.width,P.height),this.fire("comp",y,z,$,w,B,H,P)),(w=P.image)&&x[b+"|"+N+"|image"]&&(w[y]&&w[y](z,$,n,H,P.width,P.height),this.fire("image",y,z,$,w,M,H,P))}}},initImageResource:function(){n.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(p,v,u,b,K,_){var y=v.rect,z=v.matrix.applyInverse(p).sub(y),N=z.x>=0&&z.y>=0&&z.x<=y.width&&z.y<=y.height;if(!N)return z;if(b&&Io(b.pixelPerfect,_,K)){var y,G=1;this._is2d?(G=K.getZoom(),y=bm(p.x,p.y,M,G)):y=bm(p.x,p.y);var A=!1,L=y.x,o=y.y,S=y.width,g=y.height,i=n.hitMaxArea,R=S*g*G*G;if(R>i){var D=Math.sqrt(i/R);G*=D}S*=G,g*=G,2>S&&(S=2),2>g&&(g=2),L*=G,o*=G;var Q=sm(S,g),k=new Jm(0,-L,-o,G,G);k.append(v.matrix),K._drawForChecking=!0,b.transform=k;var T=u.comps;u.comps=[b],Ad(Q,u,0,0,S,g,_,self),u.comps=T,delete b.transform,K._drawForChecking=!1;try{for(var E=0,h=Q.getImageData(0,0,S,g).data;E<h.length;E+=4)if(0!==h[E+3]){A=!0;break}Q.restore()}catch(r){wo=a,A=!1}z.inRect=A}else z.inRect=!0;return z}});var ub=br.DefaultInteractor=function(q){Bh(ub,this,[q])};Fg("DefaultInteractor",Tc,{handle_mousedown:function(g){gh(g);var V=this,W=V.gv,M=W.getDataAt(g);if(W.setFocus(g)&&!W._editing&&!W._scrolling){Ph(g)?W.handleDoubleClick(g,M):W.handleClick(g,M);var B=Zf(g);!Lh()&&!B&&M&&(W.isMovable(M)||W.isInteractive(M))||!W.isPannable()||!Qk(g)&&!B||Zl(g)||(V._tx=W.tx(),V._ty=W.ty(),V.startDragging(g))}},handleWindowMouseUp:function(o){var R=this,G=R.gv;G._panning&&(delete G._panning,G.onPanEnded(),R.fi({kind:"endPan",event:o})),delete R._tx,delete R._ty,R.clearDragging()},handle_mousemove:function(B){var h=this,A=h.gv;h._hoverTimer&&($(h._hoverTimer),delete h._hoverTimer),h._hoverTimer=_(function(){h.fi({kind:"hover",event:B}),$(h._hoverTimer),delete h._hoverTimer},A.getHoverDelay()||n.hoverDelay)},handle_touchmove:function(Z){this.handle_mousemove(Z)},handleWindowMouseMove:function(Z){var H=this,X=H.gv;H.fi({kind:X._panning?"betweenPan":"beginPan",event:Z}),X._panning=1;var S=aj(X,Z,H._lastClientPoint);X.setTranslate(H._tx+S.x,H._ty+S.y)},handle_mousewheel:function(F){this.gv.handleScroll(F,F.wheelDelta)},handle_DOMMouseScroll:function(F){2===F.axis&&this.gv.handleScroll(F,-F.detail)},handle_keydown:function(r){this.gv.handleKeyDown(r)}});var ze=br.SelectInteractor=function(c){Bh(ze,this,[c])};Fg("SelectInteractor",Tc,{_42:function(){var Y=this,L=Y.gv,l=L.getZoom(),Z=Y.mark,U=Y.div;U||(U=Y.div=lj(),eg(Y.getView(),U));var M={};M.x=Z.x*l+L.tx(),M.y=Z.y*l+L.ty(),M.width=Z.width*l,M.height=Z.height*l,Fl(U,M),this.intersects()?(U.style.border="",U.style.background=L.getRectSelectBackground()):(U.style.background="",U.style.border="1px solid "+L.getRectSelectBorderColor())},handle_mousedown:function(s){var V=this,x=V.gv;if(V._57I=a,V.pendingClickThrough=a,!(x._editing||x._scrolling||Lh()||Zf(s))){var u=x.getDataAt(s),e=x.sm();u?Zl(s)?e.co(u)?e.rs(u):e.as(u):e.co(u)?u instanceof Md&&u.isClickThroughEnabled()&&Qk(s)&&(V.pendingClickThrough=Ac(s)):e.ss(u):Zl(s)||!x.isPannable()?Qk(s)&&(Zl(s)||e.cs(),x.isRectSelectable()&&(V.startDragging(s),x._77O=1)):Qk(s)&&(V._57I=Ac(s))}},handle_mouseup:function(C){var O=this,E=O.gv,o=O._57I;if(o&&(sh(o,Ac(C))<=1&&E.sm().cs(),O._57I=a),O.pendingClickThrough){if(sh(O.pendingClickThrough,Ac(C))<=1){var F=E.getDataAt(C);if(F instanceof Md&&F.isClickThroughEnabled()){var $=E.getDataAt(C,function(r){var K=r.getParent()===F&&E.isSelectable(r,!0);return K});$&&(C.clickThrough=!0,E.sm().ss($))}}O.pendingClickThrough=a}},handleWindowMouseUp:function(n){this.clear(n)},handleWindowMouseMove:function(h){var S=this,W=S.gv;S._logicalPoint=W.lp(h),S.mark?(S.fi({kind:"betweenRectSelect",event:h}),W.isPannable()&&S.autoScroll(h),S.redraw()):S.fi({kind:"beginRectSelect",event:h}),S.mark=rh(S._lastLogicalPoint,S._logicalPoint),S.redraw()},intersects:function(){var x=this,n=x._lastLogicalPoint,o=x._logicalPoint;return n.x>o.x||n.y>o.y},clear:function(V){var Q=this,I=Q.gv,v=Q.mark;if(Q._57I=a,Q.pendingClickThrough=a,Q._lastLogicalPoint){if(v){if(0!==v.width&&0!==v.height){var r=I.getDatasInRect(v,Q.intersects());if(!r.isEmpty()){var w=I.sm(),D=w.toSelection();r.each(function(M){w.co(M)?D.remove(M):D.add(M)}),w.ss(D)}}Bm(Q.div),delete Q.div,delete Q.mark,Q.redraw(),Q.fi({kind:"endRectSelect",event:V}),I.onRectSelectEnded()}Q.clearDragging(),delete I._77O}},redraw:function(){var e=this;e._draw||(e._draw=1,_(function(){e.mark&&e._42(),delete e._draw},16))}});var rc=br.MoveInteractor=function(x){Bh(rc,this,[x])};Fg("MoveInteractor",Tc,{handle_mousedown:function(u){var R=this,s=R.gv;if(Qk(u)&&!s._editing&&!s._scrolling&&!Lh()){var d=s.getSelectedDataAt(u);!d||s.isInteractive(d)&&!s.isMovable(d)?s._focusData=a:(R._data=d,s.handleMouseDown&&s.handleMouseDown(u,d),R.startDragging(u),s.isMovable(d)&&(s._moving=1))}},handleWindowMouseUp:function(g){var H=this,M=H.gv;M.handleMouseUp&&M.handleMouseUp(g,H._data),H.clear(g)},handleWindowMouseMove:function(F){var e=this,g=e._data,m=e.gv;if((!m._93O||!m._93O(F,g))&&m._moving){e._logicalPoint||e.fi({kind:"prepareMove",event:F});var T=e._logicalPoint?"betweenMove":"beginMove",P={kind:T,event:F},Y=e._logicalPoint=m.lp(F);"beginMove"!==T||e._alreadyBeginTransaction||(e._alreadyBeginTransaction=!0,m.getDataModel().beginTransaction());var J=e._calcShift(T,F),U=J.x,H=J.y,O=e.gv.getMoveMode(F,g);O&&("x"===O?H=0:"y"===O?U=0:"xy"!==O&&(U=H=0)),m.moveSelection(U,H),e._lastLogicalPoint=Y,e.autoScroll(F),e.fi(P)}},_calcShift:function(){var c=this,j=c._logicalPoint,w=c._lastLogicalPoint,G=j.x-w.x,A=j.y-w.y;return{x:G,y:A}},clear:function(V){var c=this,L=c.gv;c._lastLogicalPoint&&(c._lastLogicalPoint=c._data=L._moving=a,c._logicalPoint&&(c.fi({kind:"endMove",event:V}),L.onMoveEnded()),c.clearDragging()),c._alreadyBeginTransaction&&(c._alreadyBeginTransaction=!1,L.getDataModel().endTransaction())}});var Lk=br.TextEditInteractor=function(B){Bh(Lk,this,[B]),this.init()};Fg("TextEditInteractor",Tc,{init:function(){var F=this,M=this.input=j.createElement("input"),S=M.style;M.text="text",S.border="1px solid #d8d8d8",S.position="absolute",S.padding="2px 3px",S.outline="none",S.marginLeft="-90px",S.marginTop="-16px",S.backgroundColor="rgba(255,255,255, 0.9)",S.fontSize="14px",S.width="180px",S.height="32px",S.boxShadow="0 0 13px rgba(16,142,233, 0.5)",S.textAlign="center",S.boxSizing="border-box",M.addEventListener("keyup",function(E){as(E)&&F.endTextEdit()}),M.addEventListener("focus",function(){M.select()});var K=this.textarea=j.createElement("textarea"),e=this.wrap=j.createElement("div");e.appendChild(K),S=K.style,S.margin=0,S.padding="4px",S.overflow="hidden",S.boxSizing="border-box",S.position="absolute",S.outline="none",S.backgroundColor="transparent",S.resize="none",S.textAlign="center",S.fontSize="14px",S.border="none",S.borderWidth=0,S.width="100%",S.top="50%",S=e.style,S.boxSizing="border-box",S.margin=0,S.padding=0,S.position="absolute",S.boxShadow="0 0 13px rgba(16,142,233, 0.5)",S.border="1px solid #d8d8d8",S.backgroundColor="rgba(255,255,255, 0.9)",S.width="180px",S.marginLeft="-90px",K.addEventListener("keydown",function(f){return(Gq()||Zl())&&as(f)?(F.endTextEdit(),void 0):(F.calculateTextareaHeight(String.fromCharCode(f.keyCode)),void 0)}),K.addEventListener("focus",function(){K.select()});var W=function(h){h.stopPropagation()};M.addEventListener("mousedown",W),M.addEventListener("touchstart",W),K.addEventListener("mousedown",W),K.addEventListener("touchstart",W),F.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],F.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",F.handleWindowClick=function(d){var Z=F._editingDOM,J=Z.getBoundingClientRect(),b=Ac(d);Aj(J,b)||F.endTextEdit()}},handle_mousedown:function(P){var e=this,U=e.gv;if(Ph(P)&&!U._editing){var h=U.getDataAt(P);if(h){var Y=U.getTextEditInfo(h);Y&&(this._editInfo=Y,this._editTarget=h,U._editing=!0,Y.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var f=this,D=f.gv,N=f._editTarget,w=f.getTargetValue(),E=f.textarea,m=f.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===w||w===M)&&(w=""),E.value=w,f._editingDOM=E,D.getView().appendChild(m),this.layoutHTML(m,N),this.calculateTextareaHeight(),_(function(){E.focus(),i.addEventListener("mousedown",f.handleWindowClick),i.addEventListener("touchstart",f.handleWindowClick)},10)},handleTextEdit:function(){var Q=this,F=Q.gv,Y=Q._editTarget,e=Q.getTargetValue(),G=Q.input;(null===e||e===M)&&(e=""),G.value=e,Q._editingDOM=G,F.getView().appendChild(G),this.layoutHTML(G,Y),_(function(){G.focus(),i.addEventListener("mousedown",Q.handleWindowClick),i.addEventListener("touchstart",Q.handleWindowClick)},10)},layoutHTML:function(y,d){var r=this.gv,b=r.getZoom();if(d instanceof w.Node){var e=d.getRect();y.style.left=(e.x+e.width/2)*b+r.tx()+"px",y.style.top=(e.y+e.height/2)*b+r.ty()+"px"}else if(d instanceof w.Edge){var G=r.getDataUI(d),e=G._6I;y.style.left=(e.x+e.width/2)*b+r.tx()+"px",y.style.top=(e.y+e.height/2)*b+r.ty()+"px"}},endTextEdit:function(){var K=this,B=K._editInfo.isMultiline?K.wrap:K.input,I=K._editInfo.isMultiline?K.textarea:K.input;K.setTargetValue(I.value),K.gv.getView().removeChild(B),K.gv._editing=!1,delete K._editingDOM,i.removeEventListener("mousedown",K.handleWindowClick),i.removeEventListener("touchstart",K.handleWindowClick)},setTargetValue:function(r){var D=this,a=D._editTarget,q=D._editInfo,K=q.accessType,H=q.name;if(H&&K||(K="p",H="name"),"p"===K){var L=w.Default.setter(H);a[L](r)}else"a"===K?a.a(H,r):a.s(H,r)},getTargetValue:function(){var f=this,P=f._editTarget,o=f._editInfo,v=o.accessType,m=o.name;if(m&&v||(v="p",m="name"),"p"===v){var I=w.Default.getter(m);return P[I]()}return"a"===v?P.a(m):P.s(m)},createHiddenTextarea:function(){this.hiddenTextarea=j.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(u,M){if(M&&this.computedStyleCache)return this.computedStyleCache;var N=this,p=i.getComputedStyle(u),S=p.getPropertyValue("box-sizing")||p.getPropertyValue("-moz-box-sizing")||p.getPropertyValue("-webkit-box-sizing"),L=parseFloat(p.getPropertyValue("padding-bottom"))+parseFloat(p.getPropertyValue("padding-top")),A=parseFloat(p.getPropertyValue("border-bottom-width"))+parseFloat(p.getPropertyValue("border-top-width")),U=N.SIZING_STYLE.map(function(W){return W+":"+p.getPropertyValue(W)}).join(";"),D={sizingStyle:U,paddingSize:L,borderSize:A,boxSizing:S};return M&&(this.computedStyleCache=D),D},calculateTextareaHeight:function(S){S=S||"";var V=this,R=V.textarea,Q=V.hiddenTextarea,e=V.wrap,w=32,L=V.calculateHTMLStyle(R,!1),u=L.paddingSize,H=L.borderSize,n=L.boxSizing,q=L.sizingStyle;Q.setAttribute("style",q+";"+V.HIDDEN_TEXTAREA_STYLE),Q.value=R.value+S;var f=Q.scrollHeight;"border-box"===n?f+=H:"content-box"===n&&(f-=u),R.style.height=f+"px",R.style.marginTop=0-.5*f+"px",e.style.height=Math.max(f,w)+"px",e.style.marginTop=f*-.5+"px"}});var Zn=br.ScrollBarInteractor=function(x){Bh(Zn,this,[x])};Fg("ScrollBarInteractor",Tc,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(e){var q=this.gv.getViewRect();return this._41o()&&(q.x+q.width-this.gv.lp(e).x)*this.gv.getZoom()<qf},isH:function(A){var B=this.gv.getViewRect();return this._40o()&&(B.y+B.height-this.gv.lp(A).y)*this.gv.getZoom()<qf},handle_mousemove:function(t){this.handle_touchmove(t)},handle_touchmove:function(s){if(!Ji&&Qk(s)&&this.gv.isScrollBarVisible()){var O=this,E=O.isV(s),X=O.isH(s);(E||X)&&O.gv.showScrollBar(),O.gv._scrolling=E||X}},handleWindowMouseUp:function(i){this.handleWindowTouchEnd(i)},handleWindowTouchEnd:function(w){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=a,this.fi({kind:"endScroll",event:w})},handle_mousedown:function(u){this.handle_touchstart(u)},handle_touchstart:function(b){var f=this;if(f.gv.setFocus(b),gh(b),f.handle_touchmove(b),!(wr(b)>1)&&f.gv._scrolling&&f.gv.isScrollBarVisible()){f._cp=Ac(b),f._tx=f.gv.tx(),f._ty=f.gv.ty();var M=f.isV(b);f._state=M?"vScroll":"hScroll",fg(f,b),f.fi({kind:"beginScroll",event:b})}},handleWindowMouseMove:function(A){this.handleWindowTouchMove(A)},handleWindowTouchMove:function(N){var n=Ac(N),y=this.gv.getViewRect(),r=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-n.y)*r.height/y.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-n.x)*r.width/y.width),this.fi({kind:"betweenScroll",event:N})}});var Xj=br.TouchInteractor=function(s,F){F=F||{},F.selectable===M&&(F.selectable=!0),F.movable===M&&(F.movable=!0),F.pannable===M&&(F.pannable=!0),F.pinchable===M&&(F.pinchable=!0),F.editable===M&&(F.editable=!0),this.params=F,Bh(Xj,this,[s])};Fg("TouchInteractor",Tc,{ms_edit:1,setUp:function(){var Z=this;Xj.superClass.setUp.call(Z),jl&&Z.params.editable&&Z.gv.setEditInteractor(Z)},tearDown:function(){var k=this;Xj.superClass.tearDown.call(k),jl&&k.params.editable&&k.gv.setEditInteractor(a)},clear:function(C){var u=this,_=u.gv;_._moving&&(u.fi({kind:"endMove",event:C}),delete _._moving,_.onMoveEnded(),_.dm().endTransaction()),_._panning&&(u.fi({kind:"endPan",event:C}),delete _._panning,_.onPanEnded()),_._pinching&&(u.fi({kind:"endPinch",event:C}),delete _._pinching,_.onPinchEnded()),_._editing&&(u._46O(C),u._77I=u._node=u._edge=u._shape=u._rect=u._89I=u._index=_._editing=a),u._moving=u._panning=u._pinching=u._editing=u._57I=u._data=u._beginHistory=a,u.clearDragging()},handle_touchstart:function(K){var o=this;if(!o.gv._editing){gh(K),o._57I=a;var W=o.params,n=o.gv,Y=n.sm(),i=n.getDataAt(K),t=wr(K);if(1===t){if(Ph(K))return n.handleDoubleClick(K,i),void 0;n.handleClick(K,i),i&&(n.handleMouseDown&&n.handleMouseDown(K,i),o._data=i),W.selectable||(i=a),i?(Y.co(i)||Y.ss(i),W.editable&&n.isEditable(i)&&o._79I(K,i,!0)?(o._editing=1,o.startDragging(K)):W.movable&&n.isMovable(i)&&(o._moving=1,o.startDragging(K))):(o._57I=Ac(K),W.pannable&&n.isPannable()&&(o._panning=1,o.startDragging(K),o._translate={x:n.tx(),y:n.ty()}))}else if(W.pinchable&&2===t){o._pinching=1,o.startDragging(K);var f=n.getView(),r=n.getZoom(),I=f.getBoundingClientRect(),C=K.touches[0],g=K.touches[1],H={x:(C.clientX+g.clientX)/2-I.left,y:(C.clientY+g.clientY)/2-I.top};H.x-=n.tx(),H.y-=n.ty(),H.x/=r,H.y/=r,o._p=H,o._d=Gn(K)}}},handle_touchend:function(Q){var w=this,c=w.gv,g=w._57I,Y=w._data;g&&(sh(g,Ac(Q))<=1&&c.sm().cs(),w._57I=a),Y&&c.handleMouseUp&&c.handleMouseUp(Q,Y)},handleWindowTouchEnd:function(U){this.clear(U)},handleWindowTouchMove:function(o){var Q=this,g=Q.gv,v=wr(o);if(1===v){if(Q._editing&&(Q._beginHistory||(Q._beginHistory=1,g.dm().beginTransaction()),g._editing=1,Q._78I(o)),Q._moving)Q._beginHistory||(Q._beginHistory=1,g.dm().beginTransaction()),Q.handleMove(o);else if(Q._panning){var L=Ac(o),W=aj(g,L,Q._lastClientPoint);g.setTranslate(Q._translate.x+W.x,Q._translate.y+W.y),Q.fi({kind:g._panning?"betweenPan":"beginPan",event:o}),g._panning=1}}else if(2===v&&Q._pinching){var $=Gn(o);g.handlePinch(Q._p,$,Q._d),Q._d=$,Q.fi({kind:g._pinching?"betweenPinch":"beginPinch",event:o}),g._pinching=1}},handleMove:function(H){var Z=this,c=Z.gv,d=c.lp(H);c._93O&&c._93O(H,Z._data)||(c.moveSelection(d.x-Z._lastLogicalPoint.x,d.y-Z._lastLogicalPoint.y),Z._lastLogicalPoint=d,Z.autoScroll(H),Z.fi({kind:c._moving?"betweenMove":"beginMove",event:H}),c._moving=1)}});var w=i.ht,eh=w.graph._editor={Math:w.Math,Guide:{}};eh.getStyle=function($){var K,r=eh.StyleMap;return r&&(K=r[$],K!==M)?K:eh.DefaultStyleMap[$]},eh.setStyle=function(i,A){var c=eh.StyleMap;c||(c=eh.StyleMap={}),c[i]=A},eh.inEdit=function(U){return U._inXEdit===!0},eh.startEdit=function(e){e._inXEdit=!0,eh.Inject.doInject(e)},eh._46O=function(M){M._inXEdit=!1,eh.Inject.undoInject(M)},eh.toScreenPosition=function(a,f){var Z=a.tx(),F=a.ty(),$=a._zoom;return new eh.Math.Vector2(f.x*$+Z,f.y*$+F)},eh.checkHit=function(u,D,i){return u.distanceTo(D)<i?!0:!1},eh.toWorldPosition=function(P,Q){var E=P.tx(),L=P.ty(),Z=P._zoom;return{x:(Q.x-E)/Z,y:(Q.y-L)/Z}},eh.setAntialias=function(o,v){for(var r,K=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],H=0,X=K.length;X>H&&(r=K[H],!(r in o));H++);o[r],o[r]=v},eh.getTargetCornersOnScreen=function(y,p){if(!p)return null;var t,u=[];if(Hp(p,y)){var i=rn(y,p);t=[{x:i.x,y:i.y},{x:i.x+i.width,y:i.y},{x:i.x+i.width,y:i.y+i.height},{x:i.x,y:i.y+i.height}]}else{if(!p.getCorners)return null;t=p.getCorners()}return t.forEach(function(X){var C=eh.toScreenPosition(y,X);u.push(C.x,C.y)}),u},eh.log=function(){};var hq=eh.Inject={_modules:[]};hq.registAsModule=function(D,e){var f={},t={};for(var I in D){var d=e.prototype[I];f[I]=d}D.getBackup=function(E){return f[E]},D.getBackups=function(){return f},t.doInject=function(){for(var L in D)"getBackup"!==L&&(e.prototype[L]=D[L])},t.undoInject=function(){for(var y in D)"getBackup"!==y&&(e.prototype[y]=f[y])},hq._modules.push(t)},hq.doInject=function(C){for(var q,N=hq._modules,S=0,e=N.length;e>S;S++)q=N[S],q.doInject(C)},hq.undoInject=function(z){for(var l,b=hq._modules,o=0,C=b.length;C>o;o++)l=b[o],l.undoInject(z)};var Tc=w.graph.EditInteractor=function(g){var _=this,c=j.createElement("canvas");c.className="editCanvas",c.style.position="absolute",_._styleMap={},_._canvas=c,_._context=c.getContext("2d"),Tc.superClass.constructor.call(_,g),eh.setAntialias(_._context,!1),_._subModules=[new eh.Anchor(_),new eh.RotateX(_),new eh.MoveDummy(_),new eh.Rect(_),new eh.Curve(_),new eh.MoveHelper(_)],_._gridGuide=new eh.Guide.Grid(_),_._rectGuide=new eh.Guide.Rect(_),_._hoverGuide=new eh.Guide.Hover(_)},tc=Tc;w.Default.def(Tc,w.graph.Interactor,{ms_edit:1,ms_fire:1}),E.defineProperties(Tc.prototype,{editDetail:{get:function(){var E=!!this._editDetail;return E},set:function($){var C=this,h=C._editDetail;h!==$&&(C._editDetail=$,C.gv._editing=$,C.fp("editDetail",h,$),C.fp("pointsEditingMode",h,$),C.fi({kind:$?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(h){(!this._editDetail||h)&&(this.gv._editing=h,h||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(K){this._editing=K,this.gvEditing=K}},pointsEditingMode:{get:function(){return this.editDetail},set:function(A){var x=this;x.editDetail!==A&&(A?x._tryEnterEditDetailMode():x._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var o=this._gridEnabled;if(!o)return!1;var u=this.gv;return u?!0:!0},set:function(u){u!==this._gridEnabled&&(this._gridEnabled=u,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(X){X!==this._agEnabled&&(this._agEnabled=X,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Tc.prototype.getSubModule=function(p){var x,j,l,w=this._subModules;for(j=0,l=w.length;l>j;j++)if(x=w[j],x.catalog===p)return x},Tc.prototype.invokeSubModule=function(V,v){var q=this,e=q._subModules;if(e)for(var n,L,K,W=Array.prototype.slice.call(arguments,2),p=0,j=e.length;j>p;p++)if(n=e[p],L=n[V],L&&(K=L.apply(n,W),K!=M&&v))return n},Tc.prototype.invokeSubModuleInverse=function(F,N){var C=this,f=C._subModules;if(f)for(var W,O,H,r=Array.prototype.slice.call(arguments,2),G=f.length-1;G>=0;G--)if(W=f[G],O=W[F],O&&(H=O.apply(W,r),H!=M&&N))return W},Tc.prototype.setUp=function(){eh.log("setUp");var j=this,Z=j.gv,h=Z.getView(),S=j._canvas;Tc.superClass.setUp.call(j),Z.setEditInteractor(j),Z._79O?h.insertBefore(S,Z._79O):h.appendChild(S),eh.startEdit(Z),j.invokeSubModule("setUp"),Z.dm().mm(j._onDataModelChanged,j),Z.dm().md(j._onDataPropertyChanged,j)},Tc.prototype.tearDown=function(){eh.log("tearDown");var a=this,N=a.gv,z=N.getView();a._resetCustomCursorStyle(),Tc.superClass.tearDown.call(a),N.dm().umm(a._onDataModelChanged,a),N.dm().umd(a._onDataPropertyChanged,a),N.setEditInteractor(null),z.removeChild(a._canvas),a._drawTimer&&($(a._drawTimer),a._drawTimer=null),eh._46O(N),a.invokeSubModule("tearDown")},Tc.prototype._onDataModelChanged=function(x){var o=this;("clear"===x.kind||"remove"===x.kind&&o.editDetail&&x.data===o.getSubModule("Curve").target)&&(o.editDetail=!1,o._42())},Tc.prototype._onDataPropertyChanged=function(T){var m=this;if(m.editDetail){var w=m.getSubModule("Curve"),t=T.data;t===w.target&&(t._writing||w._handleDataChanged(T))}},Tc.prototype.clear=function(){eh.log("clear")},Tc.prototype.redraw=function(){this._42()},Tc.prototype._42=function(){var f=this;f._drawTimer||(f._drawTimer=_(function(){f._drawTimer=null,f.drawImpl()},0))},Tc.prototype.drawImpl=function(){var y;for(y in{_42:!0})break;return function(){var e=this,k=e._canvas,s=e.gv,F=s.getWidth(),h=s.getHeight(),m=e._context,A=w.Default.getInternal(),K=i.devicePixelRatio;(k.width!==F||k.height!==h)&&A.setCanvas(k,F,h,K),m.clearRect(0,0,k.width,k.height);var S=e._getValidSelection();m.save(),m.scale(K,K),e._gridGuide._42(),e.invokeSubModuleInverse(y,!1,m,s,S),e._rectGuide._42(),e._hoverGuide._42(),m.restore()}}(),Tc.prototype._getValidSelection=function(){var T=this,a=T.gv,o=a.sm().getSelection(),r=[];return o.each(function(J){a.isVisible(J)&&a.isEditable(J)&&r.push(J)}),r},Tc.prototype.handle_touchmove=function(V){return this.handle_mousemove(V)},Tc.prototype.handle_mousemove=function(a){if(!w.Default.isDragging()){var H=this;if(H.editDetail||!Lh()&&!Zf(a))if(H.gvEditing=!1,H._checkEdit(a))H.gvEditing=!0;else{if(!H.getStyle("hoverGuideEnabled"))return;H.hoverData=H.gv.getDataAt(a),H._42()}}},Tc.prototype.handle_touchstart=function(f){return this.handle_mousedown(f)},Tc.prototype.handle_mousedown=function(z){gh(z);var k=this;if(k.editDetail||!Lh()&&!Zf(z)){if(Ph(z)&&!z.clickThrough){if(k.editDetail){if(k._tryQuitEditDetailMode(z))return}else if(k._tryEnterEditDetailMode())return;k.gv.dm().beginTransaction();var t=k.invokeSubModule("handleDoubleClick",!0,z);if(k.gv.dm().endTransaction(),t)return}var Z=k._checkEdit(z);Z&&(k._downPosition=k._getLogicalPoint(z),k.gv.dm().beginTransaction(),Z.startEdit(k,z),k.editing=!0)}},Tc.prototype._checkEdit=function(L){var s=this,D=s.gv,X=s._getLogicalPoint(L),I=s.invokeSubModule("check",!0,D,L,X)||null;return s._editMod=I,I},Tc.prototype.handleWindowTouchMove=function($){return this.handleWindowMouseMove($)},Tc.prototype.handleWindowMouseMove=function(i){var Z=this,m=Z._downPosition;if(m){var O=Z._getLogicalPoint(i);if(O.distanceTo(m)<Z.getStyle("moveSensitivity"))return;delete Z._downPosition}var Q=Z._editMod;Q&&Q.handleEdit(Z.gv,i)},Tc.prototype._getLogicalPoint=function(o){var S=this,q=w.Default.getLogicalPoint(o,S._canvas);return new eh.Math.Vector2(q)},Tc.prototype.handleWindowTouchEnd=function(l){return this.handleWindowMouseUp(l)},Tc.prototype.handleWindowMouseUp=function(){var m;for(m in{_46O:!0})break;return function(N){var h=this;h.editing=!1,h.setCursor("default"),h.invokeSubModule(m,!1,N),h._42(),h.gv.dm().endTransaction()}}(),Tc.prototype.handle_mousewheel=function(e){var L=this;gh(e),L.invokeSubModule("preHandleScroll",!0)||L.gv.handleScroll(e,e.wheelDelta)},Tc.prototype.handleDelete=function(){var N=this;if(!N.editDetail){N.gv.dm().beginTransaction();var n=N.invokeSubModule("handleNormalStateDelete",!0);return N.gv.dm().endTransaction(),n||N.gv.removeSelection(),void 0}N.gv.dm().beginTransaction(),N.invokeSubModule("handleDelete",!0),N.gv.dm().endTransaction(),N._42()},Tc.prototype.handle_keydown=function(L){var R=this;if((L.metaKey||L.ctrlKey)&&R._42(),Lh(L)&&!R.editing)return R.gvEditing=!1,R.setCursor("default"),R._42(),void 0;var n=as(L);return R.editDetail?((n||_i(L))&&(R.editDetail=!1,R._42()),R.gv.dm().beginTransaction(),R.invokeSubModule("handle_keydown",!0,L),R.gv.dm().endTransaction(),void 0):(R.gv.dm().beginTransaction(),R.invokeSubModule("handleNormalStateKeyDown",!0,L),R.gv.dm().endTransaction(),n&&R._tryEnterEditDetailMode(),void 0)},Tc.prototype.handle_keyup=function(z){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,z),this.gv.dm().endTransaction()},Tc.prototype._tryEnterEditDetailMode=function(){var A=this;return!A.editDetail&&A.invokeSubModule("canEnterEditDetailMode",!0)&&1===A._getValidSelection().length?(A.editDetail=!0,A._42(),!0):void 0},Tc.prototype._tryQuitEditDetailMode=function(c){var O=this;return O.editDetail?!c||O.invokeSubModule("canQuitEditDetailMode",!0,c)?(O.editDetail=!1,O._42(),!0):!1:!1},Tc.prototype.setStyle=function(s,Y,b){var g=this;b?eh.setStyle(s,Y):g._styleMap[s]=Y,"baseColor"===s&&(bl=Y),g.fp("styleChanged",null,{key:s,value:Y,base:b}),g._42()},Tc.prototype.getStyle=function(K){var R=this,T=R._styleMap[K];return T!==M?T:eh.getStyle(K)},Tc.prototype.setCursor=function(l){this._resetCustomCursorStyle(),w.graph.EditInteractor.superClass.setCursor.call(this,l)},Tc.prototype._resetCustomCursorStyle=function(){var T=this;if(T._customStyle){var H=this.gv.getView();H.classList&&H.classList.remove&&H.classList.remove(T._customStyle),T._customStyle=null}},Tc.prototype._setRotateCursor=function(D){var P=this,k=P._cursorFactory;k||(k=P._cursorFactory=new eh.CursorFactory(P));var J=k.getRotateCursor(D),M=P.gv.getView();P._resetCustomCursorStyle(),P._customStyle=J,M.classList&&M.classList.add&&M.classList.add(J)};var ae=eh.Group=function(z){var p=this;p._entities=z,p._64O=0,p._position={x:0,y:0},p._scale={x:1,y:1},p._anchor={x:.5,y:.5},p._anchor2={x:.5,y:.5}};ae.prototype={},ae.prototype.constructor=ae;var Rm=null;ae.findOrCreateGroup=function(G){if(Rm&&Rm.checkIsMe(G))return Rm;var F=new eh.Group(G);return F.getKeyOb()?(Rm=F,F):void 0},ae.prototype.checkIsMe=function(R){var B=this._entities;if(B.length!==R.length)return!1;var e,p={},E=R.length;for(e=0;E>e;e++)p[R[e]._id]=!0;for(e=0;E>e;e++)if(!p[B[e]._id])return!1;return!0},ae.prototype.getRotation=function(){return this._64O},ae.prototype.getPosition=function(){return this._position},ae.prototype.getAnchor=function(){return this._anchor},ae.prototype.getWidth=function(){return this._width},ae.prototype.getScale=function(){return this._scale},ae.prototype.getSize=function(){return{width:this._width,height:this._height}},ae.prototype.getHeight=function(){return this._height},ae.prototype.getKeyOb=function(){for(var h=this._entities,S=h.length-1;S>=0;S--){var y=h[S];if(this.isNode(y))return y}},ae.prototype.getAnchor2=function(){var w=this,y=w.rotateCenter;if(y)return y;var Y=w.getKeyOb();if(!Y)return w._anchor;var z=w._anchor2,q=Y.getMatrix();return q.tf({x:Y.getWidth()*(z.x-Y.getAnchor().x),y:Y.getHeight()*(z.y-Y.getAnchor().y)})},ae.prototype.setAnchor2=function(n,U){var E=this,R=E.getKeyOb();if(R){var C,H=R.getMatrix();C="number"==typeof n?{x:n,y:U}:n;var r=H.tfi(C);E._anchor2={x:R.getAnchor().x+r.x/R.getWidth(),y:R.getAnchor().y+r.y/R.getHeight()}}},ae.prototype.setRotation=function(){},ae.prototype.beginRotate=function(Q){this.rotateCenter=Q.pos,this.rotateMode=Q.groupRotateMode},ae.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},ae.prototype.addRotation=function(C,F){return"batch"===F?this._addRotationInBatchMode(C):"block"===F?this._addRotationInBlockMode(C):void 0},ae.prototype._addRotationInBlockMode=function(A){var I=this,$=I.rotateCenter||I.getPosition();I._entities.forEach(function(H){if(I.isNode(H)){var p=H.getMatrix();p.translate(-$.x,-$.y),p.rotate(A),p.translate($.x,$.y);var S=Math.sign(H.getScale().x);H.setRotation(x(p.b*S,p.a*S)),H.setPosition(p.tx,p.ty)}})},ae.prototype._addRotationInBatchMode=function(N){var M=this,g=M._anchor2;M._entities.forEach(function(H){if(M.isNode(H)){var G=H.getAnchor(),S=H.getMatrix(),C=S.tf({x:H.getWidth()*(g.x-G.x),y:H.getHeight()*(g.y-G.y)}),m=new eh.Math.Matrix2d;m.set(S.a,S.b,S.c,S.d,S.tx,S.ty),m.translate(-C.x,-C.y),m.rotate(N),m.translate(C.x,C.y);var s=Math.sign(H.getScale().x);H.setRotation(x(m.b*s,m.a*s)),H.setPosition(m.tx,m.ty)}})},ae.prototype.setPosition=function(S){var F,s,B,l,r=this,D=r._position,u=S.x-D.x,A=S.y-D.y,Z=r._entities;for(s=0,B=Z.length;B>s;s++)F=Z[s],wc(F)&&(l=F.getPosition(),F.setPosition(l.x+u,l.y+A));r._position=S},ae.prototype.setScale=function(C,N){var d=this,X=C/d._scale.x,U=N/d._scale.y;d._adjustChildScaleOrSize(X,U,"size"),d._scale={x:C,y:N}},ae.prototype.getRect=function(){var k=this,U=k._position,A=k._width,d=k._height;return{x:U.x-A/2,y:U.y-d/2,width:A,height:d}},ae.prototype.setSize=function(I,Z){var j=this,I=Math.max(1,I),Z=Math.max(1,Z),n=I/j._width,l=Z/j._height;j._adjustChildScaleOrSize(n,l,"size"),j._width=I,j._height=Z},ae.prototype._adjustChildScaleOrSize=function(S,M,k){var N,F,_,l,U,n,H,u,B,g,r,O,L,f,t=this,w=t._position,Z=t._entities,T=new eh.Math.Matrix2d;for(F=0,_=Z.length;_>F;F++)if(N=Z[F],t.isNode(N)){if(l=N.getPosition(),U=N.getRotation(),n=N.getWidth(),H=N.getHeight(),u=N.getScale(),r=u.x*n,O=u.y*H,T.identity().scale(r,O).rotate(U).translate(l.x,l.y).translate(-w.x,-w.y).rotate(-t._64O),U=x(T.b*Math.sign(r),T.a*Math.sign(r)),T.scale(S,M),B=Math.cos(U),g=Math.sin(U),Math.abs(B)<.001?(L=T.b/g,f=-T.c/g):(L=T.a/B,f=T.d/B),"scale"===k)N.setScale(L/n,f/H);else if("size"===k){var R=L/u.x,D=f/u.y;N.setScale(Rj(L)*Math.abs(u.x),Rj(f)*Math.abs(u.y)),N.setSize(Math.max(.1,Math.abs(R)),Math.max(.1,Math.abs(D)))}T.rotate(t._64O).translate(w.x,w.y),N.setPosition(T.tx,T.ty)}},ae.prototype.getMatrix=function(){var p=this,l=p._position,f=w.Default.getInternal(),y=p._scale;return new f.Mat(p._64O,l.x,l.y,y.x,y.y)},ae.prototype.toGlobal=function(K){return this.getMatrix().tf(K)},ae.prototype.getCorners=function(){var p=this,h=p._width,E=p._height,Q=p._anchor,$=-h*Q.x,F=-E*Q.y,Z=p.getMatrix();return[Z.tf($,F),Z.tf($,F+E),Z.tf($+h,F+E),Z.tf($+h,F)]},ae.prototype.calcInfo=function(){var c,e,B,U,s,K,T=this,b=[],h=T._entities,k=T._64O;for(U=0,s=h.length;s>U;U++)K=h[U],T.isNode(K)&&K.getCorners&&b.push.apply(b,K.getCorners());if(b.length){var z=Math.cos(-k),i=Math.sin(-k),r=1/0,l=-1/0,P=1/0,J=-1/0;for(U=0,s=b.length;s>U;U++)B=b[U],c=B.x,e=B.y,B.x=z*c-i*e,B.y=i*c+z*e,r=Math.min(r,B.x),l=Math.max(l,B.x),P=Math.min(P,B.y),J=Math.max(J,B.y);T._width=(l-r)/T._scale.x,T._height=(J-P)/T._scale.y,z=Math.cos(k),i=Math.sin(k);var M=T._anchor;c=r+(l-r)*M.x,e=P+(J-P)*M.y,T._position={x:z*c-i*e,y:i*c+z*e}}},ae.prototype.isNode=function(x){return wc(x)?Hp(x)?!1:!0:!1},ae.prototype._42=function(Q,z,t){var J,T,r,P,j,v,B,_,D=this,F=D._entities,d=D.rotateMode;for("batch"===d&&(_=D.getKeyOb()),J=0,T=F.length;T>J;J++)r=F[J],D.isNode(r)&&(v=r.getRect(),P=eh.toScreenPosition(t,{x:v.x,y:v.y}),j=eh.toScreenPosition(t,{x:v.x+v.width,y:v.y+v.height}),B={min:P,max:j},r===_&&(B.isKeyOb=!0),eh.Icons.DrawIcon(Q,z,eh.Icons.GroupSubEntityRect,B))};var rj=eh.CurveActiving=function(r,f){this._curve=r,this._interactor=r._interactor;for(var K in f)this[K]=f[K]};rj.prototype={},rj.prototype.constructor=rj,E.defineProperties(rj.prototype,{point:{get:function(){return this._point
},set:function(h){var x=this;x._point=h,x.editingCtrl||x._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(l){var s=this;s._pairs=l,s.editingCtrl&&s._firePointChange()}}}),rj.prototype._firePointChange=function(){var i=this,E=i.getCurrentEditingPoint(),s=i._interactor;if(!E)return s.fi({kind:"selectPoint"}),void 0;var L=this._curve.target;if(L){var V=eh.getDataMatrix(L).invert(),h=E.e;E=V.apply(eh.toWorldPosition(s.gv,E)),E.e=h;var g=i._lastFirePoint;g&&Math.abs(E.x-g.x)<1e-5&&Math.abs(E.y-g.y)<1e-5&&(E.e==M&&g.e==M||Math.abs(E.e-g.e)<1e-5)||(i._lastFirePoint=E,s.fi({kind:"selectPoint",x:E.x,y:E.y,e:E.e}))}},rj.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},rj.prototype.getCurrentEditingPoint=function(){var V=this,P=V.editingCtrl;if(P){var D=V.pairs;if(D){var o=D[P.pairId],y=o[P.type];if(y)return y}}return V._point};var vm=eh.CursorFactory=function(F){var D=this;D._interactor=F,D._rotateCursorStyles={}};vm.prototype={},vm.prototype.constructor=vm,vm.prototype.getRotateCursor=function(h){var A=this;0>h&&(h+=2*Math.PI);var i=A._interactor,H=i.getStyle("rotateCursorSize"),j=i.getStyle("rotateCursorRound"),J=Math.round(180*(h/Math.PI)/j);J*j>=360&&(J=0);var N=A._rotateCursorStyles,L="htCustomRotateStyle_"+H+"_"+j+"_"+J;return N[L]||(A._produceRotateCursor(L,H,j,J),N[L]=!0),L},vm.prototype._produceRotateCursor=function(x,m,s,a){var B=this;B._interactor;var C=B._canvas;C||(C=B._canvas=j.createElement("canvas")),C.width=C.height=m*devicePixelRatio,C.style.width=C.style.height=m+" px";var o=C.getContext("2d");eh.setAntialias(o,!1),o.scale(devicePixelRatio,devicePixelRatio);var _,w,R,O,z,T=Math.round(m/2),g=""+T+" "+T+",auto !important;";_=Math.PI/180*a*s,o.clearRect(0,0,m,m),o.save(),o.scale(m/32,m/32),o.translate(16,16),o.rotate(_+Math.PI/2),o.beginPath(),o.moveTo(-8,0),o.lineTo(-8,3),o.lineTo(-5,3),o.moveTo(8,0),o.lineTo(8,3),o.lineTo(5,3),o.moveTo(-8,3),o.quadraticCurveTo(0,-6,8,3),o.restore(),o.strokeStyle="white",o.lineWidth=4,o.stroke(),o.strokeStyle="black",o.lineWidth=2,o.stroke(),w=JSON.stringify(C.toDataURL()),O="cursor:url("+w+")"+g,1!==devicePixelRatio&&(R='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+m+'px" height="'+m+'px"><image xlink:href='+w+' width="'+m+'" height="'+m+'"/></svg>',O+="cursor:url(data:image/svg+xml;base64,"+btoa(R)+")"+g,O+="cursor:-webkit-image-set(url("+w+")"+devicePixelRatio+"x,url("+w+")1x)"+g),z=j.createElement("style"),z.textContent="body."+x+" *, ."+x+"{"+O+"}",j.head.appendChild(z)};var nf=eh.Guide.Grid=function(i){var c=this;c._interactor=i,c._alignmentGuideId=0,c._xAlignmentGuide=[],c._yAlignmentGuide=[]};nf.prototype={},nf.prototype.constructor=nf,E.defineProperties(nf.prototype,{gridBlockSize:{get:function(){var K=this;return K._gridBlockSize||K._interactor.getStyle("gridBlockSize")},set:function(B){this._gridBlockSize=B,this._interactor._42()}},gridThickLinesEvery:{get:function(){var w=this;return w._gridThickLinesEvery||w._interactor.getStyle("gridThickLinesEvery")},set:function(X){this._gridThickLinesEvery=X,this._interactor._42()}},gridEnabled:{get:function(){var V=this,w=V._interactor;return w.gridEnabled&&V.isValidGrid()}}}),nf.prototype._42=function(){var B=this,P=B._interactor;B.gridEnabled&&B.drawGrid(),P.alignmentGuideEnabled&&B.drawAlignmentGuide()},nf.prototype.makeMatrix=function(){var u=this,b=u._interactor.getStyle("gridAngle"),x=u._interactor.getStyle("gridRotation"),F=new eh.Math.Matrix2d,Y=Math.sin(b),m=Math.cos(b);return F.set(1,0,m,Y,0,0),F.rotate(x),F},nf.prototype.isValidGrid=function(){var e=this,C=Math.PI,L=e._interactor,E=L.gv;if(E._zoom<L.getStyle("gridZoomThreshold"))return!1;var T=L.getStyle("gridAngle"),c=Math.abs(180*(T%C/C)),k=1-1e-8;return k>c||c>180-k?!1:!0},nf.prototype.drawAlignmentGuide=function(){var b=this,j=b._interactor,$=j.gv,M=j._canvas,i=j._context,L=M.width,n=M.height,S=$.tx(),d=$.ty(),g=$._zoom;i.beginPath(),i.strokeStyle=j.getStyle("gridAlignmentGuideColor"),i.lineWidth=1,b._xAlignmentGuide.forEach(function(R){var G=R.p*g+S;i.moveTo(G,0),i.lineTo(G,n)}),b._yAlignmentGuide.forEach(function(h){var K=h.p*g+d;i.moveTo(0,K),i.lineTo(L,K)}),i.stroke()},nf.prototype.drawGrid=function(){function V(M,C,r,T){var S=eh.toScreenPosition(l,K.apply({x:M,y:C})),n=eh.toScreenPosition(l,K.apply({x:r,y:T}));j.moveTo(S.x,S.y),j.lineTo(n.x,n.y)}var b=this,u=b._interactor,A=b.gridBlockSize,N=b.gridThickLinesEvery,M=u.getStyle("gridThickColor"),B=u.getStyle("gridLightColor"),l=u.gv,k=u._canvas,j=u._context,F=k.width,p=k.height,K=b.makeMatrix(),c=K.applyInverse(eh.toWorldPosition(l,{x:0,y:0})),C=K.applyInverse(eh.toWorldPosition(l,{x:F,y:0})),$=K.applyInverse(eh.toWorldPosition(l,{x:0,y:p})),t=K.applyInverse(eh.toWorldPosition(l,{x:F,y:p})),P=Math.min(c.x,C.x,$.x,t.x),d=Math.max(c.x,C.x,$.x,t.x),R=Math.min(c.y,C.y,$.y,t.y),Q=Math.max(c.y,C.y,$.y,t.y);F=d-P,p=Q-R;var a=Math.ceil(P/A),D=Math.floor(d/A),E=Math.ceil(R/A),r=Math.floor(Q/A);l.tx(),l.ty(),l._zoom;var L,i,J;for(j.save(),j.lineWidth=1,j.beginPath(),j.strokeStyle=M,J=Math.ceil(a/N)*N;D>=J;J+=N)L=J*A,V(L,R,L,Q);for(J=Math.ceil(E/N)*N;r>=J;J+=N)i=J*A,V(P,i,d,i);for(j.stroke(),j.beginPath(),j.strokeStyle=B,J=a;D>=J;J++)0!==J%N&&(L=J*A,V(L,R,L,Q));for(J=E;r>=J;J++)0!==J%N&&(i=J*A,V(P,i,d,i));j.stroke(),j.restore()},nf.prototype.getAlignmentGuides=function(){var b=this;return{x:b._xAlignmentGuide,y:b._yAlignmentGuide}},nf.prototype.addAlignmentGuide=function(w,s,y){var H=this,v="x"===w?H._xAlignmentGuide:H._yAlignmentGuide,y=y?y:++H._alignmentGuideId,A={p:s,id:y};if(v.length){var C=H._findClosestAlignmentGuide(A.p,v);C.dis<0?v.splice(C.index+1,0,A):v.splice(C.index,0,A)}else v.push(A);return H._interactor._42(),y},nf.prototype.findClosest=function(g,u,U){var A=this,j=A._interactor,J=j.gv;U&&(g=eh.toWorldPosition(J,g));var S,X,D,H=1/0,T=1/0,i=g.x,L=g.y;if(A.gridEnabled){var s=A.gridBlockSize,Z=A.makeMatrix(),W=Z.applyInverse(g);W=Z.apply({x:Math.round(W.x/s)*s,y:Math.round(W.y/s)*s}),H=W.x-i,T=W.y-L,D=!0}if(j.alignmentGuideEnabled&&(S=A._findClosestAlignmentGuide(i,A._xAlignmentGuide).dis,X=A._findClosestAlignmentGuide(L,A._yAlignmentGuide).dis,Math.abs(S)<Math.abs(H)&&(H=S,D=!0),Math.abs(X)<Math.abs(T)&&(T=X,D=!0)),D){D=!1;var N=J._zoom,B=j.getStyle("smartGuideSensitivity")/N,x={};if(Math.abs(H)<B&&"y"!==u&&(x.x=U?H*N:H,D=!0),Math.abs(T)<B&&"x"!==u&&(x.y=U?T*N:T,D=!0),D)return x}},nf.prototype._findClosestAlignmentGuide=function(K,B){if(!B.length)return{dis:1/0};for(var U,k=0,E=B.length-1;E-k>1;)U=Math.floor((k+E)/2),B[U].p<K?k=U:E=U;var o=B[k].p-K,Q=B[E].p-K;return Math.abs(o)<=Math.abs(Q)?{line:B[k],dis:o,index:k}:{line:B[E],dis:Q,index:E}},nf.prototype.removeAllAlignmentGuide=function(w){var o=this;"y"!==w&&(o._xAlignmentGuide=[]),"x"!==w&&(o._yAlignmentGuide=[]),o._interactor._42()},nf.prototype.removeAlignmentGuide=function(i){for(var w,o,B,O=this,D=O._xAlignmentGuide,b=0;2>b;b++)for(D=0===b?O._xAlignmentGuide:O._yAlignmentGuide,w=0,o=D.length;o>w;w++)if(B=D[w],B.id===i)return D.splice(w,1),O._interactor._42(),{axis:0===b?"x":"y",position:B.p};return!1},nf.prototype.adjustAlignmentGuide=function(o,q){var R=this,B=R.removeAlignmentGuide(o);return B?(R.addAlignmentGuide(B.axis,q,o),!0):!1};var Mc=eh.Guide.Rect=function(y){var N=this;N._interactor=y};Mc.prototype={},Mc.prototype.constructor=Mc,Mc.prototype.gatherRects=function(){var e,Z,A,i,$=this,F=$._interactor.gv,w=[],v=[],B={x:w,y:v},y={},K=F.getDataModel(),p=K.a("width"),P=K.a("height");p&&P&&(e=0,Z=0,A=p,i=P,w.push({node:K,type:0,p:e},{node:K,type:1,p:e+A/2},{node:K,type:2,p:e+A}),v.push({node:K,type:0,p:Z},{node:K,type:1,p:Z+i/2},{node:K,type:2,p:Z+i}),y[K._id||0]={x:e,y:Z,width:A,height:i}),K.each(function(h){if(wc(h)&&!F.isSelected(h)&&F.isVisible(h)){var B=!1;if(F.sm().getSelection().each(function(x){B||(h.isHostOn(x)?B=!0:h.isDescendantOf(x)&&(B=!0))}),!B){var X=h.getRect();e=X.x,Z=X.y,A=X.width,i=X.height,w.push({node:h,type:0,p:e},{node:h,type:1,p:e+A/2},{node:h,type:2,p:e+A}),v.push({node:h,type:0,p:Z},{node:h,type:1,p:Z+i/2},{node:h,type:2,p:Z+i}),y[h._id]=X}}}),w.sort(function(F,e){return F.p-e.p}),v.sort(function(b,$){return b.p-$.p}),$._grid=B,$._87I=y},Mc.prototype.gatherLines=function(r,G,X){var Y,F,a,N,E,l,d,j,C,e,Q,n,g=this,f=[g.findClosest({x:r.x,y:r.y},G),g.findClosest({x:r.x+r.w/2,y:r.y+r.h/2},G),g.findClosest({x:r.x+r.w,y:r.y+r.h},G)],U={},q=g._87I;X=X||255;var P,W;for(g._guideLine=[],Y=0;2>Y;Y++)for(U={},0===Y?(N="y",j=r.x,C=j+r.w):(N="x",j=r.y,C=j+r.h),F=0;3>F;F++)E=f[F],E&&isFinite(E[N])&&(P=1<<3*Y+F,X&P&&(l=E[N+"Line"],d=l.node,W=d._id||0,U[W]||(U[W]=!0,n=q[W],"y"===N?(e=n.x,Q=n.x+n.width):(e=n.y,Q=n.y+n.height),a=l.p,g._guideLine.push({type:N,a:j,b:C,c:e,d:Q,p:a,center:1===l.type}))))},Mc.prototype._binarySearchClosest=function(v,A){if(!A.length)return{dis:1/0};for(var H,I=0,W=A.length-1;W-I>1;)H=Math.floor((I+W)/2),A[H].p<v?I=H:W=H;var j=A[I].p-v,U=A[W].p-v;return Math.abs(j)<=Math.abs(U)?{line:A[I],dis:j}:{line:A[W],dis:U}},Mc.prototype.findClosest=function(l,m,t){var f=this,N=f._interactor,A=N.gv,i=f._grid;t&&(l=eh.toWorldPosition(A,l));var $,H=f._binarySearchClosest(l.x,i.x),u=f._binarySearchClosest(l.y,i.y),V=H.dis,D=u.dis,E=A._zoom,h=N.getStyle("smartGuideSensitivity")/E,W={};return Math.abs(V)<h&&"y"!==m&&(W.x=t?V*E:V,W.xLine=H.line,$=!0),Math.abs(D)<h&&"x"!==m&&(W.y=t?D*E:D,W.yLine=u.line,$=!0),$?W:void 0},Mc.prototype._42=function(){var z=this,j=z._guideLine;if(j&&!w.Default.isCtrlDown()){var b,q,E,f,I,L,r,G,M,_,F,y,A,U,P,X,l,S=z._interactor,B=S.gv,p=S._context,s=B.tx(),h=B.ty(),Z=B._zoom,g=S.getStyle("guideLineTextSpacing");for(b=0,q=j.length;q>b;b++)E=j[b],G=E.type,M=E.p,_=E.a,F=E.b,y=E.c,A=E.d,U=Math.min(_,y),P=Math.max(F,A),"x"===G?(f=M*Z+s,I=U*Z+h,L=f,r=P*Z+h):(f=U*Z+s,I=M*Z+h,L=P*Z+s,r=I),eh.Icons.DrawIcon(S,p,eh.Icons.MoveLineGuide,{rect:[f,I,L,r],center:E.center}),A>=_&&F>=y||(U=_>A?A:F,P=_>A?_:y,l=P-U,"x"===G?(E.center2center||(f-=g,L=f),I=U*Z+h,r=P*Z+h,X=eh.Icons.MoveLineGuideDistanceV):"y"===G&&(E.center2center||(I-=g,r=I),f=U*Z+s,L=P*Z+s,X=eh.Icons.MoveLineGuideDistanceH),eh.Icons.DrawIcon(S,p,X,{x0:f,y0:I,x1:L,y1:r,dis:l}))}},Mc.prototype.clear=function(){this._guideLine=null};var eb=eh.Guide.Hover=function(Y){var W=this;W._interactor=Y};eb.prototype={},eb.prototype.constructor=eb,E.defineProperties(eb.prototype,{}),eb.prototype._42=function(){var a=this._interactor;if(a.getStyle("hoverGuideEnabled")&&!a.gvEditing){var b=a.hoverData,O=a.gv;if(!wc(b)||O.isSelected(b))return a.hoverData=null,void 0;var P=rn(O,b),R=eh.toScreenPosition(O,{x:P.x,y:P.y}),S=eh.toScreenPosition(O,{x:P.x+P.width,y:P.y+P.height});eh.Icons.DrawIcon(a,a._context,eh.Icons.HoverDataRect,{min:R,max:S,color:a.getStyle("hoverGuideColor")||a.getStyle("baseColor")})}},eh.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyVisible:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,guideLineTextSpacing:0,hoverGuideEnabled:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var bh=eh.Icons={},Yd=1e4,qc=null,bl=eh.DefaultStyleMap.baseColor,Ec="rgb(183,232,135)",Dr="rgb(255,204,153)",Fo=6;w.Default.setImage("Icons.RectPoint",{width:Fo,height:Fo,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return bl}},rect:[0,0,Fo,Fo]}]}),bh.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var H=bh.GroupSubEntityRect.data;if(!H)return[];var u=H.min,B=H.max;return[u.x,u.y,u.x,B.y,B.x,B.y,B.x,u.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return bh.GroupSubEntityRect.data.isKeyOb?bl:bl}}}]};var Rb=4;bh.HoverDataRect={comps:[{type:"shape",points:{func:function(){var d=bh.HoverDataRect.data;if(!d)return[];var l=d.min,H=d.max,E=Rb;return l.x-=E,l.y-=E,H.x+=E,H.y+=E,[l.x,l.y,l.x,H.y,H.x,H.y,H.x,l.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return bh.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},bh.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[bh.Line.data.P1.x,bh.Line.data.P1.y],Fo,Fo]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[bh.Line.data.P2.x,bh.Line.data.P2.y],Fo,Fo]}}}]},bh.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return bh.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},bh.Rect={comps:[{type:"shape",points:{func:function(){var e=bh.Rect.data;if(!e)return[];var s=e.LT,y=e.LB,B=e.RB,f=e.RT;return[s.x,s.y,y.x,y.y,B.x,B.y,f.x,f.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return bl}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},rect:{func:function(){return[[bh.Rect.data.LT.x,bh.Rect.data.LT.y],Fo,Fo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},rect:{func:function(){return[[bh.Rect.data.LB.x,bh.Rect.data.LB.y],Fo,Fo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},rect:{func:function(){return[[bh.Rect.data.RB.x,bh.Rect.data.RB.y],Fo,Fo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},rect:{func:function(){return[[bh.Rect.data.RT.x,bh.Rect.data.RT.y],Fo,Fo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},visible:{func:function(){return bh.Rect.data.L?!0:!1}},rect:{func:function(){return[[bh.Rect.data.L.x,bh.Rect.data.L.y],Fo,Fo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},visible:{func:function(){return bh.Rect.data.R?!0:!1}},rect:{func:function(){return[[bh.Rect.data.R.x,bh.Rect.data.R.y],Fo,Fo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},visible:{func:function(){return bh.Rect.data.T?!0:!1}},rect:{func:function(){return[[bh.Rect.data.T.x,bh.Rect.data.T.y],Fo,Fo]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return bh.Rect.data.rotation}},visible:{func:function(){return bh.Rect.data.B?!0:!1}},rect:{func:function(){return[[bh.Rect.data.B.x,bh.Rect.data.B.y],Fo,Fo]}}}]};var vk=16;w.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return bl}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return bl}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),bh.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[bh.Anchor.data.POS.x,bh.Anchor.data.POS.y],vk,vk]}}}]},bh.TipShiftX=12,bh.TipShiftY=12;var Bp=[8,28];bh.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[bh.TipHelper.data.helperPos.x,bh.TipHelper.data.helperPos.y,Bp[0]*bh.TipHelper.data.size,Bp[1]]}},background:{func:function(){return qc.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return bh.TipHelper.data.text}},rect:{func:function(){return[bh.TipHelper.data.helperPos.x,bh.TipHelper.data.helperPos.y,Bp[0]*bh.TipHelper.data.size,Bp[1]]}},color:{func:function(){return qc.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var xn=7;bh.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!bh.ShapePoint.data.dynamicVisible}},rect:{func:function(){var i=bh.ShapePoint.data.point,z=bh.ShapePoint.data.size||xn;return[i,z+10,z+10]}},background:{func:function(){var Y=Date.now(),s=bh.ShapePoint.data.dynamicPeriod||1500,c=Math.sin(Y%s/s*Math.PI);return"rgba(27,124,22,"+.5*c+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var p=bh.ShapePoint.data.point,H=bh.ShapePoint.data.size||xn;return[p,H,H]}},background:{func:function(){var J=bh.ShapePoint.data.isEnd;return J?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return bh.ShapePoint.data.color||bl}}},{type:"rect",visible:{func:function(){return!!bh.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return bl}},rect:{func:function(){var M=5;return[bh.ShapePoint.data.point,M,M]}}}]},bh.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!bh.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return bh.ShapeBgCurve.data.P}},segments:{func:function(){return bh.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var y=Date.now(),J=bh.ShapeBgCurve.data.dynamicPeriod||1500,G=Math.sin(y%J/J*Math.PI);return"rgba(27,124,22,"+.3*G+")"}}},{type:"shape",points:{func:function(){return bh.ShapeBgCurve.data.P}},segments:{func:function(){return bh.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return bh.ShapeBgCurve.data.color||bl}}}]};var so=8;bh.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var S=bh.ShapeHighlighPoint.data;return[[S.x,S.y],so,so]}},background:{func:function(){return qc.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var mm=10;bh.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var U=bh.ShapeHighlighRealPoint.data;return[[U.x,U.y],mm,mm]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return bl}}}]};var Rh=8;bh.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var L=bh.ShapeHighlighCtrlPoint.data,Z=L.x,f=L.y,e=Rh/2;return[Z-e,f-e,Z-e,f+e,Z+e,f+e,Z+e,f-e]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return qc.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return qc.getStyle("shapeCtrlPointBorderColor")||bl}}}]};var ib=3;bh.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return bh.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:ib,borderColor:{func:function(){return qc.getStyle("curveHighlightColor")}}}]},bh.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return bh.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},bh.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return bh.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return bh.MoveLineGuide.data.center?Ec:Dr}}}]};var yd=5;bh.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var s=bh.MoveLineGuideDistanceH.data,C=s.x0,c=s.y0;return[C,c-yd,C,c+yd]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Dr},{type:"shape",points:{func:function(){var C=bh.MoveLineGuideDistanceH.data,h=C.x1,j=C.y1;return[h,j-yd,h,j+yd]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Dr},{type:"text",text:{func:function(){return Math.round(bh.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var e=bh.MoveLineGuideDistanceH.data;return[[(e.x0+e.x1)/2,e.y0-10],20,20]}},color:Dr,font:"12px Arial",align:"center"}]},bh.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var b=bh.MoveLineGuideDistanceV.data,x=b.x0,A=b.y0;return[x-yd,A,x+yd,A]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Dr},{type:"shape",points:{func:function(){var s=bh.MoveLineGuideDistanceV.data,M=s.x1,c=s.y1;return[M-yd,c,M+yd,c]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Dr},{type:"text",text:{func:function(){return Math.round(bh.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var J=bh.MoveLineGuideDistanceV.data;return[[J.x0-10,(J.y0+J.y1)/2],20,20]}},color:Dr,font:"12px Arial",align:"center"}]},w.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),bh.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var V=bh.EdgeElevationGuide.data,G=V.x,U=V.y,C=qc.getStyle("curveElevationIntersectSize"),S=qc.getStyle("curveElevationGuideShift");return G+=S[0],U+=S[1],[G-C,U-C,2*C,2*C]}}}]},w.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),w.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),bh.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return bh.ConnectGuide.data.rotation}},rect:{func:function(){var H=bh.ConnectGuide.data.connect;H.x,H.y;var h=qc.getStyle("connectGuideIntersectSize");return[[H.x,H.y],2*h,2*h]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var B=bh.ConnectGuide.data.cursorPos||bh.ConnectGuide.data.connect,G=qc.getStyle("connectGuideIntersectSize");return[[B.x,B.y],2*G-2,2*G-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var E=bh.ConnectGuide.data.connect,_=bh.ConnectGuide.data.cursorPos||E;return[E.x,E.y,E.x+.5*(_.x-E.x),E.y,_.x+.5*(E.x-_.x),_.y,_.x,_.y]}}}]},w.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),w.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),bh.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var H=bh.ConnectGuideGarbage.data.hover;return H?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var s=bh.ConnectGuideGarbage.data,S=qc.getStyle("connectGuideGarbageIntersectsize");return s.hover&&(S+=5),[[s.x,s.y],2*S,2*S]}}}]};var _f=6;bh.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return bh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var Y=bh.ShapeActivingCtrl.data;return[Y.point.x,Y.point.y,Y.c1.x,Y.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return bl}}},{type:"shape",visible:{func:function(){return bh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var d=bh.ShapeActivingCtrl.data;return[d.point.x,d.point.y,d.c2.x,d.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return bl}}},{type:"shape",visible:{func:function(){return bh.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var D=bh.ShapeActivingCtrl.data.c1,L=D.x,O=D.y,d=_f/2;return"c1"===bh.ShapeActivingCtrl.data.hl&&(d+=.5),[L-d,O-d,L-d,O+d,L+d,O+d,L+d,O-d]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return qc.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===bh.ShapeActivingCtrl.data.hl?qc.getStyle("shapeCtrlPointHighlightBorder")||bl:qc.getStyle("shapeCtrlPointBorderColor")||bl}}},{type:"shape",visible:{func:function(){return bh.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var v=bh.ShapeActivingCtrl.data.c2,Y=v.x,k=v.y,q=_f/2;return"c2"===bh.ShapeActivingCtrl.data.hl&&(q+=.5),[Y-q,k-q,Y-q,k+q,Y+q,k+q,Y+q,k-q]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return qc.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===bh.ShapeActivingCtrl.data.hl?qc.getStyle("shapeCtrlPointHighlightBorder")||bl:qc.getStyle("shapeCtrlPointBorderColor")||bl}}}]},bh.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return bl}},rect:{func:function(){return[[bh.RoundPoint.data.x,bh.RoundPoint.data.y],Fo,Fo]}}}]},bh.AttachPoint={comps:[{type:"rect",background:{func:function(){return bh.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return bl}},rect:{func:function(){var I=bh.AttachPoint.data.isAttach?Fo+4:Fo;return[[bh.AttachPoint.data.x,bh.AttachPoint.data.y],I,I]}}}]},bh.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return bh.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return bh.SimpleRect.data.color||bl}},rect:{func:function(){var Z=bh.SimpleRect.data;return[Z.x,Z.y,Z.width,Z.height]}}}]},w.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),bh.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var L=bh.MoveDummy.data;return[[L.pos.x,L.pos.y],2*L.size,2*L.size]}}}]},eh.Icons.DrawIcon=function(q,W,N,m){N.width=N.height=Yd,N.data=m,qc=q,w.Default.drawImage(W,N,0,0,Yd,Yd)},eh.Icons.MapPoints=function(o,N){for(var O=0,Z=o.length;Z>O;O++)o[O]/=N},eh.roundTo=function(p,u,h){var M=Math.abs(p%u);return h>M||h>u-M?u*Math.round(p/u):p},eh.toFixed=function(w){return Math.round(100*w)/100},eh.getDataMatrix=function(u){if(u instanceof w.Shape){var n=new w.Math.Matrix2d,l=u.getPosition();return n.translate(-l.x,-l.y).scale(u.getScale().x,u.getScale().y).rotate(u.getRotation()).translate(l.x,l.y),n}return u.getMatrix?u.getMatrix():new w.Math.Matrix2d};var gc=eh.Math.Curve=function(){this._curves=[]};gc.prototype={},gc.prototype.constructor=gc,gc.prototype.createFromHtShape=function(o,$,Z){$ instanceof w.List&&($=$.toArray());var b,x,s,L,f,B,Q,U=this,v=null,S=null,l=0,G=eh.Math.Vector2,Y=eh.Math.CubicBezier,k=function(g){return new G(o[g],o[g+1],Z?Z[g/2]:M)};for(x=0,s=$.length;s>x;x++){switch(L=$[x],f=null,L){case 1:S=k(l),v=S,l+=2;break;case 2:b=k(l),l+=2,f=new Y(S,S.clone(),b.clone(),b),S=b;break;case 3:B=k(l),b=k(l+2),l+=4,f=new Y(S,B.clone().sub(S).multiplyScalar(2/3).add(S),B.clone().sub(b).multiplyScalar(2/3).add(b),b),S=b;break;case 4:B=k(l),Q=k(l+2),b=k(l+4),l+=6,f=new Y(S,B,Q,b),S=b;break;case 5:if(!v)break;f=new Y(S,S.clone(),v.clone(),v),S=null,v=null}f&&(f._index=U._curves.length,U._curves.push(f))
}},gc.prototype.checkPoint=function(v,_){var w,z,T,o,H,Q=this,q=Q._curves;for(w=0,z=q.length;z>w;w++)if(o=q[w],H=o.intersectRect(v,_,_),H.length)return T=0,H.forEach(function(B){T+=B.t}),T/=H.length,v=o.getPointAt(T),v.t=T,{bezier:o,intersection:v}},gc.prototype.insertKnot=function(g,L){var O=g.insertKnot(L),N=this,H=N._curves;H.splice(g._index,1,O[0],O[1])},gc.prototype._isCloseEnough=function(Q,d){return Math.abs(Q.x-d.x)<1e-6&&Math.abs(Q.y-d.y)<1e-6},gc.prototype._isSamePoint=function(C,A){return C===A},gc.prototype.moveRealPoint=function(w,n){var E=this,$=E._curves,W=n.clone().sub(w);$.forEach(function(O){var F=O._p1;O._p2,O._p3;var b=O._p4;E._isSamePoint(F,w)&&(O._p2.add(W),O._p1=n),E._isSamePoint(b,w)&&(O._p3.add(W),O._p4=n)})},gc.prototype.moveCtrlDueToRealPointMovement=function(F,V){var D=this,h=D._curves,g=function(C){C.add(V),C.e&&V.e&&(C.e+=V.e)};h.forEach(function(d){var v=d._p1;d._p2,d._p3;var $=d._p4;D._isSamePoint(v,F)&&g(d._p2),D._isSamePoint($,F)&&g(d._p3)})},gc.prototype.moveCtrlPoint=function(n,D,q){var y=n[q];if(y){y.e!==M&&(D.e=y.e);var j=this,k=j._curves;D.clone().sub(y),k.forEach(function(G){var $;"c2"===q?$="_p2":"c1"===q&&($="_p3"),j._isSamePoint(G[$],y)&&(G[$]=D)}),n[q]=D}},gc.prototype.deleteRealPoint=function(s,U){var b,S,g,F,o,M,L,y=this,i=y._curves,E={},t=[],e=eh.Math.CubicBezier;for(S=0,g=i.length;g>S;S++)b=i[S],F=b._p1,o=b._p2,M=b._p3,L=b._p4,(E[S]||!y._isSamePoint(F,s))&&(y._isSamePoint(L,s)?g>S+1&&y._isSamePoint(i[S+1]._p1,s)&&(U||t.push(new e(F,o,i[S+1]._p3,i[S+1]._p4))):t.push(b));y._curves=t},gc.prototype.findPairs=function(R,B){var w,U,M,T,J,u,I,E,h=this,o=h._curves,K={},L=[];for(U=0,M=o.length;M>U;U++)w=o[U],T=w._p1,J=w._p2,u=w._p3,I=w._p4,!K[U]&&h._isSamePoint(T,R)&&(B?L.push({point:T,r2:I}):L.push({point:T,c2:J})),h._isSamePoint(I,R)&&(E=B?{point:I,r1:T}:{point:I,c1:u},M>U+1&&h._isSamePoint(o[U+1]._p1,R)&&(B?E.r2=o[U+1]._p4:E.c2=o[U+1]._p2,K[U+1]=!0),L.push(E));return L},gc.prototype.toHtShape=function(){var c=this,d=c._curves,q=[],D=[],o={x:1/0,y:1/0};return d.forEach(function($){var n=$._p1,W=$._p2,X=$._p3,k=$._p4;return c._isCloseEnough(n,o)||(q.push(1),D.push(n.clone())),o=k,c._isCloseEnough(n,W)&&c._isCloseEnough(X,k)?(q.push(2),D.push(k.clone()),void 0):(q.push(4),D.push(W.clone(),X.clone(),k.clone()),void 0)}),{segments:q,points:D}};var Uc=eh.Math.CubicBezier=function(k,i,Z,y){var a=this;a._id=eh.Math.CubicBezier._globalId++,a._p1=k,a._p2=i,a._p3=Z,a._p4=y};Uc._globalId=1,Uc.prototype={},Uc.prototype.constructor=Uc,Uc.prototype.toString=function(){return this._id},Uc.prototype.intersectRect=function(J,j,$){var V=j/2,z=$/2,r=J.x,S=J.y,X=eh.Math.Vector2,Q=new X(-V+r,-z+S),k=new X(V+r,z+S),h=new X(k.x,Q.y),l=new X(Q.x,k.y),o=this,O=o.intersectLine(Q,h),x=o.intersectLine(h,k),Z=o.intersectLine(k,l),P=o.intersectLine(l,Q),v=O.concat(x).concat(Z).concat(P);return v},Uc.prototype.intersectLine=function(F,f){var o,Y,s,y,z,b,B,x,q,l,g,n,i,p=this,t=F.clone().min(f),k=F.clone().max(f);y=p._p1,z=p._p2,b=p._p3,B=p._p4,o=y.clone().multiplyScalar(-1),Y=z.clone().multiplyScalar(3),s=b.clone().multiplyScalar(-3),g=o.add(Y).add(s).add(B),o=y.clone().multiplyScalar(3),Y=z.clone().multiplyScalar(-6),s=b.clone().multiplyScalar(3),l=o.add(Y).add(s),o=y.clone().multiplyScalar(-3),Y=z.clone().multiplyScalar(3),q=o.add(Y),x=y.clone(),i=new eh.Math.Vector2(F.y-f.y,f.x-F.x),n=F.x*f.y-f.x*F.y;for(var V=p.getRoots(i.dot(g),i.dot(l),i.dot(q),i.dot(x)+n),h=new Array,j=0,R=V.length;R>j;j++){var e=V[j];if(!(0>e||e>1)){var P=y.clone().lerp(z,e),C=z.clone().lerp(b,e),A=b.clone().lerp(B,e),D=P.lerp(C,e),U=C.lerp(A,e),I=D.lerp(U,e);I.t=e,F.x==f.x?t.y<=I.y&&I.y<=k.y&&h.push(I):F.y==f.y?t.x<=I.x&&I.x<=k.x&&h.push(I):I.x>=t.x&&I.y>=t.y&&I.x<=k.x&&I.y<=k.y&&h.push(I)}}return h},Uc.prototype.solveTForPoint=function(n){var m,C,Y,q,y=this;m=y._p1.x-n.x,C=y._p2.x-n.x,Y=y._p3.x-n.x,q=y._p4.x-n.x;for(var h=y.getRoots(q-3*Y+3*C-m,3*Y-6*C+3*m,3*C-3*m,m),w=M,c=1/0,W=0,$=h.length;$>W;W++){var l=h[W];if(!(0>l||l>1)){var _=y._p1.clone().lerp(y._p2,l),z=y._p2.clone().lerp(y._p3,l),Z=y._p3.clone().lerp(y._p4,l),G=_.lerp(z,l),N=z.lerp(Z,l),L=G.lerp(N,l);L.t=l;var A=Math.abs(L.y-n.y);c>A&&(c=A,w=L)}}return w},Uc.prototype.getPointAt=function(l){var N=this,K=N._p1,R=N._p2,W=N._p3,j=N._p4,V=K.clone().lerp(R,l),$=R.clone().lerp(W,l),q=W.clone().lerp(j,l),c=V.lerp($,l),x=$.lerp(q,l);return c.lerp(x,l)},Uc.prototype.getRoots=function(U,g,f,E){var A,J,z,q,W,L=new Array;if(Math.abs(U)<1e-6){var A=g,J=f/A,z=E/A,q=J*J-4*z;if(q>0){var W=Math.sqrt(q);L.push(.5*(-J+W)),L.push(.5*(-J-W))}else 0==q&&L.push(.5*-J)}g/=U,f/=U,E/=U,A=(3*f-g*g)/3,J=(2*g*g*g-9*f*g+27*E)/27;var N=g/3,t=J*J/4+A*A*A/27,p=J/2;if(Math.abs(t)<=1e-6&&(t=0),t>0){var F,T,W=Math.sqrt(t);F=-p+W,T=F>=0?Math.pow(F,1/3):-Math.pow(-F,1/3),F=-p-W,F>=0?T+=Math.pow(F,1/3):T-=Math.pow(-F,1/3),L.push(T-N)}else if(0>t){var I=Math.sqrt(-A/3),H=Math.atan2(Math.sqrt(-t),-p)/3,k=Math.cos(H),n=Math.sin(H),G=Math.sqrt(3);L.push(2*I*k-N),L.push(-I*(k+G*n)-N),L.push(-I*(k-G*n)-N)}else{var F;F=p>=0?-Math.pow(p,1/3):Math.pow(-p,1/3),L.push(2*F-N),L.push(-F-N)}return L},Uc.prototype._70I=function(){var z=this;return z._p1.distanceToSquared(z._p2)<1e-10&&z._p3.distanceToSquared(z._p4)<1e-10},Uc.prototype.insertKnot=function(F){var V=this,J=V._p1,e=V._p2,Z=V._p3,s=V._p4,o=J.clone().lerp(e,F),T=e.clone().lerp(Z,F),Y=Z.clone().lerp(s,F),x=o.clone().lerp(T,F),q=T.clone().lerp(Y,F),H=x.clone().lerp(q,F);return V._70I()?(J.clone().lerp(s,F),[new eh.Math.CubicBezier(J,J.clone(),H.clone(),H),new eh.Math.CubicBezier(H,H.clone(),s.clone(),s)]):[new eh.Math.CubicBezier(J,o,x,H),new eh.Math.CubicBezier(H,q,Y,s)]};var Pn=w.Default.getInternal().ui().EdgeUI,sr={_47O:function(c){var o=this,_=sr.getBackups()._47O;eh.inEdit(o.gv)||_.call(o,c)}};eh.Inject.registAsModule(sr,Pn);var Wl=w.Default.getInternal().ui().NodeUI,Dl={_47O:function(i){var r=this,x=Dl.getBackups()._47O;eh.inEdit(r.gv)||x.call(r,i)},getSelectWidth:function(){var U=this,W=U.gv,G=U._data;if(W.isEditable(G)&&eh.inEdit(W))return 0;var F=Dl.getBackup("getSelectWidth");return F.call(U)}};eh.Inject.registAsModule(Dl,Wl);var to=w.graph.GraphView,jh={_editPointSize:function(){var _=w.Default.isTouchable,o=eh.getStyle("pointSize");return o[_?0:1]}(),isPointEditable:function(y){var c=this;if(eh.inEdit(c))return c._pointEditableFunc?c._pointEditableFunc(y):!0;var i=jh.getBackup("isPointEditable");i.call(c,y)},isEditable:function(n){var L,m=this,T=jh.getBackup("isEditable");if(L=n instanceof eh.Group?!0:T.call(m,n),!eh.inEdit(m))return L;if(!(n instanceof w.Edge))return L;if(!n.s("2d.editable"))return!1;var f=m.getEditableFunc();return f?f(n):!0},_42:function(u,I){var V=this,s=jh.getBackups()._42;if(s.call(V,u,I),eh.inEdit(V)){var i=V.getEditInteractor();i.drawImpl()}}};eh.Inject.registAsModule(jh,to);var mb=w.Default.getInternal().ui().ShapeUI,Pk={_47O:function(l){var D=this,o=Pk.getBackups()._47O;eh.inEdit(D.gv)||o.call(D,l)}};eh.Inject.registAsModule(Pk,mb);var ub=w.graph.DefaultInteractor,ei={handle_mousewheel:function(u){var W=this,X=ei.getBackup("handle_mousewheel");eh.inEdit(W.gv)||X.call(W,u)}};eh.Inject.registAsModule(ei,ub);var rc=w.graph.MoveInteractor,rp={_calcShift:function(a,O){var R=this,j=rp.getBackup("_calcShift"),Q=R.gv;if(!eh.inEdit(Q))return j.call(R,a,O);var $=Q.getEditInteractor(),p=$.getSubModule("Move").calcShift(a,O,R);return p||j.call(R,a,O)},clear:function($){var l=this,K=rp.getBackup("clear");K.call(l,$);var a=l.gv;if(eh.inEdit(a)){var V=a.getEditInteractor();V.getSubModule("Move").clear($)}}};eh.Inject.registAsModule(rp,rc);var Mc=eh.Rect=function(D){this.catalog="Rect",this._interactor=D};Mc.prototype={},Mc.prototype.constructor=Mc,Mc.prototype.gatherInfo=function(O,c){var d=this;if(1===c.length){var R=c[0];return R instanceof w.Shape&&R._70I()?d.gatherLine(O,R):Hp(R,O)?!1:d.gatherSingleTarget(O,R)}return c.length>1?d.gatherMultiTargets(O,c):!1},Mc.prototype.gatherSingleTarget=function($,a){if(a.getCorners){var u,k=this,n=k.info;k.target=a,u=k.screenInfo={};var T=a.getCorners();n.LT=new eh.Math.Vector2(T[0]),n.LB=new eh.Math.Vector2(T[1]),n.RB=new eh.Math.Vector2(T[2]),n.RT=new eh.Math.Vector2(T[3]),n.T=n.LT.clone().add(n.RT).divideScalar(2),n.B=n.LB.clone().add(n.RB).divideScalar(2),n.L=n.LT.clone().add(n.LB).divideScalar(2),n.R=n.RT.clone().add(n.RB).divideScalar(2);for(var Q in n)u[Q]=eh.toScreenPosition($,n[Q]);var K=k._interactor,G=K.getStyle("checkSize"),L=function(o,h,s){var J=h.clone().sub(o).setLength(-G),m=s.clone().sub(o).setLength(-G),I=J.add(m).add(o);return I};return u.rotLT=L(u.LT,u.RT,u.LB),u.rotLB=L(u.LB,u.LT,u.RB),u.rotRB=L(u.RB,u.LB,u.RT),u.rotRT=L(u.RT,u.LT,u.RB),u.rotT=u.rotLT.clone().add(u.rotRT).divideScalar(2),u.rotB=u.rotLB.clone().add(u.rotRB).divideScalar(2),u.rotL=u.rotLT.clone().add(u.rotLB).divideScalar(2),u.rotR=u.rotRT.clone().add(u.rotRB).divideScalar(2),u.rotation=a.getRotation(),k.gatherConnectInfo(),!0}},Mc.prototype.gatherConnectInfo=function(){var J=this,L=J.target,x=J._interactor,U=J.screenInfo,w=x.gv;if(w.isConnectActionVisible(L)&&x.getStyle("connectGuideVisible")){var _;L.s&&(_=L.s("connectGuideShift")),_||(_=x.getStyle("connectGuideShift"));var H=L.getAnchor(),f=L.getSize(),R=L.toGlobal({x:f.width*(_[0]-H.x),y:f.height*(_[1]-H.y)});R=eh.toScreenPosition(w,R),U.P1?R.add(U.P2.clone().sub(U.P1).setLength(_[2])):(R.add(U.RT.clone().sub(U.LT).setLength(_[2])),R.add(U.LB.clone().sub(U.LT).setLength(_[3]))),U.connect=R}},Mc.prototype.gatherMultiTargets=function(p,P){var I=eh.Group.findOrCreateGroup(P);if(!I)return!1;var L=this;return L.editing&&"rotate"!==L.editing.mode||I.calcInfo(),L.gatherSingleTarget(p,I)},Mc.prototype.gatherLine=function(Z,K){this.target=K;var $=this.screenInfo={},I=K.getPoints(),R=eh.getDataMatrix(K);return $.P1=eh.toScreenPosition(Z,R.apply(I.get(0))),$.P2=eh.toScreenPosition(Z,R.apply(I.get(1))),this.gatherConnectInfo(),!0},Mc.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Mc.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Mc.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Mc.prototype.check=function(v,Q,C){if(w.Default.isLeftButton(Q)){var a=this;if(a.editing=null,a.tipInfo=null,a.screenInfo){var A=a.target,X=v.isEditable(A),S=a.screenInfo;if(X&&S.connect){var x=a._checkConnect(C);if(x)return x}if(S.P1)return a._checkLine(C);var s,M,V,h=null,U=a._interactor,g=U.getStyle("checkSize");if(X&&v.isRectEditable(A))for(M=0;M<eh.Rect.ResizeKeys.length;M++)if(V=eh.Rect.ResizeKeys[M],eh.checkHit(C,S[V],g)){h=V,s="resize";break}if(!h&&X&&v.isRotationEditable(A)&&!U.getStyle("rotateAsClock")){var m=U.getStyle("rotateCheckSize");for(M=0;M<eh.Rect.RotateKeys.length;M++)if(V=eh.Rect.RotateKeys[M],eh.checkHit(C,S[V],m)){h=V,s="rotate";break}}if(!h)return U.setCursor("default"),void 0;if("rotate"===s){var P,_=v.lp(Q);if(A instanceof eh.Group){var c=U.getStyle("groupRotateModeKey");"string"==typeof c&&(c=[c]);for(var J=!1,L=0,u=c.length;u>L;L++)if(Q[c[L]]){J=!0;break}var t=U.getStyle("groupRotateModeDefault");P=J?"batch"===t?"block":"batch":t}var Z="batch"===P?A.getAnchor2():A.getPosition(),k=Math.atan2(_.y-Z.y,_.x-Z.x);U._setRotateCursor(k),a.editing={mode:s,key:h,pos:Z,flipY:A.getScale().y<0,rotation:A.getRotation(),hitRot:k},P&&(a.editing.groupRotateMode=P)}else{var y=eh.Rect.ResizeKeys.indexOf(h),$=eh.Rect.ResizeDirection[y],T=Math.cos(A.getRotation()),o=Math.sin(A.getRotation()),G=$.x*Math.sign(A.getScale().x),l=$.y*Math.sign(A.getScale().y),K=Math.atan2(-o*G-T*l,T*G-o*l),r=(Math.round(K/(Math.PI/4))+8)%8,n=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][r];this._interactor.setCursor(n);var F=A.getWidth(),e=A.getHeight(),d=A.getAnchor();a.editing={mode:s,key:h,rect:{x:-F*d.x,y:-e*d.y,width:F,height:e},anchor:d,matrix:A.getMatrix()}}return h}}},Mc.prototype._checkLine=function(D){var j=this;j.screenInfo;var y,Z=j._interactor.getStyle("checkSize");if(eh.checkHit(D,j.screenInfo.P1,Z))y="P1";else{if(!eh.checkHit(D,j.screenInfo.P2,Z))return this._interactor.setCursor("default"),void 0;y="P2"}return j.editing={mode:"line",key:y},y},Mc.prototype._checkConnect=function(r){var O=this,f=O.screenInfo,k=O._interactor,b=k.getStyle("connectGuideIntersectSize"),T=f.connect,K=r.x,j=T.x;if(j>K&&b>j-K&&Math.abs(T.y-r.y)<b||K>=j&&eh.checkHit(r,T,b)){var q="connect",V=n.getConnectAction(k.gv);if(O.editing={mode:q},V&&V.delete)if(O.target instanceof eh.Group){var Z=!0;k.gv.sm().getSelection().each(function(g){V.delete.visible.call(null,k.gv,g)||(Z=!1)}),O.editing.hasDeleteAction=Z}else V.delete.visible.call(null,k.gv,O.target)&&(O.editing.hasDeleteAction=!0);return k.setCursor("default"),q}},Mc.prototype._fireEditEvent=function(i,$){var k=this._interactor,o=this.editing;if(o){var q=o.mode;q="rotate"===q?"Rotation":"connect"===q?"Connection":q[0].toUpperCase()+q.slice(1),k.fi({kind:i+"Edit"+q,event:$})}},Mc.prototype.startEdit=function(_,D){_.startDragging(D);var o=this;o._interactor.fi({kind:"prepareEdit",event:D});var V=o.editing,Z=o.target;if(V){if(o._fireEditEvent("begin",D),"rotate"===V.mode)return V.groupRotateMode&&Z.beginRotate(V),void 0;if("connect"!==V.mode)("line"===V.mode||Z&&0===Z.getRotation())&&(o._inSmartGuide=!0,o._interactor.rectGuide.gatherRects());else if(V.hasDeleteAction){var y=_.gv,C=o._interactor.getStyle("connectGuideGarbageShift");V.garbageInfo={x:y.getWidth()*C[0]+C[2],y:y.getHeight()*C[1]+C[3],size:o._interactor.getStyle("connectGuideGarbageIntersectsize")},_._42()}}},Mc.prototype._46O=function(y){var F,J,k=this,c=k.editing,G=k.target;if(c){if("connect"===c.mode&&!c.canceled&&!c.deleted)try{c.garbageInfo&&c.garbageInfo.hover?n.doDeleteConnectionAction(k._interactor.gv,G):n.doConnectAction(k._interactor.gv,G,c.target)}catch(u){console.error(u)}J=c.freezeFlag,F=k.editing.groupRotateMode,k._fireEditEvent("end",y),k.editing=null}k.tipInfo=null,k._inSmartGuide&&(k._interactor.rectGuide.clear(),k._inSmartGuide=!1),F&&G&&G.endRotate(),G instanceof w.Block&&(J===M?delete G._freezeSyncFromChildren:G._freezeSyncFromChildren=J,G.updateFromChildren())},Mc.prototype.handleNormalStateDelete=function(){var u=this,p=u.editing;if(p&&"connect"===p.mode&&!p.canceled&&!p.deleted){if(p.garbageInfo){try{n.doDeleteConnectionAction(u._interactor.gv,u.target)}catch(U){console.error(U)}p.garbageInfo=null}return p.cursorPos=null,p.targetCorners=null,p.deleted=!0,u._interactor._42(),!0}},Mc.prototype.handleNormalStateKeyDown=function(m){var g=this,J=g.editing;return!J||"connect"!==J.mode||J.canceled||J.deleted?void 0:w.Default.isEsc(m)?(J.cursorPos=null,J.targetCorners=null,J.canceled=!0,g._interactor._42(),!0):void 0},Mc.prototype.handleEdit=function(y,c){var b=this,j=b.editing;if(j){var U,f,A,h,t,K=b.target,r=j.key,i=j.mode,x=y.lp(c),M=b._interactor;if("connect"===i){if(j.canceled)return;if(j.deleted)return;j.cursorPos=M._getLogicalPoint(c);var Y=j.garbageInfo;return Y&&eh.checkHit(j.cursorPos,Y,Y.size)?(Y.hover=!0,j.target=null,j.targetCorners=null):(Y&&(Y.hover=!1),j.target=y.getDataAt(x,function(u){return y.isSelectable(u)?wc(u)?!0:!1:!1})||null,j.targetCorners=eh.getTargetCornersOnScreen(y,j.target)),M._42(),void 0}if("rotate"===i){var o,k,R=j.pos,Q=Math.atan2(x.y-R.y,x.x-R.x);if(j.groupRotateMode?k=Q-j.hitRot:(o=Q-j.hitRot,k=j.rotation+o),k%=2*Math.PI,0>k&&(k+=2*Math.PI),!w.Default.isCtrlDown(c)){var u,G;Gq(c)?(u=M.getStyle("shiftRotateRound"),G=u/2):(u=M.getStyle("rotateRound"),G=M.getStyle("rotateSensitivity")),k=eh.roundTo(k,u,G)}j.groupRotateMode?(o=k-(j.lastRotation||0),0!==o&&(K.addRotation(o,j.groupRotateMode),j.lastRotation=k)):K.setRotation(k),M._setRotateCursor(Q),k>Math.PI&&(k-=2*Math.PI);var l=180*(k/Math.PI);l=l.toFixed(2),U=""+l+""}else if("resize"===i){var $=j.rect;A=$.x,h=$.y;var p,T=$.width,P=$.height,Z=j.anchor,m=j.matrix,B=K.s&&K.s("keepAspectRatio")||M.getStyle("keepAspectRatio");Gq(c)&&(B=!B);var _=b._unionPointMode1,q=b._unionPointMode2;if(b._inSmartGuide&&!w.Default.isCtrlDown(c)&&!B){var H;"L"===r||"R"===r?H="x":("T"===r||"B"===r)&&(H="y"),b._adsorbedToClosest(x,H),t=!0}p=m.tfi(x);var L;"LT"===r?($=_(p,{x:A+T,y:h+P},T,P,B),L=9):"T"===r?($=q({x:A,y:p.y},{x:A+T,y:h+P},T,P,B,"v"),L=1):"RT"===r?($=_(p,{x:A,y:h+P},T,P,B),L=33):"L"===r?($=q({x:p.x,y:h},{x:A+T,y:h+P},T,P,B,"h"),L=8):"R"===r?($=q({x:A,y:h},{x:p.x,y:h+P},T,P,B,"h"),L=32):"LB"===r?($=_(p,{x:A+T,y:h},T,P,B),L=12):"B"===r?($=q({x:A,y:h},{x:A+T,y:p.y},T,P,B,"v"),L=4):"RB"===r&&($=_(p,{x:A,y:h},T,P,B),L=36);var g=m.tf($.x+$.width*Z.x,$.y+$.height*Z.y);K instanceof w.Block&&(j.hasOwnProperty("freezeFlag")||(j.freezeFlag=K._freezeSyncFromChildren,K._freezeSyncFromChildren=!0)),K.setPosition(g),K.setSize($.width,$.height),t&&(f=K.getRect(),M.rectGuide.gatherLines({node:K,x:f.x,y:f.y,w:f.width,h:f.height},H,L)),U=""+Math.round($.width)+" * "+Math.round($.height)}else if("line"===i){if(Gq(c)){var W=K.getPoints(),d="P1"===r?W.get(1):W.get(0),C={x:x.x-d.x,y:x.y-d.y},e=M.getStyle("shiftLineRotateRound"),X=b._shiftDirList;if(!X||b._shiftRotateRound!==e){b._shiftRotateRound=e,b._shiftDirList=X=[];for(var I=0;I<Math.PI;I+=e)X.push({x:N(I),y:s(I)})}for(var O,F=0,a=0,J=X.length;J>a;a++){var S=X[a],z=S.x*C.x+S.y*C.y;Math.abs(z)>Math.abs(F)&&(F=z,O=S)}x={x:d.x+O.x*F,y:d.y+O.y*F},M.rectGuide.clear()}else b._inSmartGuide&&!w.Default.isCtrlDown(c)&&(b._adsorbedToClosest(x),t=!0);var D=eh.getDataMatrix(K).applyInverse(x);K.setPoint("P1"===r?0:1,D,!0);var V=K.getPoints(),E=V.get(0),v=V.get(1);A=E.x-v.x,h=E.y-v.y,U=" "+Math.round(Math.sqrt(A*A+h*h))+" ",t&&(f=K.getRect(),M.rectGuide.gatherLines({node:K,x:f.x,y:f.y,w:f.width,h:f.height}))}if(U){var n=w.Default.getLogicalPoint(c,M._canvas);n.x+=eh.Icons.TipShiftX,n.y+=eh.Icons.TipShiftY,b.tipInfo={helperPos:n,text:U,size:U.length}}b._fireEditEvent("between",c)}},Mc.prototype._unionPointMode1=function(B,g,P,R,C){if(C&&P&&R){var p=B.x-g.x,L=B.y-g.y;Math.abs(p*R)<Math.abs(L*P)?(L=Math.sign(L)*Math.abs(p*R/P),B.y=g.y+L):(p=Math.sign(p)*Math.abs(L*P/R),B.x=g.x+p)}return w.Default.unionPoint(B,g)},Mc.prototype._unionPointMode2=function(r,l,d,O,k,m){var C=w.Default.unionPoint(r,l);if(k&&d&&O){var Y;"v"===m?(Y=C.x+C.width/2,C.width=d*C.height/O,C.x=Y-C.width/2):(Y=C.y+C.height/2,C.height=O*C.width/d,C.y=Y-C.height/2)}return C},Mc.prototype._adsorbedToClosest=function(R,P){var d=this,i=d._interactor,s=i.rectGuide.findClosest(R,P),V=i.gridGuide.findClosest(R,P),U=1/0,t=1/0;s&&(isFinite(s.x)&&(U=s.x),isFinite(s.y)&&(t=s.y)),V&&(isFinite(V.x)&&Math.abs(V.x)<Math.abs(U)&&(U=V.x),isFinite(V.y)&&Math.abs(V.y)<Math.abs(t)&&(t=V.y)),isFinite(U)&&(R.x+=U),isFinite(t)&&(R.y+=t)},Mc.prototype._42=function(g,O,k){var c=this;c.info={},c.screenInfo=null;var C=c._interactor;if(!C.editDetail&&c.gatherInfo(O,k)){var G=c.editing,R=G?G.groupRotateMode:null,r=c.screenInfo;if("block"!==R){if(r.P1?eh.Icons.DrawIcon(C,g,eh.Icons.Line,r):eh.Icons.DrawIcon(C,g,eh.Icons.Rect,r),r.connect&&(eh.Icons.DrawIcon(C,g,eh.Icons.ConnectGuide,{rotation:r.rotation,connect:r.connect,cursorPos:G?G.cursorPos:null}),G)){if(G.targetCorners){for(var v={x:1/0,y:1/0},V={x:-1/0,y:-1/0},z=0,Z=G.targetCorners.length;Z>z;z+=2)v.x=Math.min(v.x,G.targetCorners[z]),V.x=Math.max(V.x,G.targetCorners[z]),v.y=Math.min(v.y,G.targetCorners[z+1]),V.y=Math.max(V.y,G.targetCorners[z+1]);eh.Icons.DrawIcon(C,g,eh.Icons.HoverDataRect,{min:v,max:V,color:C.getStyle("hoverGuideColor")||C.getStyle("baseColor")})}G.garbageInfo&&eh.Icons.DrawIcon(C,g,eh.Icons.ConnectGuideGarbage,G.garbageInfo)}c.tipInfo&&eh.Icons.DrawIcon(C,g,eh.Icons.TipHelper,c.tipInfo)}c.target instanceof eh.Group&&c.target._42(C,g,O)}};var il=eh.Anchor=function(z){this.catalog="Anchor",this._interactor=z};il.prototype={},il.prototype.constructor=il,il.prototype.gatherInfo=function(C,D){var R=this;if(1===D.length){var O=D[0];if(!O.getAnchor)return;if(O instanceof w.Shape&&O._70I())return;if(Hp(O,C))return;return R.gatherSingleTarget(C,D[0])}return D.length>1?R.gatherMultiTargets(C,D):!1},il.prototype.gatherSingleTarget=function(a,n){var O=this;return O.info.POS=n.getPosition(),O.screenInfo.POS=eh.toScreenPosition(a,O.info.POS),O.target=n,!0},il.prototype.gatherMultiTargets=function(S,Q){var R=this,w=eh.Group.findOrCreateGroup(Q);return w?(R.screenInfo.POS=eh.toScreenPosition(S,w.getAnchor2()),R.target=w,!0):!1},il.prototype.isVisible=function(){var p=this,n=p._interactor;if(n.getStyle("anchorVisible")===!1)return!1;var u=p.target;if(u){if(this.editing)return!0;var A=u.getAnchor(),C=n.getStyle("anchorOutsideVisibleThreshold");if(A.x<-C||A.x>1+C||A.y<-C||A.y>1+C)return!0;var S=u.getSize(),d=u.getScale(),B=Math.min(Math.abs(S.width*d.x),Math.abs(S.height*d.y));if(B*n.gv._zoom<n.getStyle("anchorHideThreshold"))return!1}return!0},il.prototype.check=function(V,h,x){if(w.Default.isLeftButton(h)){var W=this,m=W._interactor;if(W.isVisible()&&m.getStyle("anchorMovable")!==!1){W.editing=null,W.tipInfo=null;var j=W.target;if(j&&V.isAnchorEditable(j)&&V.isEditable(j)){var I;if(W.screenInfo&&(I=W.screenInfo.POS)&&eh.checkHit(x,new eh.Math.Vector2(I),m.getStyle("checkSize"))){if(j instanceof eh.Group)return W.editing={},!0;var k=j.getWidth(),p=j.getHeight(),l=j.getAnchor();return W.editing={rect:{x:-k*l.x,y:-p*l.y,width:k,height:p},anchor:l,matrix:j.getMatrix()},!0}}}}},il.prototype.startEdit=function(J,c){J.startDragging(c),J.fi({kind:"beginEditAnchor",event:c})},il.prototype._46O=function(z){var w=this;w.editing&&(w.editing=null,w._interactor.fi({kind:"endEditAnchor",event:z})),w.tipInfo=null},il.prototype.handleEdit=function(h,$){var x=this,t=x.target;if(t){var R=x.editing;if(R){var S=h.lp($),i=x._interactor;if(t instanceof eh.Group)return t.setAnchor2(S),i._42(),void 0;var B=R.matrix,l=B.tfi(S),s=R.rect,b=(l.x-s.x)/s.width,u=(l.y-s.y)/s.height;if(!w.Default.isCtrlDown($)){var C=i.getStyle("anchorRound"),E=i.getStyle("anchorSensitivity");b=eh.roundTo(b,C,E),u=eh.roundTo(u,C,E)}t.setAnchor(b,u,!0);var Z=w.Default.getLogicalPoint($,i._canvas);Z.x+=eh.Icons.TipShiftX,Z.y+=eh.Icons.TipShiftY;var F=""+b.toFixed(2)+", "+u.toFixed(2);x.tipInfo={helperPos:Z,text:F,size:F.length},i.fi({kind:"betweenEditAnchor",event:$})}}},il.prototype._42=function(R,C,I){var c=this;c.info={},c.screenInfo={};var m=c._interactor;m.editDetail||c.gatherInfo(C,I)&&c.isVisible()&&(eh.Icons.DrawIcon(m,R,eh.Icons.Anchor,c.screenInfo),c.tipInfo&&eh.Icons.DrawIcon(m,R,eh.Icons.TipHelper,c.tipInfo))};var Ue=eh.MoveDummy=function(M){this.catalog="MoveDummy",this._interactor=M};Ue.prototype={},Ue.prototype.constructor=Ue,Ue.prototype.gatherInfo=function(){var E=this,r=this._interactor.getSubModule("Rect");if(r){var G=r.screenInfo;if(G){var u=E._interactor,_=E.getMovableTarget(r.target);if(_){var g=u.getStyle("moveDummyVisible"),$=G.LT||G.P1,F=G.RT||G.P2,L=G.LB||$;if($){var a=G.P1,M=Math.min($.distanceTo(L),$.distanceTo(F));if(!(M>g)){var h=u.getStyle("moveDummyPosition"),i=F.clone().sub($),Y=L.clone().sub($),n=h[2],K=h[3];if(a){var B=u.getStyle("moveDummyLineExtraShift");B&&(n+=B[0],K+=B[1])}var J=$.clone().add(i.clone().multiplyScalar(h[0])).add(i.setLength(n)).add(Y.clone().multiplyScalar(h[1])).add(Y.setLength(K));return E.screenInfo.pos=J,E.screenInfo.size=u.getStyle("moveDummySensitivity"),!0}}}}}},Ue.prototype.getMovableTarget=function(j){var k=this._interactor.gv;if(wc(j)){if(k.isMovable(j))return j}else if(j instanceof eh.Group)for(var Q=j._entities,o=Q.length-1;o>=0;o--){var O=Q[o];if(wc(O)&&k.isMovable(O))return O}return null},Ue.prototype.getMoveInteractor=function(){for(var H,q,Y,R=this._interactor.gv,J=R.getInteractors(),H=0,q=J.length;q>H;H++)if(Y=J.get(H),Y instanceof rc)return Y},Ue.prototype.startEdit=function(F,Z){F.startDragging(Z);var n=this.getMoveInteractor();if(n){var z=this.selectedTarget,x=F.gv;x._moving=1,n._data=z,x.handleMouseDown&&x.handleMouseDown(Z,z)}},Ue.prototype._46O=function(x){var j=this,n=j.getMoveInteractor();n&&(n.handleWindowMouseUp(x),j.selectedTarget=null)},Ue.prototype.handleEdit=function(i,t){var B=this.getMoveInteractor();B&&B.handleWindowMouseMove(t)},Ue.prototype.check=function(i,K,Y){if(this.selectedTarget=null,w.Default.isLeftButton(K)&&!i._scrolling&&!Lh()){var a=this,e=a.screenInfo.pos;if(e&&!(Y.distanceTo(e)>a.screenInfo.size)){var r=a._interactor;return a.selectedTarget=a.getMovableTarget(r.getSubModule("Rect").target),r.setCursor("default"),!0}}},Ue.prototype._42=function(V,r,b){var k=this;k.screenInfo={};var n=k._interactor;n.editDetail||k.gatherInfo(r,b)&&(!n.editing||k.selectedTarget)&&eh.Icons.DrawIcon(n,V,eh.Icons.MoveDummy,k.screenInfo)};var gr=eh.RotateX=function(M){this.catalog="RotateX",this._interactor=M};gr.prototype={},gr.prototype.constructor=gr,gr.prototype.gatherInfo=function(x,c){var P=this;if(1===c.length){var n=c[0];return n instanceof w.Shape&&n._70I()||Hp(n,x)?!1:P.gatherSingleTarget(x,n)}return c.length>1?P.gatherMultiTargets(x,c):!1},gr.prototype.gatherSingleTarget=function(){var _=new w.Math.Vector2,J=new w.Math.Vector2,T=new w.Math.Vector2,U=new w.Math.Vector2,v=function(f,s){var N=f.x-s.x,w=f.y-s.y;return N*N+w*w};return function(O,s){if(s.getCorners){var h=this,F=s.getCorners(),Z=15,Q=s.getPosition();_.copy(F[0]),T.copy(F[1]),U.copy(F[3]),J.copy(_).add(U).divideScalar(2).add(_.sub(T).setLength(Z/O.getZoom()));var n=Math.max(v(Q,F[0]),v(Q,F[1]),v(Q,F[2]),v(Q,F[3]));return h.info.POS=J.clone(),h.screenInfo.POS=eh.toScreenPosition(O,h.info.POS),h.screenInfo.LEN=Math.sqrt(n)*O.getZoom()+Z,h.screenInfo.CENTER=eh.toScreenPosition(O,Q),h.target=s,!0}}}(),gr.prototype.gatherMultiTargets=function(M,c){var W=this,C=eh.Group.findOrCreateGroup(c);if(!C)return!1;var W=this;return W.gatherSingleTarget(M,C)},gr.prototype.isVisible=function(){var n=this._interactor;if(!n.getStyle("rotateAsClock"))return!1;var w=this.target;if(!w)return!0;var z=n.gv;return z.isEditable(w)&&z.isRotationEditable(w)?!0:!1},gr.prototype.check=function(E,y,F){var o=this,i=o._checkImpl(E,y,F);return(i||o._clockPainted)&&o._interactor._42(),i},gr.prototype._checkImpl=function(i,D,S){if(w.Default.isLeftButton(D)){var F=this;F.editing=null,F.tipInfo=null;var j;if(F.screenInfo&&(j=F.screenInfo.POS)&&F.isVisible()){var J=F._interactor;if(eh.checkHit(S,j,J.getStyle("checkSize"))){var s=F.target,N=i.lp(D),V=s.getPosition(),l=Math.atan2(N.y-V.y,N.x-V.x);return J._setRotateCursor(l),F.editing={pos:V,rotation:s.getRotation(),hitRot:l,groupRotateMode:"block",screenInfo:{CENTER:F.screenInfo.CENTER,LEN:F.screenInfo.LEN}},!0}}}},gr.prototype.startEdit=function(i,M){i.startDragging(M),i.fi({kind:"beginEditRotation",event:M}),this.target instanceof eh.Group&&this.target.beginRotate(this.editing)},gr.prototype._46O=function(q){var y=this;y.editing&&(y.editing=null,y._interactor.fi({kind:"endEditRotation",event:q})),y.target instanceof eh.Group&&y.target.endRotate(),y.tipInfo=null},gr.prototype.handleEdit=function(h,p){var J=this,y=J.editing;if(y){var j,C,F=J.target,m=h.lp(p),I=J._interactor,W=y.pos,U=Math.atan2(m.y-W.y,m.x-W.x),c=F instanceof eh.Group;if(c?C=U-y.hitRot:(j=U-y.hitRot,C=y.rotation+j),C%=2*Math.PI,0>C&&(C+=2*Math.PI),!w.Default.isCtrlDown(p)){var v,x;Gq(p)?(v=I.getStyle("shiftRotateRound"),x=v/2):(v=I.getStyle("rotateRound"),x=I.getStyle("rotateSensitivity")),C=eh.roundTo(C,v,x)}c?(j=C-(y.lastRotation||0),0!==j&&(F.addRotation(j,y.groupRotateMode),y.lastRotation=C)):F.setRotation(C),I._setRotateCursor(U),C>Math.PI&&(C-=2*Math.PI);var X=180*(C/Math.PI),o=""+X.toFixed(2)+"",b=w.Default.getLogicalPoint(p,I._canvas);b.x+=eh.Icons.TipShiftX,b.y+=eh.Icons.TipShiftY,J.tipInfo={helperPos:b,text:o,size:o.length},I.fi({kind:"betweenEditRotation",event:p})}},gr.prototype._42=function(q,M,e){var E=this;E._clockPainted=!1,E.info={},E.screenInfo={};var V=E._interactor;V.editDetail||E.gatherInfo(M,e)&&E.isVisible()&&(eh.Icons.DrawIcon(V,q,eh.Icons.RoundPoint,E.screenInfo.POS),E.tipInfo&&eh.Icons.DrawIcon(V,q,eh.Icons.TipHelper,E.tipInfo),E.editing&&E.drawClock(q))},gr.prototype.drawClock=function(o){o.save();var w=this;w._clockPainted=!0;var S=w.editing||{},h=S.screenInfo||w.screenInfo,F=h.LEN,E=F+8,H=F+18;o.save(),o.translate(h.CENTER.x,h.CENTER.y),o.beginPath(),o.strokeStyle="rgb(150, 150, 150)";for(var y,f,G,X,q,r=0;360>r;r++)y=r*Math.PI/180,0===r%5&&(f=s(y)*F,G=N(y)*F,X=s(y)*E,q=N(y)*E,o.moveTo(f,G),o.lineTo(X,q)),0===r%45&&(f=s(y)*F,G=N(y)*F,X=s(y)*H,q=N(y)*H,o.moveTo(f,G),o.lineTo(X,q));o.stroke(),o.rotate(-Z);var x=S.lastRotation||w.target.getRotation();o.beginPath(),o.fillStyle="rgba(255, 0, 0, 0.1)",o.strokeStyle="rgb(157, 157, 157)",o.moveTo(0,0),o.arc(0,0,H,0,x,!1),o.fill(),o.beginPath(),o.moveTo(0+H,0),o.arc(0,0,H,0,x,!1),o.stroke(),o.restore()};var gc=eh.Curve=function(E){this.catalog="Curve",this._interactor=E};gc.prototype={},gc.prototype.constructor=gc,E.defineProperties(gc.prototype,{activing:{get:function(){return this._activing},set:function(C){var e=this;if(C)e._activing=new eh.CurveActiving(this,C);else{var k=e._activing;k&&k.dispose(),e._activing=null}}}}),gc.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},gc.prototype.setUp=function(){var L=this,k=L._interactor;k&&k.gv.mp(L._onGraphviewPropertyChanged,L)},gc.prototype._onGraphviewPropertyChanged=function(T){("zoom"===T.property||"translateX"===T.property||"translateY"===T.property)&&this._handleDataChanged()},gc.prototype.tearDown=function(){var c=this,U=c._interactor;U&&U.gv.ump(c._onGraphviewPropertyChanged,c)},gc.prototype.canEnterEditDetailMode=function(){var J=this,m=J._interactor,i=m._getValidSelection();if(1===i.length){var r=i[0],V=r instanceof w.Edge;if(r instanceof w.Shape||V){if(V){var e=r.s("edge.type");if(e&&"points"!==e)return}var q=m.gv;if(q.isPointEditable(r)&&q.isEditable(r))return J.target=r,!0}}},gc.prototype.canQuitEditDetailMode=function(T){var I=this,N=I._interactor._getLogicalPoint(T);return I._checkEditRealPoint(N)?void 0:I._interactor.gv.getDataAt(T)!==I.target?!0:void 0},gc.prototype.preHandleScroll=function(){var c=this.editing;return c&&c.inEdit?!0:void 0},gc.prototype.getCurrentSelectintStatus=function(){var q=this;if(q.activing&&!q.activing.selections){if(q.activing.status!=M)return q.activing.status;var T=function(b){var R=q.activing.status;q.activing.status=b,q._interactor.fp("shapePointStatus",R,b)},E=eh.Curve.PointType,B=q.activing.point,t=q.activing.pairs;if(!t||1!==t.length)return T(E.Mirrored);var F=t[0],o=F.c1&&F.c1.isNearEnough(B),K=F.c2&&F.c2.isNearEnough(B);if(!F.c1||!F.c2)return o||K?T(E.Straight):T(E.Disconnected);if(o&&K)return T(E.Straight);if(o||K)return T(E.Asymmetric);var i=F.c1.clone().sub(B),J=F.c2.clone().sub(B);return Math.abs(i.x*J.y-i.y*J.x)>1e-5||i.x*J.x>0?T(E.Disconnected):Math.abs(i.length()-J.length())>1e-5?T(E.Asymmetric):T(E.Mirrored)}},gc.prototype.handle_keydown=function(X){var Q=this;if(Q._interactor.editDetail){var Z=eh.Curve.PointType;"1"===X.key?Q._setCurrentSelectionStatus(Z.Straight):"2"===X.key?Q._setCurrentSelectionStatus(Z.Mirrored):"3"===X.key?Q._setCurrentSelectionStatus(Z.Disconnected):"4"===X.key&&Q._setCurrentSelectionStatus(Z.Asymmetric)}},gc.prototype.setCurrentSelectionStatus=function(V){var A=this,K=A._interactor;if(K){var g=K.gv;g.dm().beginTransaction(),this._setCurrentSelectionStatus(V),g.dm().endTransaction()}},gc.prototype._setCurrentSelectionStatus=function(m){var F=this,j=F.activing;if(j){var K=F.getCurrentSelectintStatus();if(null!==K&&K!==m){j.status=m;var U=F.activing.point,Z=F.activing.pairs;if(Z&&1===Z.length){var p=Z[0],J=F.screenInfo.curve,I=eh.Curve.PointType,W=function(){F._writeToHt(),F._interactor.fp("shapePointStatus",K,m)};if(m===I.Straight)return J.moveCtrlPoint(p,U,"c1"),J.moveCtrlPoint(p,U,"c2"),W(),void 0;if(K===I.Straight){var D=J.findPairs(U,!0),u=D[0],l=u.r1||U,Y=u.r2||U,h=Y.clone().sub(l).multiplyScalar(.25);return J.moveCtrlPoint(p,U.clone().sub(h),"c1"),J.moveCtrlPoint(p,U.clone().add(h),"c2"),W(),void 0}var V=p.c1,C=p.c2;if(V&&C){if(m===I.Mirrored)return J.moveCtrlPoint(p,U.clone().multiplyScalar(2).sub(C),"c1"),W(),void 0;if(m===I.Asymmetric&&K===I.Disconnected){var O=V.clone().sub(U).length(),h=U.clone().sub(C).setLength(O).add(U);return J.moveCtrlPoint(p,h,"c1"),W(),void 0
}}j._firePointChange(),F._interactor.fp("shapePointStatus",K,m)}}}},gc.prototype._handleDataChanged=function(){var P="points,segments,shape,position,rotation,scale".split(",");return function(O){var j=this;if(j.screenInfo&&j.target){if(O&&P.indexOf(O.property)<0)return;var N=j._interactor;j.gatherSingleTarget(N.gv,j.target,!0),j.check(N.gv,null,new eh.Math.Vector2(N._lastClientPoint)),N._42()}}}(),gc.prototype.gatherSingleTarget=function(z,k,C){var A,I,R=this;R.screenInfo&&R.screenInfo.curve&&(I=R.screenInfo.curve._curves);var s=R.editing;A=s?R.screenInfo:R.screenInfo={};var g,U,S=k instanceof w.Edge;S?(g=k.s("edge.segments"),U=k.s("edge.points")||new w.List):(g=k._58O,U=k._59O),A.S=g;var J,u=A.P=[],p=eh.getDataMatrix(k);if(k instanceof w.Polyline&&(J=k.getElevation()||0,A.E=[]),U.each(function(U){A.E&&A.E.push(U.e||J),U=p.apply(U);var w=eh.toScreenPosition(z,U);u.push(w.x,w.y)}),S){var Z=eh.toScreenPosition(z,k._lastSourcePoint),Q=eh.toScreenPosition(z,k._lastTargetPoint);u.splice(0,0,Z.x,Z.y),u.push(Q.x,Q.y)}if(!A.S||!A.S.size()){A.S=new w.List,A.S.add(1);for(var X=0;X<u.length/2-1;X++)A.S.add(2)}if((!s||C)&&R.convertToCubicBezier(I),R.activing&&(C||!R.editing||"realPoint"===R.editing.type)){var h=A.curve.findPairs(R.activing.point);R.activing.pairs=h}S&&"points"!==k.s("edge.type")&&R._writeToHt()},gc.prototype._convertToNewPoint=function(m,O,F){var $,G,M;for($=0,G=O.length;G>$;$++){if(M=O[$],M._p1.isNearEnough(m))return M._p1;if(M._p4.isNearEnough(m))return M._p4}if(F)for($=0,G=Math.min(F.length,G);G>$;$++){if(M=F[$],M._p1===m)return O[$]._p1;if(M._p4===m)return O[$]._p4}},gc.prototype.convertToCubicBezier=function(V){var d,K,f=this,J=new eh.Math.Curve,M=f.screenInfo;if(J.createFromHtShape(M.P,M.S,M.E),M.curve=J,f.activing){var k=J._curves;if(d=f.activing.point,K=f._convertToNewPoint(d,k,V),K&&(f.activing.point=K),f.activing.selections){var X=-1,m=f.activing.selections;m.forEach(function(n){X++,K=f._convertToNewPoint(n,k,V),K&&(m[X]=K)})}}},gc.prototype.check=function(O,k,U){if(!k||Qk(k)||Zf(k)){var i=this;if(i._interactor.setCursor("default"),i.editing=null,i.highlight=null,i.tipInfo=null,i.edgeEditResult=null,i.screenInfo){if(Lh()||Zf(k))return i._interactor._42(),!0;if(i._checkEditCtrlPoint(U))return i._interactor._42(),!0;if(i._checkEditRealPoint(U))return i._interactor._42(),!0;if(i._checkEditElevation(U))return i._interactor._42(),!0;var q=i.screenInfo.curve,F=q.checkPoint(U,i._interactor.getStyle("curveIntersectSize"));if(F){var K=i.highlight={};K.type="insertKnot",K.bezier=F.bezier,K.point=F.intersection}return i._interactor._42(),!0}}},gc.prototype._checkEditRealPoint=function(b){var t,w,d,k,Y,u,S=this,H=S.screenInfo.curve._curves,q=S._interactor.getStyle("curvePointIntersectSize"),o=1/0;for(q*=q,d=0,k=H.length;k>d;d++)t=H[d],Y=t._p1,u=b.distanceToSquared(Y),o>u&&(o=u,w=Y),Y=t._p4,u=b.distanceToSquared(Y),o>u&&(o=u,w=Y);if(o>q)return!1;var A=S.highlight={};return A.type="changeRealPoint",A.point=w,S.editing={type:"realPoint",point:w,shiftGuide:{point:w.clone(),dir:"x",limit:0}},S._interactor.setCursor("crosshair"),!0},gc.prototype._checkEditElevation=function(j){var i=this;if(!i._interactor.getStyle("curveElevationVisible"))return!1;var A=i.activing;if(!A)return!1;var H=A.getCurrentEditingPoint();if(!H)return!1;var L=i._interactor,I=L.getStyle("curveElevationGuideShift"),w=L.getStyle("curveElevationIntersectSize"),N=j.distanceToSquared({x:H.x+I[0],y:H.y+I[1]});if(!(N>w*w)){var p=i.highlight={};p.type="elevation";var F=new eh.Math.Vector2(j.x,j.y,H.e);return i.editing={type:"elevation",startPoint:F},i._interactor.setCursor("crosshair"),!0}},gc.prototype._checkEditCtrlPoint=function(b){var C=this;if(C.activing&&!C.activing.selections){var O=C.getCurrentSelectintStatus();if(O!==eh.Curve.PointType.Straight){var I=C.activing.pairs;if(I){var a=C._interactor.getStyle("curvePointIntersectSize");a*=a;var s,M,z,d,F,L,c,v,T,E=1/0;for(c=0,T=I.length;T>c;c++)for(d=I[c],v=0;2>v;v++)F=0===v?"c1":"c2",d[F]&&(L=b.distanceToSquared(d[F]),E>L&&(E=L,s=d,M=c,z=F));if(E>a)return!1;C.activing.hlpair=s,C.activing.hltype=z;var P=C.highlight={};return P.type="changeCtrlPoint",P.point=s[z],C.editing={type:"ctrlPoint",pair:s,pairId:M,ctrlType:z,direction:s[z].clone().sub(C.activing.point).normalize()},C._interactor.setCursor("crosshair"),!0}}}},gc.prototype.startEdit=function(b,v){b.startDragging(v);var y=this;y.highlight&&"insertKnot"===y.highlight.type&&(y.insertKnot(),y.gatherSingleTarget(y._interactor.gv,y.target),y.activing=null,y._checkEditRealPoint(y._interactor._getLogicalPoint(v)));var z=y._activing;if(z){var P=y.editing?y.editing.type:null;"ctrlPoint"===P?z.editingCtrl={pairId:y.editing.pairId,type:z.hltype}:"realPoint"===P&&(z.editingCtrl=!1)}var T=y.highlight,O=w.Default.isCtrlDown(v);if(!T||Lh()||Zf(v)){var J=y._interactor.gv;if(!J.setFocus(v)||J._scrolling)return;return O?y._multiSelect={startPoint:J.lp(v)}:J.isPannable()&&(Qk(v)||Zf(v))&&(y._pan={tx:J.tx(),ty:J.ty()},b.fi({kind:"beginPan",event:v})),void 0}if("changeRealPoint"===T.type){var A,B=y.activing?y.activing.point:null,g=y.activing?y.activing.selections:null;if(O&&y.activing)B===T.point?(g?(y.activing={point:g[0]},g.length>1&&(g.splice(0,1),y.activing.selections=g)):y.activing=null,y.editing=null):g&&(A=g.indexOf(T.point))>=0?(g.length>1?g.splice(A,1):delete y.activing.selections,y.editing=null):g?(g.push(B),y.activing={point:T.point,selections:g}):y.activing={point:T.point,selections:[B]};else if(g)B===T.point||((A=g.indexOf(T.point))>=0?(g.splice(A,1,B),y.activing={point:T.point,selections:g}):y.activing={point:T.point});else{var V;B===T.point&&(V=y.activing.status),y.activing={point:T.point},V&&(y.activing.status=V)}b.fi({kind:"beginEditPoint",event:v})}},gc.prototype.insertKnot=function(){var a=this,K=a.highlight,q=a.screenInfo.curve;q.insertKnot(K.bezier,K.point.t),a._writeToHt()},gc.prototype._writeToHt=function(){var e,K,v,C,y=this,S=y.screenInfo.curve,B=S.toHtShape(),X=B.points,s=[],V=B.segments,i=y._interactor.gv,f=y.target,m=f instanceof w.Edge,j=eh.getDataMatrix(f).invert();C=f instanceof w.Polyline,C&&(v=f.getElevation());for(var Q=0,A=X.length;A>Q;Q++)e=X[Q],K=eh.toWorldPosition(i,e),K=j.apply(K),e.e!=M&&e.e!==v&&(K.e=e.e),s.push(K);if(f._writing=!0,m){f.s("edge.type","points"),f.setStyle("edge.segments",V),f.setStyle("edge.points",s.slice(1,s.length-1)),f.setStyle("edge.source.offset.x",0),f.setStyle("edge.source.offset.y",0),f.setStyle("edge.target.offset.x",0),f.setStyle("edge.target.offset.y",0);var O=y._nextChangeEdgeHost;delete y._nextChangeEdgeHost,O&&("source"===O.type?f.setSource(O.host):f.setTarget(O.host)),y._writeEdgeHostAnchor("source",s[0]),y._writeEdgeHostAnchor("target",s[s.length-1])}else s.length?(f.setSegments(V),f.setPoints(s,!0)):f.removeFromDataModel();delete f._writing},gc.prototype._writeEdgeHostAnchor=function(d,L){var p=this,Z=p.target,D=p._calcHostAnchor(Z,d,L);D.index!==M?(Z.setStyle("edge."+d+".index",D.index),Z.setStyle("edge."+d+".percent",M),Z.setStyle("edge."+d+".anchor.x",M),Z.setStyle("edge."+d+".anchor.y",M)):D.percent!==M?(Z.setStyle("edge."+d+".percent",D.percent),Z.setStyle("edge."+d+".index",M),Z.setStyle("edge."+d+".anchor.x",M),Z.setStyle("edge."+d+".anchor.y",M)):(Z.s("edge."+d+".anchor.x",D.x),Z.s("edge."+d+".anchor.y",D.y),D.offsetX||D.offsetY?(Z.s("edge."+d+".offset.x",D.offsetX),Z.s("edge."+d+".offset.y",D.offsetY)):(Z.s("edge."+d+".offset.x",0),Z.s("edge."+d+".offset.y",0)))},gc.prototype._calcHostAnchor=function(i,Y,d,I){I||(I="source"===Y?i.getSource():i.getTarget());var b=this._interactor.gv,B=b.calculateAttachPoint(I,d);if(B)return B.info;if(wj(I)){var e=b.calculateEdgePosition(I,d);return e}var U=I.getRotation(),q=I.getAnchor();if(Hp(I,b)&&(U=0),U){var F=I.getMatrix(),k=F.tfi(d),s=I.getSize();return{x:k.x/s.width+q.x,y:k.y/s.height+q.y}}var Q=rn(b,I),j={x:(d.x-Q.x)/Q.width,y:(d.y-Q.y)/Q.height};return j},gc.prototype._handlePanning=function(Z){var N=this,e=N._pan;if(e){e.started=!0;var X=N._interactor,R=X.gv,k=X._lastClientPoint,z=Ac(Z),Q=aj(R,z,k);R.setTranslate(e.tx+Q.x,e.ty+Q.y),N.gatherSingleTarget(X.gv,N.target),X._42(),X.fi({kind:"betweenPan",event:Z})}},gc.prototype.handleEdit=function(R,K){var N=this,j=N.editing;if(N._pan)return N._handlePanning(K),void 0;if(N._multiSelect)return N._multiSelect.endPoint=R.lp(K),N._interactor.redraw(),void 0;if(j){j.inEdit=!0;var i,v,Z,u=N._interactor._getLogicalPoint(K),h=w.Default.isCtrlDown(K),k=w.Default.isShiftDown(K),J=j.type,_=N.activing;if(N._guideInfo=null,"ctrlPoint"===J&&k){var V=N.editing.direction.clone();i=_.point;var Q=V.dot(u.clone().sub(i));u=V.setLength(Q).add(i)}else if("ctrlPoint"===J||"realPoint"===J){var V;if("realPoint"===J&&k){var x=N.editing.shiftGuide;v=x.point;var c=Math.abs(u.x-v.x),H=Math.abs(u.y-v.y);c>H&&c>x.limit&&"y"===x.dir&&(x.dir="x"),H>c&&H>x.limit&&"x"===x.dir&&(x.dir="y"),V=x.dir,"x"===V?(u.y=v.y,x.limit=Math.max(x.limit,c)):"y"===V&&(u.x=v.x,x.limit=Math.max(x.limit,H))}var S=N._isEditEdgeSourceTarget();if(S){var q=N._editEdgeSourceTarget(S,u,h);q&&(N.edgeEditResult=q,Z=q.tipText)}else if(!h){var F=N._guidingToEdit(u,V),t="realPoint"===J?N._interactor.gridGuide.findClosest(u,V,!0):null,g=1/0,m=1/0;t&&(t.x&&(g=t.x),t.y&&(m=t.y));var L=!1;F&&(F.xList&&(Math.abs(F.x)<=Math.abs(g)?(L=!0,g=F.x):delete F.xList),F.yList&&(Math.abs(F.y)<=Math.abs(m)?(L=!0,m=F.y):delete F.yList),L&&(N._guideInfo=F)),isFinite(g)&&(u.x+=g),isFinite(m)&&(u.y+=m),L&&(F.v=u)}}var r=N.screenInfo.curve;if("realPoint"===j.type){i=j.point,i.e!==M&&(u.e=i.e),r.moveRealPoint(i,u),j.point=u,N.highlight.point=u;var B=_.status,X=_.selections;if(N.activing={point:u,status:B},X){var P=u.clone().sub(i),e=0;X.forEach(function($){var I=$.clone().add(P);r.moveRealPoint($,I),X[e++]=I}),N.activing.selections=X}}else if("ctrlPoint"===j.type){var Y=_.pairs,l=Y[j.pairId];r.moveCtrlPoint(l,u,j.ctrlType);var o=_.status,a=eh.Curve.PointType;if((o===a.Mirrored||o===a.Asymmetric)&&l.c1&&l.c2){var i=new eh.Math.Vector2(_.point),n="c1"===j.ctrlType?"c2":"c1";if(o===eh.Curve.PointType.Mirrored)r.moveCtrlPoint(l,i.clone().multiplyScalar(2).sub(u),n);else if(o===a.Asymmetric){var Q=l[n].clone().sub(i).length(),E=i.clone().sub(l[j.ctrlType]).setLength(Q).add(i);isNaN(E.x)||r.moveCtrlPoint(l,E,n)}}_._firePointChange()}else if("elevation"===j.type){v=j.startPoint;var C=v.e+(v.y-u.y)/R._zoom;N._setCurrentPointImpl("e",C),_._firePointChange(),Z="E: "+eh.toFixed(C)}var D=w.Default.getLogicalPoint(K,N._interactor._canvas);if(D.x+=eh.Icons.TipShiftX,D.y+=eh.Icons.TipShiftY,!Z){var U=eh.toWorldPosition(R,u);Z=""+eh.toFixed(U.x)+", "+eh.toFixed(U.y)}N.tipInfo={helperPos:D,text:Z,size:Z.length},N._writeToHt(),N._interactor.fi({kind:"betweenEditPoint",event:K})}},gc.prototype._setCurrentPointImpl=function(e,i){var C=this,l=C._activing;if(!l)return!1;var H=C.target;if(!H)return!1;var k=l.getCurrentEditingPoint();if(!k)return!1;var x=l.editingCtrl;if(!x)var a=k.clone();if("e"===e)k.e=i;else{var p;if("x"===e||"y"===e){var u=l._lastFirePoint;p="x"===e?{x:i,y:u?u.y:0}:{x:u?u.x:0,y:i}}else"object"==typeof e?(p=e,e.e!==M&&(k.e=e.e)):(p={x:arguments[0],y:arguments[1]},arguments[2]!==M&&(k.e=arguments[2]));var P=eh.getDataMatrix(H);p=eh.toScreenPosition(C._interactor.gv,P.apply(p)),k.x=p.x,k.y=p.y}if(!x){var j=a.multiplyScalar(-1).add(k);k.e&&a.e&&(j.e=k.e-a.e),C.screenInfo.curve.moveCtrlDueToRealPointMovement(k,j)}return!0},gc.prototype.setCurrentPoint=function(Z,V){return this._setCurrentPointImpl(Z,V)?(this._writeToHt(),!0):!1},gc.prototype._isEditEdgeSourceTarget=function(){var U=this,H=U.target;if(!(H instanceof w.Edge))return!1;var p=U.editing.point,y=U.screenInfo.curve._curves;return p===y[0]._p1?"source":p===y[y.length-1]._p4?"target":!1},gc.prototype._editEdgeSourceTarget=function(e,b,C){var R,F=this,w=F.target;if(R="source"===e?w.getSource():w.getTarget()){var T,Y=F._interactor.gv,y=eh.toWorldPosition(Y,b),_=F._calcHostAnchor(w,e,y,R);if(T=_.index!==M||_.percent!==M?_.distance*Y.getZoom()>F._interactor.getStyle("edgeHostEdgeMaxDistance"):F._interactor.getStyle("edgeHostDetectPerFrame")?!0:_.x<0||_.x>1||_.y<0||_.y>1?!0:!1){var I=Y.getDataAt(y,function(h){return Y.isSelectable(h)?h===R?!1:w.canSetSourceTarget(h,e)?!0:!1:!1});if(I){var B=F._calcHostAnchor(w,e,y,I);R=I,F._nextChangeEdgeHost={type:e,host:I},_=B}}var x,G,J;if(C||_.x===M)(_.percent!==M||_.index!==M)&&(G=_.point);else{var c=F._interactor.getStyle("anchorRound"),Q=F._interactor.getStyle("anchorSensitivity");x=Y.calculateAttachPoint(R,y),x?_=x.info:(_.x=eh.roundTo(_.x,c,Q),_.y=eh.roundTo(_.y,c,Q)),G=R.getAttachPosition(_.x,_.y,_.offsetX,_.offsetY)}G&&(J=eh.toScreenPosition(Y,G),b.x=J.x,b.y=J.y),F._edgeHostGuideInfo={corners:eh.getTargetCornersOnScreen(Y,R),attach:x?x.index:-1,host:R};var m;return _.percent!==M?m="percent: "+_.percent.toFixed(2):_.index!==M?m="index: "+_.index:(m=""+_.x.toFixed(2)+", "+_.y.toFixed(2),(_.offsetX||_.offsetY)&&(m+=" offset: "+_.offsetX.toFixed(2)+", "+_.offsetY.toFixed(2))),{host:R,anchor:_,tipText:m}}},gc.prototype._guidingToEdit=function(_,O){var A,Y,R=this;if(A=R.screenInfo.curve){Y=A._curves;var q,G,p,r,u,j,a,C,I=1/0,g=1/0,B=[];for(R.editing&&"realPoint"===R.editing.type&&(C=R.editing.point),u=0,j=2*Y.length;j>u;u++)a=Y[Math.floor(u/2)][u%2?"_p4":"_p1"],B.indexOf(a)>=0||(B.push(a),C&&C===a||(p=a.x-_.x,r=a.y-_.y,Math.abs(p)<Math.abs(I)?(I=p,q=[a]):p===I&&q.push(a),Math.abs(r)<Math.abs(g)?(g=r,G=[a]):r===g&&G.push(a)));var D=R._interactor.getStyle("smartGuideSensitivity");if((Math.abs(I)>D||"y"===O)&&(q=null),(Math.abs(g)>D||"x"===O)&&(G=null),q||G){var F=!1,m={};if(q&&(F=!0,m.xList=q,m.x=I),G&&(F=!0,m.yList=G,m.y=g),F)return m}}},gc.prototype._46O=function(z){var Z=this;Z.editing&&(Z.editing=null,Z._interactor.fi({kind:"endEditPoint",event:z})),Z._guideInfo=null,Z._edgeHostGuideInfo=null,Z._pan&&(Z._pan=null,Z._interactor.fi({kind:"endPan",event:z})),Z._multiSelect&&(Z._handleMultiSelect(Z._multiSelect),Z._multiSelect=null),Z.tipInfo=null,Z.edgeEditResult=null},gc.prototype._handleMultiSelect=function(z){if(z.startPoint&&z.endPoint){var i,B,K,x,h,l=this,v=l._interactor,C=v.gv,f=eh.toScreenPosition(C,z.startPoint),F=eh.toScreenPosition(C,z.endPoint),$=w.Default.unionPoint(f,F),y=l.screenInfo.curve._curves,a=[],e=function(L){L.x>=$.x&&L.y>=$.y&&L.x<=$.x+$.width&&L.y<=$.y+$.height&&a.indexOf(L)<0&&a.push(L)};for(i=0,B=y.length;B>i;i++)h=y[i],e(h._p1),e(h._p4);if(a.length){var u=l.activing||{},W=u.selections||[];for(u.point&&W.push(u.point),i=0,B=W.length;B>i;i++)K=W[i],x=a.indexOf(K),x>=0?a[x]=M:a.push(K);var j=a;for(a=[],i=0,B=j.length;B>i;i++)j[i]&&a.push(j[i]);B=a.length,0===B?l.activing=null:1===B?l.activing={point:a[0]}:(K=a[B-1],l.activing={point:K,selections:a.splice(0,B-1)}),v.redraw()}}},gc.prototype._canDeletePoint=function(h,H){var G=this.target;if(!(G instanceof w.Edge))return!0;var I=h._curves[0],P=h._curves[h._curves.length-1];return I._p1===H||P._p4===H?!1:!0},gc.prototype.handleDelete=function(){var V=this;if(V.activing&&V.screenInfo){var i=w.Default.isShiftDown(),o=V.screenInfo.curve;V._canDeletePoint(o,V.activing.point)&&o.deleteRealPoint(V.activing.point,i),V.activing.selections&&V.activing.selections.forEach(function(z){V._canDeletePoint(o,z)&&o.deleteRealPoint(z,i)}),V.activing=null,delete V.editing,delete V.tipInfo,delete V.edgeEditResult,delete V._pan,delete V._multiSelect,V._writeToHt(),V._interactor.fp("deleteShapePoint",!1,!0)}},gc.prototype.handleDoubleClick=function(U){var G=this,Q=G._interactor._getLogicalPoint(U);if(G.screenInfo&&G._checkEditRealPoint(Q)){var q=G.getCurrentSelectintStatus(),f=eh.Curve.PointType;return q=q===f.Mirrored?f.Straight:f.Mirrored,G._setCurrentSelectionStatus(q),G._interactor._42(),!0}},gc.prototype._drawHighlight=function(q){var R=this,$=R.highlight;if($){var v=$.bezier,M=R._interactor;v&&eh.Icons.DrawIcon(M,q,eh.Icons.ShapeHighlightCurve,[v._p1.x,v._p1.y,v._p2.x,v._p2.y,v._p3.x,v._p3.y,v._p4.x,v._p4.y]);var x=$.point;x&&"insertKnot"===$.type&&eh.Icons.DrawIcon(M,q,eh.Icons.ShapeHighlighPoint,x)}},gc.prototype._drawGuide=function(n){var L=this,C=L._guideInfo;if(C){var b,c,Q,j,K=C.v;for(b=0;2>b;b++)if(j=0===b?C.xList:C.yList)for(c=0,Q=j.length;Q>c;c++)eh.Icons.DrawIcon(L._interactor,n,eh.Icons.ShapeGuideLine,[K.x,K.y,j[c].x,j[c].y])}},gc.prototype._drawCurrentPoint=function(i){var z=this;if(z.activing){var E=z.activing,F=z.getCurrentSelectintStatus(),n=z._interactor;if(F!==eh.Curve.PointType.Straight){var u=E.pairs;E.hlpair,E.hltype;var x=E.selections,Y=E.editingCtrl;if(u&&!x){var Q,y,N;for(y=0,N=u.length;N>y;y++)Q=u[y],Y&&y===Y.pairId&&Q[Y.type]?eh.Icons.DrawIcon(n,i,eh.Icons.ShapeActivingCtrl,{point:Q.point,c1:Q.c1,c2:Q.c2,hl:Y.type}):eh.Icons.DrawIcon(n,i,eh.Icons.ShapeActivingCtrl,Q)}}eh.Icons.DrawIcon(n,i,eh.Icons.ShapeHighlighRealPoint,z.activing.point),x&&x.forEach(function(P){eh.Icons.DrawIcon(n,i,eh.Icons.ShapeHighlighRealPoint,P)})}},gc.prototype.clear=function(){var M=this;M.editing=null,M._guideInfo=null,M.activing=null,M.highlight=null},gc.prototype._42=function(X){var E=this;E.info={},E.editing||(E.screenInfo=null);var U=E._interactor;if(!U.editDetail)return E.clear(),void 0;var Y=U.gv;if(!E.target||!Y.isSelected(E.target)||!Y.isVisible(E.target))return U.editDetail=!1,E.clear(),void 0;if(E.gatherSingleTarget(Y,E.target),eh.Icons.DrawIcon(U,X,eh.Icons.ShapeBgCurve,E.screenInfo),E._drawHighlight(X),E._drawCurrentPoint(X),E._getRealPoint().forEach(function(t){eh.Icons.DrawIcon(U,X,eh.Icons.ShapePoint,t)}),E._drawGuide(X),E.tipInfo&&eh.Icons.DrawIcon(U,X,eh.Icons.TipHelper,E.tipInfo),E._edgeHostGuideInfo){eh.Icons.DrawIcon(U,X,eh.Icons.NodeHoverGuide,E._edgeHostGuideInfo.corners);var t=E._edgeHostGuideInfo.host;if(t){var O=Y.getAttachPoints(t);if(O&&O.length)for(var n=0,P=O.length;P>n;n++){var N=O[n],r=t.getAttachPosition(N.x,N.y,N.offsetX,N.offsetY);r=eh.toScreenPosition(Y,r),r.isAttach=E._edgeHostGuideInfo.attach===n,eh.Icons.DrawIcon(U,X,eh.Icons.AttachPoint,r)}}}if(E._interactor.getStyle("curveElevationVisible")&&E.target instanceof w.Polyline&&E.activing){var L=E.activing.getCurrentEditingPoint();L&&eh.Icons.DrawIcon(U,X,eh.Icons.EdgeElevationGuide,L)}if(E.edgeEditResult&&E._drawEdgeHostHighlight(X,E.edgeEditResult.host,E.edgeEditResult.anchor),E._multiSelect&&E._multiSelect.endPoint){var v=w.Default.unionPoint(eh.toScreenPosition(Y,E._multiSelect.startPoint),eh.toScreenPosition(Y,E._multiSelect.endPoint));v.color=Y.getRectSelectBorderColor(),X.save(),X.setTransform(1,0,0,1,0,0);var I=i.devicePixelRatio,B=v.borderWidth=Math.round(I);B/=2,v.x=Math.round(v.x*I)+B,v.y=Math.round(v.y*I)+B,v.width=Math.round(v.width*I),v.height=Math.round(v.height*I),eh.Icons.DrawIcon(U,X,eh.Icons.SimpleRect,v),X.restore()}},gc.prototype._drawEdgeHostHighlight=function(P,c,n){this.drawEdgeHostHighlight(P,c,n),this._interactor.redraw()},gc.prototype.drawEdgeHostHighlight=function(E,K,D){if(wj(K)){var z,X,d,r,y=this,J=y._interactor,Y=J.gv,t=Y.getDataUI(K),H=_r(t),_=[];for(d=0,r=H.points.length;r>d;d++)X=eh.toScreenPosition(Y,H.points.get(d)),_.push(X.x,X.y);H.segments&&(z=H.segments.toArray());var o=J.getStyle("edgeHostHighlighPeriod"),b=J.getStyle("edgeHostEdgeHighlighColor");eh.Icons.DrawIcon(J,E,eh.Icons.ShapeBgCurve,{P:_,S:z,color:b,dynamicVisible:D.index===M,dynamicPeriod:o}),b=J.getStyle("edgeHostPointHighlighColor");var s=Vi(t);for(d=0,r=s.length;r>d;d++){var T=s[d],m=eh.toScreenPosition(Y,T);eh.Icons.DrawIcon(J,E,eh.Icons.ShapePoint,{point:{x:m.x,y:m.y},color:b,size:12,dynamicVisible:d===D.index,dynamicPeriod:o})}}},gc.prototype._getRealPoint=function(){var U,y=this.screenInfo,u=y.P,O=y.S,J=-1,h=[],Q=-1,A=O.length;return O.each(function(i){Q++;var M=1;if(3===i)M=2;else if(4===i)M=3;else if(5===i)return;J+=M,U=Q+1>=A?!0:1===O.get(Q+1)?!0:!1,h.push({point:{x:u[2*J],y:u[2*J+1]},segmentIndex:Q,pointIndex:J,isEnd:U})}),h},gc.prototype.getEditingPointsInfo=function(g){var h=this,o=h.activing;if(!o)return!1;var p=o.point;if(!p)return!1;var U=this._getRealPoint(),x=[{screen:p}];o.selections&&o.selections.forEach(function(L){x.push({screen:L})});var M,l,W=U.length;return x.forEach(function(N){for(M=0;W>M;M++)if(l=U[M],N.screen.isNearEnough(l.point)){N.segmentIndex=l.segmentIndex,N.pointIndex=l.pointIndex,N.point=h.target.getPoints().get(l.pointIndex);break}}),g&&x.sort(function(a,F){return a.segmentIndex-F.segmentIndex}),x};var Ki=eh.MoveHelper=function(N){var x=this;x.catalog="Move",x._interactor=N};Ki.prototype={},Ki.prototype.constructor=Ki,Ki.prototype.calcShift=function(b,f,s){var S,M,u=this,E=u._interactor.gv,U=E.lp(f);if("beginMove"===b&&u._gatherGridInfo(s._lastLogicalPoint||U),S=u._target){var g=S.downPosition;if(g){var T=u._interactor.getStyle("moveSensitivity")/E._zoom;if(g.distanceTo(U)<T)return{x:0,y:0};delete S.downPosition}var c;M=w.Default.isShiftDown(f),M&&(U=u._dealShiftDown(U),c=S.shiftGuide.dir);var $,L=S.rawPos={x:S.pos.x+U.x-S.lp.x,y:S.pos.y+U.y-S.lp.y};if(w.Default.isCtrlDown(f)){if($=u._calcShiftByAddon(),u._target.node instanceof eh.Group){var W=u._target.node;W._position.x+=$.x,W._position.y+=$.y}return $}for(var z,n=S.x+L.x,j=S.y+L.y,R={x:n,y:j},Y={x:n+S.w/2,y:j+S.h/2},J={x:n+S.w,y:j+S.h},l=u._interactor.rectGuide,k=u._interactor.gridGuide,p=[l.findClosest(R,c),l.findClosest(Y,c),l.findClosest(J,c),k.findClosest(R,c),k.findClosest(Y,c),k.findClosest(J,c)],X=1/0,B=1/0,K=0,V=p.length;V>K;K++)z=p[K],z&&(n=z.x,j=z.y,isFinite(n)&&Math.abs(n)<Math.abs(X)&&(X=n),isFinite(j)&&Math.abs(j)<Math.abs(B)&&(B=j));if(isFinite(X)||(X=0),isFinite(B)||(B=0),$=u._calcShiftByAddon(X,B),u._target.node instanceof eh.Group){var W=u._target.node;W._position.x+=$.x,W._position.y+=$.y}var e=S.node;if(!Hp(e,E)){var d=L.x+X,q=L.y+B;u._interactor.rectGuide.gatherLines({node:e,x:S.x+d,y:S.y+q,w:S.w,h:S.h},c)}return $}},Ki.prototype._calcShiftByAddon=function(K,c){var J=this._target,p=J.rawPos,O=J.node.getPosition();return K=K||0,c=c||0,{x:p.x-O.x+K,y:p.y-O.y+c}},Ki.prototype._dealShiftDown=function(c){var L=this,l=L._target.shiftGuide,I=L._target.lp,K=Math.abs(c.x-I.x),Q=Math.abs(c.y-I.y);K>Q&&K>l.limit&&"y"===l.dir&&(l.dir="x"),Q>K&&Q>l.limit&&"x"===l.dir&&(l.dir="y");var g=l.dir;return"x"===g?(c.y=I.y,l.limit=Math.max(l.limit,K)):"y"===g&&(c.x=I.x,l.limit=Math.max(l.limit,Q)),c},Ki.prototype._gatherGridInfo=function(Q){var v,J=this,H=J._interactor,R=H._getValidSelection();if(R.length){if(1===R.length){if(v=R[0],!v.getRect)return J._target=null,void 0}else if(v=eh.Group.findOrCreateGroup(R),!v)return J._target=null,void 0}else{var R=H.gv.sm().getSelection();if(R.length&&(v=R.get(0),!v.getRect))return J._target=null,void 0}var U=v.getPosition(),Z=v.getRect();J._target={node:v,x:Z.x-U.x,y:Z.y-U.y,w:Z.width,h:Z.height,lp:{x:Q.x,y:Q.y},pos:{x:U.x,y:U.y},shiftGuide:{dir:"x",limit:0},downPosition:new eh.Math.Vector2(Q)},H.rectGuide.gatherRects()},Ki.prototype.clear=function(){var i=this;i._interactor.rectGuide.clear(),i._interactor._42()};var iq="directional",yn="point",ys="spot",vl="light.color",fr=function(K,Z){mc(Z)&&Uj.test(Z)?Ze(K,Z):$l(Z)&&Z.modelType?Po(K,Z):Ah[K]=Z},mi=function(H){if($l(H))return H.modelType?H.uuid?Ah[H.uuid]:(H.uuid=w.Math.generateUUID(),Po(H.uuid,H),M):H;var I=Ah[H];return H&&I===M&&Uj.test(H)&&(ts&&ts[H]||Ze(H,H)),I},Oe=function(C,M){C.frameStack?C.frameStack.push(M):C.frameStack=[M],C.bindFramebuffer(C.FRAMEBUFFER,M)},Iq=function(o){var C=o.frameStack;if(C){if(C.pop(),C.length)return o.bindFramebuffer(o.FRAMEBUFFER,C[C.length-1]),void 0;o.frameStack=null}o.bindFramebuffer(o.FRAMEBUFFER,null)};jn(n,{graph3dViewAttributes:a,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:W/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Ei,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:W/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:fr,getShape3dModel:mi,createMatrix:function(B,I){uo(B)||(B=[B]);for(var b=B.length-1;b>=0;b--){var J=B[b];I=js(J.mat,J.s3,J.r3,J.rotationMode,J.t3,I)}return I},transformVec:function(y,V){return jr(y,V)},glBindFrame:Oe,glUnbindFrame:Iq,createBoxModel:function(){return{vs:an,ns:_n,uv:Xo,is:id}},createRoundRectModel:function(o,O){return qo.roundRect(o,O)},createStarModel:function(O,T){return qo.star(O,T)},createRectModel:function(S,d){return qo.rect(S,d)},createTriangleModel:function(n,I){return qo.triangle(n,I)},createRightTriangleModel:function(b,W){return qo.rightTriangle(b,W)},createParallelogramModel:function(r,f){return qo.parallelogram(r,f)},createTrapezoidModel:function(G,_){return qo.trapezoid(G,_)},createSmoothSphereModel:function(d,O,t,r,h,l,W){return Vn(new Db(d,O,t,r,h,l,W))},createSphereModel:function(b,y,C,I,A,d){return b?Mh(b,y,C,I,A,d):n.createSmoothSphereModel()},createSmoothConeModel:function(s,b,$,c,Q){return qb(s,b,$,c,Q)},createConeModel:function(U,b,p,t,u,S){return U?sg(U,b,p,t,u,S):qb(S)},createSmoothCylinderModel:function(X,I,E,o,P,O,m,j){return Vn(new Do(X,I,E,o,P,O,m,j))},createCylinderModel:function(e,O,_,h,W,S,z){return e?Rd(e,O,_,h,W,S,z):yk(S,z)},createSmoothTorusModel:function(r,b,v,J,X,O){return Vn(new pg(r,b,v,J,X,O))},createTorusModel:function(k,t,Y,S,T,O,p){return k?ig(k,t,Y,S,T,O,p):xq(O,p)},createExtrusionModel:function(K,E,M,j,Y,v,S,b){return zh(K,E,M,j,Y,v,S,b)},createSmoothRingModel:function(w,k,v,l,M,u){for(var G=[],x=0;x<w.length-1;x+=2)G.push({x:w[x],y:w[x+1]});for(w=Cl(G,k,v)[0],G=[],x=0;x<w.length;x++){var r=w[x];G.push(new Mn(r.x,0,r.y))}return Vn(new Jq(G,u,l,M))},createTextGeometry:function(V,p){return Vn(new Mf(V,p))},loadFontFace:function(G,c){n.xhrLoad(G,function(w){if(!w)return c();var J;try{J=JSON.parse(w)}catch(U){J=JSON.parse(w.substring(65,w.length-2))}Yl.loadFace(J),c&&c(J.familyName.toLowerCase())},c?null:{sync:!0})},createRingModel:function(d,G,H,X,b,o,C,p,w,E){for(var Z=[],e=0;e<d.length-1;e+=2)Z.push({x:d[e],y:d[e+1]});o=o||n.shapeSide,C=C||0,p=p||o;var l,h,j,Y,r,x,k,$,U,q,e,g,_,c,m,B,f,S,A=[],M=[],D=w?[]:a,I=w?[]:a,T=E?[]:a,u=E?[]:a,V=X?[]:a,Q=X?[]:a,v=b?[]:a,F=b?[]:a,d=Cl(Z,G,H),z=lc(d),y=0,L=2*Math.PI/o;return d.forEach(function(W){if(j=W.length,j>1){if(Y=W[0],X)for(x=Y.x,$=Y.y,e=C;p>e;e++)g=e+1,_=e*L,c=g*L,m=s(_),B=N(_),f=s(c),S=N(c),V.push(m*x,$,-B*x,f*x,$,-S*x,0,$,0),Q.push(.5-.5*m,.5-.5*B,.5-.5*f,.5-.5*S,.5,.5);for(q=0;j>q;q++){for(r=W[q],x=Y.x,k=r.x,$=Y.y,U=r.y,l=y/z,y+=sh(Y,r),h=y/z,e=C;p>e;e++)g=e+1,_=e*L,c=g*L,m=s(_),B=N(_),f=s(c),S=N(c),A.push(m*k,U,-B*k,f*k,U,-S*k,m*x,$,-B*x,f*k,U,-S*k,f*x,$,-S*x,m*x,$,-B*x),M.push(e/o,h,g/o,h,e/o,l,g/o,h,g/o,l,e/o,l),w&&e===C&&(D.push(0,$,0,0,U,0,m*k,U,-B*k,m*k,U,-B*k,m*x,$,-B*x,0,$,0),I.push(0,.5-$,0,.5-U,2*k,.5-U,2*k,.5-U,2*x,.5-$,0,.5-$)),E&&g===p&&(T.push(0,$,0,f*k,U,-S*k,0,U,0,f*k,U,-S*k,0,$,0,f*x,$,-S*x),u.push(1,.5-$,1-2*k,.5-U,1,.5-U,1-2*k,.5-U,1,.5-$,1-2*x,.5-$));Y=r}if(b)for(x=Y.x,$=Y.y,e=C;p>e;e++)g=e+1,_=e*L,c=g*L,m=s(_),B=N(_),f=s(c),S=N(c),v.push(f*x,$,-S*x,m*x,$,-B*x,0,$,0),F.push(.5-.5*f,.5+.5*S,.5-.5*m,.5+.5*B,.5,.5)}}),{vs:A,uv:M,bottom_vs:v,bottom_uv:F,top_vs:V,top_uv:Q,from_vs:D,from_uv:I,to_vs:T,to_uv:u}}},!0),jn(P,{"3d.move.mode":M,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":M,"edge.gradient.color":M,"edge.source.t3":M,"edge.target.t3":M,"light.type":yn,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":W/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":wb,"wf.short":!1,"wf.mat":M,"wf.geometry":!1,batch:M,"transparent.mask":!1,brightness:M,"select.brightness":.7,"repeat.uv.length":M,alphaTest:.4,renderTextureSamples:4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":xr,"label.t3":M,"label.r3":M,"label.texture.scale":2,"label.rotationMode":pb,"label.light":!1,"label.blend":M,"label.reverse.flip":!1,"label.reverse.color":Yf,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":xr,"label2.t3":M,"label2.r3":M,"label2.texture.scale":2,"label2.rotationMode":pb,"label2.light":!1,"label2.blend":M,"label2.reverse.flip":!1,"label2.reverse.color":Yf,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":xr,"note.t3":M,"note.r3":M,"note.texture.scale":2,"note.rotationMode":pb,"note.light":!1,"note.blend":M,"note.reverse.flip":!1,"note.reverse.color":Yf,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":xr,"note2.t3":M,"note2.r3":M,"note2.texture.scale":2,"note2.rotationMode":pb,"note2.light":!1,"note2.blend":M,"note2.reverse.flip":!1,"note2.reverse.color":Yf,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:M,"shape3d.color":Lq,"shape3d.top.color":M,"shape3d.bottom.color":M,"shape3d.from.color":M,"shape3d.to.color":M,"shape3d.image":M,"shape3d.top.image":M,"shape3d.bottom.image":M,"shape3d.from.image":M,"shape3d.to.image":M,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":M,"shape3d.side.to":M,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":M,"shape3d.opacity":M,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Yf,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":M,"shape3d.uv.scale":M,"shape3d.top.uv.offset":M,"shape3d.top.uv.scale":M,"shape3d.bottom.uv.offset":M,"shape3d.bottom.uv.scale":M,"shape3d.from.uv.offset":M,"shape3d.from.uv.scale":M,"shape3d.to.uv.offset":M,"shape3d.to.uv.scale":M,"shape3d.top.cap":M,"shape3d.bottom.cap":M,"shape3d.start.angle":0,"shape3d.sweep.angle":O,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":M,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":Lq,"all.image":M,"all.blend":M,"all.opacity":M,"all.reverse.flip":!1,"all.reverse.color":Yf,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":M,"all.uv.offset":M,"all.uv.scale":M,"all.discard.selectable":!0,mat:M,"left.mat":M,"right.mat":M,"top.mat":M,"bottom.mat":M,"front.mat":M,"back.mat":M},!0);var Xh,ih=!1,Rk=[0,0,0,0],Cn={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Ul,2:Te,3:rr,4:tf,5:xr,6:Th}},Nd=function(u,j,K,F){if(j.getFaceVisible(u,K)){Sh(j,Rl(u,j.getFaceMat(u,K)||j.getMat(u)));var G=j._26I;j.getFaceReverseCull(u,K)?G.enable(G.CULL_FACE):G.disable(G.CULL_FACE),Ik(G,j._prg.uFixPickReverseColor,Cn[K]),mr(G),Sd(G,F,6),Kb(G),Ni(j)}},Om=function(V){return V instanceof Hn},af=function(X){return[X.x,X.e||0,X.y]},Jj=function(Q,M,I){for(var M=fj(M),K=M[0],v=M[1],p=M[2];I--;)Q.push(K,v,p)},Di=function(E,m,r){for(var m=fj(m),c=m[0],q=m[1],$=m[2],f=m[3];r--;)E.push(c,q,$,f)},rg=function(M,o,g){if(o)for(var W,v,S,Z=o[0],E=o[1],U=o[2],u=o[4],O=o[5],h=o[6],K=o[8],e=o[9],l=o[10],Y=o[12],R=o[13],$=o[14],t=g.length,p=0,p=0;t>p;p+=3)W=g[p],v=g[p+1],S=g[p+2],M.push(Z*W+u*v+K*S+Y,E*W+O*v+e*S+R,U*W+h*v+l*S+$);
else ks(M,g)},cg=function(A,u){var F=u.s("light.intensity"),t=fj(u.s(vl)),h=t[0],z=t[1],G=t[2];1!==F&&(h*=F,z*=F,G*=F),A.push(h,z,G,u.s("light.disabled")?1:0)},Im=function(X,N,h){Ik(N,h.uHeadlightRange,X._headlightRange);var T=X._headlightIntensity,z=fj(X._headlightColor);1!==T&&(z=[z[0]*T,z[1]*T,z[2]*T]),Ik(N,h.uHeadlightColor,[z[0],z[1],z[2],X._headlightDisabled?1:0]);var U=X._59O,W=X._spots,q=X._dirs;if(U.length){var y=[],t=[],L=[];U.forEach(function(B){cg(y,B),ks(t,X._transformPointToViewSpace(B.p3())),L.push(B.s("light.range"))}),N.uniform4fv(h.uPointColor,y),N.uniform1fv(h.uPointRange,L),N.uniform3fv(h.uPointPosition,t)}if(W.length){var E=[],S=[],F=[],g=[],K=[],B=[];W.forEach(function(j){cg(E,j),ks(S,X._transformPointToViewSpace(j.p3())),ks(K,X._transformDirectionToViewSpace(j.p3(),j.s("light.center"))),F.push(j.s("light.range")),g.push(s(j.s("light.angle")/2)),B.push(j.s("light.exponent"))}),N.uniform4fv(h.uSpotColor,E),N.uniform1fv(h.uSpotRange,F),N.uniform1fv(h.uSpotAngle,g),N.uniform1fv(h.uSpotExponent,B),N.uniform3fv(h.uSpotPosition,S),N.uniform3fv(h.uSpotDirection,K)}if(q.length){var C=[],$=[];q.forEach(function(M){cg(C,M),ks($,X._transformDirectionToViewSpace(M.p3()))}),N.uniform4fv(h.uDirColor,C),N.uniform3fv(h.uDirDirection,$)}},Nb=function(W){return W>0&&0===(W-1&W)},El=function(n){return n=t(0,p(W,n)),n=t(Un,p(W-Un,n))},Sf=function(){return.05+f()/2},Co=function(d,p,J,R){var U,B=d.getEye();return d.isOrtho()?(U=Eh(d.getCenter(),B),U[0]+=R[0],U[1]+=R[1],U[2]+=R[2]):U=B,Fr(p,J,R,U)},Fr=function(K,C,$,d){var U=Ng(K,C),L=Eh(d,$,!0),A=Ng(L,C);if(y(A)<Un)return a;var Q=(U-Ng($,C))/A;return[$[0]+L[0]*Q,$[1]+L[1]*Q,$[2]+L[2]*Q]},vd=function(K,j){return{x:2*K.x-j.x,y:2*K.y-j.y}},Xr=function(J,o,d,b){var R,m;if(!J)return R=x(o.y-d.y,d.x-o.x),{x:o.x+b*N(R),y:o.y+b*s(R)};if(!d)return R=x(J.y-o.y,o.x-J.x),{x:o.x+b*N(R),y:o.y+b*s(R)};var D=Eh([J.x,J.y,0],[o.x,o.y,0],!0),i=Eh([d.x,d.y,0],[o.x,o.y,0],!0),G=-(D[0]+i[0])/2,z=-(D[1]+i[1])/2,T=l(G*G+z*z);if(Un>T)return R=x(J.y-o.y,o.x-J.x),{x:o.x+b*N(R),y:o.y+b*s(R)};var P=J.x-o.x,C=J.y-o.y,n=d.x-o.x,Q=d.y-o.y,L=l(P*P+C*C),w=l(n*n+Q*Q);R=I(Ng(D,i))/2,m=D[1]*i[0]-D[0]*i[1]>0?-1:1,G/=T,z/=T;var B=b/N(R),W=t(L,w)/s(R);T=Math.min(B,W);var k={x:o.x+m*T*G,y:o.y+m*T*z};return d.b&&B>w/s(R)&&(k.adjust=!0),k},sl=function(v){var i=v[1],L=v[2],o=v[3],c=v[6],B=v[7],l=v[11];v[1]=v[4],v[2]=v[8],v[3]=v[12],v[4]=i,v[6]=v[9],v[7]=v[13],v[8]=L,v[9]=c,v[11]=v[14],v[12]=o,v[13]=B,v[14]=l},vj=function(G){var k=G[0],b=G[1],s=G[2],l=G[3],r=G[4],Z=G[5],w=G[6],j=G[7],T=G[8],f=G[9],X=G[10],y=G[11],q=G[12],c=G[13],V=G[14],A=G[15],n=k*Z-b*r,i=k*w-s*r,K=k*j-l*r,D=b*w-s*Z,R=b*j-l*Z,P=s*j-l*w,_=T*c-f*q,H=T*V-X*q,$=T*A-y*q,Q=f*V-X*c,e=f*A-y*c,z=X*A-y*V,W=n*z-i*e+K*Q+D*$-R*H+P*_;return W?(W=1/W,G[0]=(Z*z-w*e+j*Q)*W,G[1]=(s*e-b*z-l*Q)*W,G[2]=(c*P-V*R+A*D)*W,G[3]=(X*R-f*P-y*D)*W,G[4]=(w*$-r*z-j*H)*W,G[5]=(k*z-s*$+l*H)*W,G[6]=(V*K-q*P-A*i)*W,G[7]=(T*P-X*K+y*i)*W,G[8]=(r*e-Z*$+j*_)*W,G[9]=(b*$-k*e-l*_)*W,G[10]=(q*R-c*K+A*n)*W,G[11]=(f*K-T*R-y*n)*W,G[12]=(Z*H-r*Q-w*_)*W,G[13]=(k*Q-b*H+s*_)*W,G[14]=(c*i-q*D-V*n)*W,G[15]=(T*D-f*i+X*n)*W,void 0):a},jo=function(k,y){if(y){var j=y[0],G=y[1],L=y[2];k[12]=k[0]*j+k[4]*G+k[8]*L+k[12],k[13]=k[1]*j+k[5]*G+k[9]*L+k[13],k[14]=k[2]*j+k[6]*G+k[10]*L+k[14],k[15]=k[3]*j+k[7]*G+k[11]*L+k[15]}},up=function(f,k){if(k){var r=k[0],V=k[1],P=k[2];f[0]=f[0]*r,f[1]=f[1]*r,f[2]=f[2]*r,f[3]=f[3]*r,f[4]=f[4]*V,f[5]=f[5]*V,f[6]=f[6]*V,f[7]=f[7]*V,f[8]=f[8]*P,f[9]=f[9]*P,f[10]=f[10]*P,f[11]=f[11]*P}},yb=function(a,g,i){var t=g[0],k=g[1],R=g[2],b=g[3],f=g[4],d=g[5],u=g[6],I=g[7],r=g[8],q=g[9],Z=g[10],n=g[11],K=g[12],A=g[13],T=g[14],c=g[15],z=i[0],J=i[1],p=i[2],j=i[3];return a[0]=z*t+J*f+p*r+j*K,a[1]=z*k+J*d+p*q+j*A,a[2]=z*R+J*u+p*Z+j*T,a[3]=z*b+J*I+p*n+j*c,z=i[4],J=i[5],p=i[6],j=i[7],a[4]=z*t+J*f+p*r+j*K,a[5]=z*k+J*d+p*q+j*A,a[6]=z*R+J*u+p*Z+j*T,a[7]=z*b+J*I+p*n+j*c,z=i[8],J=i[9],p=i[10],j=i[11],a[8]=z*t+J*f+p*r+j*K,a[9]=z*k+J*d+p*q+j*A,a[10]=z*R+J*u+p*Z+j*T,a[11]=z*b+J*I+p*n+j*c,z=i[12],J=i[13],p=i[14],j=i[15],a[12]=z*t+J*f+p*r+j*K,a[13]=z*k+J*d+p*q+j*A,a[14]=z*R+J*u+p*Z+j*T,a[15]=z*b+J*I+p*n+j*c,a},Hk=function(S,T,U,s){var F,A,V,d,q,e,$,M,D,W,K=T[0],H=T[1],J=T[2],p=s[0],Q=s[1],R=s[2],u=U[0],b=U[1],X=U[2];return y(K-u)<Un&&y(H-b)<Un&&y(J-X)<Un?cr(S):($=K-u,M=H-b,D=J-X,W=1/l($*$+M*M+D*D),$*=W,M*=W,D*=W,F=Q*D-R*M,A=R*$-p*D,V=p*M-Q*$,W=l(F*F+A*A+V*V),W?(W=1/W,F*=W,A*=W,V*=W):(F=0,A=0,V=0),d=M*V-D*A,q=D*F-$*V,e=$*A-M*F,W=l(d*d+q*q+e*e),W?(W=1/W,d*=W,q*=W,e*=W):(d=0,q=0,e=0),S[0]=F,S[1]=d,S[2]=$,S[3]=0,S[4]=A,S[5]=q,S[6]=M,S[7]=0,S[8]=V,S[9]=e,S[10]=D,S[11]=0,S[12]=-(F*K+A*H+V*J),S[13]=-(d*K+q*H+e*J),S[14]=-($*K+M*H+D*J),S[15]=1,S)},Zp=function(G,K,h,l,O){var D=1/X(K/2),Z=1/(l-O);return G[0]=D/h,G[1]=0,G[2]=0,G[3]=0,G[4]=0,G[5]=D,G[6]=0,G[7]=0,G[8]=0,G[9]=0,G[10]=(O+l)*Z,G[11]=-1,G[12]=0,G[13]=0,G[14]=2*O*l*Z,G[15]=0,G},Df=function(x,d,V,q,Q,Y,y){var b=1/(d-V),U=1/(q-Q),g=1/(Y-y);return x[0]=-2*b,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*U,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=2*g,x[11]=0,x[12]=(d+V)*b,x[13]=(Q+q)*U,x[14]=(y+Y)*g,x[15]=1,x},qn=function(a,U){var $=U[0],H=U[1],i=U[2],R=U[3],g=$*$+H*H+i*i+R*R,q=g?1/g:0;return a[0]=-$*q,a[1]=-H*q,a[2]=-i*q,a[3]=R*q,a},Tm=function(S,l){var q=l[0]+l[5]+l[10],Q=0;return q>0?(Q=2*Math.sqrt(q+1),S[3]=.25*Q,S[0]=(l[6]-l[9])/Q,S[1]=(l[8]-l[2])/Q,S[2]=(l[1]-l[4])/Q):l[0]>l[5]&l[0]>l[10]?(Q=2*Math.sqrt(1+l[0]-l[5]-l[10]),S[3]=(l[6]-l[9])/Q,S[0]=.25*Q,S[1]=(l[1]+l[4])/Q,S[2]=(l[8]+l[2])/Q):l[5]>l[10]?(Q=2*Math.sqrt(1+l[5]-l[0]-l[10]),S[3]=(l[8]-l[2])/Q,S[0]=(l[1]+l[4])/Q,S[1]=.25*Q,S[2]=(l[6]+l[9])/Q):(Q=2*Math.sqrt(1+l[10]-l[0]-l[5]),S[3]=(l[1]-l[4])/Q,S[0]=(l[8]+l[2])/Q,S[1]=(l[6]+l[9])/Q,S[2]=.25*Q),S},Ro=function(N,A,O){var Q=A[0],C=A[1],s=A[2],K=A[3],h=Q+Q,m=C+C,U=s+s,_=Q*h,t=Q*m,n=Q*U,u=C*m,e=C*U,B=s*U,p=K*h,V=K*m,L=K*U;return N[0]=1-(u+B),N[1]=t+L,N[2]=n-V,N[3]=0,N[4]=t-L,N[5]=1-(_+B),N[6]=e+p,N[7]=0,N[8]=n+V,N[9]=e-p,N[10]=1-(_+u),N[11]=0,N[12]=O[0],N[13]=O[1],N[14]=O[2],N[15]=1,N},Dp=function(){var v=[0,0,0],q=[0,0,0],C=[0,0,0],g=function(q,d,s){q[0]=d[1]*s[2]-d[2]*s[1],q[1]=d[2]*s[0]-d[0]*s[2],q[2]=d[0]*s[1]-d[1]*s[0]},x=function(b){return b[0]*b[0]+b[1]*b[1]+b[2]*b[2]},z=function(Q){var X=Math.sqrt(x(Q));Q[0]/=X,Q[1]/=X,Q[2]/=X},I=function(V,h,v){V[0]=h[0]-v[0],V[1]=h[1]-v[1],V[2]=h[2]-v[2]};return function(m,Z,Q){var K=vo();return I(C,m,Z),0===x(C)&&(C[2]=1),z(C),g(v,Q,C),0===x(v)&&(1===Math.abs(Q[2])?C[0]+=1e-4:C[2]+=1e-4,z(C),g(v,Q,C)),z(v),g(q,C,v),K[0]=v[0],K[4]=q[0],K[8]=C[0],K[1]=v[1],K[5]=q[1],K[9]=C[1],K[2]=v[2],K[6]=q[2],K[10]=C[2],K}}(),Ir=function(j,z){if(j.vr.enable){var f=j.vr.getViewMatrix(z);if(f)return f}return Hk(z?z:vo(),j._eye,j._center,j._up)},Jo=function(E){if(E.vr.enable){var C=E.vr.getProjectMatrix();if(C)return C}var r=E.getAspect(),A=E._near,G=E._far,w=vo();if(E._ortho){var L=E._orthoWidth/2,u=L/r;Df(w,-L,L,-u,u,A,G)}else Zp(w,E._fovy,r,A,G);return w},mg=function(i,H){if(!i)return a;var V=0,F=1,c=2,m=[],d=0,N=i.length,b=N/3;if(H){for(;N>d;d++)m[d]=0;for(d=0;d<H.length;d+=3){var z=[],u=[],o=[];z[V]=i[3*H[d+1]+V]-i[3*H[d]+V],z[F]=i[3*H[d+1]+F]-i[3*H[d]+F],z[c]=i[3*H[d+1]+c]-i[3*H[d]+c],u[V]=i[3*H[d+2]+V]-i[3*H[d+1]+V],u[F]=i[3*H[d+2]+F]-i[3*H[d+1]+F],u[c]=i[3*H[d+2]+c]-i[3*H[d+1]+c],o[V]=z[F]*u[c]-z[c]*u[F],o[F]=z[c]*u[V]-z[V]*u[c],o[c]=z[V]*u[F]-z[F]*u[V];for(var P=0;3>P;P++)m[3*H[d+P]+V]+=o[V],m[3*H[d+P]+F]+=o[F],m[3*H[d+P]+c]+=o[c]}}else for(d=0;b>d;d+=3){var z=[],u=[],o=[];z[V]=i[3*(d+1)+V]-i[3*d+V],z[F]=i[3*(d+1)+F]-i[3*d+F],z[c]=i[3*(d+1)+c]-i[3*d+c],u[V]=i[3*(d+2)+V]-i[3*(d+1)+V],u[F]=i[3*(d+2)+F]-i[3*(d+1)+F],u[c]=i[3*(d+2)+c]-i[3*(d+1)+c],o[V]=z[F]*u[c]-z[c]*u[F],o[F]=z[c]*u[V]-z[V]*u[c],o[c]=z[V]*u[F]-z[F]*u[V];for(var P=0;3>P;P++)m[3*(d+P)+V]=o[V],m[3*(d+P)+F]=o[F],m[3*(d+P)+c]=o[c]}for(d=0;N>d;d+=3){var D=[];D[V]=m[d+V],D[F]=m[d+F],D[c]=m[d+c];var j=l(D[V]*D[V]+D[F]*D[F]+D[c]*D[c]);0===j&&(j=Un),D[V]=D[V]/j,D[F]=D[F]/j,D[c]=D[c]/j,m[d+V]=D[V],m[d+F]=D[F],m[d+c]=D[c]}return new go(m)},pl=function(v,d,l,s){if(l||(l=v.createTexture()),d){var J=v.TEXTURE_2D,p=v.REPEAT,D=v.CLAMP_TO_EDGE,k=v.TEXTURE_MIN_FILTER;s!==v.NEAREST&&(s=v.LINEAR),Ib(v,l),v.texImage2D(J,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,d),Eg(v,v.TEXTURE_MAG_FILTER,s);var b=d.naturalWidth||d.width,L=d.naturalHeight||d.height;Nb(b)&&Nb(L)&&!d.clampToEdge?(Eg(v,v.TEXTURE_WRAP_S,p),Eg(v,v.TEXTURE_WRAP_T,p),Eg(v,k,v.LINEAR_MIPMAP_LINEAR),v.generateMipmap(J)):(Eg(v,v.TEXTURE_WRAP_S,D),Eg(v,v.TEXTURE_WRAP_T,D),Eg(v,k,s)),Ib(v,a)}return l},vh=function(U,O){var b=new Uint8Array(4);return O=O||U.createTexture(),Ib(U,O),Eg(U,U.TEXTURE_MIN_FILTER,U.LINEAR),U.texImage2D(U.TEXTURE_2D,0,U.RGBA,1,1,0,U.RGBA,U.UNSIGNED_BYTE,b),O},Oj=function(N){N._26I&&N._prg&&(N._26I.deleteProgram(N._prg),N._prg=a)},cb=function(t,G,R,J){var e=t.createShader(R);return t.shaderSource(e,J),t.compileShader(e),t.attachShader(G,e),e},dq=function(N){return N.createBuffer()},Ib=function(u,z){u.bindTexture(u.TEXTURE_2D,z)},Eg=function(U,P,Z){U.texParameteri(U.TEXTURE_2D,P,Z)},Ee=function(N,D){N.enable(N.POLYGON_OFFSET_FILL),N.polygonOffset(D[0],D[1])},Ke=function(u){u.disable(u.POLYGON_OFFSET_FILL)},Ci=function(Q,q){if(q){var q=fj(q);Q.clearColor(q[0],q[1],q[2],q[3])}},pq=function(B,i){Ik(B,i.uFix,!0),Sm(B,i.aNormal)},Pf=function(G,O){Ik(G,O.uFix,!1),Wd(G,O.aNormal)},Vf=function(M,c,u,o,B,y,$,z){M._picking||(u?(Ik(M,c.uBlend,!0),Ik(M,c.uBlendColor,u)):Ik(M,c.uBlend,!1),Ik(M,c.uLight,o==a?!0:o),qg(B)&&1!==B&&Ik(M,c.uPartOpacity,B),Ik(M,c.uReverseFlip,y==a?!1:y),Ik(M,c.uFixPickReverseColor,$||Yf)),z?M.enable(M.CULL_FACE):M.disable(M.CULL_FACE)},Ub=function(A,u){A._picking||Ik(A,u.uPartOpacity,1)},mr=function(){var R=[0,0,1,1];return function(v,M,E,Z,e,h,t,N,V){return E?(Ik(v,M.uTexture,!0),Ik(v,M.uDiscardSelectable,tq(Z)?Z:!0),Wd(v,M.aUv),gf(v,e,h,M.aUv,2),V?(Ik(v,M.uBlendTexture,!0),v.activeTexture(v.TEXTURE1),Ib(v,V),v.uniform1i(M.uBlendSampler,1)):(Ik(v,M.uBlendTexture,!1),v.activeTexture(v.TEXTURE1),Ib(v,v._emptyBlendTexture)),v.activeTexture(v.TEXTURE0),Ib(v,E),v.uniform1i(M.uSampler,0),t?(R[0]=t[0],R[1]=t[1]):(R[0]=0,R[1]=0),N?(R[2]=N[0],R[3]=N[1]):(R[2]=1,R[3]=1),Ik(v,M.uOffsetScale,R),void 0):(v.activeTexture(v.TEXTURE0),Ib(v,v._emptyTexture),v.activeTexture(v.TEXTURE1),Ib(v,v._emptyBlendTexture),void 0)}}(),Kb=function(t,Y,q){t.activeTexture(t.TEXTURE0),Ib(t,a),t.activeTexture(t.TEXTURE1),Ib(t,a),q&&(Sm(t,Y.aUv),Ik(t,Y.uTexture,!1),Ik(t,Y.uBlendTexture,!1))},yp=function(D,k,N,b,C,S){!N||r||rk||D.lineWidth(N),b&&!D._picking&&Ik(D,k.uFixPickReverseColor,b),C&&gf(D,C,S,k.aPosition)},Np=function(z,O,V,g){Xh&&(g=z[Xh]),z.drawArrays(g==a?z.TRIANGLES:g,O,V);var F=z._renderInfo;F&&(F.calls++,F.vertices+=V,(g==a||g===z.TRIANGLES)&&(F.faces+=V/3),g===z.LINES&&(F.lines+=V/2))},Sd=function(z,H,k,m){Xh&&(m=z[Xh]),z.drawElements(m==a?z.TRIANGLES:m,k,z.UNSIGNED_SHORT,H==a?0:2*H);var W=z._renderInfo;W&&(W.calls++,W.vertices+=k,(m==a||m===z.TRIANGLES)&&(W.faces+=k/3),m===z.LINES&&(W.lines+=k/2))},Bl=function(i,x,e,y,S){var W=i.ARRAY_BUFFER;i.bindBuffer(W,x),e&&i.bufferData(W,e,i.STATIC_DRAW),y!=a&&i.vertexAttribPointer(y,S?S:3,i.FLOAT,!1,0,0)},gf=function(n,Z,f,$,p){return f?(oq(n,n.ARRAY_BUFFER,Z,f),$!=a&&n.vertexAttribPointer($,p?p:3,n.FLOAT,!1,0,0),void 0):Bl(n,Z,f,$,p)},km=function(J,o,W){var M=J.ELEMENT_ARRAY_BUFFER;J.bindBuffer(M,o),W&&J.bufferData(M,W,J.STATIC_DRAW)},qm=function(A,x,o){oq(A,A.ELEMENT_ARRAY_BUFFER,x,o)},oq=function(A,O,X,B){var E=B._bufId;E||(E=B._bufId=w.Math.generateIncreasingID());var X,x=A._bufPool;(X=x[E])&&X._buf?A.bindBuffer(O,X._buf):(X=x[E]={_buf:dq(A)},A.bindBuffer(O,X._buf),A.bufferData(O,B,A.STATIC_DRAW)),X._fid=A._renderInfo.frame},Ik=function(R,_,z){if(z!=a&&_!=a){z=fj(z);var d=z.length;3===d?R.uniform3fv(_,z):4===d?R.uniform4fv(_,z):16===d?R.uniformMatrix4fv(_,!1,z):tq(z)?R.uniform1i(_,z?1:0):2===d?R.uniform2fv(_,z):R.uniform1f(_,z)}},Wd=function(B,q){q!=a&&q>=0&&B.enableVertexAttribArray(q)},Sm=function(w,i){i!=a&&i>=0&&w.disableVertexAttribArray(i)},Ni=function(F,D){var R=F.getGL(),S=F._prg;F._7O=F._8O.pop(),D&&(Ik(R,S.uMVMatrix,F._7O),F._6O=D,Ik(R,S.uNMatrix,D))},Gl=function(l,f){return f||(f=vo()),$f(f,l),vj(f),sl(f),f},Sh=function(Q,o){var l=Q.getGL(),S=Q._prg,M=Q._7O;o&&(Q._8O.push(dm(M)),Ik(l,S.uMMatrix,o),yb(M,M,o),Q._7O=M),Ik(l,S.uMVMatrix,M),Ik(l,S.uNMatrix,Gl(M,Q._6O))},wp=function(s,t,D,P,f,k){if(D){if(P){var Q=D.value++,I=2147483648|Q,e=[(255&I>>16)/255,(255&I>>8)/255,(255&I)/255,(255&I>>24)/255];D[Q]={data:f,part:k}}else e=Rk;return Ik(s,t.uFixPickReverseColor,e),e}},Bs=function(){var Q={center:function(P,A,x,U,w){var e=-A[1]/2,g={x:-A[0]/2,y:e,width:A[0],height:A[1]},n=xp(P,g,x);return[n.x+U,-n.y-w,Sf()]},front:function(k,_,H,D,I){var r=-_[1]/2,M={x:-_[0]/2,y:r,width:_[0],height:_[1]},v=xp(k,M,H);return[v.x+D,-v.y-I,_[2]/2+Sf()]},back:function(H,w,D,b,$){var c=-w[0]/2,N=-w[1]/2,l={x:c,y:N,width:w[0],height:w[1]},r=xp(H,l,D);return[-r.x-b,-r.y-$,-w[2]/2-Sf()]},left:function(F,Y,t,H,L){var E=-Y[1]/2,v={x:-Y[2]/2,y:E,width:Y[2],height:Y[1]},u=xp(F,v,t);return[-Y[0]/2-Sf(),-u.y-L,u.x+H]},right:function(k,O,Z,C,o){var s=-O[2]/2,d=-O[1]/2,x={x:s,y:d,width:O[2],height:O[1]},N=xp(k,x,Z);return[O[0]/2+Sf(),-N.y-o,-N.x-C]},top:function(f,w,x,d,B){var y={x:-w[0]/2,y:-w[2]/2,width:w[0],height:w[2]},v=xp(f,y,x);return[v.x+d,w[1]/2+Sf(),v.y+B]},bottom:function(Q,h,q,C,S){var i=-h[2]/2,L={x:-h[0]/2,y:i,width:h[0],height:h[2]},z=xp(Q,L,q);return[z.x+C,-h[1]/2-Sf(),-z.y-S]}};return function(i,O,f,q,I,S){return Q[q](i,O,f,I||0,S||0)}}(),Xn=function(s,D,J,f,g,b,S,t,n,q){if(g&&(D[0]+=g[0],D[1]+=g[1],D[2]+=g[2]),jo(s,J),t){var r=vo();if(Cq(r,n,q),jr(D,r),jo(s,D),s.auto=t,s.pos=jr([0,0,0],s),b){var c=s.mat2=vo();Cq(c,b,S)}}else Cq(s,n,q),jo(s,D),f===Ul?ch(s,-Z):f===Te?ch(s,Z):f===rr?jg(s,-Z):f===tf?jg(s,Z):f===Th&&ch(s,W),Cq(s,b,S);return s},Xc=function(Y,C){var v=C.auto,f=C.mat2,U=Y.gv;if(v){var Q,O=vo(),G=[0,0,0,0];Q="string"==typeof v?[v.indexOf("x")<0?U._eye[0]:U._center[0],v.indexOf("y")<0?U._eye[1]:U._center[1],v.indexOf("z")<0?U._eye[2]:U._center[2]]:U._eye,Tm(G,Hk(vo(),Q,U._center,U._up)),Ro(O,qn(G,G),C.pos),f&&yb(O,O,f),Sh(U,O)}else Sh(U,C)},gk=function(G,U,u,a,o){var L=G.s,v=G.gv,e=v.getGL(),Q=v._prg,q=v._buffer,J=v._1O;pl(e,wo,J),Xc(G,u),Vf(e,Q,L(U+".blend"),L(U+".light"),L(U+".opacity"),L(U+".reverse.flip"),L(U+".reverse.color"),L(U+".reverse.cull")),mr(e,Q,J,o,q.uv,Kp),gf(e,q.vs,a,Q.aPosition),gf(e,q.ns,ur,Q.aNormal),qm(e,q.is,cc),Sd(e,0,cc.length),Kb(e,Q,J),Ub(e,Q),Ni(v)},Hm=function(m,r,o){var N=m.gv,S=m.data,Y=m[r]={blend:N.getBodyColor(S)||N.getFaceBlend(S,r),light:N.getFaceLight(S,r),color:N.getFaceColor(S,r),opacity:N.getFaceOpacity(S,r),transparent:N.getFaceTransparent(S,r),reverseFlip:N.getFaceReverseFlip(S,r),reverseColor:N.getFaceReverseColor(S,r),reverseCull:N.getFaceReverseCull(S,r),texture:N.getFaceImage(S,r),blendTexture:N.getFaceBlendImage(S,r),discardSelectable:N.getFaceDiscardSelectable(S,r)};if("csg"!==r){Y.uv=N.getFaceUv(S,r)||o&&o[r+"Uv"],Y.uvScale=N.getFaceUvScale(S,r)||o&&o[r+"UvScale"],Y.uvOffset=N.getFaceUvOffset(S,r)||o&&o[r+"UvOffset"];var U=N.getFaceMat(S,r);U&&(Y.mat=Rl(S,U))}return Y},Ud=function(g,W,V,z,p){if(z){if(!p(z.transparent))return;var v=g.data,s=g.gv,x=s._buffer,h=s.getTexture(z.texture,v),e=s.getTexture(z.blendTexture,v);mr(W,V,h,z.discardSelectable,x.uv,z.tuv,z.uvOffset,z.uvScale,e),Vf(W,V,z.blend,z.light,z.opacity,z.reverseFlip,z.reverseColor,z.reverseCull),Ik(W,V.uDiffuse,z.color||P["color.empty"]),gf(W,x.vs,z.vs,V.aPosition),gf(W,x.ns,z.ns,V.aNormal),Np(W,0,z.vs.length/3),Ub(W,V),Kb(W,V,h)}},Pm=function(Q,c,e,D,i,J){var f,W,R,g,M,A,X,G,t,T,O,I=[D-c,i-e],y=Q?Q.length:0;for(R=0;y>R;R++){for(g=2,f=Q[R],M=f[0],A=f[1];g+1<f.length;){if(X=f[g],G=f[g+1],W=fp(c,e,D,i,M,A,X,G,!0)){t=[X-M,G-A],T=sh(t),t[0]/=T,t[1]/=T,T=Ng(I,t),T=T>0?J:-J,O=[t[0]*T,t[1]*T];break}M=X,A=G,g+=2}if(O)break}if(O)for(D=c+O[0],i=e+O[1],R=0;y>R;R++)for(g=2,f=Q[R],M=f[0],A=f[1];g+1<f.length;){if(X=f[g],G=f[g+1],W=fp(c,e,D,i,M,A,X,G,!0))return[0,0];M=X,A=G,g+=2}return O?O:[D-c,i-e]},Yh=w.graph3d={},Ql=function(c,g,J){Qr(D+".graph3d."+c,g,J)},ok="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",rs="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";jn(n,{setBatchInfo:function(E,r){ls[E]=r},getBatchInfo:function(S){return ls[S]}},!0);var Id=[1,1,1],ge=[1,0,0,0,0,1,0,1,1,1,1,0],Pp=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Kc=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],dr=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Tr=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Dj=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],fk=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Wk=function(N,i){nl(N,i,"_batchModelMap","_batchIndexMap"),Ol(N,i,"_wireframeModelMap","_wireframeIndexMap"),Ol(N,i,"_polylineModelMap","_polylineIndexMap"),Ol(N,i,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Ol(N,i,"_polylineModelMapSwap","_polylineIndexMapSwap")},nl=function(f,b,c,h){if(!b)return f[c]={},f[h]={},void 0;var i=b._id,d=f[h],u=d[i];if(u){var H=f[c],J=u.batch,P=H[J],q=P.ds,X=u.index;if(P.invalidate=!0,delete d[i],q.splice(X,1),Zd(q))return delete H[J],void 0;for(var M=u.begin,Z=u.size,y=3*M,E=3*Z,g=4*M,Y=4*Z,A=P.vs,L=P.ps,T=P.uv,l=P.cs,C=P.bs,t=P.rs,Q=P.ns,r=P.ls;X<q.length;X++)u=d[q[X]._id],u.index--,u.begin-=Z;A.splice(y,E),L.splice(g,Y),T&&T.splice(2*M,2*Z),l&&l.splice(g,Y),C&&C.splice(y,E),t&&t.splice(M,Z),Q&&Q.splice(y,E),r&&r.splice(M,Z)}},Ol=nl,Jh=function(e,Y,U,B){if(!B)return a;var l=Y[B];if(!l){var Z=ls[B]||si,w=Z.image?[]:a;l=Y[B]={vs:[],ns:[],uv:w,cs:w?a:Z.color?a:[],bs:Z.blend?[]:a,ps:[],rs:Z.brightness?[]:a,ds:[]}}return l.invalidate=!0,e[U._id]={index:l.ds.length,begin:l.vs.length/3,batch:B},l.ds.push(U),l},zr=function(S,e){return e!=a&&1!==e?[S[0]*e,S[1]*e,S[2]*e,S[3]]:S},lq=function(f,V,t){var E=f.getBrightness(V),o=fj(t.color||"white"),N=o[3]<1,M=Math.ceil(t.width)||1,s=(N?"T":"O")+M,A=f._wireframeIndexMap,x=f._wireframeModelMap,i=x[s];i||(i=x[s]={vs:[],cs:[],ps:[],ds:[],T:N,W:M});var l,$=f.getData3dUI(V),Q=xm($);if(t.geometry){if(!Q)return;if(l=$c(Q),!l)return}else l=t.short?co:Go;i.invalidate=!0;var c=i.vs,G=i.cs,T=i.ds,P=A[V._id]={index:T.length,begin:c.length/3,batch:s};T.push(V);var F=Rl(V,t.mat),u=$._calcAnchorMat(V);u&&yb(F,F,u),rg(c,F,l);var D=P.size=c.length/3-P.begin;Di(G,zr(o,E),D)},ph=function(D,N,q,i,w,j,Y,m,Z){var A=D.getBrightness(N);A==a&&(A=1);var Q=zr(fj(i),A),r=Q[3]<1;j=Math.ceil(j)||1;var W=(r?"T":"O")+j;if(Y){var K=Y[0],R=(Y[1]||K)+K;W+="-"+K+"-"+R,Z&&(W+="-"+Mj(Z)+"-"+A,Z=zr(fj(Z),A))}var O=D._polylineIndexMap,e=D._polylineModelMap,k=e[W];k||(k=e[W]={vs:[],cs:[],ps:[],ds:[],ls:Y?[]:a,T:r,W:j},Y&&(k.D=K,k.G=R,k.A=Z)),k.invalidate=!0;var t,d=k.vs,I=k.cs,C=k.ds,E=k.ls,U=O[N._id]={index:C.length,begin:d.length/3,batch:W};C.push(N),ks(d,q);var J,x=U.size=d.length/3-U.begin,_=q.length,P=0,T=[];if(Y||w)for(t=0;_>t;t+=6)J=sh([q[t],q[t+1],q[t+2]],[q[t+3],q[t+4],q[t+5]]),T.push(J),P+=J;if(P&&w){var B,l=zr(fj(w),A),X=[l[0]-Q[0],l[1]-Q[1],l[2]-Q[2],l[3]-Q[3]],M=0;for(t=0;_>t;t+=6)B=M/P,Di(I,[Q[0]+X[0]*B,Q[1]+X[1]*B,Q[2]+X[2]*B,Q[3]+X[3]*B],1),M+=T[t/6],B=M/P,Di(I,[Q[0]+X[0]*B,Q[1]+X[1]*B,Q[2]+X[2]*B,Q[3]+X[3]*B],1)}else Di(I,Q,x);if(Y)for(M=m||0,t=0;_>t;t+=6)E.push(M),M+=T[t/6],E.push(M)},Ui=function(T,D,L){if(D)for(var W=4*D.begin,E=L[D.batch].ps,a=0;a<D.size;a++)E[W++]=T[0],E[W++]=T[1],E[W++]=T[2],E[W++]=T[3]},Bn=function(U,t){var i=t+["32"],n=U[t],p=U[i];n?p&&p.length===n.length?(p.set(n),p._bufId=null):U[i]=new go(n):delete U[i]},ao=function(J,W,H,D,p,Y,G,N,j){if(uo(H))H.forEach(function(g){ao(J,W,g,D,p,Y,G,N,j)});else if(mc(H))ao(J,W,xm(D,H),D,p,Y,G,N,j);else if($l(H)){var h,e=Io(H.mat,W,J),X=Io(H.s3,W,J),Q=Io(H.t3,W,J),T=Io(H.r3,W,J);if((X||T||Q||e)&&(h=js(e,X,T,Io(H.rotationMode,W,J),Q),Y.push(h)),H.shape3d)ao(J,W,H.shape3d,D,p,Y,G,N,H);else{var o=D.s;j=j||si;var x=Y[0],a=Y.length,k=o("shape3d.color",H.color,j.color);if(p||(p=o("shape3d.blend",H.blend,j.blend)),a>1){x=dm(x);for(var R=1;a>R;R++)yb(x,x,Y[R])}H.vs&&o(gb,H.visible,j.visible)&&pi(x,G,N,H.vs,H.uv,H.is,p,k),H.top_vs&&o(ff,H.topVisible,j.topVisible)&&pi(x,G,N,H.top_vs,H.top_uv,H.top_is,p,o("shape3d.top.color",H.topColor,j.topColor)||k),H.bottom_vs&&o(De,H.bottomVisible,j.bottomVisible)&&pi(x,G,N,H.bottom_vs,H.bottom_uv,H.bottom_is,p,o("shape3d.bottom.color",H.bottomColor,j.bottomColor)||k),H.from_vs&&o(aq,H.fromVisible,j.fromVisible)&&pi(x,G,N,H.from_vs,H.from_uv,H.from_is,p,o("shape3d.from.color",H.fromColor,j.fromColor)||k),H.to_vs&&o(cs,H.toVisible,j.toVisible)&&pi(x,G,N,H.to_vs,H.to_uv,H.to_is,p,o("shape3d.to.color",H.toColor,j.toColor)||k)}h&&Y.pop()}},pi=function(l,z,J,u,B,q,Y,C){var I,D=z.cs,d=z.uv,X=z.bs;if(q){I=q.length;for(var U=0;I>U;U++){var n=q[U];rg(J,l,[u[3*n],u[3*n+1],u[3*n+2]]),d&&ks(d,[B[2*n],B[2*n+1]])}}else I=u.length/3,rg(J,l,u),d&&ks(d,B);D&&Di(D,C,I),X&&(Y?Jj(X,Y,I):ks(X,Id,I))},kl=function(r,j,U,v){var y=[];v?ao(r.gv,r.data,v,r,r.getBodyColor(),[j],U,y):(wg(r,Ul,j,U,y),wg(r,Te,j,U,y),wg(r,xr,j,U,y),wg(r,Th,j,U,y),wg(r,rr,j,U,y),wg(r,tf,j,U,y),wg(r,"csg",j,U,y)),y.length&&(ks(U.vs,y),ks(U.ns,mg(y)))},wg=function(n,L,c,z,N){var b=n[L];if(b){var W=b.tuv;if(W){var V,m,Z,s,Q=b.uvScale,p=b.uvOffset;if(Q)for(V=W.length,m=Q[0],Z=Q[1],s=0;V>s;s+=2)W[s]*=m,W[s+1]*=Z;if(p)for(V=W.length,m=p[0],Z=p[1],s=0;V>s;s+=2)W[s]+=m,W[s+1]+=Z}pi(c,z,N,b.vs,W,a,b.blend,b.color)}},Gb=function(b,k,z,A,H,E,R,U){var X,o=z.cs,v=z.uv,T=z.bs;if(b.getFaceVisible(k,E)){var q=b.getFaceMat(k,E);if(q&&(H=Rl(k,q)),rg(R,H,U),o&&Di(o,b.getFaceColor(k,E),6),v){var u=b.getFaceUv(k,E)||A[E+"Uv"],y=b.getFaceUvScale(k,E)||A[E+"UvScale"],e=b.getFaceUvOffset(k,E)||A[E+"UvOffset"];u=u?[u[6],u[7],u[0],u[1],u[2],u[3],u[2],u[3],u[4],u[5],u[6],u[7]]:ge;var W=u[0],L=u[1],V=u[2],n=u[3],P=u[4],M=u[5],J=u[6],C=u[7],N=u[8],O=u[9],x=u[10],F=u[11];if(y){var s=y[0],j=y[1];W*=s,L*=j,V*=s,n*=j,P*=s,M*=j,J*=s,C*=j,N*=s,O*=j,x*=s,F*=j}if(e){var G=e[0],t=e[1];W+=G,L+=t,V+=G,n+=t,P+=G,M+=t,J+=G,C+=t,N+=G,O+=t,x+=G,F+=t}v.push(W,L,V,n,P,M,J,C,N,O,x,F)}T&&(X=b.getBodyColor(k)||b.getFaceBlend(k,E),X?Jj(T,X,6):ks(T,Id,6))}},wd=function(D,h,M,R){var q=D.getGL(),Q=D._prg,c=D._buffer;if(!D.drawFilter&&!os(h)){Sh(D),pq(q,Q);for(var S in h){var u=h[S];if(!(R&&!u.T||!R&&u.T)){u.invalidate?(u.invalidate=!1,Bn(u,"vs"),Bn(u,"cs"),Bn(u,"ls"),Bn(u,"ps")):M&&Bn(u,"ps");var L=u.vs32,X=M?u.ps32:u.cs32;yp(q,Q,u.W,a,c.vs,L);var Y=u.D,m=!D._dashDisabled&&Y;Ik(q,Q.uAlphaTest,P.alphaTest),m&&(Ik(q,Q.uDash,!0),Ik(q,Q.uDashDistance,Y),Ik(q,Q.uDashGapDistance,u.G),Wd(q,Q.aLineDistance),gf(q,c.lineDistance,u.ls32,Q.aLineDistance,1),Ik(q,Q.uDiffuse,u.A||P["color.empty"]));var t=!D._batchColorDisabled;t&&(Ik(q,Q.uBatchColor,!0),Wd(q,Q.aBatchColor),gf(q,c.batchColor,X,Q.aBatchColor,4)),mr(q),Np(q,0,L.length/3,q.LINES),Kb(q),t&&(Ik(q,Q.uBatchColor,!1),Sm(q,Q.aBatchColor)),m&&(Ik(q,Q.uDash,!1),Sm(q,Q.aLineDistance))}}Pf(q,Q)}},Nl=function(R,Z,J){var q,m,I,T,b,X,Q,E,H,j,p,r=R.getGL(),c=R._prg,i=R._buffer,F=R._batchModelMap;if(!os(F)){Sh(R);for(q in F)if(m=ls[q]||si,!(J&&!m.transparent||!J&&m.transparent)&&(I=F[q],Z||!m.transparentMask)){var D=J&&m.autoSort!==!1&&(R._33Q||I.invalidate);if(I.invalidate?(I.invalidate=!1,Bn(I,"vs"),Bn(I,"ns"),Bn(I,"cs"),Bn(I,"rs"),Bn(I,"ps"),Bn(I,"bs"),Bn(I,"uv")):Z&&Bn(I,"ps"),b=I.vs32,X=Z?I.ps32:I.cs32,H=I.uv32,Q=I.bs32,E=I.rs32,p=b.length/3,D&&(I.is=Kj(b,R.getEye())),p){T=m.light,j=R.getTexture(m.image),Vf(r,c,a,m.light,m.opacity,m.reverseFlip,m.reverseColor,m.reverseCull),X?R._batchColorDisabled||(Ik(r,c.uBatchColor,!0),Wd(r,c.aBatchColor),gf(r,i.batchColor,X,c.aBatchColor,4)):Ik(r,c.uDiffuse,m.color||P["color.empty"]);var o=m.alphaTest;Ik(r,c.uAlphaTest,o===M?P.alphaTest:o);var k=Q&&!R._batchBlendDisabled;k&&(Ik(r,c.uBatchBlend,!0),Wd(r,c.aBatchBlend),gf(r,i.batchBlend,Q,c.aBatchBlend));var Y=E&&!R._batchBrightnessDisabled;Y&&(Ik(r,c.uBatchBrightness,!0),Wd(r,c.aBatchBrightness),gf(r,i.batchBrightness,E,c.aBatchBrightness,1)),H?mr(r,c,j,m.discardSelectable,i.uv,H,m.uvOffset,m.uvScale):mr(r),gf(r,i.vs,b,c.aPosition),gf(r,i.ns,I.ns32,c.aNormal),I.is?(km(r,i.is,I.is),Sd(r,0,p)):Np(r,0,p),H?Kb(r,c,j):Kb(r),X&&!R._batchColorDisabled&&(Ik(r,c.uBatchColor,!1),Sm(r,c.aBatchColor)),k&&(Ik(r,c.uBatchBlend,!1),Sm(r,c.aBatchBlend)),Y&&(Ik(r,c.uBatchBrightness,!1),Sm(r,c.aBatchBrightness)),Ub(r,c)}}}},Kj=function($,r){for(var G=$.length/3,V=new Array(G),y=G/3,n=new Array(y),I=0;y>I;I++)n[I]=I;n.sort(function(x,S){var H=9*x,f=[($[H]+$[H+3]+2*$[H+6])/4,($[H+1]+$[H+4]+2*$[H+7])/4,($[H+2]+$[H+5]+2*$[H+8])/4];
H=9*S;var N=[($[H]+$[H+3]+2*$[H+6])/4,($[H+1]+$[H+4]+2*$[H+7])/4,($[H+2]+$[H+5]+2*$[H+8])/4],s=sh(r,f)-sh(r,N);return s>0?-1:0>s?1:0});for(var I=0;y>I;I++){var x=3*I,Y=3*n[I];V[x]=Y,V[x+1]=Y+1,V[x+2]=Y+2}return new Bd(V)},$g={obj:function(q,_){var J={mat:q.mat,s3:q.s3,r3:q.r3,rotationMode:q.rotationMode,t3:q.t3,cube:q.cube==a?!0:q.cube,center:q.center==a?!0:q.center,ignoreMtls:q.ignoreMtls,ignoreTransparent:q.ignoreTransparent,ignoreColor:q.ignoreColor,ignoreImage:q.ignoreImage,ignoreNormal:q.ignoreNormal,prefix:q.prefix,flipY:q.flipY,flipFace:q.flipFace,reverseFlipMtls:q.reverseFlipMtls,finishFunc:function(S,J){if(S){var J=[];for(var R in S){var l=S[R];J.rawS3=l.rawS3,J.push(l),q.eachModel&&q.eachModel(R,l)}J.json=q,_(J)}else _()}};n.loadObj(q.obj,q.mtl,J)}};n.getModelTypeHandlers=function(){return $g},n.setModelTypeHandler=function(B,t){$g[B]=t},n.getModelTypeHandler=function(c){return $g[c]},n.handleModelLoaded=function(){},n.handleUnfoundModel=function(){};var ts=a,Tj=a,ud=function(D){ts&&!D._loadingModelView_&&(Tj||(Tj={}),Tj[D._loadingModelView_=dj()]=D)},Ze=function(y,X){ts||(ts={});var _=ts[y];if(_){if(_.url===X)return;_.request.onload=is,_.request.onerror=is}var T=new Gm;if(ts[y]={request:T,url:X},X=n.beforeLoadURL(X),X.data){var p=n.parse(X.data);Po(y,p,X)}else{T.onload=function(){if(200===this.status||0===this.status){delete ts[y];var w=n.parse(T.getResponseText());Po(y,w,X)}else Ug(y,n.handleUnfoundModel(y,X)||a)},T.onerror=function(){Ug(y,n.handleUnfoundModel(y,X)||a)};var W={};W.url=encodeURI(X),W.sync=!1,T.send(W)}},Po=function(v,A,c){var o=A.modelType;if(!o)return Ug(v,A),n.handleModelLoaded(v,A),void 0;var Y=n.getModelTypeHandler(o);if(Y){if(ts||(ts={}),ts[v])return;ts[v]=!0;var s=function(H){H?(Ug(v,H),n.handleModelLoaded(v,H)):Ug(v,n.handleUnfoundModel(v,c)||a)};Y(A,s)}else Ug(v,n.handleUnfoundModel(v,c)||a)},Ug=function(C,B){if(Ah[C]=B,delete ts[C],os(ts)&&(ts=a,Tj)){for(var $ in Tj){var u=Tj[$];u.invalidateAll&&u.invalidateAll(M,"modelLoaded",C),u.redraw&&u.redraw(),u.iv(),delete u._loadingModelView_}Tj=a}if(B&&Tj)for(var $ in Tj){var u=Tj[$];u.invalidateAll&&u.invalidateAll(M,"modelLoading",C),u.redraw&&u.redraw(),u.iv()}},Kp=new go([0,0,0,1,1,1,1,0]),ur=new go([0,0,1,0,0,1,0,0,1,0,0,1]),cc=new Bd([0,1,2,2,3,0]),an=new go([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),id=new Bd([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Xo=new go([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),_n=mg(an,id),lm=(new go([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Bd([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Ul,xr,Te,Th,rr,tf]),Go=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],co=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Mh=function(f,M,b,G,i,y){y=y||16,f=f||16,M=M||0,b=b||f;var e,t,d,A,E,n,u,p,P=.5,Y=[],Q=[],I=O/f,a=W/y;for(e=0;y>e;e++)for(E=e+1,A=e*a,p=E*a,t=M;b>t;t++)n=t+1,d=t*I,u=n*I,Y.push(P*N(A)*s(d),P*s(A),-P*N(A)*N(d),P*N(p)*s(u),P*s(p),-P*N(p)*N(u),P*N(A)*s(u),P*s(A),-P*N(A)*N(u),P*N(A)*s(d),P*s(A),-P*N(A)*N(d),P*N(p)*s(d),P*s(p),-P*N(p)*N(d),P*N(p)*s(u),P*s(p),-P*N(p)*N(u)),Q.push(t/f,e/y,n/f,E/y,n/f,e/y,t/f,e/y,t/f,E/y,n/f,E/y);if(G){var l=[],_=[];for(d=M*I,e=0;y>e;e++)E=e+1,A=e*a,p=E*a,l.push(0,0,0,P*N(p)*s(d),P*s(p),-P*N(p)*N(d),P*N(A)*s(d),P*s(A),-P*N(A)*N(d)),_.push(0,.5,M/f,E/y,M/f,e/y)}if(i){var j=[],q=[];for(d=b*I,e=0;y>e;e++)E=e+1,A=e*a,p=E*a,j.push(0,0,0,P*N(A)*s(d),P*s(A),-P*N(A)*N(d),P*N(p)*s(d),P*s(p),-P*N(p)*N(d)),q.push(1,.5,b/f,e/y,b/f,E/y)}return{vs:Y,uv:Q,from_vs:l,from_uv:_,to_vs:j,to_uv:q}},xq=function(t,r,$){t=t||.17,r=r||12,$=$||18,0>t?t=0:t>.25&&(t=.25);var D,n,b,A,l,X,c,R=.5,g=[],z=[],a=[],p=O/$,Y=O/r,I=R-t;for(n=0;r>=n;n++)for(A=-W+n*Y,X=s(A),l=N(A),D=0;$>=D;D++)b=D*p,c=I+t*X,g.push(s(b)*c,l*t,-N(b)*c),z.push(D/$,1-n/r);for(n=0;r>n;n++){var y=n*($+1),G=(n+1)*($+1);for(D=0;$>D;D++)a.push(y+D,G+D+1,G+D,y+D,y+D+1,G+D+1)}return{vs:g,uv:z,is:a}},ig=function(h,H,S,k,G,j,K){K=K||12,h=h||18,H=H||0,S=S||h,j=j||.17,0>j?j=0:j>.25&&(j=.25);var E,o,u,p,J,i,t,C,l,V,Y=.5,F=[],f=[],I=O/h,M=O/K,v=Y-j;for(u=0;K>u;u++)for(p=u+1,t=-W+u*M,C=-W+p*M,E=H;S>E;E++)o=E+1,J=E*I,i=o*I,l=v+j*s(t),V=v+j*s(C),F.push(s(J)*l,N(t)*j,-N(J)*l,s(i)*l,N(t)*j,-N(i)*l,s(i)*V,N(C)*j,-N(i)*V,s(J)*l,N(t)*j,-N(J)*l,s(i)*V,N(C)*j,-N(i)*V,s(J)*V,N(C)*j,-N(J)*V),f.push(E/h,1-u/K,o/h,1-u/K,o/h,1-p/K,E/h,1-u/K,o/h,1-p/K,E/h,1-p/K);if(k){var q=[],y=[];for(u=0;K>u;u++)p=u+1,t=-W+u*M,C=-W+p*M,J=H*I,l=v+j*s(t),V=v+j*s(C),q.push(s(J)*l,N(t)*j,-N(J)*l,s(J)*V,N(C)*j,-N(J)*V,s(J)*v,0,-N(J)*v),y.push(.5+.5*s(t),.5-.5*N(t),.5+.5*s(C),.5-.5*N(C),.5,.5)}if(G){var w=[],d=[];for(u=0;K>u;u++)p=u+1,t=-W+u*M,C=-W+p*M,J=S*I,l=v+j*s(t),V=v+j*s(C),w.push(s(J)*l,N(t)*j,-N(J)*l,s(J)*v,0,-N(J)*v,s(J)*V,N(C)*j,-N(J)*V),d.push(.5-.5*s(t),.5-.5*N(t),.5,.5,.5-.5*s(C),.5-.5*N(C))}return{vs:F,uv:f,from_vs:q,from_uv:y,to_vs:w,to_uv:d}},yk=function(Y,u){for(var J,r,U,E=.5,R=16,p=[],_=[],v=[],h=O/R,B=0;R>=B;B++)J=B*h,r=s(J)*E,U=N(J)*E,p.push(r,-E,U,r,E,U),_.push(1-B/R,1,1-B/R,0);for(B=0;R>B;B++)v.push(2*B,2*B+1,2*B+3,2*B,2*B+3,2*B+2);if(u){var c=[],y=[],S=[];for(c.push(0,-E,0),y.push(.5,.5),B=0;R>=B;B++)J=B*h,r=s(J),U=N(J),c.push(r*E,-E,-U*E),y.push(.5+.5*r,.5+.5*U);for(B=0;R>B;B++)S.push(0,B+2,B+1)}if(Y){var z=[],M=[],f=[];for(z.push(0,E,0),M.push(.5,.5),B=0;R>=B;B++)J=B*h,r=s(J),U=N(J),z.push(r*E,E,-U*E),M.push(.5+.5*r,.5-.5*U);for(B=0;R>B;B++)f.push(0,B+1,B+2)}return{vs:p,uv:_,is:v,bottom_vs:c,bottom_uv:y,bottom_is:S,top_vs:z,top_uv:M,top_is:f}},Rd=function(E,A,R,W,x,Y,Q){E=E||12,A=A||0,R=R||E;for(var H,o,t,_,c,p,b,e,z=.5,I=[],X=[],V=O/E,S=A;R>S;S++)H=S+1,o=S*V,t=H*V,_=s(o)*z,c=N(o)*z,p=s(t)*z,b=N(t)*z,I.push(_,-z,-c,p,-z,-b,_,z,-c,p,-z,-b,p,z,-b,_,z,-c),X.push(S/E,1,H/E,1,S/E,0,H/E,1,H/E,0,S/E,0);if(Q){var l=[],v=[];for(S=A;R>S;S++)o=V*S,t=V*(S+1),_=s(o),c=N(o),p=s(t),b=N(t),l.push(_*z,-z,-c*z,0,-z,0,p*z,-z,-b*z),v.push(.5+.5*_,.5+.5*c,.5,.5,.5+.5*p,.5+.5*b)}if(Y){var k=[],a=[];for(S=A;R>S;S++)o=V*S,t=V*(S+1),_=s(o),c=N(o),p=s(t),b=N(t),k.push(_*z,z,-c*z,p*z,z,-b*z,0,z,0),a.push(.5+.5*_,.5-.5*c,.5+.5*p,.5-.5*b,.5,.5)}if(W){var j=[],y=[];o=V*A,_=s(o)*z,c=N(o)*z,e=A/E,j.push(0,z,0,0,-z,0,_,-z,-c,_,-z,-c,_,z,-c,0,z,0),y.push(0,0,0,1,e,1,e,1,e,0,0,0)}if(x){var D=[],T=[];o=V*R,_=s(o)*z,c=N(o)*z,e=R/E,D.push(0,-z,0,0,z,0,_,z,-c,_,z,-c,_,-z,-c,0,-z,0),T.push(1,1,1,0,e,0,e,0,e,1,1,1)}return{vs:I,uv:X,bottom_vs:l,bottom_uv:v,top_vs:k,top_uv:a,from_vs:j,from_uv:y,to_vs:D,to_uv:T}},qb=function(e,C,J,Z,y){C=C||18,J=J||0,Z=Z==a?O:Z,y=y==a?.5:y;for(var K,f,$,c,B,m,U=[0,.5,.75,.875,.9375],P=[],E=[],n=[],X=Z/C,z=0;z<U.length;z++){var g=0===z%2?0:.5;for(K=0;C>=K;K++)f=(K+g)*X+J,$=1-U[z],P.push(s(f)*y*$,-y+2*U[z]*y,-N(f)*y*$),E.push((K+g)/C,$)}for(z=0;z<U.length-1;z++){var Q=z*(C+1),L=(z+1)*(C+1);for(K=0;C>K;K++)n.push(Q+K,L+K+1,L+K,Q+K,Q+K+1,L+K+1)}for(m=P.length/3-(C+1),K=0;C>K;K++)P.push(0,y,0),E.push((K+.5)/C,0);for(K=0;C>K;K++)n.push(m+K,m+K+1,m+(C+1)+K);if(e){var Y=[],M=[],j=[];for(Y.push(0,-y,0),M.push(.5,.5),K=0;C>=K;K++)f=K*X+J,c=s(f),B=N(f),Y.push(c*y,-y,-B*y),M.push(.5+.5*c,.5+.5*B);for(K=0;C>K;K++)j.push(0,K+2,K+1)}return{vs:P,uv:E,is:n,bottom_vs:Y,bottom_uv:M,bottom_is:j}},sg=function(C,H,E,Q,c,l){C=C||16,H=H||0,E=E||C;for(var b=.5,R=[],J=[],L=O/C,G=H;E>G;G++){var p=G+1,h=L*G,X=L*p;R.push(s(h)*b,-b,-N(h)*b,s(X)*b,-b,-N(X)*b,0,b,0),J.push(G/C,1,p/C,1,(G+p)/2/C,0)}if(l){var V=[],n=[];for(G=H;E>G;G++){h=L*G,X=L*(G+1);var e=s(h),U=N(h),Z=s(X),g=N(X);V.push(e*b,-b,-U*b,0,-b,0,Z*b,-b,-g*b),n.push(.5+.5*e,.5+.5*U,.5,.5,.5+.5*Z,.5+.5*g)}}if(Q){var v=[],I=[];h=L*H,v.push(0,b,0,0,-b,0,s(h)*b,-b,-N(h)*b),I.push(0,0,0,1,H/C,1)}if(c){var x=[],y=[];h=L*E,x.push(0,-b,0,0,b,0,s(h)*b,-b,-N(h)*b),y.push(1,1,1,0,E/C,1)}return{vs:R,uv:J,bottom_vs:V,bottom_uv:n,from_vs:v,from_uv:I,to_vs:x,to_uv:y}},zh=function(j,J,o,v,U,Z,X,P){for(var y=[],M=0;M<j.length-1;M+=2)y.push({x:j[M],y:j[M+1]});return tg(y,J,o,v,U,Z,X,P,!1)},qo={roundRect:function(l,I){return zh([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],l,I,3)},star:function(O,C){return zh([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],O,C)},rect:function(I,g){return zh([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],I,g)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(e,i){return zh([0,-.5,.5,.5,-.5,.5],[1,2,2,5],e,i)},rightTriangle:function(S,K){return zh([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],S,K)},parallelogram:function(c,H){return zh([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],c,H)},trapezoid:function(T,t){return zh([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],T,t)}},Ig={sphere:1,cylinder:1,cone:1,torus:1},$p={torus:1,sphere:1},tl=jn(Vl(qo),{cylinder:1}),Cp=jn(Vl(qo),{cylinder:1,cone:1}),lg=function(z,G,k){var V,A=Io(z.anchor3d,k,G),L=Io(z.mat,k,G),b=Io(z.s3,k,G),O=Io(z.t3,k,G),w=Io(z.r3,k,G),v=b||w||O||L;if(A||v){V=dm(G._6O);var R=v?js(L,b,w,Io(z.rotationMode,k,G),O):vo();A&&jo(R,[.5-A[0],.5-A[1],.5-A[2]]),Sh(G,R)}return V},Lm=function(T,$,n,s,l,Y,z){if(uo(n))n.forEach(function(t){Lm(T,$,t,s,l,Y,z)});else if(mc(n))Lm(T,$,xm(s,n),s,l,Y,z);else if($l(n))if(n.shape3d){var m=lg(n,T,$);Lm(T,$,n.shape3d,s,l,Y,n),m&&Ni(T,m)}else mn(T,$,n,s.s,l,Y,z)},mn=function(i,n,$,w,q,R,A){if(A=A||si,!R||R(w("shape3d.transparent",$.transparent,A.transparent))){var e=lg($,i,n);Eq($);var l=i._26I,Q=i._prg,N=i._buffer,s=w("shape3d.color",$.color,A.color);q||(q=w("shape3d.blend",$.blend,A.blend));var u,V=$.opacity==a?A.opacity:$.opacity,F=w("shape3d.opacity");u=F!=a&&V!=a?V*F:V!=a?V:F,Vf(l,Q,q,w("shape3d.light",$.light,A.light),u,w("shape3d.reverse.flip",$.reverseFlip,A.reverseFlip),w("shape3d.reverse.color",$.reverseColor,A.reverseColor),w("shape3d.reverse.cull",$.reverseCull,A.reverseCull));var v=w("polygonOffset",$.polygonOffset,A.polygonOffset);$.vs&&w(gb,$.visible,A.visible)&&Uf(l,Q,N,s,i.getTexture(w("shape3d.image",$.image,A.image),n),w("shape3d.discard.selectable",$.discardSelectable,A.discardSelectable),$.vs,$.uv,$.ns,$.is,w("shape3d.uv.offset",$.uvOffset,A.uvOffset),w("shape3d.uv.scale",$.uvScale,A.uvScale),v),$.top_vs&&w(ff,$.topVisible,A.topVisible)&&Uf(l,Q,N,w("shape3d.top.color",$.topColor,A.topColor)||s,i.getTexture(w("shape3d.top.image",$.topImage,A.topImage),n),w("shape3d.top.discard.selectable",$.topDiscardSelectable,A.topDiscardSelectable),$.top_vs,$.top_uv,$.top_ns,$.top_is,w("shape3d.top.uv.offset",$.topUvOffset,A.topUvOffset),w("shape3d.top.uv.scale",$.topUvScale,A.topUvScale),v),$.bottom_vs&&w(De,$.bottomVisible,A.bottomVisible)&&Uf(l,Q,N,w("shape3d.bottom.color",$.bottomColor,A.bottomColor)||s,i.getTexture(w("shape3d.bottom.image",$.bottomImage,A.bottomImage),n),w("shape3d.bottom.discard.selectable",$.bottomDiscardSelectable,A.bottomDiscardSelectable),$.bottom_vs,$.bottom_uv,$.bottom_ns,$.bottom_is,w("shape3d.bottom.uv.offset",$.bottomUvOffset,A.bottomUvOffset),w("shape3d.bottom.uv.scale",$.bottomUvScale,A.bottomUvScale),v),$.from_vs&&w(aq,$.fromVisible,A.fromVisible)&&Uf(l,Q,N,w("shape3d.from.color",$.fromColor,A.fromColor)||s,i.getTexture(w("shape3d.from.image",$.fromImage,A.fromImage),n),w("shape3d.from.discard.selectable",$.fromDiscardSelectable,A.fromDiscardSelectable),$.from_vs,$.from_uv,$.from_ns,$.from_is,w("shape3d.from.uv.offset",$.fromUvOffset,A.fromUvOffset),w("shape3d.from.uv.scale",$.fromUvScale,A.fromUvScale),v),$.to_vs&&w(cs,$.toVisible,A.toVisible)&&Uf(l,Q,N,w("shape3d.to.color",$.toColor,A.toColor)||s,i.getTexture(w("shape3d.to.image",$.toImage,A.toImage),n),w("shape3d.to.discard.selectable",$.toDiscardSelectable,A.toDiscardSelectable),$.to_vs,$.to_uv,$.to_ns,$.to_is,w("shape3d.to.uv.offset",$.toUvOffset,A.toUvOffset),w("shape3d.to.uv.scale",$.toUvScale,A.toUvScale),v),Ub(l,Q),e&&Ni(i,e)}},Uf=function(G,z,x,M,R,O,F,v,c,i,n,j,Q){F&&(Q&&Ee(G,Q),Ik(G,z.uDiffuse,M||P["color.empty"]),v?mr(G,z,R,O,x.uv,v,n,j):mr(G),gf(G,x.vs,F,z.aPosition),gf(G,x.ns,c,z.aNormal),i?(qm(G,x.is,i),Sd(G,0,i.length)):Np(G,0,F.length/3),v?Kb(G,z,R):Kb(G),Q&&Ke(G))},xm=function(k,_){var y=k.s;if(_||(_=y(Pj)),!_)return a;var V=mi(_);if(V)return V;if("text"===_){var r={amount:y("shape3d.text.amount"),size:y("shape3d.text.size"),font:y("shape3d.text.font"),style:y("shape3d.text.style"),weight:y("shape3d.text.weight"),fill:y("shape3d.text.fill"),curveSegments:y("shape3d.text.curveSegments"),spacing:y("shape3d.text.spacing")},C=k.gv.getShape3dText(k.data),R=C;for(var c in r)R+="_"+(r[c]===M?"U":r[c]);return k._cachedTextKey===R?k._cachedTextGeometry:(k._cachedTextKey=R,k._cachedTextGeometry=n.createTextGeometry(C,r))}var c=_;if(Ig[_]){var m=y("shape3d.side"),L=y("shape3d.side.from"),e=y("shape3d.side.to"),g=y(aq),z=y(cs);3>m?(m=0,L=0,e=0,g=!1,z=!1):((L==a||0>L)&&(L=0),(e==a||e>m)&&(e=m),0===L&&e===m&&(g=!1,z=!1)),c+="-"+m+"-"+L+"-"+e+"-"+g+"-"+z}if(tl[_]){var Y=y(ff);c+="-"+Y}if(Cp[_]){var t=y(De);c+="-"+t}if("torus"===_){var H=y("shape3d.torus.radius");0>H?H=0:H>.25&&(H=.25),c+="-"+H}if($p[_]){var x=y(kn);c+="-"+x}return V=Bj[c],V||("box"===_?V=n.createBoxModel():qo[_]?V=qo[_](Y,t):"sphere"===_?V=n.createSphereModel(m,L,e,g,z,x):_===ye?V=n.createCylinderModel(m,L,e,g,z,Y,t):"cone"===_?V=n.createConeModel(m,L,e,g,z,t):"torus"===_&&(V=n.createTorusModel(m,L,e,g,z,H,x)),Bj[c]=V),V},Eq=function(){var $=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],l=["is","top_is","bottom_is","from_is","to_is"];return L=fi(ok.substr(ok.indexOf("^#")+2)),sd(n[mp(Fh+$[15]+"n"+$[16])]())&&fd()?function(u){u&&!u._complete_&&(u._complete_=!0,u.vs&&Zd(u.ns)&&(u.ns=mg(u.vs,u.is)),u.top_vs&&Zd(u.top_ns)&&(u.top_ns=mg(u.top_vs,u.top_is)),u.bottom_vs&&Zd(u.bottom_ns)&&(u.bottom_ns=mg(u.bottom_vs,u.bottom_is)),u.from_vs&&Zd(u.from_ns)&&(u.from_ns=mg(u.from_vs,u.from_is)),u.to_vs&&Zd(u.to_ns)&&(u.to_ns=mg(u.to_vs,u.to_is)),$.forEach(function(r){var K=u[r];uo(K)&&(u[r]=new go(K))}),l.forEach(function(U){var A=u[U];uo(A)&&(u[U]=new Bd(A))}))}:void 0}(),Lr=function(Z,u){var K=Z[u];uo(K)&&(Z[u]=new go(K))};jn(Se,{_25Q:function(Z){Z._16O=function(O,r,p,$,N,j,R,g,f){var y=this.info;if(y){var m,E,u,w,h,t,K=vo();if(me[r]?(m=y.p3,E=y.c1,u=y.c2):vs[r]?(E=y.s1||y.c1,u=y.s2||y.c2):(E=y.t1||y.c1,u=y.t2||y.c2),m)t=Bs(r,ak,p,$,g,f);else{var q=Eh(u,E),v=sh(E,u);w=[0,-x(q[2],q[0]),k(q[1]/v)],h="zyx",m=[(E[0]+u[0])/2,(E[1]+u[1])/2,(E[2]+u[2])/2],t=Bs(r,[v,0,0],p,$,g,f)}return Xn(K,t,m,$,N,j,R,O,w,h)}return On},Z._80o=function(l,W,h){var o=this,Z=o.shapeModel;if(Z){var n=o.gv;Sh(n),Lm(n,o.data,Z,o,o.getBodyColor(),h)}},Z.createLineModel=function(f,C,N,w,b){for(var m=this,v=m.s,Q=ce(f,C,v(kn)),q=[],E=0;E<Q.length;E++){var j=Q[E],x=j.length;if(x>1){var _=j[0];q.push(_.x,_.y,_.z);for(var B=1;x-1>B;B++)_=j[B],q.push(_.x,_.y,_.z),q.push(_.x,_.y,_.z);_=j[x-1],q.push(_.x,_.y,_.z)}}var K,I,g,t=v(w+".color"),e=v(b),R=0;return e&&(I=v(b+".color"),K=v(b+".pattern"),R=v(b+".offset"),g=t),ph(m.gv,m.data,q,I||t,g?a:v(w+".gradient.color"),N,K||v(w+".pattern"),R,g),Q},Z.createTubeModel=function(I,b,G,u){for(var F=this,J=F.s,t=J("shape3d.side")||Nq,$=J("shape3d.start.angle"),D=J("shape3d.sweep.angle"),r=J(ff)?J("shape3d.top.cap"):a,Q=J(De)?J("shape3d.bottom.cap"):a,L="flat"===r,M="flat"===Q,_=L&&(u?u.uv:J("shape3d.top.image")),w=M&&(u?u.uv:J("shape3d.bottom.image")),R=u?u.uv:J("shape3d.image"),f={vs:[],uv:R?[]:a,top_vs:L?[]:a,top_uv:_?[]:a,bottom_vs:M?[]:a,bottom_uv:w?[]:a},C=ce(I,b,J(kn),G),U=0,i=C.length;i>U;U++)dh(f,C[U],J(hl),G,t,$,D,r,Q);if(u){var q=[];ao(F.gv,F.data,f,F,F.getBodyColor(),[],u,q),q.length&&(ks(u.vs,q),ks(u.ns,mg(q)))}else F.shapeModel=f;return C},Z.getCache=function(){var r=this.info;if(r){var d=r.list;if(d){var B=r.cache;return B||(B=r.cache=el(d)),B}}return a}}});var Jl=function(w,Z){for(var C,g=0,M=w.length,e=0,G=M-1;G>=e;)if(g=R(e+(G-e)/2),C=w[g].length-Z,0>C)e=g+1;else{if(!(C>0)){G=g;break}G=g-1}g=G;var f=w[g],l=f.point;return g===M-1||f.length===Z||(l=(new Mn).subVectors(w[g+1].point,l).normalize().multiplyScalar(Z-f.length).add(l)),{point:l,tangent:f.tangent}},el=function(X){for(var I,f,e=[],Y=0,E=0;E<X.length;E++){for(var k=X[E],j=0;j<k.length;j++){I=k[j],f&&(Y+=f.distanceTo(I));var W=new Mn,T=k[j+1];T?W.subVectors(T,I):f?W.subVectors(I,f):W.x=1,W.normalize(),e.push({point:I,length:Y,tangent:W}),f=I}f=null}return e},ce=function(S,C,f,x){f=f||ko;for(var n=[],s=0,E=S.size();E>s;s++){var i=S.get(s);n.push(new Mn(i.x,i.e||0,i.y))}C&&(Qp(C)&&(C=C._as),C.length||(C=null));for(var N,B,P,K,T,R=[],O=0,g=0,w=C?C.length:E;w>g;g++)if(T=C?C[g]:0===g?1:2,1===T)R.push(P=[]),P.push(n[O++]);else if(2===T||5===T)if(K=2===T?n[O++]:P[0],x){var h=C?C[g+1]:w>g+1?2:a;if(2===h||5===h){var _=P[P.length-1],q=2===h?n[O]:P[0],G=(new Mn).subVectors(_,K),c=(new Mn).subVectors(q,K),X=G.length(),D=c.length();if(X&&D)if(x>X/2&&x>D/2)P.push(K);else for(G.multiplyScalar(p(x,X/2)/X).add(K),c.multiplyScalar(p(x,D/2)/D).add(K),N=new ms(G,K,c).getPoints(f),B=0;f>=B;B++)P.push(N[B])}else P.push(K)}else P.push(K);else if(3===T)for(N=new ms(P[P.length-1],n[O++],n[O++]).getPoints(f),B=1;f>=B;B++)P.push(N[B]);else if(4===T)for(N=new ep(P[P.length-1],n[O++],n[O++],n[O++]).getPoints(f),B=1;f>=B;B++)P.push(N[B]);return R},ss=function(f){for(var H,$,C=new Mn,E=[],o=[],h=[],j=0,k=f.length;k>j;j++)H=f[j],$=f[j+1],$?C.subVectors($,H):C.subVectors(H,f[j-1]),E.push(C.normalize().clone());var e,U,G,m,s=new Mn,n=new Mn,_=new Pr,V=1e-4,r=Number.MAX_VALUE,P=E[0],O=o[0]=new Mn,M=h[0]=new Mn;for(U=y(P.x),G=y(P.y),m=y(P.z),r>=U&&(r=U,s.set(1,0,0)),r>=G&&(r=G,s.set(0,1,0)),r>=m&&s.set(0,0,1),n.crossVectors(P,s).normalize(),O.crossVectors(P,n),M.crossVectors(P,O),j=1;k>j;j++)o[j]=o[j-1].clone(),h[j]=h[j-1].clone(),n.crossVectors(E[j-1],E[j]),n.length()>V&&(n.normalize(),e=I(gg(E[j-1].dot(E[j]),-1,1)),o[j].applyMatrix4(_.makeRotationAxis(n,e))),h[j].crossVectors(E[j],o[j]);return{B:h,T:E,N:o}},dh=function(){var u=function(u){for(var L=1;L<arguments.length;L++){var d=arguments[L];u.push(d.x,d.y,d.z)}},B=function(z){for(var u=1;u<arguments.length;u++){var t=arguments[u].uv;z.push(t[0],t[1])}},j=function(p,b,r,x,U){var M=-x*s(U),C=x*N(U);return new Mn(p.x+M*r.x+C*b.x,p.y+M*r.y+C*b.y,p.z+M*r.z+C*b.z)},n=function(b,r,n,N,D,L,E,J){E=E||O;for(var z=[],t=E/D,P=0;D>=P;P++){var V=j(b,r,n,N,P*t+L);z.push(V),J!=a&&(V.uv=[J,P/D])}return z},S=function(l,$,X,v,m,J,W,I,b){b=b||O;var h=$?l.top_vs:l.bottom_vs;if(h)for(var x=$?l.top_uv:l.bottom_uv,n=b/W,Y=0;W>Y;Y++){var H,S;$?(H=Y*n+I,S=(Y+1)*n+I):(S=Y*n+I,H=(Y+1)*n+I),u(h,j(X,v,m,J,H),j(X,v,m,J,S),X),x&&x.push(.5-.5*s(H),.5-.5*N(H),.5-.5*s(S),.5-.5*N(S),.5,.5)}};return function(R,r,V,o,J,H,d,_,g){var e=r.length;if(e>1){var F,N,q,i,Z,z,h,P=ss(r),G=P.T,X=P.N,W=P.B;"flat"===_&&S(R,!0,r[0],W[0],X[0],o,J,H,d),"flat"===g&&S(R,!1,r[e-1],W[e-1],X[e-1],o,J,H,d);var T,j,U=[],Q=b(J/2),A="round"===_,O="round"===g,c=r[0],D=G[0],p=W[0],y=X[0],k=r[e-1],s=G[e-1],x=W[e-1],K=X[e-1];if(A){for(q=1;Q>=q;q++)X.splice(0,0,y),W.splice(0,0,p),G.splice(0,0,D),j=-q/Q*o,r.splice(0,0,D.clone().multiplyScalar(j).add(c)),U[Q-q]=l(o*o-j*j);e+=Q}if(O){for(q=1;Q>=q;q++)X.push(K),W.push(x),G.push(s),j=q/Q*o,r.push(s.clone().multiplyScalar(j).add(k)),U[r.length-1]=l(o*o-j*j);e+=Q}if(R.uv){var v=0,t=0,$=[];for(V&&(v=V),Z=r[0],$[0]=0,q=1;e>q;q++)i=r[q],$[q]=Z.distanceTo(i),Z=i,V||(v+=$[q]);for(T=[],q=0;e>q;q++)t+=$[q],T[q]=v?t/v:0}for(q=0;e>q;q++){if(i=r[q],z=W[q],h=X[q],F=n(i,z,h,U[q]===M?o:U[q],J,H,d,T?T[q]:a),N)for(var L=0;J>L;L++){var f=N[L],C=N[L+1]||N[0],w=F[L],m=F[L+1]||F[0];u(R.vs,C,f,w,w,m,C),R.uv&&B(R.uv,C,f,w,w,m,C)}N=F}}}}();jn(n,{getLineLength:function(h){return h[h.length-1].length},getLineOffset:function(H,P){return Jl(H,P)},getLineCacheInfo:function(T,m,j,V){return el(ce(T,m,j,V))}});var Ij=w.graph3d.RenderLite={},ri=new Array(0),Oh=Ij.Buffer=function(R,p,J,Q){this.gl=R,this.buffer=R.createBuffer(),this.type=p||R.ARRAY_BUFFER,this.drawType=Q||R.STATIC_DRAW,this.data=ri,J&&this.upload(J)};Oh.prototype.upload=function(E,M,D){D||this.bind();var j=this.gl;E=E||this.data,M=M||0,this.data.byteLength>=E.byteLength?j.bufferSubData(this.type,M,E):j.bufferData(this.type,E,this.drawType),this.data=E},Oh.prototype.bind=function(){var W=this.gl;W.bindBuffer(this.type,this.buffer)},Oh.createVertexBuffer=function(d,R,Y){return new Oh(d,d.ARRAY_BUFFER,R,Y)},Oh.createIndexBuffer=function(O,m,C){return new Oh(O,O.ELEMENT_ARRAY_BUFFER,m,C)},Oh.create=function(B,M,c,$){return new Oh(B,M,$)},Oh.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Um=Ij.Shader=function(T,x,j){this.gl=T,this.program=dn(T,x,j),this.attributes=uk(T,this.program);var C=zd(T,this.program);this.uniforms=zc(T,C)};Um.prototype.bind=function(){this.gl.useProgram(this.program)},Um.prototype.destroy=function(){this.gl};var dn=function(U,I,X){var Q=hp(U,U.VERTEX_SHADER,I),n=hp(U,U.FRAGMENT_SHADER,X);U.getShaderParameter(n,U.COMPILE_STATUS)||console.error(U.getError());var l=U.createProgram();return U.attachShader(l,Q),U.attachShader(l,n),U.linkProgram(l),U.getProgramParameter(l,U.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",U.getProgramParameter(l,U.VALIDATE_STATUS)),console.error("gl.getError()",U.getError()),""!==U.getProgramInfoLog(l)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",U.getProgramInfoLog(l)),U.deleteProgram(l),l=null),U.deleteShader(Q),U.deleteShader(n),l},hp=function(i,g,G){var E=i.createShader(g);return i.shaderSource(E,G),i.compileShader(E),i.getShaderParameter(E,i.COMPILE_STATUS)?E:(console.log(i.getShaderInfoLog(E)),null)},zd=function(u,k){for(var n={},L=u.getProgramParameter(k,u.ACTIVE_UNIFORMS),H=0;L>H;H++){var l=u.getActiveUniform(k,H),C=l.name.replace(/\[.*?\]/,""),w=pp(u,l.type);n[C]={type:w,size:l.size,location:u.getUniformLocation(k,C),value:_q(w,l.size)}}return n},uk=function(c,Z){for(var e={},J=c.getProgramParameter(Z,c.ACTIVE_ATTRIBUTES),v=0;J>v;v++){var F=c.getActiveAttrib(Z,v),f=pp(c,F.type);e[F.name]={type:f,size:Bo(f),gl:c,location:c.getAttribLocation(Z,F.name),pointer:Hq}}return e},Hq=function(l,x,Q,r,R){var h=this.gl;h.enableVertexAttribArray(this.location),h.bindBuffer(l.type,l.buffer),h.vertexAttribPointer(this.location,this.size,x||h.FLOAT,Q||!1,r||0,R||0)},Bo=function(B){return vq[B]},vq={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},pp=function(v,S){if(!ij){var b=E.keys(kb);ij={};for(var A=0;A<b.length;++A){var p=b[A];ij[v[p]]=kb[p]}}return ij[S]},ij=null,kb={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},_q=function(C,W){switch(C){case"float":return 0;case"vec2":return new Float32Array(2*W);case"vec3":return new Float32Array(3*W);case"vec4":return new Float32Array(4*W);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*W);case"ivec3":return new Int32Array(3*W);case"ivec4":return new Int32Array(4*W);case"bool":return!1;case"bvec2":return yr(2*W);case"bvec3":return yr(3*W);case"bvec4":return yr(4*W);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},yr=function(z){for(var e=new Array(z),i=0;i<e.length;i++)e[i]=!1;return e},zc=function(G,$){var J={data:{}};J.gl=G;for(var o=E.keys($),l=0;l<o.length;l++){var H=o[l],C=H.split("."),c=C[C.length-1],q=fe(C,J),e=$[H];q.data[c]=e,q.gl=G,E.defineProperty(q,c,{get:Mb(c),set:Dg(c,e)})}return J},Mb=function(Z){var F=cp.replace("%%",Z);return new Function(F)},Dg=function(Z,I){var S,o=Lg.replace(/%%/g,Z);return S=1===I.size?ap[I.type]:Fk[I.type],S&&(o+="\nthis.gl."+S+";"),new Function("value",o)},fe=function(q,C){for(var Y=C,y=0;y<q.length-1;y++){var L=Y[q[y]]||{data:{}};Y[q[y]]=L,Y=L}return Y},cp=["return this.data.%%.value;"].join("\n"),Lg=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),ap={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Fk={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Hn=w.Light=function(){Bh(Hn,this),this.s(vl,P[vl]),this.s(Pj,"sphere"),this.s3(20,20,20)};Cf("Light",uq,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(L,r,$){Hn.superClass.onStyleChanged.apply(this,arguments),L===vl&&this.s("shape3d.color",$)}});var oh=Yh.Graph3dView=function(D,g){var m=this;m._webGLVersion=1,m._attributes=g||n.graph3dViewAttributes,m._25I={},m._view=Ll(1,m);var F=m._canvas=Hd(m._view);F.addEventListener("webglcontextlost",function(Q){Q.preventDefault(),Oj(m),m._26I&&m._doBufferGC(m._26I,!0),m._26I=a,m._1o.texture=a,m._35O=!0},Y),F.addEventListener("webglcontextrestored",function(){m._35O=!1,m.iv()},Y),m._batchIndexMap={},m._batchModelMap={},m._wireframeIndexMap={},m._wireframeModelMap={},m._wireframeIndexMapSwap={},m._wireframeModelMapSwap={},m._polylineIndexMap={},m._polylineIndexMap={},m._polylineIndexMapSwap={},m._polylineIndexMapSwap={},m._8O=[],m._7O=vo(),m._6O=vo(),m._1o=new yj(m),m._30O=new Ap(m),m._31O=new xo(m),m._32O=new cl(m),m._raycaster=new Zm(m),m._highlightHelper=new Yq(m),m._postProcessing=new ln(m),m.vr=new lr(m),m._33Q=!0,m._eye=Vl(n.graph3dViewEye),m._center=Vl(n.graph3dViewCenter),m._up=Vl(n.graph3dViewUp),m._lightChanged=!1,m._59O=[],m._spots=[],m._dirs=[],m._frameId=0,m.overlappingBox=new nj(m),m.dm(D?D:new Pc),m._coreInteractor=new df(this),m.setInteractors([new Hb(m)])},Sr={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},ec=0;Ql("Graph3dView",E,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Tq,Hh,"firstPersonMode",Fm,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Or,Ho,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:n.graph3dViewEditHelperDisabled,_devicePixelRatio:M,_boundaries:M,_moveStep:n.graph3dViewMoveStep,_rotateStep:n.graph3dViewRotateStep,_pannable:n.graph3dViewPannable,_rotatable:n.graph3dViewRotatable,_walkable:n.graph3dViewWalkable,_resettable:n.graph3dViewResettable,_zoomable:n.graph3dViewZoomable,_firstPersonMode:n.graph3dViewFirstPersonMode,_mouseRoamable:n.graph3dViewMouseRoamable,_gridVisible:n.graph3dViewGridVisible,_gridSize:n.graph3dViewGridSize,_gridGap:n.graph3dViewGridGap,_gridColor:n.graph3dViewGridColor,_originAxisVisible:n.graph3dViewOriginAxisVisible,_centerAxisVisible:n.graph3dViewCenterAxisVisible,_axisXColor:n.graph3dViewAxisXColor,_axisYColor:n.graph3dViewAxisYColor,_axisZColor:n.graph3dViewAxisZColor,_ortho:n.graph3dViewOrtho,_orthoWidth:n.graph3dViewOrthoWidth,_fovy:n.graph3dViewFovy,_near:n.graph3dViewNear,_far:n.graph3dViewFar,_headlightColor:n.graph3dViewHeadlightColor,_headlightIntensity:n.graph3dViewHeadlightIntensity,_headlightRange:n.graph3dViewHeadlightRange,_headlightDisabled:n.graph3dViewHeadlightDisabled,_rectSelectable:n.graph3dViewRectSelectable,_rectSelectBackground:n.graph3dViewRectSelectBackground,_editSizeColor:n.graph3dViewEditSizeColor,_autoMakeVisible:Wr,_fogDisabled:n.graph3dViewFogDisabled,_fogColor:n.graph3dViewFogColor,_fogNear:n.graph3dViewFogNear,_fogFar:n.graph3dViewFogFar,_dashDisabled:n.graph3dViewDashDisabled,_batchColorDisabled:n.graph3dViewBatchColorDisabled,_batchBlendDisabled:n.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:n.graph3dViewBatchBrightnessDisabled,setEye:function(L,T,c){1===arguments.length&&(T=L[1],c=L[2],L=L[0]);var x=this._eye;x[0]=L,x[1]=T,x[2]=c,this.fp(Or,a,x)},setCenter:function(n,q,y){1===arguments.length&&(q=n[1],y=n[2],n=n[0]);var L=this._center;L[0]=n,L[1]=q,L[2]=y,this.fp(Ho,a,L)},setUp:function(d,f,h){1===arguments.length&&(f=d[1],h=d[2],d=d[0]);var v=this._up;v[0]=d,v[1]=f,v[2]=h,this.fp("up",a,v)},getDevicePixelRatio:function(){return this._devicePixelRatio||ee},isTransparentMask:function(d){return d.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var l=this,E=l._aspect;return E?E:(E=l.getWidth()/l.getHeight(),E||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(B){var T=this,b=T._dataModel,S=T._selectionModel;b!==B&&(b&&(b.ump(T.handleDataModelPropertyChange,T),b.umm(T.handleDataModelChange,T),b.umd(T.handleDataPropertyChange,T),S||b.sm().ums(T.handleSelectionChange,T)),T._dataModel=B,B.mp(T.handleDataModelPropertyChange,T),B.mm(T.handleDataModelChange,T),B.md(T.handleDataPropertyChange,T),S?S._21I(B):B.sm().ms(T.handleSelectionChange,T),T._postProcessing.handleDataModleChange(b,B),T.invalidateAll(!0),T.invalidateLight(),T.fp(Yo,b,B),T._canvas.style.background=B.getBackground()||"")},handleDataModelPropertyChange:function(j){if("background"===j.property){var H=this._canvas.style.background,n=j.newValue||"";this._canvas.style.background=n,this.fp("canvasBackground",H,n)
}else"envmap"===j.property&&this.iv()},handleDataPropertyChange:function(B){var g=B.data;this.invalidateData(g),Om(g)&&"s:light.type"===B.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(v){var g=this,p=v.property;g.iv(),g._18Q=a,"eye"===p?g._33Q=!0:"devicePixelRatio"===p?g._42(a,g.getDevicePixelRatio()):Sr[p]&&Oj(g)},_5O:function(M){var J=M._22Q();return J?new J(this,M):a},getData3dUI:function(S){var D=this._25I[S._id];return D===M&&(D=this._5O(S),this._25I[S._id]=D),D},invalidateAll:function(c){var j=this;if(c){for(var x in j._25I){var C=j._25I[x];C&&C.dispose()}j._25I={},j.iv(),Wk(j)}else Wk(j),j.dm().each(function(E){j.invalidateData(E)})},invalidateSelection:function(){var G=this;G.sm().each(function(f){G.invalidateData(f)})},invalidateData:function(q){var D=this,x=D.getData3dUI(q);x&&(x.iv(),D.iv()),Wk(D,q)},getShape3dText:function(C){return C.getStyle("shape3d.text")||this.getLabel(C)},invalidateBatch:function(V){var X=this,s=X._batchModelMap,J=s[V],b=[],f={};if(J){J.ds.forEach(function(l){var x=X.getData3dUI(l);x&&x.iv(),delete X._batchIndexMap[l._id],b.push(l._id)}),delete s[V];for(var z,O,i,h,W,P,A,U,x,N=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],e=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],B=0;B<N.length;B++){var l=X[N[B]],d=X[e[B]];for(f={},U=0;U<b.length;U++){var g=d[b[U]];if(g){delete d[b[U]],x=g.batch,z=l[x];var w=g.begin,$=g.size,o=3*w,Q=3*$,u=4*w,_=4*$;for(O=z.ds,i=z.vs,h=z.cs,W=z.ps,P=z.ls,A=g.index,z.invalidate=!0,O[A]=M,A=o;o+Q>A;A++)i[A]=M;for(A=u;u+_>A;A++)h[A]=M;for(A=u;u+_>A;A++)W[A]=M;if(P)for(A=o;o+Q>A;A++)P[A]=M;f[x]=!0}}for(x in f){z=l[x],O=z.ds,i=z.vs,h=z.cs,W=z.ps,P=z.ls;var K=[];for(A=0;A<O.length;A++)O[A]!==M&&K.push(O[A]);if(0===K.length)delete l[x];else{for(z.ds=K,K=[],A=0;A<i.length;A++)i[A]!==M&&K.push(i[A]);for(z.vs=K,K=[],A=0;A<h.length;A++)h[A]!==M&&K.push(h[A]);for(z.cs=K,K=[],A=0;A<W.length;A++)W[A]!==M&&K.push(W[A]);if(z.ps=K,P){for(K=[],A=0;A<P.length;A++)P[A]!==M&&K.push(P[A]);z.ls=K}}}}X.iv()}},handleDataModelChange:function(S){var y=this,G=S.kind,B=S.data;if("add"===G)y.invalidateData(B),wj(B)&&B.getEdgeGroup()&&B.getEdgeGroup().eachSiblingEdge(y.invalidateData,y),Om(B)&&y.invalidateLight();else if(G===Rp){var m=B._id,X=y._25I[m];X&&(X.dispose(),delete y._25I[m],y.iv()),B===y._currentSubGraph&&y.setCurrentSubGraph(a),Wk(y,B),Om(B)&&y.invalidateLight()}else G===Hg&&(y.invalidateAll(!0),y.setCurrentSubGraph(a),Wk(y),y.invalidateLight())},toCanvas:function(H,d,D){var p=this,g=p.getGL();if(p.validate(),H){var A=g.getParameter(g.COLOR_CLEAR_VALUE);Ci(g,H)}p._42(a,1);var T=p.getWidth(),C=p.getHeight(),j=new Uint8Array(4*T*C),s=Hd(),m=s.getContext("2d");g.readPixels(0,0,T,C,g.RGBA,g.UNSIGNED_BYTE,j),En(s,T,C,1);for(var w=m.getImageData(0,0,T,C),f=w.data,y=0;y<f.length;y+=4){var Y=y/4,L=R(Y/T),S=Y-L*T;Y=4*((C-1-L)*T+S),f[Y]=j[y],f[Y+1]=j[y+1],f[Y+2]=j[y+2],f[Y+3]=j[y+3]}if(m.putImageData(w,0,0),H&&Ci(g,A),p._42(a,p.getDevicePixelRatio()),d&&D){var X=Hd(),z=X.getContext("2d");return d=d,D=D,En(X,d,D,1),n.drawImage(z,s,0,0,d,D),X}return s},toDataURL:function(h,Q){var w=this,e=w.getGL();if(w.validate(),h){var f=e.getParameter(e.COLOR_CLEAR_VALUE);Ci(e,h)}w._42(a,1);var z=w._canvas.toDataURL(Q||"image/png",1);return h&&Ci(e,f),w._42(a,w.getDevicePixelRatio()),z},getGL:function(){var N=this._26I;if(N)return this.acquireProgram(),N;var s=this,c=s._canvas,j=s._attributes;try{N=c.getContext("webgl2",j)||c.getContext("experimental-webgl2",j),N&&(s._webGLVersion=2,s._26I=N)}catch(q){}if(!N)try{N=c.getContext("webgl",j)||c.getContext("experimental-webgl",j)}catch(q){throw new Error("WebGL not supported")}s._26I=N,s._2O={},N._emptyTexture=vh(N),N._emptyBlendTexture=vh(N),N._bufPool={},N._id=++ec,s._buffer={vs:dq(N),ns:dq(N),is:dq(N),uv:dq(N),batchColor:dq(N),batchBlend:dq(N),batchBrightness:dq(N),lineDistance:dq(N)},s._1O=pl(N);var L=s._cube={vs:dq(N),ns:dq(N),is:dq(N),uv:dq(N)};return Bl(N,L.vs,an),Bl(N,L.ns,_n),Bl(N,L.uv,Xo),km(N,L.is,id),s.acquireProgram(),N},acquireProgram:function(){var Y=this,R=Y._26I;if(R){var Z=w.Default.getImage(Y.dm().getEnvmap())?!0:!1,u=Y._prg&&Y._prg.envMapFlag?!0:!1;if(!Y._prg||Z!==u){var U=Y._prg=R.createProgram();if(!U)return a;U.envMapFlag=Z;var m=Y._dirs.length,E=Y._spots.length,i=Y._59O.length,O=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];m&&O.push("uDirColor","uDirDirection"),E&&O.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),i&&O.push("uPointColor","uPointRange","uPointPosition"),Ci(R,[0,0,0,0]),R.clearDepth(1),R.enable(R.DEPTH_TEST),R.depthFunc(R.LEQUAL),R.enable(R.BLEND),R.blendFuncSeparate(R.SRC_ALPHA,R.ONE_MINUS_SRC_ALPHA,R.ONE,R.ONE_MINUS_SRC_ALPHA),ih||(ok=fi(ok.substring(0,ok.indexOf("^#"))),rs=fi(rs),ih=!0);var X=["#define MAX_DIR "+m,"#define MAX_SPOT "+E,"#define MAX_POINT "+i,Y._fogDisabled?"":"#define FOG",Y._dashDisabled?"":"#define DASH",Z?"#define USE_ENVMAP":"",Y.isOrtho()?"#define ORTHOGRAPHIC":"",Y._batchColorDisabled?"":"#define BATCHCOLOR",Y._batchBlendDisabled?"":"#define BATCHBLEND",Y._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),B=cb(R,U,R.VERTEX_SHADER,ok.replace("PREFIX",X));R.getShaderParameter(B,R.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",R.getShaderInfoLog(B));var H=cb(R,U,R.FRAGMENT_SHADER,rs.replace("PREFIX",X));R.getShaderParameter(H,R.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",R.getShaderInfoLog(H)),r?O.push("aPosition"):(U.aPosition=0,R.bindAttribLocation(U,0,"aPosition")),R.linkProgram(U),O.forEach(function(r){U[r]=/^u/.test(r)?R.getUniformLocation(U,r):R.getAttribLocation(U,r)}),R.useProgram(U),R.deleteShader(B),R.deleteShader(H)}}},getBrightness:function(P){var L=P.s("brightness"),e=this.isSelected(P)?P.s("select.brightness"):a;return L==a?e:e==a?L:L*e},setHighlightMode:function(k){var I;I="selection"===k?Yq.Mode.Selection:"mouseover"===k?Yq.Mode.MouseOver:Yq.Mode.Disable,this._highlightHelper.mode=I},getHighlightMode:function(){var t=this._highlightHelper.mode;return t===Yq.Mode.Selection?"selection":t===Yq.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(v){var Z=this,J=Z._prg,b=5,W=Z.dm().getEnvmap(),L=w.Default.getImage(W);if(L){if(W!==Z._lastEnvMap){Z._envMapTexture&&v.deleteTexture(Z._envMapTexture);var f=Z._envMapTexture=v.createTexture();v.bindTexture(v.TEXTURE_CUBE_MAP,f),v.texParameteri(v.TEXTURE_CUBE_MAP,v.TEXTURE_MAG_FILTER,v.LINEAR),v.texParameteri(v.TEXTURE_CUBE_MAP,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,L),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,L),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,L),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,L),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,L),v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,L),v.bindTexture(v.TEXTURE_CUBE_MAP,null),Z._lastEnvMap=W}v.activeTexture(v.TEXTURE0+b),v.bindTexture(v.TEXTURE_CUBE_MAP,Z._envMapTexture),v.uniform1i(J.uEnvMap,b)}},getWireframe:function(N){var R=N.s("wf.visible"),C=N.s("wf.width");return R===!0||C>0&&"selected"===R&&this.isSelected(N)?{color:N.s("wf.color"),width:C,"short":N.s("wf.short"),mat:N.s("wf.mat")}:void 0},_transformPointToViewSpace:function(m){var L=[m[0],m[1],m[2]];return jr(L,this._viewMatrix),L},_transformDirectionToViewSpace:function(Q,i){var s=[Q[0],Q[1],Q[2]];jr(s,this._viewMatrix);var c=i?[i[0],i[1],i[2]]:[0,0,0];jr(c,this._viewMatrix);var f=c[0]-s[0],j=c[1]-s[1],e=c[2]-s[2],b=Math.sqrt(f*f+j*j+e*e);return b?[f/b,j/b,e/b]:[f,j,e]},getWireframeGeometry:function($){return $.s("wf.geometry")?{color:$.s("wf.color"),width:$.s("wf.width"),mat:$.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(f){return f.s("body.color")},getMat:function(z){return z.getMat?z.getMat():z.s("mat")},getFaceMat:function(e,B){return e.getFaceMat?e.getFaceMat(B):e.s(B+".mat")},getFaceBlend:function(p,L){return p.s(L+".blend")||p.s("all.blend")},getFaceColor:function(k,F){return k.s(F+".color")||k.s("all.color")},getFaceImage:function(c,Z){return c.s(Z+".image")||c.s("all.image")},getFaceBlendImage:function(h,T){return h.s(T+".blend.image")||h.s("all.blend.image")},getFaceDiscardSelectable:function(Q,S){var r=Q.s(S+".discard.selectable");return r==a?Q.s("all.discard.selectable"):r},getFaceUv:function(o,d){return o.s(d+".uv")||o.s("all.uv")},getFaceUvOffset:function(q,f){return q.s(f+".uv.offset")||q.s("all.uv.offset")},getFaceUvScale:function(D,p){return D.s(p+".uv.scale")||D.s("all.uv.scale")},getFaceLight:function(U,n){var u=U.s(n+".light");return u==a?U.s("all.light"):u},getFaceVisible:function(U,t){var i=U.s(t+".visible");return i==a?U.s("all.visible"):i},getFaceOpacity:function(N,T){var B=N.s(T+".opacity");return B==a?N.s("all.opacity"):B},getFaceTransparent:function(S,k){var C=S.s(k+".transparent");return C==a?S.s("all.transparent"):C},getFaceReverseColor:function(z,y){return z.s(y+".reverse.color")||z.s("all.reverse.color")},getFaceReverseFlip:function(G,e){var k=G.s(e+".reverse.flip");return k==a?G.s("all.reverse.flip"):k},getFaceReverseCull:function(b,X){var U=b.s(X+".reverse.cull");return U==a?b.s("all.reverse.cull"):U},getTextureMap:function(){return this._2O},deleteTexture:function(T){var $=this,y=$._2O[T];y&&(delete $._2O[T],$.getGL().deleteTexture(y))},invalidateShape3dCachedImage:function(Q){var m=this.getData3dUI(Q);m.invalidateCachedTexture(this.getGL())},isInteractive:function(L){return L.s("interactive")},getTexture:function(_,f){if(!_)return a;var O=this,q=O.getGL(),e=O._2O[_];if(!e){var X=hh(_);if(!X)return q._emptyTexture;if(X.uuid||(X.uuid=w.Math.generateUUID()),X.tagName){if(X.dynamic)return pl(q,X,O._1O);e=O._2O[_]=pl(q,X)}else{var D,c=f&&f.s("shape3d.image.cache")&&!O.isInteractive(f),Z=O.vr.isPresenting();if(Z&&(f._textureUpdateFrame===q._renderInfo.frame?c=!0:f._textureUpdateFrame=q._renderInfo.frame),c&&(D=O.getData3dUI(f),e=D.getCachedTexture()),!e){if(c){if(q._renderInfo.cacheTimeCost>n.graph3dMaxVectorCacheTime)return O.redraw(),q._emptyTexture;if(!xh(X,f))return q._emptyTexture}var V,$=f&&f.s("shape3d.fixSizeOnScreen"),d=$?q.NEAREST:q.LINEAR;$||f&&f.s("shape3d.vector.dynamic")&&(D||(D=O.getData3dUI(f)),$=D.getVectorDynamicSize(),$&&(V=O.getDevicePixelRatio(),$[0]*=V,$[1]*=V));var t,r,G=f&&f.s("shape3d.texture.scale")||1;if($?(V||(V=O.getDevicePixelRatio()),t=$[0]>0?$[0]:G*Uh(X,f)*V,r=$[1]>0?$[1]:G*zq(X,f)*V):(t=G*Uh(X,f),r=G*zq(X,f)),t>=1&&r>=1){var v=0;c&&(v=Date.now());var g=sm(t,r);if(!D&&f&&(D=O.getData3dUI(f)),D&&D.interactiveInfo){var u=_;"object"==typeof u&&(u=u.uuid||(u.uuid=w.Math.generateUUID()));var P=D.interactiveInfo[u]={};g.interactiveInfo=P.bodyInfo={compInfos:[],matrix:new Jm,rect:{x:0,y:0,width:t,height:r}}}Ad(g,X,0,0,t,r,f,O),g.interactiveInfo&&(g.interactiveInfo=null),g.restore(),c||Z?(e=pl(q,wo,null,d),D.setCachedTexture(e),q._renderInfo.cacheTimeCost+=Date.now()-v,wo=null):e=pl(q,wo,O._1O,d)}}}}return e},redraw:function(){this.iv()},validateImpl:function(){var Z=this;if(Z._lightChanged){Z._lightChanged=!1;var V=[],t=[],G=[];Z.dm().each(function(P){if(Om(P)){var W=P.s("light.type");W===yn?V.push(P):W===ys?t.push(P):W===iq&&G.push(P)}}),(V.length!==Z._59O.length||t.length!==Z._spots.length||G.length!==Z._dirs.length)&&Oj(Z),Z._59O=V,Z._spots=t,Z._dirs=G}Z._42(),Z._1o.iv()},getRenderInfo:function(){var Z=this.getGL();return Z?Z._renderInfo:void 0},getDebugTip:function(){var E=this,z=E.getRenderInfo();if(z){var t=E.getGL()._validBufCount||0,e="Draw Calls: "+z.calls+"<br/>"+"Vertices: "+z.vertices+"<br/>"+"Faces: "+z.faces+"<br/>"+"Lines: "+z.lines+"<br/>"+"Buffer Count: "+t;return E.vr.isPresenting()&&(e+="<br/>VR fps: "+E.vr.getFps()),e}},_42:function(J,W){var z=this;if(!z._35O&&(!zf||kj(zf))){var c,d;J&&(J instanceof uq?d=J:c=J);var $=z._canvas,o=z.getGL(),i=z._prg;if(o){var f=z.getWidth(),E=z.getHeight();W?J||En($,f,E,W):(W=z.getDevicePixelRatio(),J||f===$.clientWidth&&E===$.clientHeight||En($,f,E,W)),o.clear(o.COLOR_BUFFER_BIT),z.drawFilter||(o._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:J?z._frameId:++z._frameId,cacheTimeCost:0});var C=function(){if(z.overlappingBox.clear(),z._81O=a,o.clear(o.DEPTH_BUFFER_BIT),Ik(o,i.uBrightness,1),Ik(o,i.uOpacity,1),Ik(o,i.uPartOpacity,1),o._picking=!!J,Ik(o,i.uPick,!!J),Ik(o,i.uTexture,!1),Ik(o,i.uBlendTexture,!1),Ik(o,i.uAlphaTest,P.alphaTest),Ik(o,i.uTransparent,!1),Ik(o,i.uFix,!1),Ik(o,i.uBatchColor,!1),Ik(o,i.uBatchBlend,!1),Ik(o,i.uBatchBrightness,!1),Ik(o,i.uReflectivity,z._envmapReflectivity||.5),Ik(o,i.uCameraPosition,z.getEye()),Ik(o,i.uPMatrix,z._projectMatrix=Jo(z)),Ik(o,i.uViewMatrix,Ir(z,z._7O)),z.bindEnvMap(o),z._viewMatrix=dm(z._7O),J||(Im(z,o,i),z._fogDisabled||(Ik(o,i.uFogColor,z._fogColor),Ik(o,i.uFogNear,z._fogNear),Ik(o,i.uFogFar,z._fogFar))),Wd(o,i.aPosition),Wd(o,i.aNormal),Sm(o,i.aUv),Sm(o,i.aBatchColor),Sm(o,i.aBatchBlend),Sm(o,i.aBatchBrightness),Sm(o,i.aLineDistance),d){var G=o.getParameter(o.COLOR_CLEAR_VALUE);o.clearColor(0,0,0,0),o.disable(o.BLEND),Sm(o,i.aNormal),Bl(o,z._cube.vs,a,i.aPosition),km(o,z._cube.is),Nd(d,z,Ul,0),Nd(d,z,xr,6),Nd(d,z,Te,12),Nd(d,z,Th,18),Nd(d,z,rr,24),Nd(d,z,tf,30),Wd(o,i.aNormal),Ci(o,G)}else if(c){c.value=2;var G=o.getParameter(o.COLOR_CLEAR_VALUE);o.clearColor(0,0,0,0),o.disable(o.BLEND),z._95I(o,i,c),Nl(z,c),wd(z,z._polylineModelMap,c),wd(z,z._wireframeModelMap,c),Ik(o,i.uTransparent,!0),z._95I(o,i,c,!0),Nl(z,c,!0),wd(z,z._polylineModelMap,c,!0),wd(z,z._wireframeModelMap,c,!0),Ik(o,i.uTransparent,!1),o.clear(o.DEPTH_BUFFER_BIT),z._swapLineMap(),z._95I(o,i,c,!1,!0),wd(z,z._polylineModelMap,c),wd(z,z._wireframeModelMap,c),z._swapLineMap(),z._swapLineMap(),z._95I(o,i,c,!1,!0),wd(z,z._polylineModelMap,c),wd(z,z._wireframeModelMap,c),Ik(o,i.uTransparent,!0),z._95I(o,i,c,!0,!0),wd(z,z._polylineModelMap,c,!0),wd(z,z._wireframeModelMap,c,!0),Ik(o,i.uTransparent,!1),z._swapLineMap(),o.disable(o.DEPTH_TEST),z.drawFilter||z._30O._42(o,i,c),o.enable(o.DEPTH_TEST),Ci(o,G)}else o.disable(o.BLEND),z.drawSky(o,i),z._31O._42(o,i),z._95I(o,i),Nl(z),wd(z,z._polylineModelMap),wd(z,z._wireframeModelMap),o.enable(o.BLEND),Ik(o,i.uTransparent,!0),o.depthMask(!1),z._95I(o,i,a,!0),Nl(z,a,!0),wd(z,z._polylineModelMap,a,!0),wd(z,z._wireframeModelMap,a,!0),o.depthMask(!0),Ik(o,i.uTransparent,!1),o.clear(o.DEPTH_BUFFER_BIT),z._swapLineMap(),o.disable(o.BLEND),z._95I(o,i,a,!1,!0),wd(z,z._polylineModelMap),wd(z,z._wireframeModelMap),o.enable(o.BLEND),Ik(o,i.uTransparent,!0),o.depthMask(!1),z._95I(o,i,a,!0,!0),wd(z,z._polylineModelMap,a,!0),wd(z,z._wireframeModelMap,a,!0),o.depthMask(!0),Ik(o,i.uTransparent,!1),z._swapLineMap(),o.disable(o.DEPTH_TEST),o.disable(o.BLEND),z._32O._42(o,i),z._30O._42(o,i),z._highlightHelper._42(o,i),o.enable(o.DEPTH_TEST);Bl(o,a),km(o,a)},k=!1,A=f*W,K=E*W,B=z.vr;B.enable&&B._42(o,A,K,C)&&(k=!0);var V=z.envRenderer;V&&V.enable&&V._42(o,A,K,C)&&(k=!0);var t=z._postProcessing;t._42(o,A,K,C,J)&&(k=!0),k||(z.setViewport(o,0,0,f*W,E*W),C()),z._33Q=!1,z.drawFilter||z.countFrame(),z._doBufferGC(o)}}},enablePostProcessing:function(Z,z){return this._postProcessing.enableModule(Z,z)},getPostProcessingModule:function(K){return this._postProcessing.getModule(K)},setViewport:function(f,t,l,J,i){this._viewport=[t,l,J,i],f.viewport(t,l,J,i)},getViewport:function(){return this._viewport},setBufferGCInterval:function(n){this._bufferGCInterval=n},_doBufferGC:function(a,P){var V,D,Q=a._bufPool,e=0,R=0,v=a._renderInfo.frame,A=this._bufferGCInterval||10;for(V in Q)e++,D=Q[V],D&&(P||v-D._fid>A?(a.deleteBuffer(D._buf),D._buf=null,Q[V]=null):R++);if(e/2>R&&e>128){var C={};for(V in Q)Q[V]&&(C[V]=Q[V]);a._bufPool=C}a._validBufCount=R},_swapLineMap:function(){var g=this;m=g._polylineModelMap,g._polylineModelMap=g._polylineModelMapSwap,g._polylineModelMapSwap=m,m=g._wireframeModelMap,g._wireframeModelMap=g._wireframeModelMapSwap,g._wireframeModelMapSwap=m,m=g._polylineIndexMap,g._polylineIndexMap=g._polylineIndexMapSwap,g._polylineIndexMapSwap=m,m=g._wireframeIndexMap,g._wireframeIndexMap=g._wireframeIndexMapSwap,g._wireframeIndexMapSwap=m},_updateSkyBox:function(r){if(this._skyBox&&r){var a=r.property,o=!1,n=this._skyBox;if("eye"===a||"forceUpdate"===a){var N=this._eye;n.p3(N[0],N[1],N[2]),o=!0}if("near"===a||"far"===a||"forceUpdate"===a){var s=this._near,t=this._far,m=n.getFinalScale3d();if(m[0]/=2,m[1]/=2,m[2]/=2,m[0]<=s||m[0]>=t||m[1]<=s||m[1]>=t||m[2]<=s||m[2]>=t){var k=2*s*t/(s+t),E=Math.min(m[0],m[1],m[2]),B=k/E,C=n.getScale3d();n.setScale3d(C[0]*B,C[1]*B,C[2]*B),o=!0}}o&&this.invalidateData(n)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(M){var y=this._skyBox;y&&(this._skyBoxStyleMap&&y.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&y.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&y.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=M,this.ump(this._updateSkyBox,this),M&&(M.dm()&&M.dm().remove(M),this._skyBoxStyleMap=w.Default.clone(M.getStyleMap()),this._skyBoxAnchor3d=M.getAnchor3d(),M.setAnchor3d(.5,.5,.5),this._skyBoxP3=M.p3().slice(0),M.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",y,M)},drawSky:function(x,n,b){var e=this,N=e._skyBox;if(N){var J=e._headlightIntensity,k=fj(e._headlightColor),n=e._prg;1!==J&&(k=[k[0]*J,k[1]*J,k[2]*J]),Ik(x,n.uHeadlightColor,[k[0],k[1],k[2],1]);var w=e.getData3dUI(N);if(w){var v,Z=e.isOrtho();Z&&(v=e._projectMatrix,e.setOrtho(!1),Ik(x,n.uPMatrix,e._projectMatrix=Jo(e))),w._42(x,n,b,function(){return!0}),Z&&(e.setOrtho(!0),Ik(x,n.uPMatrix,e._projectMatrix=v))}x.clear(x.DEPTH_BUFFER_BIT),Ik(x,n.uHeadlightColor,[k[0],k[1],k[2],e._headlightDisabled?1:0])}},_95I:function(G,g,q,k,W){function O(T){if(!!T.s("shape3d.alwaysOnTop")==!!W&&F.isVisible(T)&&(!d||V)){if(!q&&F.isTransparentMask(T))return;var J=F.getData3dUI(T);J&&J._42(G,g,q,X)}}var F=this,X=function(L){return k?L:!L};F.sky&&G.clear(G.DEPTH_BUFFER_BIT);var h=F.drawFilter;h?F.dm().each(function($){h($)||O($)}):F.dm().each(function(M){O(M)})},getLogicalPoint:function(C){return Ao(C,this._canvas)},isRectOverlapping:function(v){var N=this.getData3dUI(v);return N._rectOverlapping},getHitFaceInfo:function(t){t.target&&(t=this.lp(t));var $=this.getDataInfoAt(t);if($){var h=this._1o.face($.data,bm(t.x,t.y));if(h)return{data:$.data,face:h}}return a},unproject:function(s,I){var j=this,w=j.getWidth(),t=j.getHeight(),m=s.target?j.lp(s):s,p=m.x-w/2,a=m.y-t/2,R=2*(p/w),h=2*(-1*a/t);I=I||0;var f=vo(),_=Jo(j),H=Ir(j);yb(f,_,H),vj(f);var u=sk([R,h,I,1],f);return[u[0]/u[3],u[1]/u[3],u[2]/u[3]]},getDataAt:function(N){var n=this.getDataInfoAt(N);return n?n.data:a},getDataInfoAt:function(Q,y){return Q.target&&(Q=this.lp(Q)),this._1o.get(bm(Q.x,Q.y,y),!0)},getDatasInRect:function(W){return this._1o.get(W)},setEditable:function(U){var G=this,X=G._editable;G._editable=U,this.fp(_g,X,U)},isEditable:function(N){var g=this;return g._editable?wc(N)?N.s("3d.editable")?g._editableFunc?g._editableFunc(N):!0:!1:!1:!1},isSelectable:function(d){return d.s("3d.selectable")&&this.sm().isSelectable(d)},isMovable:function(h){var t=this;return wj(h)&&h.getStyle(dg)!==uf?!1:h.s("3d.movable")?t._movableFunc?t._movableFunc(h):!0:!1},isSizeEditable:function(Q){return wc(Q)?this._sizeEditableFunc?this._sizeEditableFunc(Q):!0:!1},isRotationEditable:function(h){return wc(h)&&h.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(h):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(R){this.setZoom(qq,R)},zoomOut:function(r){this.setZoom(1/qq,r)},setZoom:function(C,w){if(1!==C){var n=this;if(n._ortho)return n.setOrthoZoom(C,w),void 0;n._14o&&n._14o.stop(!0);var H=1/C,b=n._eye,k=n._center,N=k[0]+(b[0]-k[0])*H-b[0],m=k[1]+(b[1]-k[1])*H-b[1],F=k[2]+(b[2]-k[2])*H-b[2];if(!(sh(b,k)<n._moveStep&&1>H)){if(w=nh(w)){var $=Vl(b);return w.action=function(x){n.fi({kind:n._zooming?"betweenZoom":"beginZoom"}),n._zooming=1,b[0]=$[0]+N*x,b[1]=$[1]+m*x,b[2]=$[2]+F*x,n.fp(Or,a,b)},w._37o=function(){delete n._14o,delete n._zooming,n.fi({kind:"endZoom"}),n.onZoomEnded()},n._14o=nq(w)}b[0]+=N,b[1]+=m,b[2]+=F,n.fp(Or,a,b)}}},setOrthoZoom:function(H,U){if(1!==H){var a=this;a._14o&&a._14o.stop(!0);var Q=a._orthoWidth,I=Q/H-Q;if(!(Q<a._moveStep&&H>1))return(U=nh(U))?(U.action=function(x){a.fi({kind:a._zooming?"betweenZoom":"beginZoom"}),a._zooming=1,a.setOrthoWidth(Q+I*x)},U._37o=function(){delete a._14o,delete a._zooming,a.fi({kind:"endZoom"}),a.onZoomEnded()},a._14o=nq(U)):(a.setOrthoWidth(Q/H),void 0)}},getPositionInfo:function(Q){var J=this,F=J._eye,r=J._center,D=J.getAspect(),N=Q?Ng(Eh(r,F,!0),Eh(Q,F)):sh(F,r);if(J._ortho){var l=J._orthoWidth;return{length:N,height:l/D,width:l}}var c=2*X(J._fovy/2)*N;return{length:N,height:c,width:c*D}},getCenterInfo:function(){var $=this;return $._81O||($._81O=$.getPositionInfo()),Vl($._81O)},rotate:function(R,A,S,U){var t=this;if(R||A){U==a&&(U=t._firstPersonMode),t._88O&&t._88O.stop(!0);var F=t._center,P=t._eye,D=t.getCenterInfo().length,Q=U?F:P,O=U?P:F,X=Eh(Q,O),B=x(X[0],X[2]),I=x(l(X[0]*X[0]+X[2]*X[2]),X[1]),p=U?Ho:Or;return U&&(A=-A),(S=nh(S))?(S.action=function(T){t.fi({kind:t._rotating?"betweenRotate":"beginRotate"}),t._rotating=1;var E=B+R*T,c=I+A*T;c=El(c),X[0]=D*N(c)*N(E),X[1]=D*s(c),X[2]=D*N(c)*s(E),Q[0]=O[0]+X[0],Q[1]=O[1]+X[1],Q[2]=O[2]+X[2],t.fp(p,a,Q)},S._37o=function(){delete t._88O,delete t._rotating,t.fi({kind:"endRotate"}),t.onRotateEnded()},t._88O=nq(S)):(B+=R,I+=A,I=El(I),X[0]=D*N(I)*N(B),X[1]=D*s(I),X[2]=D*N(I)*s(B),Q[0]=O[0]+X[0],Q[1]=O[1]+X[1],Q[2]=O[2]+X[2],t.fp(p,a,Q),void 0)}},pan:function(Q,$,S,M){if(Q||$){var V=this;M==a&&(M=V._firstPersonMode),V._89O&&V._89O.stop(!0);var m=Ir(V),L=[m[0]*Q,m[4]*Q,m[8]*Q],v=[m[1]*$,m[5]*$,m[9]*$],Y=L[0]+v[0],U=L[1]+v[1],B=L[2]+v[2],P=V._center,e=V._eye;if(M){var b=Pm(V.getBoundaries(),e[0],e[2],e[0]+Y,e[2]+B,l(Y*Y+B*B));Y=b[0],B=b[1]}if(S=nh(S)){var f=Vl(e),z=Vl(P);return S.action=function(X){V.fi({kind:V._panning?"betweenPan":"beginPan"}),V._panning=1,P[0]=z[0]+Y*X,P[1]=z[1]+U*X,P[2]=z[2]+B*X,e[0]=f[0]+Y*X,e[1]=f[1]+U*X,e[2]=f[2]+B*X,V.fp(Or,a,e),V.fp(Ho,a,P)},S._37o=function(){delete V._89O,delete V._panning,V.fi({kind:"endPan"}),V.onPanEnded()},V._89O=nq(S)}P[0]+=Y,P[1]+=U,P[2]+=B,e[0]+=Y,e[1]+=U,e[2]+=B,V.fp(Or,a,e),V.fp(Ho,a,P)}},walk:function(Q,C,x){if(Q){var o=this;x==a&&(x=o._firstPersonMode),o._90O&&o._90O.stop(!0);var s=o._center,h=o._eye,k=Eh(s,h,!0);if(x){var I=Pm(o.getBoundaries(),h[0],h[2],h[0]+k[0]*Q,h[2]+k[2]*Q,y(Q));if(Q=sh(I),!Q)return;k=[I[0]/Q,0,I[1]/Q]}if(C=nh(C)){var R=Vl(h),S=Vl(s);return C.action=function(V){o.fi({kind:o._walking?"betweenWalk":"beginWalk"}),o._walking=1;var U=Q*V;h[0]=R[0]+k[0]*U,h[1]=R[1]+k[1]*U,h[2]=R[2]+k[2]*U,s[0]=S[0]+k[0]*U,s[1]=S[1]+k[1]*U,s[2]=S[2]+k[2]*U,o.fp(Or,a,h),o.fp(Ho,a,s)},C._37o=function(){delete o._90O,delete o._walking,o.fi({kind:"endWalk"}),o.onWalkEnded()},o._90O=nq(C)}h[0]+=k[0]*Q,h[1]+=k[1]*Q,h[2]+=k[2]*Q,s[0]+=k[0]*Q,s[1]+=k[1]*Q,s[2]+=k[2]*Q,o.fp(Or,a,h),o.fp(Ho,a,s)}},handleScroll:function(O,H){O.preventDefault();var L=this,t=L._moveStep,r=L.getDataInfoAt(O);if(r){var x=r.data;if(x&&L.isInteractive(x)){var w=L.intersectObject(O,x);if(w){var D=w.part,N=hh(x.s(D+".image")||x.s("shape3d."+D+".image")||x.s("all.image")||x.s("shape3d.image"));if(N&&Io(N.scrollable,x,L))return}}}L.isFirstPersonMode()?L.isPannable()&&L.pan(0,H>0?t:-t):L.isZoomable()&&L.setZoom(0>H?1/xc:xc)},handlePinch:function(I,B){this.isZoomable()&&this.setZoom(B>I?1/Vj:Vj)},reset:function(){this.setCenter(n.graph3dViewCenter),this.setEye(n.graph3dViewEye),this.setUp(n.graph3dViewUp)},moveSelection:function(o,X,d){var F=this;F.dm().beginTransaction(),Rc(this.sm().toSelection(this.isMovable,this),o,X,d),F.dm().endTransaction()},getMoveMode:function(D,f){var S=f.s("3d.move.mode");if(S)return S;var I="88",m="89",b="90";return Gq(D)||jj[I]&&jj[m]&&jj[b]?"xyz":jj[I]&&jj[m]?"xy":jj[I]&&jj[b]?"xz":jj[m]&&jj[b]?"yz":jj[I]?"x":jj[m]?"y":jj[b]?"z":"xz"},handleTick:function(){var x=this,d=!1,h=x._moveStep,E=h,N=!1,I=!0,G=x._rotateStep*(I?-1:1);if(x.isWalkable()||(E=0),x.isPannable()||(h=0),x.isRotatable()||(G=0),x._32Q){var f=(xd()-x._32Q)/50;E*=f,h*=f,G*=f}x._31Q&&(Oi(x._31Q),delete x._31Q,delete x._32Q),vi()&&(d=!0,x.pan(-h,0,N,I)),ho()&&(d=!0,x.pan(h,0,N,I)),zp()&&(d=!0,Gq()?x.pan(0,h,N,I):x.walk(E,N,I)),$d()&&(d=!0,Gq()?x.pan(0,-h,N,I):x.walk(-E,N,I)),Wn()&&(d=!0,x.rotate(-G,0,N,I)),Vd()&&(d=!0,x.rotate(G,0,N,I)),zb()&&(d=!0,x.rotate(0,-G/2,N,I)),Ym()&&(d=!0,x.rotate(0,G/2,N,I)),d&&(x._32Q=xd(),x._31Q=nd(x.handleTick,x))},handleKeyDown:function(R){var n=this;!Zl(R)&&Cj[R.keyCode]?n.handleTick():qi(R)?n.selectAll():xg(R)?n.handleDelete(R):Lh(R)&&this.isResettable()&&n.reset()},checkDoubleClickOnNote:function(S,y,R){var t=this;if(R===Jd){if(y.s("note.toggleable"))return y.s(Ag,!y.s(Ag)),t.fi({kind:"toggleNote",event:S,data:y,part:R}),!0}else if(R===Re&&y.s("note2.toggleable"))return y.s(Ve,!y.s(Ve)),t.fi({kind:"toggleNote2",event:S,data:y,part:R}),!0;return!1},checkDoubleClickOnRotation:function(y,v,o){return o===oe?(v.setRotationX(0),!0):o===Hi?(v.setRotationY(0),!0):o===Kr?(v.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(T){var J=this;if(J.isOrtho())return J.getWidth()/J.getOrthoWidth();var U=J.getCenter(),M=J.getHeight(),N=J.getEye(),W=[U[0]-N[0],U[1]-N[1],U[2]-N[2]],t=[T[0]-N[0],T[1]-N[1],T[2]-N[2]],Y=Math.sqrt(W[0]*W[0]+W[1]*W[1]+W[2]*W[2]),g=1/Math.tan(J.getFovy()/2);return M*Y*g/(t[0]*W[0]+t[1]*W[1]+t[2]*W[2])},inViewSpace:function(G){var z,R=this,A=R._transformPointToViewSpace(G),l=R.getAspect(),K=R.getNear(),o=R.getFar();return-A[2]<K||-A[2]>o?!1:R.isOrtho()?(z=R.getOrthoWidth()/2,Math.abs(A[0])<=z&&Math.abs(A[1]*l)<=z):(z=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2])*Math.tan(R.getFovy()/2),Math.abs(A[1]<=z)&&Math.abs(A[0])<=z*l)},getPVMatrix:function(){var W=this,y=W.getWidth()/2,z=W.getHeight()/2,o=W._18Q;return o&&o._wh===y/z||(o=Jo(W),W._18Q=yb(o,o,Ir(W)),W._18Q._wh=y/z),o},toViewPosition:function(i){var E=this,M=E.getWidth()/2,J=E.getHeight()/2,W=E.getPVMatrix();return i=sk([i[0],i[1],i[2],1],W),{x:M+M*i[0]/i[3],y:J-J*i[1]/i[3],z:i[2]/i[3]}},getHitPosition:function(V,D,p){var W=this,B=W.getWidth(),Z=W.getHeight(),h=V.target?W.lp(V):V,U=h.x-B/2,k=h.y-Z/2,Y=W.getCenterInfo(),o=Ir(W);D=D?D:[0,0,0],p=p?p:[0,1,0],U=U/B*Y.width,k=-1*k/Z*Y.height;var K=[o[0]*U,o[4]*U,o[8]*U],O=[o[1]*k,o[5]*k,o[9]*k],w=[K[0]+O[0],K[1]+O[1],K[2]+O[2]],C=W.getCenter(),T=Co(W,D,p,[w[0]+C[0],w[1]+C[1],w[2]+C[2]]);return T?T:[0,0,0]},intersectObject:function(d,V){return this._raycaster.intersectObject(d,V)},intersectObjects:function(V,W,k){return this._raycaster.intersectObjects(V,W,k)},getLineLength:function(u){this.validate();var E=this.getData3dUI(u);if(E&&E.getCache){var z=E.getCache();if(z)return z[z.length-1].length}return 0},getLineOffset:function(V,D){var A=this.getData3dUI(V);if(A&&A.getCache){var u=A.getCache();if(u){var C=Jl(u,D),R=V.r3();if(0===R[0]&&0===R[1]&&0===R[2])return C;var Y=new pe(V.p3()),O=new pe(C.point).sub(Y),z=new pe(C.tangent).add(O),c=(new ps).setFromEuler(new uc(R,V.getRotationMode(),!0));return O.applyQuaternion(c),z.applyQuaternion(c),{point:O.add(Y),tangent:z.sub(O).normalize()}}}return a},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(o,Y,t){var P=this,T=P.getEye();T=[T[0],T[1],T[2]];var r=P.getCenter();if(r=[r[0],r[1],r[2]],o||(o=T),Y||(Y=r),P._flyAnim&&P._flyAnim.stop(!0),t=nh(t),!t)return P.setEye(o[0],o[1],o[2]),P.setCenter(Y[0],Y[1],Y[2]),delete P._flyAnim,!0;var q=[o[0]-T[0],o[1]-T[1],o[2]-T[2]],$=[Y[0]-r[0],Y[1]-r[1],Y[2]-r[2]];return t.action=function(Q){P.setCenter(r[0]+$[0]*Q,r[1]+$[1]*Q,r[2]+$[2]*Q),P.setEye(T[0]+q[0]*Q,T[1]+q[1]*Q,T[2]+q[2]*Q)},t._37o=function(){delete P._flyAnim},P._flyAnim=nq(t)},flyTo:function(){function j(N,i,A){if(A instanceof w.Node){f.fromArray(Rl(A,i.getMat(A)));var O=A.getAnchor3d();N.push((new pe).set(0-O.x,0-O.y,0-O.z).applyMatrix4(f)),N.push((new pe).set(0-O.x,0-O.y,1-O.z).applyMatrix4(f)),N.push((new pe).set(0-O.x,1-O.y,0-O.z).applyMatrix4(f)),N.push((new pe).set(0-O.x,1-O.y,1-O.z).applyMatrix4(f)),N.push((new pe).set(1-O.x,0-O.y,0-O.z).applyMatrix4(f)),N.push((new pe).set(1-O.x,0-O.y,1-O.z).applyMatrix4(f)),N.push((new pe).set(1-O.x,1-O.y,0-O.z).applyMatrix4(f)),N.push((new pe).set(1-O.x,1-O.y,1-O.z).applyMatrix4(f))}}var B=new pe,K=new pe,z=new pe,b=new pe,f=new yo,U=new w.Math.Quaternion,R=new uc;return function(c,N,O){var h=this;if(O!==M)N={animation:N,ratio:O};else{var m=typeof N;("boolean"===m||"object"===m&&N.duration)&&(N={animation:N})}N=N||{},B.fromArray(h.getEye()),K.fromArray(h.getCenter());var k,s,V=[],v=N.center,P=N.distance===M;if(v&&z.fromArray(v),c instanceof w.Node)v||z.fromArray(c.p3()),P&&(j(V,h,c),k=V.length);else{if(c||(c=h.dm().getDatas()),!c.length)return;if((P||!v)&&(V=[],c.forEach(function(Z){j(V,h,Z)}),k=V.length),!k)return;if(!v){for(z.set(0,0,0),s=0;k>s;s++)z.add(V[s]);z.multiplyScalar(1/k)}}if(h.setCenter(z.x,z.y,z.z),b.subVectors(B,K),N.direction||N.worldDirection){!N.worldDirection&&c instanceof w.Node?U.setFromEuler(R.set(c.r3(),c.getRotationMode(),!0)):U.set(0,0,0,1);var Q=b.length();b.fromArray(N.worldDirection||N.direction).applyQuaternion(U).setLength(Q)}if(P){for(var d,n,a,r,i,W=h.getNear(),J=10,O=N.ratio||.8;J--;){for(h._eye[0]=b.x+z.x,h._eye[1]=b.y+z.y,h._eye[2]=b.z+z.z,d=Jo(h),yb(d,d,Ir(h)),r=!0,i=-1/0,s=0;k>s;s++){if(a=V[s],n=sk([a.x,a.y,a.z,1],d),n[3]<W&&J){b.multiplyScalar(2),r=!1;break}i=Math.max(i,Math.max(Math.abs(n[0]),Math.abs(n[1]))/O-n[3])}if(r)break}b.setLength(i+b.length()).add(z)}else b.setLength(N.distance).add(z);h._flyAnim&&h._flyAnim.stop(!0);var D=nh(N.animation);if(D){h.setEye(B.x,B.y,B.z),h.setCenter(K.x,K.y,K.z);var L=(new pe).subVectors(b,B),Y=(new pe).subVectors(z,K),A=new pe,f=new pe;return D.action=function(u){A.copy(B).addScaledVector(L,u),f.copy(K).addScaledVector(Y,u),h.setCenter(f.x,f.y,f.z),h.setEye(A.x,A.y,A.z)},D._37o=function(){delete h._flyAnim},{lastEye:B,lastCenter:K,eye:b,center:z,animation:h._flyAnim=nq(D)}}return h.setEye(b.x,b.y,b.z),delete h._flyAnim,{lastEye:B,lastCenter:K,eye:b,center:z}}}(),getBoundingBox:function(){function G(G,Q,C){X.fromArray(Rl(C,Q.getMat(C)));var V=C.getAnchor3d();G.push((new pe).set(0-V.x,0-V.y,0-V.z).applyMatrix4(X)),G.push((new pe).set(0-V.x,0-V.y,1-V.z).applyMatrix4(X)),G.push((new pe).set(0-V.x,1-V.y,0-V.z).applyMatrix4(X)),G.push((new pe).set(0-V.x,1-V.y,1-V.z).applyMatrix4(X)),G.push((new pe).set(1-V.x,0-V.y,0-V.z).applyMatrix4(X)),G.push((new pe).set(1-V.x,0-V.y,1-V.z).applyMatrix4(X)),G.push((new pe).set(1-V.x,1-V.y,0-V.z).applyMatrix4(X)),G.push((new pe).set(1-V.x,1-V.y,1-V.z).applyMatrix4(X))}var X=new yo;return function(l){if(l=l||this.sm().getSelection(),l instanceof w.Node&&(l=[l]),0===l.length)return a;
var f=[];l.forEach(function(e){G(f,this,e)},this);var q=[1/0,1/0,1/0],t=[-1/0,-1/0,-1/0];return f.forEach(function(Q){q[0]=Math.min(Q.x,q[0]),q[1]=Math.min(Q.y,q[1]),q[2]=Math.min(Q.z,q[2]),t[0]=Math.max(Q.x,t[0]),t[1]=Math.max(Q.y,t[1]),t[2]=Math.max(Q.z,t[2])}),{min:q,max:t}}}()}),Yh.RenderEnv=function(T){this.gv=T,this.enable=!1},E.defineProperties(Yh.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(t){this._debugOn=t,this.capture&&this.capture()}}}),E.assign(Yh.RenderEnv.prototype,{renderEnvToCube:function(p,q,m,v){var _=this,U=_.gv;if(!p||!q||!m)return _.enable=!1,_._42=null,void 0;_.enable=!0;var o=Math.floor(v/p*q),V=U.getGL(),w=_._renderTargets;w?w.length<m&&(w=_._renderTargets=w.concat(new Array(m-w.length))):w=_._renderTargets=new Array(m);for(var n=0;m>n;n++)w[n]?w[n].setSize(V,v,o):w[n]=new Yh.RenderTarget(U,V,v,o);var s=!1;_.capture=function(){s=!0,U._42(),s=!1};var d=new pe,b=new pe,W=new pe,Q=new pe,D=(new pe).setY(0),t=2*Math.PI/m,u=p/2/Math.tan(Math.PI/m),S=2*Math.atan2(q/2,u),h=p/q;_._42=function(P,H,$,g){var z=_._debugOn;if(!s&&!z)return!1;d.copy(U.getEye()),Q.copy(U.getCenter()).sub(d);var p=Math.atan2(Q.z,Q.x),q=U.getNear(),A=U.getFovy(),k=U.getAspect();b.copy(U.getCenter());for(var B,f=0;m>f;f++)if(B=w[f],D.setZ(Math.cos(p)).setX(Math.sin(p)).multiplyScalar(u),p-=t,W.addVectors(d,D),U.setNear(u),U.setCenter([W.x,W.y,W.z]),U.setFovy(S),U.setAspect(h),z){var M=Math.round(H/m);P.viewport(M*f,0,M,$),g()}else Oe(P,B.frame),P.viewport(0,0,B.width,B.height),P.clear(P.COLOR_BUFFER_BIT),g(),Iq(P),B.assureTexture();return U.setNear(q),U.setCenter([b.x,b.y,b.z]),U.setFovy(A),U.setAspect(k),!0},_.capture()},getTextureInfo:function(v){var $=this._renderTargets;if(!$)return null;var q=this._renderTargets[v];return q?{index:v,texture:q.texture,textureName:q.uuid}:null}}),E.assign(Yh.Graph3dView.prototype,{renderEnvToCube:function(A,w,k,F){var e=this;e.envRenderer||(e.envRenderer=new Yh.RenderEnv(e)),e.envRenderer.renderEnvToCube(A,w,k,F)}}),Yh.RenderTarget=function(Z,q,d,_,S){var m=this;S=S||{},S.samples=S.samples&&S.samples>1&&2===Z._webGLVersion?S.samples:M,m.options=S,m.uuid=w.Math.generateUUID(),m.gv=Z,m.init(Z,q,S),m.setSize(q,d,_)},E.assign(Yh.RenderTarget.prototype,{bind:function(V){Oe(V,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(R){Iq(R),this.options.samples&&(R.bindFramebuffer(R.READ_FRAMEBUFFER,this._MSAAFbo),R.bindFramebuffer(R.DRAW_FRAMEBUFFER,this.frame),R.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,R.COLOR_BUFFER_BIT,R.NEAREST))},init:function(S,v,a){var $=this,e=$.texture=v.createTexture();v.activeTexture(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,e),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE);var t=a.samples,U=t?v.NEAREST:v.LINEAR;v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,a.minFilter||U),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,a.magFilter||U),v.bindTexture(v.TEXTURE_2D,null),$.render=v.createRenderbuffer(),$.frame=v.createFramebuffer(),t&&($._MSAAFbo=v.createFramebuffer(),$._MSAARbO=v.createRenderbuffer()),S._2O[$.uuid]=e},assureTexture:function(){var V=this,Y=V.uuid,e=V.gv._2O;e[Y]||(e[Y]=V.texture)},setSize:function(s,S,A){var x=this;if(S&&A&&(x.width!==S||x.height!==A)){var N=s.RGBA,J=s.TEXTURE_2D,j=s.RENDERBUFFER,m=s.FRAMEBUFFER,h=x.options.samples;Ib(s,x.texture),s.texImage2D(J,0,N,S,A,0,N,s.UNSIGNED_BYTE,a),s.bindRenderbuffer(j,x.render),h?s.renderbufferStorageMultisample(j,h,s.DEPTH_COMPONENT16,S,A):s.renderbufferStorage(j,s.DEPTH_COMPONENT16,S,A),Oe(s,x.frame),s.framebufferTexture2D(m,s.COLOR_ATTACHMENT0,J,x.texture,0),h||s.framebufferRenderbuffer(m,s.DEPTH_ATTACHMENT,j,x.render),Iq(s),h&&(s.bindRenderbuffer(s.RENDERBUFFER,x._MSAARbO),s.renderbufferStorageMultisample(s.RENDERBUFFER,h,s.RGBA8,S,A),Oe(s,x._MSAAFbo),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,x._MSAARbO),s.framebufferRenderbuffer(m,s.DEPTH_ATTACHMENT,j,x.render),Iq(s)),Ib(s,a),s.bindRenderbuffer(j,a),x.width=S,x.height=A}},toCanvas:function(){var F=this,f=F.gv.getGL();Oe(f,F.frame);var l=F.width,y=F.height,D=new Uint8Array(4*l*y);f.readPixels(0,0,l,y,f.RGBA,f.UNSIGNED_BYTE,D),Iq(f);var i=j.createElement("canvas");i.width=l,i.height=y;var X=i.getContext("2d"),R=X.createImageData(l,y);return R.data.set(D),X.putImageData(R,0,0),i}});var zm=Yh.Interactor=function(J){this.gv=J};Ql("Interactor",E,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Hb=Yh.DefaultInteractor=function(s){Bh(Hb,this,[s])};Ql("DefaultInteractor",zm,{handle_contextmenu:function(e){gh(e)},handle_mousewheel:function(b){this.gv.handleScroll(b,b.wheelDelta/40)},handle_DOMMouseScroll:function(q){2===q.axis&&this.gv.handleScroll(q,-q.detail)},handle_keydown:function(l){this.gv.handleKeyDown(l)},handle_mousedown:function(O){this.handle_touchstart(O)},handle_touchstart:function(B){gh(B);var s=this,c=s.gv,z=Qk(B),K=c.getDataInfoAt(B),i=K?K.data:a,n=K?K.part:a,G=c.sm(),f=Qd(B),v=wr(B);c.setFocus(B)&&(s._62O=a,s._57I=a,i?Zl(B)?G.co(i)?G.rs(i):G.as(i):G.co(i)||G.ss(i):z&&(Zl(B)?c.isRectSelectable()&&(s._62O=kd):s._57I=Ac(B)),s._31Q&&(Oi(s._31Q),delete s._31Q,delete s._32Q),s._62O||(c.isFirstPersonMode()&&(Gq(B)||Zf(B)||v>2?s._62O="pan":c.isMouseRoamable()||jl?(s._62O="roaming",s.foward=f&&Qk(B),s._32Q=xd(),s._31Q=nd(s.tick,s)):z||(s._62O="roaming")),s._62O||(z&&f&&wq[n]?(s._62O=n,s.p3=i.p3()):z&&f&&wc(i)&&c.isSelected(i)?c.isMovable(i)?(s._62O="move",s.p3=i.p3(),s.movedata=i):c.isInteractive(i)&&(s._62O="none"):jl&&(v>2?s._62O="pan":2===v&&(s.dist=Gn(B),s._62O="pinch")))),s.point=c.lp(B),fg(s,B),Ph(B)?c.handleDoubleClick(B,i,n):c.handleClick(B,i,n))},tick:function(){var V=this,I=V.gv,G=I._moveStep;V.point&&I.isWalkable()&&(V._32Q&&(G*=(xd()-V._32Q)/50),I.walk(V.foward?G:-G),V._32Q=xd(),V._31Q=nd(V.tick,V))},handle_mouseup:function(U){this.handle_touchend(U)},handle_touchend:function(L){var O=this._57I;O&&(sh(O,Ac(L))<=1&&this.gv.sm().cs(),this._57I=a)},handleWindowMouseMove:function(m){this.handleWindowTouchMove(m)},handleWindowTouchMove:function(j){var i,N,Y=this,w=Y.gv,q=Y._62O,b=Y.point,J=w.dm(),Q=w.lp(j),I=Q.x-b.x,f=Q.y-b.y,A=w.getWidth(),$=w.getHeight();if(A&&$){var p=-O*I/A,K=-O*f/$;if("roaming"===q)Y.rotate(j,p/2,K/2);else if(q===oe||q===Hi||q===Kr)w._86O||J.beginTransaction(),w.fi({kind:w._86O?"betweenEditRotation":"beginEditRotation",event:j}),w._86O=1,w.sm().each(function(I){if(wc(I)&&w.isRotationEditable(I)){var R=y(p)>y(K)?p:K;q===oe?I.setRotationX(I.getRotationX()+R):q===Hi?I.setRotationY(I.getRotationY()+R):q===Kr&&I.setRotationZ(I.getRotationZ()+R)}});else if("move"===q||wq[q]){q===he||q===Ic||q===Qo?(w._87O||J.beginTransaction(),w.fi({kind:w._87O?"betweenEditScale":"beginEditScale",event:j}),w._87O=1):(w._moving||J.beginTransaction(),w.fi({kind:w._moving?"betweenMove":"beginMove",event:j}),w._moving=1);var z,W=Y.p3,F=w.getPositionInfo(W),V=Ir(w);z=q===Sc?"x":q===Tl?"y":q===Xq?"z":q===he?"sx":q===Ic?"sy":q===Qo?"sz":w.getMoveMode(j,Y.movedata),I=I/A*F.width,f=-1*f/$*F.height;var u,R,r=[V[0]*I,V[4]*I,V[8]*I],x=[V[1]*f,V[5]*f,V[9]*f],Z=r[0]+x[0],l=r[1]+x[1],c=r[2]+x[2],D=[W[0]+Z,W[1]+l,W[2]+c],a=Eh(w.getEye(),D,!0);if("xyz"===z?(u=D,w.moveSelection(Z,l,c)):"xz"===z?(u=Co(w,W,[0,1,0],D),u&&w.moveSelection(u[0]-W[0],0,u[2]-W[2])):"xy"===z?(u=Co(w,W,[0,0,1],D),u&&w.moveSelection(u[0]-W[0],u[1]-W[1],0)):"yz"===z?(u=Co(w,W,[1,0,0],D),u&&w.moveSelection(0,u[1]-W[1],u[2]-W[2])):"x"===z||"sx"===z?(a[0]=0,u=Co(w,W,a,D),u&&(R=u[0]-W[0],"x"===z?w.moveSelection(R,0,0):w.sm().each(function(L){wc(L)&&w.isSizeEditable(L)&&(i=L.getScaleX()+R/100,N=i/L.getScaleX(),L.setScaleX(i),Gq(j)&&(L.setScaleY(L.getScaleY()*N),L.setScaleTall(L.getScaleTall()*N)))}))):"y"===z||"sy"===z?(a[1]=0,u=Co(w,W,a,D),u&&(R=u[1]-W[1],"y"===z?w.moveSelection(0,R,0):w.sm().each(function(O){wc(O)&&w.isSizeEditable(O)&&(i=O.getScaleTall()+R/100,N=i/O.getScaleTall(),O.setScaleTall(i),Gq(j)&&(O.setScaleY(O.getScaleY()*N),O.setScaleX(O.getScaleX()*N)))}))):("z"===z||"sz"===z)&&(a[2]=0,u=Co(w,W,a,D),u&&(R=u[2]-W[2],"z"===z?w.moveSelection(0,0,R):w.sm().each(function(W){wc(W)&&w.isSizeEditable(W)&&(i=W.getScaleY()+R/100,N=i/W.getScaleY(),W.setScaleY(i),Gq(j)&&(W.setScaleX(W.getScaleX()*N),W.setScaleTall(W.getScaleTall()*N)))}))),!u)return;Y.p3=u}else if(q===kd){var H=Y.div;H||(H=Y.div=lj(),eg(Y.getView(),H),H.op=b,H.style.background=w.getRectSelectBackground()),w.fi({kind:w._rectSelecting?"betweenRectSelect":"beginRectSelect",event:j}),w._rectSelecting=1,H.rect=rh(H.op,Q),Fl(H,H.rect)}else if("pinch"===q&&2===wr(j)){w.fi({kind:w._pinching?"betweenPinch":"beginPinch",event:j}),w._pinching=1;var R=Gn(j);w.handlePinch(R,Y.dist),Y.dist=R}else"pan"===q||Gq(j)||Zf(j)?Y.pan(j,I,f):"none"===q||w.isFirstPersonMode()||(Qk(j)?Y.rotate(j,p,K):(Y.pan(j,I,0),w.isWalkable()&&(w.fi({kind:w._walking?"betweenWalk":"beginWalk",event:j}),w._walking=1,w.walk(f/w.getHeight()*w.getCenterInfo().height))));Y.point=Q}},pan:function(I,L,Y){var X=this.gv;if(X.isPannable()){var G=X.getWidth(),W=X.getHeight();if(!G||!W)return;var K=X.getCenterInfo(),A=L/G*K.width,B=-1*Y/W*K.height;X.fi({kind:X._panning?"betweenPan":"beginPan",event:I}),X._panning=1,X.pan(-A,-B)}},rotate:function(F,q,M){var p=this.gv;p.isRotatable()&&(p.fi({kind:p._rotating?"betweenRotate":"beginRotate",event:F}),p._rotating=1,p.rotate(q,M))},handleWindowMouseUp:function($){this.handleWindowTouchEnd($)},handleWindowTouchEnd:function(n){var w=this,h=w.gv,E=h.dm(),B=w.div;if(B){var Y=h.getDatasInRect(B.rect);if(!Y.isEmpty()){var u=h.sm(),t=u.toSelection();Y.each(function(Z){u.co(Z)?t.remove(Z):t.add(Z)}),u.ss(t)}Bm(B)}h._moving&&(delete h._moving,h.fi({kind:"endMove",event:n}),h.onMoveEnded(),E.endTransaction()),h._panning&&(delete h._panning,h.fi({kind:"endPan",event:n}),h.onPanEnded()),h._rotating&&(delete h._rotating,h.fi({kind:"endRotate",event:n}),h.onRotateEnded()),h._86O&&(delete h._86O,h.fi({kind:"endEditRotation",event:n}),E.endTransaction()),h._87O&&(delete h._87O,h.fi({kind:"endEditScale",event:n}),E.endTransaction()),h._pinching&&(delete h._pinching,h.fi({kind:"endPinch",event:n}),h.onPinchEnded()),h._rectSelecting&&(delete h._rectSelecting,h.fi({kind:"endRectSelect",event:n}),h.onRectSelectEnded()),h._walking&&(delete h._walking,h.fi({kind:"endWalk",event:n}),h.onWalkEnded()),w.dist=w.point=w._62O=w.p3=w.movedata=w.div=w._57I=w._32Q=w._31Q=w.foward=a}});var Rf=Yh.MapInteractor=function(a){Bh(Rf,this,[a]),this._minPhi=0,this._maxPhi=5*W/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};Ql("MapInteractor",zm,{handle_contextmenu:function(o){gh(o)},handle_mousewheel:function(X){this.gv.handleScroll(X,X.wheelDelta/40)},handle_DOMMouseScroll:function(Z){2===Z.axis&&this.gv.handleScroll(Z,-Z.detail)},handle_keydown:function(F){this.gv.handleKeyDown(F)},handle_mousedown:function(k){this.handle_touchstart(k)},handle_touchstart:function(i){gh(i);var F=this,q=F.gv;if(q.setFocus(i)){q.lp(i);var v=q.getDataInfoAt(i),m=v?v.data:a,h=v?v.part:a;if(!m||!q.isInteractive(m)){var P=F.editing={point:q.lp(i)};jl?P.touch=!0:(P.touch=!1,P.clickLeft=Qk(i),P.pan=Zf(i)?!0:"left"===this.panButton===P.clickLeft),fg(F,i)}Ph(i)?q.handleDoubleClick(i,m,h):q.handleClick(i,m,h)}},handle_mouseup:function(C){this.handle_touchend(C)},handle_touchend:function(){},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(i){var o=this,R=o.gv,m=o.editing;if(m){var V=R.lp(i),f=m.point,L=V.x-f.x,T=V.y-f.y;if(!m.moved){if(Math.abs(L)<o.threshold&&Math.abs(T)<o.threshold&&!(i.touches&&i.touches.length>1))return;m.moved=!0}if(m.point=V,m.touch){var r=i.touches.length;if(2!==r)o.pan(i,L,T);else{if(1>=r)return;var c=i.touches,B={x:c[0].clientX,y:c[0].clientY},S={x:c[1].clientX,y:c[1].clientY},Q={x:S.x-B.x,y:S.y-B.y},k=m.lastCenter,I=Math.atan2(Q.y,Q.x),g=m.theta,X=0;g==a?g=m.theta=I:(X=I-g,m.thetaStarted||Math.abs(X)>o.touchRotateThreshold?(m.thetaStarted=!0,m.theta=I):X=0);var F=W*(B.y+S.y)/2/R.getHeight(),M=m.phi,s=0;M==a?M=m.phi=F:(s=F-M,m.phiStarted||Math.abs(s)>o.touchRotateThreshold?(m.phiStarted=!0,m.phi=F):s=0);var J,H=Math.sqrt(Q.x*Q.x+Q.y*Q.y),p=m.vlen;if(p){var d=B.x-k.x,x=B.y-k.y,$=S.x-k.x,E=S.y-k.y,q=Math.sqrt(d*d+x*x),U=Math.sqrt($*$+E*E),y=p/2,K=o._sign2(q-y),l=o._sign2(U-y);0>K*l||0===K&&0===l?(J=1,m.vlen=H):(J||(J=H/p),m.scaleStarted||Math.abs(J-1)>o.touchScaleThreshold?(m.vlen=H,m.scaleStarted=!0):J=1)}else p=m.vlen=H,J=1;1!==J&&R.setZoom(J),(s||X)&&o.rotate(i,X,-s),m.lastCenter={x:(S.x+B.x)/2,y:(S.y+B.y)/2}}}else if(m.pan)o.pan(i,L,T);else{var e=R.getWidth(),Y=R.getHeight();if(!e||!Y)return;var h=-O*L/e,t=-O*T/Y;o.rotate(i,h,t)}}},_sign2:function(B){return Math.abs(B)<this._touchScaleCheckAccuracy?0:B>0?1:-1},handleWindowMouseUp:function(E){this.handleWindowTouchEnd(E)},handleWindowTouchEnd:function(U){var N=this,e=N.editing;if(N.editing=null,e){var w=N.gv;if(!e.moved&&e.clickLeft){var q=w.getDataAt(U);q?w.sm().setSelection([q]):w.sm().clearSelection()}else w._panning=null,w._rotating=null,w.fi({kind:e.pan?"endPan":"endRotate",event:U})}},pan:function(c,X,E){var h=this,A=h.gv;if(A.isPannable()){var O=A.getWidth(),M=A.getHeight();if(O&&M){var x=A.getCenterInfo(),w=-X/O*x.width,o=1*E/M*x.height;A.fi({kind:A._panning?"betweenPan":"beginPan",event:c}),A._panning=1;var r=h.keepHorizon,k=h.editing.touch;if((k&&c.touches&&c.touches.length>1||!k&&Gq(c))&&(r=!r),!r)return A.pan(w,o);if(w||o){var y=Ir(A),g=[y[0]*w,y[4]*w,y[8]*w],z=[y[1],0,y[9]],q=Math.sqrt(z[0]*z[0]+z[2]*z[2]);q&&(z=[z[0]/q*o,0,z[2]/q*o]);var l=g[0]+z[0],K=g[1]+z[1],j=g[2]+z[2],p=A._center,H=A._eye;p[0]+=l,p[1]+=K,p[2]+=j,H[0]+=l,H[1]+=K,H[2]+=j,A.fp(Or,a,H),A.fp(Ho,a,p)}}}},rotate:function(I,o,k){var t=this,D=t.gv;if(D.isRotatable()){var G=D._center,q=D._eye,i=Eh(q,G),F=x(l(i[0]*i[0]+i[2]*i[2]),i[1]),A=F+k;A=Math.max(t.minPhi,Math.min(t.maxPhi,A)),k=A-F,D.fi({kind:D._rotating?"betweenRotate":"beginRotate",event:I}),D._rotating=1,D.rotate(o,k)}}}),E.defineProperties(Rf.prototype,{panButton:{get:function(){return this._panButton},set:function(i){this._panButton=i}},minPhi:{get:function(){return this._minPhi},set:function(y){this._minPhi=y}},maxPhi:{get:function(){return this._maxPhi},set:function(e){this._maxPhi=e}},keepHorizon:{get:function(){return this._keepHorizon},set:function(o){this._keepHorizon=o}},threshold:{get:function(){return this._threshold},set:function(i){this._threshold=i}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(X){this._touchScaleThreshold=X}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(X){this._touchRotateThreshold=X}}});var yj=function(I){this.gv=I};Qr(yj,E,{_iv:!0,iv:function(){this._iv=!0},face:function(v,o){var X=this,K=X.gv.getGL();if(!K||!wc(v))return a;var J=o.x,e=o.width,C=o.height,b=X.height-o.y-C,$=R(e/2),p=new Uint8Array(4*e*C),G=0;for(X.iv(),X.validate(v),Oe(K,X.frame),K.readPixels(J,b,e,C,K.RGBA,K.UNSIGNED_BYTE,p),Iq(K),X.iv();$>=G;G++)for(var H=$-G,w=$+G,M=H;w>=M;M++)for(var O=H;w>=O;O++)if(M===H||M===w||O===H||O===w){var c=Cn.m[p[4*(M*e+O)]];if(c)return c}},get:function(y,s){this.validate();var U=this,e=U.gv.getGL();if(!e)return a;var q,X,O=y.x,$=y.width,C=y.height,n=U.height-y.y-C,H=R($/2),D=new Uint8Array(4*$*C),i=0,b=D.length,T=s?a:new Yp,j=s?a:{};if(Oe(e,U.frame),e.readPixels(O,n,$,C,e.RGBA,e.UNSIGNED_BYTE,D),Iq(e),s){for(;H>=i;i++)for(var v=H-i,g=H+i,k=v;g>=k;k++)for(var V=v;g>=V;V++)if((k===v||k===g||V===v||V===g)&&(q=U.info(D,4*(k*$+V))))return q}else for(;b>i;i+=4)q=U.info(D,i),q&&(X=q.data,j[X._id]||(T.add(X),j[X._id]=X));return T},info:function(k,B){return this.colorMap[(k[B]<<16)+(k[B+1]<<8)+k[B+2]+((127&k[B+3])<<24)]},validate:function(H){var Y=this,J=Y.gv,I=J.getGL();if(I){var N=J.getWidth(),q=J.getHeight(),G=I.RGBA,s=I.TEXTURE_2D,P=I.RENDERBUFFER,$=I.FRAMEBUFFER;Y.texture||(Y.texture=pl(I),Y.render=I.createRenderbuffer(),Y.frame=I.createFramebuffer()),(Y.width!==N||Y.height!==q)&&(Ib(I,Y.texture),I.texImage2D(s,0,G,N,q,0,G,I.UNSIGNED_BYTE,a),Eg(I,I.TEXTURE_MIN_FILTER,I.LINEAR),I.bindRenderbuffer(P,Y.render),I.renderbufferStorage(P,I.DEPTH_COMPONENT16,N,q),Oe(I,Y.frame),I.framebufferTexture2D($,I.COLOR_ATTACHMENT0,s,Y.texture,0),I.framebufferRenderbuffer($,I.DEPTH_ATTACHMENT,P,Y.render),Ib(I,a),I.bindRenderbuffer(P,a),Iq(I),Y.width=N,Y.height=q),Y._iv&&(Y._iv=!1,Oe(I,Y.frame),J._42(H||(Y.colorMap={}),1),Iq(I))}}});var xo=function(l){this.gv=l};Qr(xo,E,{gap:0,size:0,_42:function(n,J){var k=this,H=k.gv,r=H._gridGap,g=H._gridSize;if(H._gridVisible){if(k.gap!==r||k.size!==g){for(var E=[],S=H._gridSize/2,A=r*S,C=0;2*S+1>C;C++){var w=6*C,P=6*(2*S+1)+w;E[w]=-A,E[w+1]=0,E[w+2]=-A+C*r,E[w+3]=A,E[w+4]=0,E[w+5]=-A+C*r,E[P]=-A+C*r,E[P+1]=0,E[P+2]=-A,E[P+3]=-A+C*r,E[P+4]=0,E[P+5]=A}k.vs=new go(E),k.gap=r,k.size=g}Sh(H),pq(n,J),mr(n),yp(n,J,1,H._gridColor,H._buffer.vs,k.vs),Np(n,0,k.vs.length/3,n.LINES),Kb(n),Pf(n,J)}else k.vs=k.gap=k.size=a}});var cl=function(m){this.gv=m};Qr(cl,E,{_42:function(Y,$){var z=this.gv,v=z._buffer.vs,m=z._axisXColor,g=z._axisYColor,l=z._axisZColor,e=z._originAxisVisible,o=z._centerAxisVisible;if(e||o){var F=r?Y.TRIANGLES:Y.TRIANGLE_FAN,n=Y.LINES;if(Sh(z),pq(Y,$),mr(Y),e){var i=z.getCenterInfo(),f=p(i.width,i.height)/5,d=.8*f,A=.05*f;yp(Y,$,1.5,m,v,new go([0,0,0,f,0,0,d,A,0,d,0,A,d,-A,0,d,0,-A,d,A,0,0,0,0,0,f,0,A,d,0,0,d,A,-A,d,0,0,d,-A,A,d,0,0,0,0,0,0,f,A,0,d,0,A,d,-A,0,d,0,-A,d,A,0,d])),Np(Y,0,2,n),Np(Y,1,6,F),yp(Y,$,a,g),Np(Y,7,2,n),Np(Y,8,6,F),yp(Y,$,a,l),Np(Y,14,2,n),Np(Y,15,6,F)}if(o){var M=z._center,G=M[0],Z=M[1],W=M[2],i=z.getPositionInfo(M);f=p(i.width,i.height)/20,yp(Y,$,1.5,m,v,new go([G,Z,W,G+f,Z,W,G,Z,W,G,Z+f,W,G,Z,W,G,Z,W+f])),Np(Y,0,2,n),yp(Y,$,a,g),Np(Y,2,2,n),yp(Y,$,a,l),Np(Y,4,2,n)}Kb(Y),Pf(Y,$)}}});var Yq=function(E){this.gv=E,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Yq.Mode.Disable};Yq.Mode={Disable:0,Selection:1,MouseOver:2},Qr(Yq,E,{onMouseOver:function(A){n.preventDefault(A);var Z=this.gv.getDataAt(A);Z!==this.mouseOverData&&(this.mouseOverData=Z,this.gv.iv())},setFetchTargetFunc:function(G){this.fetchTargetFunc=G},_42:function(q,x){var r,i=this,U=i._mode;if(U!==Yq.Mode.Disable&&(U===Yq.Mode.Selection?r=i.gv.sm().getSelection().toArray(function(u){return u.s("highlight.visible")}):U===Yq.Mode.MouseOver&&i.mouseOverData&&i.mouseOverData.s("highlight.visible")&&(r=[i.mouseOverData]),i.fetchTargetFunc&&(r=i.fetchTargetFunc(r)),r&&r.length)){var g=i.gv,o=g.vr.isPresenting(),Y=g.getWidth();if(o){var t=g.getWidth;Y/=2,g.getWidth=function(){return Y};var $=g.getViewport()}var l,T=g.getDevicePixelRatio(),C=Y*T,A=g.getHeight()*T;(l=i._renderTarget)?l.setSize(q,C,A):i._renderTarget=l=new Yh.RenderTarget(g,q,C,A),Oe(q,l.frame),g.drawFilter=function(h){return r.indexOf(h)<0?!0:void 0},g._42({}),g.drawFilter=null,Iq(q),o&&(g.getWidth=t,g.setViewport(q,$[0],$[1],$[2],$[3])),i.shader||(i.shader=new Ij.Shader(q,Rq.vs,Rq.fs));var L=i.shader;if(i.shader.bind(),q.enable(q.BLEND),q.activeTexture(q.TEXTURE0+0),q.bindTexture(q.TEXTURE_2D,l.texture),L.uniforms.image=0,L.uniforms.textureSize=[C,A],L.uniforms.edgeWidth=P["highlight.width"],i.highlightColor!==P["highlight.color"]){var D=Mj(i.highlightColor=P["highlight.color"]);i.highlightColorData=[D[0]/255,D[1]/255,D[2]/255,D[3]/255]}L.uniforms.edgeColor=i.highlightColorData,i.ibuffer?(i.ibuffer.upload(),i.vbuffer.upload()):(i.ibuffer=Ij.Buffer.createIndexBuffer(q,new Uint16Array([0,2,1,1,2,3])),i.vbuffer=Ij.Buffer.createVertexBuffer(q,new Float32Array([0,0,1,0,0,1,1,1]))),L.attributes.pos.pointer(i.vbuffer),q.drawElements(q.TRIANGLES,6,q.UNSIGNED_SHORT,0),q.disable(q.BLEND),q.bindTexture(q.TEXTURE_2D,null),q.useProgram(x)}}}),E.defineProperties(Yq.prototype,{mode:{get:function(){return this._mode},set:function(P){var J=this._mode;P!==J&&(this._mode=P,P===Yq.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):J===Yq.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var Rq={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Ap=function(s){this.gv=s},Sc="edit_tx",Tl="edit_ty",Xq="edit_tz",oe="edit_rx",Hi="edit_ry",Kr="edit_rz",he="edit_sx",Ic="edit_sy",Qo="edit_sz",wq={};wq[Sc]=1,wq[Tl]=1,wq[Xq]=1,wq[oe]=1,wq[Hi]=1,wq[Kr]=1,wq[he]=1,wq[Ic]=1,wq[Qo]=1,Qr(Ap,E,{_42:function(z,J,u){var m=this,s=m.gv,$=s.sm().ld();if($&&s.isEditable($)&&!s.isEditHelperDisabled()&&wc($)&&(!s.isFirstPersonMode()||!s.isMouseRoamable()&&!jl)){Sh(s);var U,S,I=s.isMovable($),V=s.isRotationEditable($),a=s.isSizeEditable($),i=s._axisXColor,l=s._axisYColor,R=s._axisZColor,t=s._editSizeColor,b=$.p3(),Y=sh(s.getEye(),b)/10,v=Y/(u?5:10),B=.7*Y,H=.4*B,D=b[0],L=b[1],h=b[2];U=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],I&&m._17O(z,J,$,u,Sc,i,U,[D,L-v,h,D+B,L-v,h,D+B,L,h,D+B,L,h,D,L,h,D,L-v,h,D,L-v,h+v,D+B,L-v,h+v,D+B,L-v,h,D+B,L-v,h,D,L-v,h,D,L-v,h+v]),S=D+B,a&&m._17O(z,J,$,u,he,t,U,[S,L-v,h,S+H,L-v,h,S+H,L,h,S+H,L,h,S,L,h,S,L-v,h,S,L-v,h+v,S+H,L-v,h+v,S+H,L-v,h,S+H,L-v,h,S,L-v,h,S,L-v,h+v]),S+=H,V&&m._17O(z,J,$,u,oe,i,U,[S,L-v,h,S+H,L-v,h,S+H,L,h,S+H,L,h,S,L,h,S,L-v,h,S,L-v,h+v,S+H,L-v,h+v,S+H,L-v,h,S+H,L-v,h,S,L-v,h,S,L-v,h+v]),U=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],I&&m._17O(z,J,$,u,Tl,l,U,[D,L,h,D,L+B,h,D-v,L+B,h,D-v,L+B,h,D-v,L,h,D,L,h,D,L,h,D,L,h-v,D,L+B,h-v,D,L+B,h-v,D,L+B,h,D,L,h]),S=L+B,a&&m._17O(z,J,$,u,Ic,t,U,[D,S,h,D,S+H,h,D-v,S+H,h,D-v,S+H,h,D-v,S,h,D,S,h,D,S,h,D,S,h-v,D,S+H,h-v,D,S+H,h-v,D,S+H,h,D,S,h]),S+=H,V&&m._17O(z,J,$,u,Hi,l,U,[D,S,h,D,S+H,h,D-v,S+H,h,D-v,S+H,h,D-v,S,h,D,S,h,D,S,h,D,S,h-v,D,S+H,h-v,D,S+H,h-v,D,S+H,h,D,S,h]),U=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],I&&m._17O(z,J,$,u,Xq,R,U,[D,L,h,D,L,h+B,D,L-v,h+B,D,L-v,h+B,D,L-v,h,D,L,h,D,L-v,h,D-v,L-v,h,D-v,L-v,h+B,D-v,L-v,h+B,D,L-v,h+B,D,L-v,h]),S=h+B,a&&m._17O(z,J,$,u,Qo,t,U,[D,L,S,D,L,S+H,D,L-v,S+H,D,L-v,S+H,D,L-v,S,D,L,S,D,L-v,S,D-v,L-v,S,D-v,L-v,S+H,D-v,L-v,S+H,D,L-v,S+H,D,L-v,S]),S+=H,V&&m._17O(z,J,$,u,Kr,R,U,[D,L,S,D,L,S+H,D,L-v,S+H,D,L-v,S+H,D,L-v,S,D,L,S,D,L-v,S,D-v,L-v,S,D-v,L-v,S+H,D-v,L-v,S+H,D,L-v,S+H,D,L-v,S])}},_17O:function(Q,P,G,D,v,d,I,z){var e=this.gv._buffer;wp(Q,P,D,!0,G,v),Vf(Q,P,a,!0,a,!0,a,!1),Ik(Q,P.uDiffuse,d),Bl(Q,e.vs,new go(z),P.aPosition),Bl(Q,e.ns,new go(I),P.aNormal),mr(Q),Np(Q,0,12),Kb(Q),Ub(Q,P)}});var Zm=w.Raycaster=function(n){this.gv=n,this.maxTriangleTest=1/0};Cf("Raycaster",E,{intersect:function(T){var g=this,P=g.gv,s=P.getDataAt(T);return s?g.intersectObject(T,s):null},intersectObjects:function(d,T,i){var k,u,g,p,K=this,S=1/0,l=d.origin||(new pe).fromArray(K.gv.getEye()),W=K.maxTriangleTest,R=[];return T.forEach(function(h){i&&i(h)===!1||h.s("intersect")!==!1&&R.push(h)}),R.sort(function(d,G){return l.distanceToSquared2(d.p3())-l.distanceToSquared2(G.p3())}),K.countTriangles=0,R.forEach(function(j){K.countTriangles>W||(k=K.intersectObject(d,j),k&&(u=l.distanceToSquared(k.world),S>u&&(g=j,p=k,S=u)))}),K.countTriangles=0,{data:g,intersect:p}},intersectObject:function(D,_){if(D instanceof hj)return this._intersectObjectImpl(D,_);var y,N,m=this,x=m.gv;N=x.unproject(D);var I=x.getEye();x.isOrtho()?(y=Eh(x.getCenter(),I),y[0]+=y[0],y[1]+=y[1],y[2]+=y[2]):y=I,y=new pe(y);var h=new pe(N).sub(y).normalize(),n=new w.Math.Ray(y,h);return m._intersectObjectImpl(n,_)},_intersectObjectImpl:function(){function Z(){var S=new pe;return S.subVectors(P,R),f.subVectors(u,R),S.cross(f).normalize(),S}function v(N,C,U,v,B,A,$){return Yg.barycoordFromPoint(N,C,U,v,i),B.multiplyScalar(i.x),A.multiplyScalar(i.y),$.multiplyScalar(i.z),B.add(A).add($),B.clone()}var T=new yo,O=new yo,b=new hj,$=new pe,G=new pe,r=new pe,d=new pe,B=new pe,u=new pe,R=new pe,P=new pe,A=new Xd,X=new Xd,Y=new Xd,f=new pe,V={vs:an,is:id,uv:Xo},i=new pe;return function(l,U){var o=this.gv.getData3dUI(U),K=U.mat||o.mat;if(K){T.fromArray(K),O.getInverse(T),b.copy(l).applyMatrix4(O);var s,D,C="body",E=o.shapeModel;if(E||(E=xm(o)),E||(U instanceof w.Node&&!(U instanceof w.Shape)?(s=!0,E=V):(D=!0,E=[o.left,o.front,o.right,o.back,o.top,o.bottom])),!E)return console.log("Can not find shape model."),null;uo(E)||(E=[E]);var N,x,y,F,M,f,g,m,J,H,_,k,W,a,c,S,I=1/0,q=["","top_","bottom_"],L=!1;for(N=0,x=E.length;x>N;N++)if(W=E[N])for(y=0,F=q.length;F>y;y++)if(a=q[y],g=W[a+"vs"],m=W[a+"is"],J=W[a+"uv"]||W[a+"tuv"],g){if(c=W[a+"boundingBox"]){var _=b.intersectBox(c);if(!_)continue;if(b.origin.distanceTo(_)>I)continue;S=!1}else W[a+"boundingBox"]=c=new w.Math.Box3,S=!0;for(M=0,f=m?m.length:g.length/3;f>M;M+=3)this.countTriangles++,m?(G.fromArray(g,3*m[M]),r.fromArray(g,3*m[M+1]),d.fromArray(g,3*m[M+2])):(G.fromArray(g,3*M),r.fromArray(g,3*(M+1)),d.fromArray(g,3*(M+2))),S&&(c.expandByPoint(G),c.expandByPoint(r),c.expandByPoint(d)),H=b.intersectTriangle(G,r,d,!0,$),H&&(k=b.origin.distanceTo(H),I>k&&(I=k,B.copy(H),u.copy(G),R.copy(r),P.copy(d),""!==a?C=a.slice(0,-1):s?C=lm[Math.floor(M/6)]:D&&(C=lm[N]),J&&(L=!0,m?(A.fromArray(J,2*m[M]),X.fromArray(J,2*m[M+1]),Y.fromArray(J,2*m[M+2])):(A.fromArray(J,2*M),X.fromArray(J,2*(M+1)),Y.fromArray(J,2*(M+2))))))}if(!isFinite(I))return null;var n,t=B.clone().applyMatrix4(T);L&&(n=v(B,u,R,P,A,X,Y));var p=Z(u,R,P),j=Z(u.applyMatrix4(T),R.applyMatrix4(T),P.applyMatrix4(T)),i=b.direction.dot(p);return i>0&&(p.multiplyScalar(-1),j.multiplyScalar(-1)),{world:t,local:B.clone(),worldNormal:j,normal:p,uv:n,part:C}}}}()});var Wf=function(H,h){this.gv=H,this.s=function(E,i,t){return i==a&&(i=t),i==a?h.getStyle(E):Io(i,h,H)},this.data=h};Qr(Wf,E,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(c,x,y,b){var w=this,q=w.data;if(!(q instanceof Md)){var u,A,C,k,r,m,U,D=w.gv,P=q._id,l=w.s("shape3d.alwaysOnTop")?null:w.s("batch"),F=D._batchIndexMap,$=D._batchModelMap,V=D.isSelectable(q),z=D.getBrightness(q),_=z!=a&&1!==z;if(w.needValidate(c)){if(C=Jh(F,$,q,l),w.validate(C,l?ls[l]||si:a),C&&(k=F[P],r=k.size=C.vs.length/3-k.begin,U=C.rs))for(z=_?z:1,m=0;r>m;m++)U.push(z);if(wc(q)){var N=D.getWireframeGeometry(q);if(N)lq(D,q,N);else{var M=D.getWireframe(q);M&&lq(D,q,M)}}w.labelInfo=w.label2Info=w.noteInfo=w.note2Info=w._38o=a,w._24O(Hj,"getLabel"),w._24O(Kf,"getLabel2"),w._26O(Jd,"getNote"),w._26O(Re,"getNote2"),w._15O(),w.interactiveInfo=D.isInteractive(q)?{}:a,w._iv=!1}_&&Ik(c,x.uBrightness,z),Ik(c,x.uAlphaTest,w.s("alphaTest")),Ik(c,x.uUseEnvMap,q.s("envmap")?!0:!1),Ik(c,x.uReflectivity,q.s("envmap")||.01),A=wp(c,x,y,V,q,Ck),A&&(Ui(A,F[P],$),Ui(A,D._polylineIndexMap[P],D._polylineModelMap),Ui(A,D._wireframeIndexMap[P],D._wireframeModelMap)),F[P]||w._80o(c,x,b),D.isLabelVisible(q)&&((u=w.labelInfo)&&(wp(c,x,y,V,q,Hj),w._28O(u,Hj,b)),(u=w.label2Info)&&(wp(c,x,y,V,q,Kf),w._28O(u,Kf,b))),D.isNoteVisible(q)&&((u=w.noteInfo)&&(wp(c,x,y,V,q,Jd),w._29O(u,Jd,b)),(u=w.note2Info)&&(wp(c,x,y,V,q,Re),w._29O(u,Re,b))),(u=w._38o)&&w._99O(c,x,u,y,V,b),_&&Ik(c,x.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return On},_80o:function(){},dispose:function(){},_calcAnchorMat:function(F){if(F.hasOwnProperty("_anchor")||F.hasOwnProperty("_anchorElevation")){var D=F.getAnchor3d(),f={x:D.x-.5,y:D.y-.5,z:D.z-.5},S=vo();return jo(S,[-f.x,-f.y,-f.z]),S}},getBodyColor:function(m){var s=this.data,A=this.gv.getBodyColor(s);return A?A:m?s.getStyle(m):a},_24O:function(X,v){var g=this,W=g.data,A=g.gv,l=g.s,P=A[v](W);if(P!=a){var m=l(X+".scale"),F=l(X+".max"),q=g[X+"Info"]={label:P,textureScale:l(X+".texture.scale"),color:A[v+"Color"](W),font:l(X+".font"),align:l(X+".align"),background:A[v+"Background"](W)},J=q.rect=en(q,P);F>0&&F<J.width&&(q.labelWidth=J.width,J.width=F),J.x=J.y=0,J.width*=m,J.height*=m,q.mat=g._16O(l(X+".autorotate"),l(X+".position"),J,l(X+".face"),l(X+".t3"),l(X+".r3"),l(X+".rotationMode"));var n=J.width/2,t=J.height/2;q.vs=new go([-n,t,0,-n,-t,0,n,-t,0,n,t,0]),J.width/=m,J.height/=m}},_26O:function($,R){var o=this,A=o.data,p=o.gv,H=o.s,P=p[R](A);if(P!=a){var f=H($+".scale"),c=this[$+"Info"]={note:P,textureScale:H($+".texture.scale"),expanded:H($+".expanded"),font:H($+".font"),color:H($+".color"),align:H($+".align"),borderWidth:H($+".border.width"),borderColor:H($+".border.color"),background:p[R+"Background"](A)};if(c.expanded){var Q=H($+".max"),C=en(c,P);C.width+=6,C.height+=2,Q>0&&Q<C.width&&(c.labelWidth=C.width,C.width=Q);var w={x:-C.width/2,y:-8-C.height,width:C.width,height:C.height+8}}else w={x:-6,y:-18,width:12,height:18};c.mat=o._16O(H($+".autorotate"),H($+".position"),a,H($+".face"),H($+".t3"),H($+".r3"),H($+".rotationMode")),c.rect=w,1!==f&&(w=Vl(w),w.x*=f,w.height*=f,w.y=-w.height,w.width*=f);var D=w.x,J=w.y,u=w.width,b=w.height;c.vs=new go([D,-J,0,D,-J-b,0,D+u,-J-b,0,D+u,-J,0])}},_28O:function(D,n,m){if(m(this.s(n+".transparent"))){var S=D.rect,X=D.textureScale,s=S.width*X,w=S.height*X;if(s>=1&&w>=1){var E=sm(s,w);1!==X&&(E.translate(E,S.x,S.y),E.scale(X,X),E.translate(E,-S.x,-S.y)),se(E,D),E.restore(),gk(this,n,D.mat,D.vs,!0)}}},_29O:function(k,D,H){if(H(this.s(D+".transparent"))){var t=k.rect,R=k.textureScale,S=t.x,Y=t.y,w=t.width*R,F=t.height*R;if(w>=1&&F>=1){t.x=t.y=0;var x=sm(w,F);1!==R&&x.scale(R,R),rd(x,k),x.restore(),t.x=S,t.y=Y,gk(this,D,k.mat,k.vs,!1)}}},_99O:function(i,U,L,b,o,e){if(L){var y=this,d=y.gv,$=y.data,O=d._buffer,G=d._1O,T=L.icons;for(var D in T){var v=T[D],m=L.rects[D];if(m&&e(Io(v.transparent,$,d))){wp(i,U,b,o,$,D);var q=Io(v.shape3d,$,d),W=q?[q]:Io(v.names,$,d),R=W?W.length:0,t=Io(v.textureScale,$,d)||1,M=Io(v.light,$,d);M==a&&(M=q?!0:!1),Vf(i,U,Io(v.blend,$,d),M,Io(v.opacity,$,d),Io(v.reverseFlip,$,d),Io(v.reverseColor,$,d),Io(v.reverseCull,$,d));for(var C=0;R>C;C++){var N=W[C],j=m[C];if(Xc(y,j.mat),q)Lm(d,$,xm(y,q),y);else{var A=hh(N);if(A){var p=j.width*t,g=j.height*t;if(p>=1&&g>=1){var r=sm(p,g);Me(r,A,Io(v.stretch,$,d),0,0,p,g,$,d),r.restore(),pl(i,wo,G),mr(i,U,G,Io(v.discardSelectable,$,d),O.uv,Kp),Bl(i,O.vs,j.vs,U.aPosition),gf(i,O.ns,ur,U.aNormal),qm(i,O.is,cc),Sd(i,0,cc.length),Kb(i,U,G)}}}Ni(d)}Ub(i,U)}}}}});var gs=function(z,J){Bh(gs,this,[z,J])};Qr(gs,Wf,{_16O:function(w,H,P,q,y,o,N,V,t){var S=this.data,J=S.getFinalScale3d(),I=Bs(H,J,P,q,V,t);if(S.hasOwnProperty("_anchor")||S.hasOwnProperty("_anchorElevation")){var z=S.getAnchor3d();I[0]-=(z.x-.5)*J[0],I[1]-=(z.y-.5)*J[1],I[2]-=(z.z-.5)*J[2]}return Xn(vo(),I,S.p3(),q,y,o,N,w,S.getFinalRotation3d(),S.getRotationMode())},clear:function(){var D=this;D.faceMat=D.mat=D.shapeModel=D.left=D.right=D.front=D.back=D.top=D.bottom=D.csg=a},needValidate:function(X){if(this._iv)return this._validateFrameId=X._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var i=X._renderInfo.frame;if(this._validateFrameId!==i)return this._validateFrameId=i,!0
}return!1},validate:function(G,y){var r=this,D=r.gv,w=r.data,J=r.shapeName=r.s(Pj),g=xm(r,J);r._updateAutoRotation(),r._updateFixSize2d(),r._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Ol(D,w,"_wireframeModelMap","_wireframeIndexMap"),Ol(D,w,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var H=Rl(w,D.getMat(w),g?r.s("shape3d.scaleable"):!0),m=r._calcAnchorMat(w);if(m&&yb(H,H,m),w.mat=H,r.clear(),g||!J)if(G){var l=[];g?ao(D,w,g,r,r.getBodyColor(),[H],G,l):(Gb(D,w,G,y,H,Ul,l,Pp),Gb(D,w,G,y,H,Te,l,Kc),Gb(D,w,G,y,H,rr,l,dr),Gb(D,w,G,y,H,tf,l,Tr),Gb(D,w,G,y,H,xr,l,Dj),Gb(D,w,G,y,H,Th,l,fk)),l.length&&(ks(G.vs,l),ks(G.ns,mg(l)))}else r.mat=H,(r.shapeModel=g)||(r._cubeUvs=null,r.vf(Ul,0),r.vf(Te,16),r.vf(xr,8),r.vf(Th,24),r.vf(rr,32),r.vf(tf,40))},_updateAutoRotation:function(){var d=new uc;return function(){var e=this,O=e.data,v=e.s("shape3d.autorotate");if(!v)return O._dynamicRotation&&delete O._dynamicRotation,void 0;var r,E=e.gv;r="string"==typeof v?[v.indexOf("x")<0?E._eye[0]:E._center[0],v.indexOf("y")<0?E._eye[1]:E._center[1],v.indexOf("z")<0?E._eye[2]:E._center[2]]:E._eye;var C=E._center,I=O.p3(),W=Dp([I[0]+r[0]-C[0],I[1]+r[1]-C[1],I[2]+r[2]-C[2]],I,E._up);d.set(0,0,0,O.getRotationMode(),!0).setFromRotationMatrix(W);var P=O._dynamicRotation;P&&Math.abs(P[0]-d.x)<1e-5&&Math.abs(P[1]-d.y)<1e-5&&Math.abs(P[2]-d.z)<1e-5||(O._dynamicRotation=[d.x,d.y,d.z])}}(),_updateFixSize2d:function(){var I=this,c=I.data,z=I.s("shape3d.fixSizeOnScreen");if(!z)return c._dynamicScale3d&&delete c._dynamicScale3d,void 0;var G=I.gv;c.getFinalScale3d();var p=Rl(c,G.getMat(c)),k=jr([0,0,0],p),Z=G.toViewPosition(k);if(!isNaN(Z.x)&&!isNaN(Z.y)){var q=jr([1,0,0],p),o=G.toViewPosition(q),m=jr([0,1,0],p),B=G.toViewPosition(m),S=o.x-Z.x,v=B.y-Z.y;if(S&&v){var $=c._dynamicScale3d||[1,1,1],V=hh(c.s("shape3d.image")),A=z[0]>0?z[0]:V?Uh(V,c):20,y=z[1]>0?z[1]:V?zq(V,c):20,t=Math.abs(S/A),O=Math.abs(v/y);Math.abs(t-1)<.001&&Math.abs(O-1)<.001||(c._dynamicScale3d=[$[0]/t,$[1]/O,$[2]])}}},_updateOverlapping:function(){var q=this,n=q.s("hide.overlapping.group");if(!n)return q._rectOverlapping&&(q._rectOverlapping=M),void 0;var i,C,y,S=q.gv,H=q.data,v=Rl(H,S.getMat(H)),O=1/0,Q=1/0,m=-1/0,p=-1/0,G=H.getAnchor3d(),g=G.x,w=G.y,R=G.z;for(i=0;8>i;i++){if(C=jr([(i>>2)-g,(1&i>>1)-w,(1&i)-R],v),y=S.toViewPosition(C),isNaN(y.x)||isNaN(y.y))return;O=Math.min(O,y.x),m=Math.max(m,y.x),Q=Math.min(Q,y.y),p=Math.max(p,y.y)}var N={x:O,y:Q,w:m-O,h:p-Q};q._rectOverlapping=S.overlappingBox.isOverlapping(n,N)},getVectorDynamicSize:function(){var G,L=this,h=L.s("shape3d"),C=L.data;if("billboard"===h||"plane"===h||(G=C._currentCubeElementId)!=a){var p,P,k=L.gv,Q=Rl(C,k.getMat(C)),c=C.getAnchor3d(),M=.5-c.x,f=.5-c.y,j=.5-c.z,E=L.s("shape3d.vector.dynamic.maxsize"),s=function(b,i){b[0]+=M,b[1]+=f,b[2]+=j,i[0]+=M,i[1]+=f,i[2]+=j;var S=k.toViewPosition(jr(b,Q)),W=k.toViewPosition(jr(i,Q)),t=S.x-W.x,p=S.y-W.y;return Math.min(E,Math.sqrt(t*t+p*p))};if("billboard"===h)p=s([-.5,0,0],[.5,0,0]),P=s([0,-.5,0],[0,.5,0]);else if("plane"===h)p=s([-.5,0,0],[.5,0,0]),P=s([0,0,-.5],[0,0,.5]);else if(C._currentCubeElementId!=a){var b=3*id[G+1],m=3*id[G],D=3*id[G+2];p=s([an[b],an[b+1],an[b+2]],[an[D],an[D+1],an[D+2]]),P=s([an[b],an[b+1],an[b+2]],[an[m],an[m+1],an[m+2]])}return[p,P]}},getCachedTexture:function(){var Q=this,b=Q.data,t=b._currentCubeElementId;return t!=a?Q._cubeCachedImage?Q._cubeCachedImage[t]:null:Q._shape3dCachedImage},setCachedTexture:function(I){var W=this,S=W.data,T=S._currentCubeElementId;T!=a?(W._cubeCachedImage||(W._cubeCachedImage={}),W._cubeCachedImage[T]=I):W._shape3dCachedImage=I},invalidateCachedTexture:function(e){var X,v,M,j=this;if((M=j._shape3dCachedImage)&&(e.deleteTexture(M),j._shape3dCachedImage=null),v=j._cubeCachedImage){for(X in v)e.deleteTexture(v[X]);j._cubeCachedImage=null}},vf:function(H,v){var R=this;if(R.gv.getFaceVisible(R.data,H)){var I=Hm(R,H);I.mat&&(R.faceMat=!0);var F=I.uv;if(F){var Y=R._cubeUvs;Y||(Y=R._cubeUvs=new go([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var V=0;8>V;V++)Y[v+V]=F[V]}return I}},_billboardInView:function(){var u=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],A=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],f=new ie(new pe(-1,-1,-1),new pe(1,1,1)),I=new ie,Z=new pe,w=new yo,z=new yo;return function(Q){var n=this;if(!n.mat)return!0;var t="billboard"===Q?u:A;I.makeEmpty(),z.fromArray(n.mat),w.fromArray(n.gv.getPVMatrix()).multiply(z);for(var X=0,m=t.length;m>X;X+=3)I.expandByPoint(Z.fromArray(t,X).applyMatrix4(w));return I.intersectsBox(f)}}(),_80o:function(o,V,j){var n=this;if(n._rectOverlapping)return!0;var t=n.shapeModel;if(t||!n.shapeName){var X=n.s("shape3d");if(("billboard"===X||"plane"===X)&&!n._billboardInView(X))return!0;var N=n.gv,f=n.data,u=N._cube;Sh(N,n.mat),t?Lm(N,f,t,n,n.getBodyColor(),j):(Bl(o,u.vs,a,V.aPosition),Bl(o,u.ns,a,V.aNormal),km(o,u.is),n._18O(o,V,n.left,0,j),n._18O(o,V,n.front,6,j),n._18O(o,V,n.right,12,j),n._18O(o,V,n.back,18,j),n._18O(o,V,n.top,24,j),n._18O(o,V,n.bottom,30,j)),Ni(N),n.faceMat&&(n._18O(o,V,n.left,0,j,!0),n._18O(o,V,n.front,6,j,!0),n._18O(o,V,n.right,12,j,!0),n._18O(o,V,n.back,18,j,!0),n._18O(o,V,n.top,24,j,!0),n._18O(o,V,n.bottom,30,j,!0))}},_18O:function(m,l,K,L,w,Y){if(K){if(!w(K.transparent))return;if(Y&&!K.mat||!Y&&K.mat)return;var S=this.data.s("polygonOffset");S&&Ee(m,S),Y&&Sh(this.gv,K.mat);var D=this,d=D.data;d._currentCubeElementId=L;var n=D.gv,j=n.getTexture(K.texture,d),C=K.uv,o=K.uvScale,A=K.uvOffset,y=K.discardSelectable;j?C?mr(m,l,j,y,n._buffer.uv,D._cubeUvs,A,o):mr(m,l,j,y,n._cube.uv,a,A,o):mr(m),Vf(m,l,K.blend,K.light,K.opacity,K.reverseFlip,K.reverseColor,K.reverseCull),Ik(m,l.uDiffuse,K.color||P["color.empty"]),Sd(m,L,6),Ub(m,l),Kb(m,l,j),Y&&Ni(n),S&&Ke(m),d._currentCubeElementId=null}}});var Xi=function(n,U){Bh(Xi,this,[n,U])};Qr(Xi,Wf,{_25Q:1,validate:function(D){var R=this,u=R.gv,N=R.data,l=R.s,q=l("edge.width"),W=N._40I,m=N._41I;if(R.shapeModel=R.info=a,W&&m){var w,J,C,r,s,S,G,T,y,F,b=N.isLooped(),f=l(dg),H=n.getEdgeType(f);if(H){var Y=H(N,om(R,u,N,b,f),u,R._19Q);if(!Y.points||Y.points.isEmpty())return;S=R.info={},G=Y.segments,s=Y.points,T=s.size();for(var v=W.getElevation(),t=m.getElevation(),O=0;T>O;O++){var V=s.get(O);V.e==a&&(V.e=v+(t-v)*O/(T-1))}y=af(s.get(0)),F=af(s.get(T-1));var j=T%2;0===j?(S.c1=af(s.get(T/2-1)),S.c2=af(s.get(T/2))):S.p3=af(s.get((T-j)/2)),S.s1=y,S.s2=af(s.get(1)),S.t1=af(s.get(T-2)),S.t2=F}else{s=new Yp,S=R.info={};var Z=l("edge.offset"),X=l("edge.center"),g=l("edge.source.t3"),I=l("edge.target.t3"),A=W.p3(),$=m.p3();if(g&&(A[0]+=g[0],A[1]+=g[1],A[2]+=g[2]),I&&($[0]+=I[0],$[1]+=I[1],$[2]+=I[2]),f===uf){G=l("edge.segments");var P=S.points=l(tk)||Wi;if(T=P.size()){y=af(P.get(0)),F=af(P.get(T-1)),!X&&Z&&(C=Eh(y,A,!0),Z=p(Z,sh(A,y)),A=[A[0]+C[0]*Z,A[1]+C[1]*Z,A[2]+C[2]*Z],C=Eh($,F,!0),Z=p(Z,sh(F,$)),$=[$[0]-C[0]*Z,$[1]-C[1]*Z,$[2]-C[2]*Z]);var j=T%2;0===j?(w=af(P.get(T/2-1)),J=af(P.get(T/2))):S.p3=af(P.get((T-j)/2)),S.s1=A,S.s2=y,S.t1=F,S.t2=$}else!X&&Z&&(C=Eh($,A,!0),r=sh(A,$),Z=gm(Z,r),A=[A[0]+C[0]*Z,A[1]+C[1]*Z,A[2]+C[2]*Z],$=[$[0]-C[0]*Z,$[1]-C[1]*Z,$[2]-C[2]*Z]),w=A,J=$;s.add({x:A[0],y:A[2],e:A[1]}),s.addAll(P),s.add({x:$[0],y:$[2],e:$[1]})}else{var e=om(R,u,N,b,f);if(R._19Q||(e=-e),b){var B=A[0],E=A[1],k=A[2],U=W.getTall()/2+e;w=[B-e,E+U,k],J=[B+e,E+U,k],s.add({x:B-e,y:k,e:E}),s.add({x:B-e,y:k,e:E+U}),s.add({x:B+e,y:k,e:E+U}),s.add({x:B+e,y:k,e:E})}else{C=Eh($,A,!0),r=sh(A,$);var Q={x:A[0],y:A[2]},o={x:$[0],y:$[2]},K=Xr(a,Q,o,e),x=K.x-Q.x,M=K.y-Q.y;Z=gm(Z,r),C[0]*=Z,C[1]*=Z,C[2]*=Z,w=[A[0]+C[0]+x,A[1]+C[1],A[2]+C[2]+M],J=[$[0]-C[0]+x,$[1]-C[1],$[2]-C[2]+M],X?(s.add({x:A[0],y:A[2],e:A[1]}),s.add({x:w[0],y:w[2],e:w[1]}),s.add({x:J[0],y:J[2],e:J[1]}),s.add({x:$[0],y:$[2],e:$[1]})):(s.add({x:w[0],y:w[2],e:w[1]}),s.add({x:J[0],y:J[2],e:J[1]}))}}S.c1=w,S.c2=J}S.list=l(Pj)===ye?R.createTubeModel(s,G,q/2,D):R.createLineModel(s,G,q,"edge","edge.dash")}}});var of=function(b,A){Bh(of,this,[b,A])};Qr(of,gs,{_80o:function(g,R,M){var p=this,e=p.gv,r=p.shapeModel;Sh(e,p.mat),r?Lm(e,p.data,r,p,p.getBodyColor(),M):(Ud(p,g,R,p.left,M),Ud(p,g,R,p.front,M),Ud(p,g,R,p.right,M),Ud(p,g,R,p.back,M),Ud(p,g,R,p.top,M),Ud(p,g,R,p.bottom,M)),Ni(e)},validate:function(K,B){var O,L,D=this,F=D.s,V=D.data,U=V.p3(),e=V._thickness/2,b=V.isClosePath(),Y=V.getPoints(),f=V.getSegments(),H=F(kn),n=K&&K.uv;if(D.clear(),0>e)L=D.shapeModel=tg(Y,f,F(ff),F(De),H,F(hl),V.getTall(),V.getShapeElevation(),b),F(gb)?F("shape3d.image")||delete L.uv:(delete L.vs,delete L.ns,delete L.uv),F("shape3d.top.image")||delete L.top_uv,F("shape3d.bottom.image")||delete L.bottom_uv;else if(F(Pj)===ye)O=Cl(Y,f,H,b),L=D.shapeModel={vs:[]},F("shape3d.image")&&(L.uv=[],L.sum=F(hl)||lc(O)||1,L.len=0),F(ff)&&!b&&(L.top_vs=[],F("shape3d.top.image")&&(L.top_uv=[])),F(De)&&!b&&(L.bottom_vs=[],F("shape3d.bottom.image")&&(L.bottom_uv=[])),D._12O(O,e);else{var h,C,p,$,k,X,Q,d,P,m;if(O=Cl(Y,f,H,b),k=D.vf(xr,n,!1,B),e&&(X=D.vf(Th,n,!1,B),Q=b?a:D.vf(Ul,n,!1,B),d=b?a:D.vf(Te,n,!1,B),P=D.vf(rr,n,!1,B),m=D.vf(tf,n,!1,B)),e){for(var T=0,M=O.length;M>T;T++)O[T]=D._tryRemoveBezierPoints(O[T],e);D._12O(O,e)}else k&&O.forEach(function(x){if($=x.length,$>0)for(h=x[0],p=1;$>p;p++)C=x[p],D.addV(k.vs,h,C),h=C});D._20Q(O),K||(k&&(k.ns=mg(k.vs),Lr(k,"vs"),Lr(k,no)),e&&(X&&(X.ns=mg(X.vs),Lr(X,"vs"),Lr(X,no)),Q&&(Q.ns=mg(Q.vs),Lr(Q,"vs"),Lr(Q,no)),d&&(d.ns=mg(d.vs),Lr(d,"vs"),Lr(d,no)),P&&(P.ns=mg(P.vs),Lr(P,"vs"),Lr(P,no)),m&&(m.ns=mg(m.vs),Lr(m,"vs"),Lr(m,no))))}var s=D.mat=vo();jo(s,U),Cq(s,V.getFinalRotation3d(),V.getRotationMode());var x=V.getScale3d(),I=V._dynamicScale3d;I&&(x[0]*=I[0],x[1]*=I[1],x[2]*=I[2]),up(s,x),jo(s,on(U)),K&&(kl(D,s,K,L),D.clear())},_20Q:function(P){var z,Z,n,D,Y,S,K,l=this,X=l.front,t=l.back,w=l.top,L=l.bottom,O=X?X.tuv:a,G=t?t.tuv:a,A=w?w.tuv:a,U=L?L.tuv:a,e=0;(O||G||A||U)&&(z=l.s(hl)||lc(P)||1,P.forEach(function(o){if(Z=o.length,Z>0)for(S=o[0],n=1;Z>n;n++)K=o[n],D=e/z,e+=sh(S,K),Y=e/z,l._14O(X,D,Y),l._14O(t,1-Y,1-D),l._14O(w,D,Y),l._14O(L,D,Y),S=K}))},_14O:function(c,R,o){if(c){var s=c.uv,D=c.tuv;if(D){if(s)var r=s[0]+(s[6]-s[0])*R,w=s[1]+(s[7]-s[1])*R,g=s[2]+(s[4]-s[2])*R,n=s[3]+(s[5]-s[3])*R,G=s[2]+(s[4]-s[2])*o,z=s[3]+(s[5]-s[3])*o,H=s[0]+(s[6]-s[0])*o,l=s[1]+(s[7]-s[1])*o;else r=R,w=0,g=R,n=1,G=o,z=1,H=o,l=0;D.push(g,n,G,z,H,l,H,l,r,w,g,n)}}},_13O:function(v){var m=v.uv,w=v.tuv;w&&(m?w.push(m[2],m[3],m[4],m[5],m[6],m[7],m[6],m[7],m[0],m[1],m[2],m[3]):w.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(j,b){var K=j.length;if(4>K)return j;var $,S,B,n,W,M,D=!1,x=function(W){return j[W]},v=function(y){return j[K-1-y]};for(W=0;1>=W;W++)for(M=W?v:x,S=M(0),B=M(1),$=2;K-1>$;$++)if(n=M($),!n.remove)if(n.b){var G=Xr(S,B,n,b);G.adjust?(n.remove=!0,D=!0):(S=B,B=n)}else S=B,B=n;if(!D)return j;var V=[];for($=0;K>$;$++)j[$].remove||V.push(j[$]);return V},_12O:function(Y,R){var E,A,Q,J,w,P=this;Y.forEach(function(x){if(w=x.length,w>0)for(E={p:x[0],n:!0},J=1;w>J;J++)A=x[J],Q=w-1>J?x[J+1]:a,P.addPoint(E,A,Q,R,x)})},addPoint:function(U,R,u,v,D){var T,d,A,g,Z,J,N,F,M,p=this,z=U.p,n=U.f,x=U.b,j=p.s("shape3d.side")||Nq,w=p.s("shape3d.start.angle"),o=p.s("shape3d.sweep.angle"),q=p.shapeModel,k=p.data.isClosePath();if(U.n&&(U.n=!1,n=k&&D.length>2?Xr(D[D.length-2],z,R,v):Xr(a,z,R,v),x=vd(z,n),q?q.top_vs&&p._10O(x,n,j,w,o,q.top_vs,q.top_uv):(T=p.left)&&(p.addV(T.vs,x,n),p._13O(T))),d=u?Xr(z,R,u,v):k&&D.length>2?Xr(z,R,D[1],v):Xr(z,R,a,v),A=vd(R,d),q){var $,m,s=q.vs,e=q.uv,_=q.sum;for(e&&($=q.len/_,q.len+=sh(z,R),m=q.len/_),J=p._9O(x,n,j,w,o),N=p._9O(A,d,j,w,o),F=0;j>F;F++)M=F+1,ks(s,J[M]),ks(s,N[F]),ks(s,J[F]),ks(s,N[F]),ks(s,J[M]),ks(s,N[M]),e&&(g=F/j,Z=M/j,e.push($,Z,m,g,$,g,m,g,$,Z,m,Z));!u&&q.bottom_vs&&p._10O(A,d,j,w,o,q.bottom_vs,q.bottom_uv,!0)}else!u&&(T=p.right)&&(p.addV(T.vs,d,A),p._13O(T)),(T=p.front)&&p.addV(T.vs,n,d),(T=p.back)&&p.addV(T.vs,A,x),(T=p.top)&&p.addH(T.vs,n,d,A,x,!0),(T=p.bottom)&&p.addH(T.vs,x,A,d,n);U.p=R,U.f=d,U.b=A},_10O:function(r,K,b,B,T,J,y,R){var d,D,W=this,n=W.data,P=W._9O(r,K,b,B,T),j=(r.x+K.x)/2,U=(r.y+K.y)/2,m=n.getShapeElevation(),X=0;for(X=0;b>X;X++)R?(ks(J,P[X]),ks(J,P[X+1])):(ks(J,P[X+1]),ks(J,P[X])),ks(J,[j,m,U]),y&&(R?(d=O*(X+1)/b+B,D=O*X/b+B):(d=O*X/b+B,D=O*(X+1)/b+B),y.push(.5-.5*s(D),.5-.5*N(D),.5-.5*s(d),.5-.5*N(d),.5,.5))},_9O:function(q,a,Z,t,k){var K,y,i=this,v=i.data,f=[],C=(q.x+a.x)/2,e=(q.y+a.y)/2,A=v.getTall()/2,n=v.getShapeElevation(),V=0;for(k=k||O;Z>=V;V++)K=k*V/Z+t,y=s(K),f.push([C+(q.x-C)*y,n+A*N(K),e+(q.y-e)*y]);return f},addV:function(w,U,Y){var H=U.x,f=U.y,T=Y.x,v=Y.y,I=this.data,x=I.getShapeElevation(),M=I.getTall()/2;w.push(H,x-M,f,T,x-M,v,T,x+M,v,T,x+M,v,H,x+M,f,H,x-M,f)},addH:function(A,U,h,J,X,e){var c=this.data,B=c.getTall()/2,N=c.getShapeElevation()+(e?B:-B);A.push(U.x,N,U.y,h.x,N,h.y,J.x,N,J.y,J.x,N,J.y,X.x,N,X.y,U.x,N,U.y)},vf:function(Y,W,n,I){var E,B=this,K=B.gv.getFaceVisible(B.data,Y);return(n||K)&&(E=Hm(B,Y,I),E.vs=[],E.tuv=K&&(E.texture||W)?[]:a,E.visible=K),E}});var tr=function(n,U){Bh(tr,this,[n,U])};Qr(tr,Wf,{_25Q:1,validate:function(v){var d=this,Y=d.data,j=d.s,I=Y.getPoints(),B=I.size();if(d.shapeModel=d.info=a,B>1){var t=d.info={},Q=Y.getSegments(),Z=Y.getThickness(),A=af(I.get(0)),P=af(I.get(B-1)),b=B%2;0===b?(t.c1=af(I.get(B/2-1)),t.c2=af(I.get(B/2))):t.p3=af(I.get((B-b)/2)),t.s1=A,t.s2=af(I.get(1)),t.t1=af(I.get(B-2)),t.t2=P,t.list=j(Pj)===ye?d.createTubeModel(I,Q,Z/2,v):d.createLineModel(I,Q,Z,"shape.border","shape.dash")}var x=Y.p3(),L=d.mat=vo();jo(L,x),Cq(L,Y.getFinalRotation3d(),Y.getRotationMode());var E=Y.getScale3d(),e=Y._dynamicScale3d;e&&(E[0]*=e[0],E[1]*=e[1],E[2]*=e[2]),up(L,E),jo(L,on(x))},_80o:function(p,G,z){var Q=this,y=Q.shapeModel;if(y){var F=Q.gv;Sh(F,Q.mat),Lm(F,Q.data,y,Q,Q.getBodyColor(),z),Ni(F)}}});var lr=w.graph3d.VR=function(a){var N=this;N.gv=a,N._controllers=[],N.switch=new qj(N),N._enable=!1,N._defaultCallLater=w.Default.callLater,N._defaultCancelLater=Oi,"undefined"!=typeof i&&"VRFrameData"in i&&(N._frameData=new i.VRFrameData),N.measureOflength=1,N.eyesOffset=[0,0,0],N._orientation=new w.Math.Quaternion,N._lastHeadPose=[0,0,0],N._offsetToBeAdd=[0,0,0],N._fpsInfo={time:0,fps:0,frames:0}};Qr(lr,E,{ms_fire:!0,_42:function(g,F,E,n){var e=this,a=e.gv;if(!a.drawFilter&&e._deviceInAction){var u=e._device;if(u){var A=e._measureOflength;u.depthNear=a.getNear()*A,u.depthFar=a.getFar()*A;var z=e._offsetToBeAdd;if(e.eyesOffset[0]+=z[0],e.eyesOffset[1]+=z[1],e.eyesOffset[2]+=z[2],z[0]=0,z[1]=0,z[2]=0,u.isPresenting===!1)return e._controllers.forEach(function(D){D&&D.update()}),a.iv(),!1;var l=e._frameData;u.getFrameData(l);var k=l.pose.position;if(k){var o=e.toViewPosition(k);a.setEye(o),e._orientation.fromArray(l.pose.orientation);var R=new w.Math.Vector3(0,0,-10*e._scaleFactor);R.applyQuaternion(e._orientation),a.setCenter([o[0]+R.x,o[1]+R.y,o[2]+R.z])}e._controllers.forEach(function(k){k&&k.update()}),a.setViewport(g,0,0,F/2,E),e._viewMatrix=e._copyViewMatrix(l.leftViewMatrix),e._projectMatrix=e._copyProjectMatrix(l.leftProjectionMatrix),n(),a.setViewport(g,F/2,0,F/2,E),e._viewMatrix=e._copyViewMatrix(l.rightViewMatrix),e._projectMatrix=e._copyProjectMatrix(l.rightProjectionMatrix),n(),e._lastViewMatrix=e._viewMatrix,e._lastProjectMatrix=e._projectMatrix,e._viewMatrix=null,e._projectMatrix=null,e.submitFrame();var U=Date.now(),V=e._fpsInfo;return U-V.time>1e3?(V.fps=Math.round(1e3*(V.frames+1)/(U-V.time)),V.time=U,V.frames=0):V.frames++,!0}}},onVRDisplayPresentChange:function(){var q=this.isPresenting();this._injectGraphView(q),this.fp("present",!q,q)},getOrientation:function(){return this._orientation},addController:function(v){v=v||0;var j=this,p=j.getController(v);return p?p:(p=new Ne(j,v),j._controllers.push(p),p)},getController:function(z){z=z||0;for(var D=this._controllers,w=0,C=D.length;C>w;w++)if(D[w]&&D[w].id===z)return D[w];return null},removeController:function(i){i=i||0;for(var d=this._controllers,v=0,r=d.length;r>v;v++)if(d[v]&&d[v].id===i)return d.splice(v,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(d,v){var G=this,U=G._scaleFactor,f=G._eyesOffset,D=G._lastHeadPose;return D[0]=d[0]*U,D[1]=d[1]*U,D[2]=d[2]*U,v?(v[0]=D[0]+f[0],v[1]=D[1]+f[1],v[2]=D[2]+f[2],v):[D[0]+f[0],D[1]+f[1],D[2]+f[2]]},addEyesOffset:function(I,o,g){var S=this._offsetToBeAdd;S[0]+=I,S[1]+=o,S[2]+=g},_copyViewMatrix:function(V){var b=this.dup(V),d=this._scaleFactor;b[12]*=d,b[13]*=d,b[14]*=d;var P=this._eyesOffset;if(P&&(P[0]||P[1]||P[2])){var s=P[0],Q=P[1],a=P[2];b[12]-=b[0]*s+b[4]*Q+b[8]*a,b[13]-=b[1]*s+b[5]*Q+b[9]*a,b[14]-=b[2]*s+b[6]*Q+b[10]*a}return b},shutdown:function(){var T=this._device;T&&T.isPresenting&&T.exitPresent()},isPresenting:function(){var u=this._device;return u&&u.isPresenting},_copyProjectMatrix:function(e){var D=this.dup(e),V=this._scaleFactor;return D[14]*=V,D},dup:function(h,J){for(var C=h.length,o=J||new Array(C);C--;)o[C]=h[C];return o},getViewMatrix:function(j){var B=this._viewMatrix;return B?this.dup(B,j):void 0},getProjectMatrix:function(){var q=this._projectMatrix;return q?this.dup(q):void 0},submitFrame:function(){var I=this;if(I._enable&&I._deviceInAction){var y=I._device;y&&y.isPresenting&&(y.submitFrame(),I.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(z){var T=this.gv;return T.intersectObjects(z,T.dm().getDatas())},setDevice:function(f){var _=this;_._device=f},_injectGraphView:function(){var M,L,C;return function(s){var D=this.gv;if(!s)return M&&(D.getWidth=M,D.getHeight=L,D.getDevicePixelRatio=C),void 0;var z=this._device,m=z.getEyeParameters("left"),S=m.renderWidth,r=m.renderHeight;M=D.getWidth,L=D.getHeight,C=D.getDevicePixelRatio,D.getWidth=function(){return 2*S},D.getHeight=function(){return r},D.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(k){var F=this;if(!k)return nd=w.Default.callLater=F._defaultCallLater,Oi=w.Default.cancelLater=F._defaultCancelLater,void 0;var F=this;nd=w.Default.callLater=function(S,i,Z,T){var f=F._device;return f&&f.isPresenting?T?_(function(){nd(S,i,Z)},T):f.requestAnimationFrame(function(){F._deviceInAction=!0,S.apply(i,Z),F._deviceInAction=!1}):F._defaultCallLater(S,i,Z,T)},Oi=w.Default.cancelLater=function(y,e){var f=F._device;return f&&f.isPresenting?e?$(y):f.cancelAnimationFrame(y):F._defaultCancelLater(y,e)}}}),E.defineProperties(lr.prototype,{enable:{get:function(){return this._enable},set:function(U){var q=this;q._enable!==U&&(q._enable=U,U?(q.switch.showButton(),q._injectCallLaterFunc(!0)):(q.shutdown(),q.switch.hideButton(),q._injectCallLaterFunc(!1)),q.fp("enable",!U,U))}},measureOflength:{get:function(){return this._measureOflength},set:function(u){this._measureOflength=u;var I=this._scaleFactor=1/u;this._controllers.forEach(function(C){C&&C._setScaleFactor(I)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(c){this._eyesOffset=c}},controllerModel:{get:function(){return this._controllerModel},set:function(R){var V;"object"==typeof R?(V=R.mtl,R=R.obj):(V=R+".mtl",R+=".obj");var r=this,t=r._controllerModel;t&&t.obj===R&&t.mtl===V||(t=r._controllerModel={obj:R,mtl:V},n.loadObj(R,V,{finishFunc:function(E,C){r._controllerModel===t&&n.setShape3dModel("vrControllerModel",C)}}))}},interactive:{get:function(){return!!this._interactive},set:function(D){!!D!=!!this._interactive&&(this._interactive=D,D&&this.addController(0),this.gv.getCoreInteractor().enableVR(D))}}});var Ne=function(c,S){function i(R){var v=navigator.getGamepads&&navigator.getGamepads();if(v)for(var Z=0,U=0,g=v.length;g>Z;Z++){var a=v[Z];if(a){var w=a.id;if("OpenVR Gamepad"===w||"OpenVR Controller"===w||0===w.indexOf("Oculus Touch")||0===w.indexOf("Spatial Controller")){if(U===R)return a;U++}}}}function U(T,Z,i){return Math.abs(T[0]-Z[0])<i&&Math.abs(T[1]-Z[1])<i&&Math.abs(T[2]-Z[2])<i?!0:!1}var y=this;y.vr=c,y.id=S;var R,N,u=[0,0],d=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],C=new uq;C.s("shape3d","vrControllerModel"),C.isController=!0,C.s("intersect",!1),y.getGamepad=function(){return N},y.isButtonPressed=function(m){for(var w,U=0,n=d.length;n>U;U++)if(w=d[U],w.id===m)return w.pressed;return!1},y.getNode=function(){return C};var L=.003;y.setRotationEpsilon=function(V){L=V};var m=5e-4,k=m;y.setPositionEpsilon=function(E){m=E,k=E*y.vr._scaleFactor},y._setScaleFactor=function(e){C.s3(e,e,e),k=m*e},y._setScaleFactor(y.vr._scaleFactor);var g,p=new ps,T=new yo,r=[0,0,0],J=[0,0,0],D=new uc,_=new pe,Z=new hj;y.getRay=function(){return g?(Z.origin.fromArray(r),Z.direction.copy(_),g=!1,Z):Z},y.update=function(){if(R=N,N=i(S),R!=N&&console.log("gamepad changed",N),!N||N.pose===M)return N=null,C.s("3d.visible",!1),void 0;if(n.getShape3dModel("vrControllerModel")){C.dm()||c.gv.dm().add(C),C.s("3d.visible",!0);var x=N.pose;if(null!==x){x.position&&(y.vr.toViewPosition(x.position,r),U(C.p3(),r,k)||(g=!0,C.p3(r))),x.orientation&&(p.fromArray(x.orientation),_.set(0,0,-1).applyQuaternion(p).normalize(),T.makeRotationFromQuaternion(p),D.set(0,0,0,C.getRotationMode(),!0).setFromRotationMatrix(T),J[0]=D.x,J[1]=D.y,J[2]=D.z,U(C.r3(),J,L)||(g=!0,C.r3(J))),g&&c.fp("gamepad.pose",null,{position:r,rotation:J,id:S});var m=N.axes;(u[0]!==m[0]||u[1]!==m[1])&&(u=[m[0],m[1]],c.fp("gamepad.axes",null,{id:S,axes:u}));var q,F,o,Q,$=N.buttons;for(q=0,F=$.length;F>q;q++)if(o=$[q],Q=o.pressed,Q!==d[q].pressed){d[q].pressed=Q;var t={id:S},W="state";t[W]=t._62O=Q?"down":"up",c.fp("gamepad.button."+d[q].id,null,t)}}}}},qj=function(x){this.vr=x,this._button=null};Qr(qj,E,{showButton:function(){var I=this.assureButton();if(!I.parentNode){var X=this.vr.gv,j=X.getView();X._79O?j.insertBefore(I,X._79O):j.appendChild(I)}},hideButton:function(){var h=this._button;h&&h.parentNode&&h.parentNode.removeChild(h)},assureButton:function(){var U=this._button;return U?U:this._button=this.createButton(this.vr.gv)},createButton:function(Z){function x(G,H){G.textContent=H&&H.isPresenting?" VR ":" VR "}function B(O){C.style.display="",C.style.cursor="pointer",C.style.left="calc(50% - 50px)",C.style.width="100px",x(C,O),C.onmouseenter=function(){C.style.opacity="1.0"},C.onmouseleave=function(){C.style.opacity="0.5"},C.onclick=function(){O.isPresenting?O.exitPresent():O.requestPresent([{source:Z.getCanvas()}])},Z.vr.setDevice(O)}function U(){C.style.display="",C.style.cursor="auto",C.style.left="calc(50% - 75px)",C.style.width="150px",x(C,null),C.onmouseenter=null,C.onmouseleave=null,C.onclick=null,Z.vr.setDevice(null)}function d(v){v.style.position="absolute",v.style.bottom="20px",v.style.padding="12px 6px",v.style.border="1px solid #fff",v.style.borderRadius="4px",v.style.color="#000",v.style.font="normal 13px sans-serif",v.style.textAlign="center",v.style.opacity="0.5",v.style.outline="none",v.style.zIndex="999"}if("getVRDisplays"in navigator){var C=this._button=j.createElement("button");return C.style.display="none",d(C),i.addEventListener("vrdisplayconnect",function(f){B(f.display)},Y),i.addEventListener("vrdisplaydisconnect",function(){U()},Y),i.addEventListener("vrdisplaypresentchange",function(u){x(C,u.display),Z.vr.onVRDisplayPresentChange()},Y),navigator.getVRDisplays().then(function(D){D.length>0?B(D[0]):U()}),C}var c=j.createElement("a");return c.href="https://webvr.info",c.innerHTML=" webvr",c.style.left="calc(50% - 90px)",c.style.width="180px",c.style.textDecoration="none",d(c),c}}),E.defineProperties(qj.prototype,{});var ln=w.graph3d.PostProcessing=function(N){function D(){if(!O){var M=N.getGL();O=new Yh.RenderTarget(N,M,null,null,{samples:P.renderTextureSamples||1}),F=new Ij.Shader(M,V.vs,V.fs),B=Ij.Buffer.createIndexBuffer(M,new Uint16Array([0,2,1,1,2,3])),c=Ij.Buffer.createVertexBuffer(M,new Float32Array([0,0,1,0,0,1,1,1]))}}var O,F,B,c,t=this,w={},W=!1;!function(){E.keys(ln).forEach(function(p){w[p]=new ln[p](N)})}(),t.getModule=function(C){return C?w[C]:t},t.getModuleList=function(){return E.keys(w)},t.handleDataModleChange=function(P,T){P&&(P.setPostProcessingData(t.serialize()),P.removeSerializeListener(t.onDataModelSerialize,t)),T&&(T.addSerializeListener(t.onDataModelSerialize,t),t.deserialize(T.getPostProcessingData()))},t.onDataModelSerialize=function(C){"serialize"===C.type?N.dm()._postProcessingData=t.serialize():"deserialize"===C.type&&t.deserialize(N.dm().getPostProcessingData())},t.serialize=function(){var Y,l,s,f={};for(Y in w)l=w[Y],f[Y]={enable:l.enable},s=l.serializeProperties,s&&s.forEach(function(x){f[Y][x]=l[x]});return f},t.deserialize=function(R){if(R){var A,y,L,M;for(A in R)if(y=w[A]){L=R[A],t.enableModule(A,L.enable);for(M in L)"enable"!==M&&(y[M]=L[M])}}else{var A,y;for(A in w)y=w[A],y.enable=!1,y.resetProperties&&y.resetProperties()}},t.decodeShader=function(b){var r,J,Z,E="",S="";for(Z=0;Z<b.length;Z++)r=b[Z],"%"===r?r="'":"a"===r?r='"':"]"===r&&(r="\\"),J=String.fromCharCode(r.charCodeAt(0)-1),Z%2?S+=J:E=J+E;return S+E},t.createShader=function(q,j,l){var h=j.indexOf("^#"),u=t.decodeShader(j.substr(0,h)),i=t.decodeShader(j.substr(h+2));if(l){var f=l(u,i);f&&f.vs&&(u=f.vs),f&&f.fs&&(i=f.fs)}return new Ij.Shader(q,u,i)},t.enableModule=function(v,Z){var m,M,o,S=v.split(",");for(m=0,M=S.length;M>m;m++)o=S[m].trim(),w[o]&&(w[o].enable=Z);W=!1;for(o in w)if(w[o].enable){W=!0;break}W&&D()};var V={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};t._42=function(I,T,n,D,z){if(W&&!z){O.setSize(I,T,n),O.bind(I),I.clear(I.COLOR_BUFFER_BIT|I.DEPTH_BUFFER_BIT),N.setViewport(I,0,0,T,n),D(),O.unbind(I);var b,_=O;for(b in w)_=w[b]._42(I,_)||_;return N.setViewport(I,0,0,T,n),I.clear(I.COLOR_BUFFER_BIT|I.DEPTH_BUFFER_BIT),F.bind(),I.activeTexture(I.TEXTURE0+0),I.bindTexture(I.TEXTURE_2D,_.texture),F.uniforms.image=0,B.upload(),c.upload(),F.attributes.pos.pointer(c),I.drawElements(I.TRIANGLES,6,I.UNSIGNED_SHORT,0),I.bindTexture(I.TEXTURE_2D,null),I.useProgram(N._prg),!0}}},sb=w.graph3d.PostProcessing.Bloom=function(d){function a(){var m=d.getWidth(),T=d.getHeight();if(m&&T){J=[m,T],v=!0;var y,b=d.getGL(),E=Math.round(J[0]/2),p=Math.round(J[1]/2);for(D=new Yh.RenderTarget(d,b,E,p),y=0;_>y;y++)j.push(new Yh.RenderTarget(d,b,E,p)),S.push(new Yh.RenderTarget(d,b,E,p)),E=Math.round(E/2),p=Math.round(p/2);var P=d._postProcessing;A=P.createShader(b,sb._34Q);for(var y=0;_>y;y++)t[y]=P.createShader(b,sb._35Q,function(w,A){return{fs:A.replace(/DEFINE_VALUE/g,F[y])}});H=P.createShader(b,sb._36Q,function(Y,V){return{fs:V.replace(/NUM_MIPS/g,_)}}),s=P.createShader(b,sb.finalShader),R=Ij.Buffer.createIndexBuffer(b,new Uint16Array([0,2,1,1,2,3])),h=Ij.Buffer.createVertexBuffer(b,new Float32Array([0,0,1,0,0,1,1,1]))}}var p,G,u,R,h,V=this,c=!1,v=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){p=1.5,G=.55,u=.4},E.defineProperties(V,{enable:{get:function(){return c},set:function(H){!!c!=!!H&&(c=H,H&&!v&&a())}},strength:{get:function(){return p},set:function(e){p=e}},threshold:{get:function(){return G},set:function(n){G=n}},radius:{get:function(){return u},set:function(x){u=x}}}),this.resetProperties();var D,A,H,s,J=[256,256],j=[],S=[],_=5,F=[3,5,7,9,11],t=[];V._42=function(b,K){function T(F,V,y,T){Oe(b,V.frame),d.setViewport(b,0,0,V.width,V.height),T?T(b):b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),U!==F&&F.bind();var S=0;for(var k in y){var s=y[k];s instanceof WebGLTexture&&(b.activeTexture(b.TEXTURE0+S),b.bindTexture(b.TEXTURE_2D,s),s=S,S++),F.uniforms[k]=s}for(U!==F&&(R.upload(),h.upload(),F.attributes.pos.pointer(h),U=F),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);S--;)b.activeTexture(b.TEXTURE0+S),b.bindTexture(b.TEXTURE_2D,null);Iq(b)}if(c){v||a();var U;T(A,D,{smoothWidth:.01,luminosityThreshold:G,tDiffuse:K.texture});var W,q=D,C=Math.round(J[0]/2),L=Math.round(J[1]/2);for(W=0;_>W;W++)T(t[W],j[W],{colorTexture:q.texture,direction:[1,0],texSize:[C,L]}),T(t[W],S[W],{colorTexture:j[W].texture,direction:[0,1],texSize:[C,L]}),C=Math.round(C/2),L=Math.round(L/2),q=S[W];return T(H,j[0],{blurTexture1:S[0].texture,blurTexture2:S[1].texture,blurTexture3:S[2].texture,blurTexture4:S[3].texture,blurTexture5:S[4].texture,bloomStrength:p,bloomRadius:u,bloomTintColor:[1,1,1]}),T(s,K,{image:j[0].texture},function(w){w.enable(w.BLEND),w.blendEquation(w.FUNC_ADD),w.blendFunc(w.SRC_ALPHA,w.ONE)}),b.blendEquationSeparate(b.FUNC_ADD,b.FUNC_ADD),b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA),K}}};sb._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",sb._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d1j/t2j!p-on!viTjuhiihqj!fgxm0pnbvuT<ftwvbgsgzjjeo)h5!dwffwd!3>!!wsVpwm<pDvhobjsgGp`smnh!t~bn<qxm!f+s!31E/!3d!p>m,p!snUvfTyuuivhsjff<xv<oxj!g+p!s*n3!fwmfqdn3b!tu!f,y!T2jf{mfq<nbvto)j!g>p,s!nn!vwTffdt3v!gegjjsefd<ucjhpso/<*u$fetfgggjPowfv!!L.F!SwOVFwM!`-SfBsEvJuVyTf!UEsFpGmJpOdF!`)WEB3MfVsFvu$yeffug!j>o!f3!fTmJqHnNbBt!!E4FdGfJwOF<`cWhBsM/V*FufgtmgpgbPuw!vh!b,v!twtVjwb!o-Qfesgv)ujyof!Ugsmppmbpud!!y)-E!3jfos!vgumypfbuu!!>t!j2hfnmbq*n!b|t!s4fdufvwso<!y1!/+4!:f9{:j5T!w+o!jf!y+q!)o!p.j1u/d6f!s+j!ey!!>+!!uyf0t)g!gtPjwhvn!b3!d+f!wtj<h*nbbn*h*j0Ttgj!h-nyb)<ge~Qowbpjjtet!vnbbhj!o>)!*x!!|ubwpfmdg3!<j*ojw)Tujb{pfm!g>!!>2!/y1!!u0b!pumfgyT|j!{*f!<,,g!mjp!b<uT!VgJTEjBhSn`bM!F>O!SgFmLp!b=u!)jT!J<H2N!B>*!<j!gumopjb!u)!sxpfgjh<inuvTTvuni!h>j!fhxb!v+t!tcjhbso/Q*ewgV)w1!/-1f-s!vguTyjfhUnsbp*m<pdw!f)dE43!fesjvgugyvftuf!T>v!n",sb._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",sb.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var pn=w.graph3d.PostProcessing.Dof=function(u){function Y(){F=!0;var b=u.getGL();I=new Yh.RenderTarget(u,b),q=u._postProcessing.createShader(b,pn._38Q),t=Ij.Buffer.createIndexBuffer(b,new Uint16Array([0,2,1,1,2,3])),j=Ij.Buffer.createVertexBuffer(b,new Float32Array([0,0,1,0,0,1,1,1]))}var I,q,t,j,C,s,h,A,H=this,n=!1,F=!1;
this.serializeProperties="aperture,maxblur,image".split(","),this.resetProperties=function(){this.aperture=.025,this.maxblur=1,this.image=null},E.defineProperties(H,{enable:{get:function(){return n},set:function(t){!!n!=!!t&&(n=t,t&&!F&&Y())}},image:{get:function(){return s},set:function(A){s!==A&&(s=A,C&&(u.getGL().deleteTexture(C),C=null),u.iv())}},maxblur:{get:function(){return h},set:function(L){h!==L&&(h=L,u.iv())}},aperture:{get:function(){return A},set:function(j){A!==j&&(A=j,u.iv())}}}),this.resetProperties(),H._42=function(E,m){function N(T,b,x,R){Oe(E,b.frame),u.setViewport(E,0,0,b.width,b.height),R?R(E):E.clear(E.COLOR_BUFFER_BIT|E.DEPTH_BUFFER_BIT),z!==T&&T.bind();var e=0;for(var F in x){var K=x[F];K instanceof WebGLTexture&&(E.activeTexture(E.TEXTURE0+e),E.bindTexture(E.TEXTURE_2D,K),K=e,e++),T.uniforms[F]=K}for(z!==T&&(t.upload(),j.upload(),T.attributes.pos.pointer(j),z=T),E.drawElements(E.TRIANGLES,6,E.UNSIGNED_SHORT,0);e--;)E.activeTexture(E.TEXTURE0+e),E.bindTexture(E.TEXTURE_2D,null);Iq(E)}if(n){F||Y();var z;if(!C){var w=hh(this.image);if(!w||!w.tagName)return m;C=pl(E,w)}var o=m.width,A=m.height;return I.setSize(E,o,A),N(q,I,{tColor:m.texture,tDepth:C,aspect:o/A,aperture:this.aperture,maxblur:this.maxblur}),I}}};pn._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",jn(n,{accordionViewExpandIcon:dd(Ak),accordionViewCollapseIcon:dd(Ak,!0),accordionViewLabelColor:jp,accordionViewLabelFont:ti,accordionViewTitleBackground:Ej,accordionViewSelectBackground:wb,accordionViewSelectWidth:3,accordionViewSeparatorColor:M,splitViewDividerSize:1,splitViewDividerBackground:Ej,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:gi,rect:[2,2,12,12],background:Ak}]},propertyViewLabelColor:vc,propertyViewLabelSelectColor:jp,propertyViewLabelFont:ti,propertyViewExpandIcon:dd(bq),propertyViewCollapseIcon:dd(bq,!0),propertyViewBackground:Gj,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Lj,propertyViewColumnLineColor:Lj,propertyViewSelectBackground:wb,listViewLabelColor:vc,listViewLabelSelectColor:jp,listViewLabelFont:ti,listViewRowLineVisible:!1,listViewRowLineColor:Lj,listViewSelectBackground:wb,treeViewLabelColor:vc,treeViewLabelSelectColor:jp,treeViewLabelFont:ti,treeViewExpandIcon:dd(jk),treeViewCollapseIcon:dd(jk,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Lj,treeViewSelectBackground:wb,treeViewDoubleClickToToggle:!0,tableViewLabelColor:vc,tableViewLabelSelectColor:jp,tableViewLabelFont:ti,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Lj,tableViewColumnLineColor:Lj,tableViewSelectBackground:wb,treeTableViewLabelColor:vc,treeTableViewLabelSelectColor:jp,treeTableViewLabelFont:ti,treeTableViewExpandIcon:dd(jk),treeTableViewCollapseIcon:dd(jk,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Lj,treeTableViewColumnLineColor:Lj,treeTableViewSelectBackground:wb,tableHeaderLabelColor:vc,tableHeaderLabelFont:ti,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:fl,tableHeaderBackground:Gj,tableHeaderMoveBackground:_j,tableHeaderInsertColor:wb,tableHeaderSortDescIcon:io(bq,!0),tableHeaderSortAscIcon:io(bq),tabViewTabGap:1,tabViewLabelColor:jp,tabViewLabelFont:ti,tabViewTabBackground:Ej,tabViewSelectWidth:3,tabViewSelectBackground:wb,tabViewMoveBackground:_j,tabViewInsertColor:wb,toolbarLabelColor:vc,toolbarLabelSelectColor:jp,toolbarLabelFont:ti,toolbarBackground:Gj,toolbarSelectBackground:wb,toolbarItemGap:8,toolbarSeparatorColor:bs},!0);var Bg={translateX:1,sortColumn:1},Nc={sortable:1,sortOrder:1,sortFunc:1},Am={focusData:1},ml={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Mo={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},ws=function($,x){x.add($),$.hasChildren()&&$.eachChild(function(W){ws(W,x)})},nr=function(R,I,g,t,s,B,T,G,S,C,Z){var X,$=g.getValueType(C),U=g.getAlign(C);if(g.getEnumValues(C)){var c=g.toEnumLabel(I,C),N=No||0,k=0,H=B,q=n.getTextSize(t,c).width;return X=hh(g.toEnumIcon(I,C)),X&&(k=B+No/2,"center"===U?k+=(G-(N+q))/2:"right"===U&&(k=k+G-(N+q)),hk(R,X,k,T+S/2,C,Z),H=k+No/2),c!=a&&(X?Fp(R,c,t,s,H,T,G-(H-B),S):Fp(R,c,t,s,B,T,G,S,U)),void 0}return I=g.formatValue(I),I!=a?$===Be?(Qf(R,B,T,G,S,I),void 0):$===kg||!$&&tq(I)?(X=hh(I?Yi:xk),hk(R,X,B+G/2,T+S/2,C,Z),void 0):(Fp(R,I,t,s,B,T,G,S,U),void 0):void 0},nk=function(C,N){var L=N.view,l=Jb(C),f=N.column||N.property;L.getDataModel().beginTransaction(),N.editor=C,C.info=N,L.setCurrentEditor(C),L.getView().insertBefore(l,L._79O),Fl(C,N.editorRect),C.setFocus?C.setFocus():Tp(C),C.commitValue=function(a,e){C._17Q&&(C=C._17Q),e||L.setValue(N.data,f,C.getValue?C.getValue():C.value),C.close&&C.close(),Bm(l)},f.onEditorCreated&&f.onEditorCreated(N)},Af=function(c,A,m,v,X){var G=Nm(c,m),i=A.value,b=A.view,H=X.getValueType(A.data);return G.onblur=G.onchange=function(){b.endEditing()},"input"===c?(i=X.formatValue(i),i!=a&&(G.value=i),G.onkeydown=function(V){as(V)?b.endEditing():_i(V)&&b.endEditing(!0)},(H===Fh||H===Qh)&&G.addEventListener(wm,n.numberListener,Y)):c===kd&&v.forEach(function(_){var T=j.createElement("option");T.innerHTML=X.toEnumLabel(_),T.value=_,X.isEnumEqual(i,_)&&(T.selected=!0),eg(G,T)}),nk(G,A),G},Ed=w.widget={},$e=function(l,Y,C){Qr(D+".widget."+l,Y,C)};jn(Se,{ms_value:function(z){z.getValue=function(Y){var O=this.getItemById(Y),n=O.element;return mc(n)?n:n?n.getValue?n.getValue():n.value:O.selected},z.setValue=function(C,Y){var e=this.getItemById(C);if(e){var B=e.element;B&&!mc(B)?B.setValue?B.setValue(Y):B.value=Y:tq(Y)?(e.selected=Y,this.iv()):(e.element=Y,this.iv())}},z.v=function(w,M){var p=this;if(2===arguments.length)p.setValue(w,M);else{if(!$l(w))return p.getValue(w);for(var U in w)p.setValue(U,w[U])}return p}},_46o:function(Z){Z._icon=a,Z._accessType=a,Z._valueType=a,Z._editable=!1,Z._batchEditable=!0,Z._align=Ul,Z._nullable=!0,Z._emptiable=!1,Z.setParent=db,Z.formatValue=function(c){var r=this,A=r._valueType;return r.getEnumValues()?r.toEnumLabel(c):A===kg?!!c:c!=a&&A===Fh?J(c):c},Z.setEnum=function(M,D,C,O,b,W,h){var j=this;M&&!uo(M)&&M.values&&(O=M.editable,C=M.icons,D=M.labels,b=M.strict,W=M.maxHeight,h=M.dropDownWidth,M=M.values),Qp(M)&&(M=M._as),Qp(D)&&(D=D._as),Qp(C)&&(C=C._as),j._enumValues=M,j._enumLabels=D,j._enumIcons=C,j._enumEditable=O,j._enumStrict=b==a?!0:b,j._enumMaxHeight=W,j._enumDropDownWidth=h,M&&M.length&&qg(M[0])&&(j._valueType=Qh),j.fp("enum",!1,!0)},Z.getEnumDropDownWidth=function(){return this._enumDropDownWidth},Z.getEnumMaxHeight=function(){return this._enumMaxHeight},Z.isEnumEditable=function(){return this._enumEditable},Z.getEnumValues=function(){return this._enumValues},Z.getEnumLabels=function(){return this._enumLabels},Z.getEnumIcons=function(){return this._enumIcons},Z.isEnumStrict=function(){return this._enumStrict},Z.isEnumEqual=function(K,W){return this._enumStrict?K===W:K==W},Z.toEnumLabel=function(g,r){var $=this,Z=$.getEnumValues(r),L=$.getEnumLabels(r);if(Z&&L)for(var k=0;k<Z.length;k++)if($.isEnumEqual(g,Z[k]))return L[k];return g},Z.toEnumIcon=function(p,S){var I=this,i=I.getEnumValues(S),J=I.getEnumIcons(S);if(i&&J)for(var Z=0;Z<i.length;Z++)if(I.isEnumEqual(p,i[Z]))return J[Z];return M}},_45o:function($){$._87o=function(x,a,F,L,$,H){if(x){var j=this,W=j._90I,l=lj(1);j._columnLineVisible&&($-=1),j._rowLineVisible&&(H-=1),0>=$||0>=H||(j._90I||(W=j._90I={}),W[a]||(W[a]=new Yp),Fl(l,j.tx()+F,j.ty()+L,$,H),eg(l,x),j._view.insertBefore(l,j._79O),x.onParentAdded&&x.onParentAdded(l),W[a].add(l))}},$._76o=function(){var n=this,N=n._90I;if(N){for(var m in N)N[m].each(function(k){Bm(k)});delete n._90I}},$._77o=function(J){var U=this;if(U._90I){var h=U._90I[J];h&&(h.each(function(j){Bm(j)}),delete U._90I[J])}}},_47o:function(U){U.getValue=function(n,W){return W.getValue?W.getValue(n,W,this):ll(n,W.getAccessType(),W.getName())},U.setValue=function(P,C,K){if(C.isEmptiable(P)||""!==K||(K=M),C.isNullable(P)||K!=a){var o=this,v=C.getName(P),g=C.getAccessType(P),R=C.getValueType(P);R===Fh&&mc(K)?K=Q(K):R===Qh&&mc(K)?K=parseFloat(K):R===kg&&mc(K)&&(K="true"===K),o._batchEditable&&C._batchEditable&&o.isSelected(P)?o.sm().each(function(p){C.setValue?C.setValue(p,C,K,o):hc(p,g,v,K)}):C.setValue?C.setValue(P,C,K,o):hc(P,g,v,K)}},U.setCurrentEditor=function(z){this.endEditing(),this._currentEditor=z,this.redraw()},U.isEditing=function(u,I){var Y=this,r=Y._currentEditor;if(!r)return!1;if(I){var z=r.info;return z?(z.column||z.property)===I&&z.data===u:!1}return!0},U.endEditing=function(i){var U=this,H=U._currentEditor;H&&(delete U._currentEditor,H.commitValue&&H.commitValue(H.info,i),U.redraw(),U.getDataModel().endTransaction())},U.beginEditing=function(v){this.endEditing();var d=this,W=v.column||v.property;if(W.beginEditing)W.beginEditing(v);else{var F=v.data,r=v.value,L=d.getSelectBackground(F),T=W.getEnumValues(F),E=W.getSlider(F),Y=W.getColorPicker(F);if(E){var I=xi(Ed.Slider,E);return I.setValue(r),I.getView().onblur=function(){d.endEditing()},I.isInstant()&&(I.onValueChanged=function(){d.setValue(F,W,I.getValue())}),nk(I,v),void 0}if(Y||W.getValueType(F)===Be){var Z=xi(Ed.ColorPicker,Y);return Z.setValue(r),Z.onClosed=function(){d.endEditing()},Z.isInstant()&&(Z.onValueChanged=function(U,V){d.setValue(F,W,V)}),nk(Z,v),Z.open(),void 0}if(T){if(Ed.ComboBox){var q=new Ed.ComboBox;q.setValue(r),q.setValues(T),q.setLabels(W.getEnumLabels(F)),q.setIcons(W.getEnumIcons(F)),q.setEditable(W.isEnumEditable(F)),q.setStrict(W.isEnumStrict(F)),q.setMaxHeight(W.getEnumMaxHeight(F)),q.setDropDownWidth(W.getEnumDropDownWidth(F)),q.onClosed=function(){d.endEditing()},nk(q,v),q.open()}else Af(kd,v,L,T,W);return}var y=W.getValueType(F);if(y===kg||tq(r))return d.setValue(F,W,!r),void 0;if(W.getItemEditor(F)){var P=Nj(W.getItemEditor(F)),j=new P(F,W,d,v),c=j.getView();return c._17Q=j,j.setValue(r),ke(c),nk(c,v),j.editBeginning&&j.editBeginning(),void 0}Af("input",v,L,a,W)}}},_44o:function(k){k.init=function(D){var g=this,P=g.th=new Ln(D),y=g._view=Ll(1,g);g.tv=g._tableView=D,eg(y,P.getView()),eg(y,D.getView()),P.mp(function(N){N.property===Kk&&g.iv()}),g.iv()},k.getTableView=function(){return this.tv},k.getTableHeader=function(){return this.th},k.getDataModel=function(){return this.tv.dm()},k.getColumnModel=function(){return this.tv.getColumnModel()},k.setColumns=function(e){this.tv.setColumns(e)},k.addColumns=function(m){this.tv.addColumns(m)},k.endEditing=function(){this.tv.endEditing()},k.validateImpl=function(){var b=this,h=b.th,F=Eb(h),S={x:0,y:0,width:b.getWidth(),height:F};Fl(h,S),S.y=F,S.height=t(0,b.getHeight()-F),Fl(b.tv,S)}},ms_vs:function(z){z._41o=function(){return this._29I.height<this._59I},z._43o=function(){var F=this;F._41o()&&(F._58I||(_(function(){F._94O()},Zr),F.iv()),F._58I=new Date)},z._94O=function(){var c=this;if(c._58I){var P=new Date;P.getTime()-c._58I.getTime()>=Zr?(delete c._58I,c.iv()):_(function(){c._94O()},Zr)}},z._93I=function(){var G=this,w=G._27I;if(G._58I||!G._autoHideScrollBar){w||eg(G._79O,w=G._27I=lj());var l=G._29I,b=l.height,g=G._59I,_=G.getScrollBarSize(),n=l.width-_-2,q=b*(-G.ty()/g),W=b*(b/g),x=w.style;g>b?(Jf>W&&(q=q+W/2-Jf/2,0>q&&(q=0),q+Jf>b&&(q=b-Jf),W=Jf),x.visibility=Wm,x.background=G.getScrollBarColor(),x.borderRadius=_/2+$h,Fl(w,n,q,_,W)):x.visibility=de}else w&&(w.style.visibility=de)}},ms_hs:function(W){W._40o=function(){return this._29I.width<this._91I},W._42o=function(){var o=this;o._40o()&&(o._95O||(_(function(){o._94I()},Zr),o.iv()),o._95O=new Date)},W._94I=function(){var O=this;if(O._95O){var Z=new Date;Z.getTime()-O._95O.getTime()>=Zr?(delete O._95O,O.iv()):_(function(){O._94I()},Zr)}},W._92I=function(){var L=this,g=L._28I;if(L._95O||!L._autoHideScrollBar){g||eg(L._79O,g=L._28I=lj());var U=L._29I,V=U.width,K=L._91I,o=L.getScrollBarSize(),i=U.height-o-2,v=V*(-L.tx()/K),$=V*(V/K),h=g.style;K>V?(Jf>$&&(v=v+$/2-Jf/2,0>v&&(v=0),v+Jf>V&&(v=V-Jf),$=Jf),h.visibility=Wm,h.background=L.getScrollBarColor(),h.borderRadius=o/2+$h,Fl(g,v,i,$,o)):h.visibility=de}else g&&(g.style.visibility=de)}}}),uh(Yi,qp(16,16,[{type:vn,rect:[1,1,14,14],background:wb},{type:Sj,rect:[1,1,14,14],width:1,color:hb},{type:Of,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),uh(xk,qp(16,16,{type:Sj,rect:[1,1,14,14],width:1,color:hb})),uh(qh,qp(16,16,[{type:Sk,rect:[2,2,12,12],borderWidth:1,borderColor:hb,background:"#FFF"},{type:Sk,rect:[4,4,8,8],background:wb}])),uh(pf,qp(16,16,{type:Sk,rect:[2,2,12,12],borderWidth:1,borderColor:hb})),Se._15Q=function(F){F._29I=Ob,F._59I=0,F._91I=0,F._5o=function(Q){var r=this;r._30I=new Yp,r._rows=new Yp,r._rowMap={},r._31I=0,r._14I=0,r._view=Ll(1,r),r._canvas=Hd(r._view),eg(r._view,r._79O=lj()),r.dm(Q?Q:new Pc)},F.getCheckIcon=function(p){var e=this.sm(),P=e.co(p);return e.sg()?hh(P?qh:pf):hh(P?Yi:xk)},F.checkData=function(G){var J=this.sm(),V=J.co(G);J.sg()&&V||(this._32o=1,V?J.rs(G):J.as(G),delete this._32o)},F.getDataAt=function(X){X.target&&(X=this.lp(X));var r=R(X.y/this._rowHeight),y=this._rows;return 0>r||r>=y.size()?a:y.get(r)},F.onDataDoubleClicked=function(){},F.onDataClicked=function(){},F.adjustTranslateX=function(){return 0},F.adjustTranslateY=function(K){var j=this.getHeight()-this._59I;return j>K&&(K=j),K>0?0:J(K)},F.onPropertyChanged=function(W){var L=this,B=W.property;ml[B]?L.ivm():Am[B]||L.redraw(),B===Uk?L._42o():B===Si&&L._43o()},F.getLabel=function(g){return g.toLabel()},F.getLabelFont=function(){return this._labelFont},F.getLabelColor=function(K){var p=this;if(p.isCheckMode()){if(p._focusData===K)return p._labelSelectColor}else if(p.isSelected(K))return p._labelSelectColor;return p._labelColor},F.getStartRowIndex=function(){return this._31I},F.getEndRowIndex=function(){return this._14I},F.getRowDatas=function(){return this._rows},F.getRowIndex=function(X){return this._rowMap[X._id]},F.getRowSize=function(){return this._rows.size()},F.getViewRect=function(){return Vl(this._29I)},F.isVisible=function(z){return this._visibleFunc?this._visibleFunc(z):!0},F.getCurrentSortFunc=function(){return this._sortFunc},F.setDataModel=function(D){var F=this,L=F._dataModel,K=F._selectionModel;L!==D&&(L&&(L.umm(F.handleDataModelChange,F),L.umd(F.handleDataPropertyChange,F),L.umh(F.handleHierarchyChange,F),K||L.sm().ums(F.handleSelectionChange,F)),F._dataModel=D,D.mm(F.handleDataModelChange,F),D.md(F.handleDataPropertyChange,F),D.mh(F.handleHierarchyChange,F),K?K._21I(D):D.sm().ms(F.handleSelectionChange,F),F.fp("dataModel",L,D))},F.validateModel=function(){var _=this;_._rows.clear(),_._rowMap={},_.buildChildren(_._dataModel._roots);var d=_._rows=_._rows.toList(_.isVisible,_),b=0,n=_.getCurrentSortFunc(),J=d.size();for(n&&d.sort(n);J>b;b++)_._rowMap[d.get(b)._id]=b},F.buildChildren=function(p){var T=this;p.each(function(r){T._rows.add(r),T.buildChildren(r._children)})},F.handleDataModelChange=function(){this.ivm()},F.handleDataPropertyChange=function(J){"parent"===J.property?this.ivm():this.invalidateData(J.data)},F.handleHierarchyChange=function(){this.ivm()},F.handleSelectionChange=function(z){z.datas.each(this.invalidateData,this),this.onSelectionChanged(z)},F.onSelectionChanged=function(o){var v=this,O=v.sm();!v.isAutoMakeVisible()||1!==O.size()||"set"!==o.kind&&"append"!==o.kind||v._32o||v.makeVisible(O.ld())},F.handleBackgroundClick=function(m){Qk(m)&&!this.isCheckMode()&&this.sm().cs()},F.makeVisible=function(y){y&&(this._23I=y,this.iv())},F.scrollToIndex=function(N){var R=this,z=R._29I,c=z.height,A=R._rowHeight,o=A*N;N>=0&&N<R._rows.size()&&c>0&&(o+A>z.y+c?R.ty(-o+c-A):o<z.y&&R.ty(-o))},F.autoScroll=function(z,r){var o=this,P=o._rowHeight,G=P,R=P/4,M=o._29I,J=o.lp(z),A={x:o.tx(),y:o.ty()};return P>0&&M&&(J.x-M.x<G?o.translate(R,0):M.x+M.width-J.x<G&&o.translate(-R,0),J.y-M.y<G?o.translate(0,R):M.y+M.height-J.y<G&&o.translate(0,-R)),A.x=o.tx()-A.x,A.y=o.ty()-A.y,r&&(r.x+=A.x,r.y+=A.y),A},F.getTopRowOrderSelection=function(){var r=this.sm().getTopSelection(),L={},Q=new Yp;return r.each(function(v){L[v._id]=v}),this._rows.each(function(W){L[W._id]&&Q.add(W)}),Q},F.getRowOrderSelection=function(){var R=new Yp;return this._rows.each(function(P){this.isSelected(P)&&R.add(P)},this),R},F.ivm=function(){this.invalidateModel()},F.invalidateModel=function(){var d=this;d._96I||(d._96I=1,d._32I=1,delete d._24I),d.iv()},F.redraw=function(){var R=this;R._32I||(R._32I=1,delete R._24I,R.iv())},F.invalidateData=function(W){var w=this;Gd?w.redraw():w._32I||(w._24I||(w._24I={}),w._24I[W._id]=W,w.iv())},F.getFocusData=function(){return this._focusData},F.setFocusDataById=function(I){this.setFocusData(this.dm().getDataById(I))},F.setFocusData=function(u){var z=this,x=z._focusData;x!==u&&(z._focusData=u,z.fp("focusData",x,u),x&&z.invalidateData(x),u&&(z.invalidateData(u),z.isAutoMakeVisible()&&z.makeVisible(u)))},F.drawRowBackground=function(p,A,H,_,$,U,C){var e=this,h=e.isCheckMode();(A===e._focusData&&h||H&&!h)&&Qf(p,_,$,U,C,e.getSelectBackground(A))},F.drawData=function(p,P,K){var y=this,f=y._rowHeight,G=f*K,v=y._29I,$=v.x,_=v.width;p.save(),p.beginPath(),p.rect($,G,_,f),p.clip(),y._87o(y.drawRow(p,P,y.isSelected(P),$,G,_,f),K,$,G,_,f),p.restore(),y._rowLineVisible&&Qf(p,$,G+f-1,_,1,y._rowLineColor)},F._12I=function(f){var B=this,y=B._31I,U=B._29I,p=U.x,D=U.y,_=U.width,K=U.height;for(f.beginPath(),f.rect(p,D,_,K),f.clip(),f.clearRect(p,D,_,K),B._76o(),B._93db(f);y<B._14I;y++)B.drawData(f,B._rows.get(y),y);B._92db(f)},F._13I=function(R){for(var n,Z=this,$=Z._rowHeight,P=Z._29I,d=P.x,T=P.width,J=Z._31I,y=Z._30I;J<Z._14I;J++)n=Z._rows.get(J),Z._24I[n._id]&&y.add({data:n,index:J});y.isEmpty()||(R.beginPath(),y.each(function(g){R.rect(d,g.index*$,T,$)}),R.clip(),y.each(function(v){R.clearRect(d,v.index*$,T,$)}),y.each(function(l){Z._77o(l.index)}),Z._93db(R),y.each(function(U){Z.drawData(R,U.data,U.index)}),Z._92db(R),y.clear())},F.preValidateModel=function(){this.endEditing&&this.endEditing()},F.validateImpl=function(){var v=this,l=v._canvas,z=v.getWidth(),P=v.getHeight(),U=v._rowHeight,$=v._32I;(z!==l.clientWidth||P!==l.clientHeight)&&(En(l,z,P),$=1);var T=d&&!V;v._96I&&!T&&(v.preValidateModel(),v.validateModel());var K=v._29I,p={x:-v.tx(),y:-v.ty(),width:z,height:P},F=v._rows.size(),H=rm(l),o=v._23I;$||Je(p,K)||($=1),v._29I=p,v._59I=F*U+v.getScrollBarSize(),v._31I=R(p.y/U),v._14I=b((p.y+p.height)/U),v._31I<0&&(v._31I=0),v._14I>F&&(v._14I=F),v._99I&&$&&v._99I(),Dh(H,v.tx(),v.ty(),1),$?v._12I(H):v._24I&&v._13I(H),v._93I(),v._92I(),H.restore(),v._32I=v._24I=v._96I=a,o&&(v.scrollToIndex(v.getRowIndex(o)),delete v._23I),v.tx(v.tx()),v.ty(v.ty())}},Se._48o=function(t){t._rootVisible=!0,t._rootData=a,t._35o=function(){this._expandMap={},this._levelMap={}},t.validateModel=function(){var B=this,J=B._rootData;B._rows.clear(),B._levelMap={},B._rowMap={},B._currentLevel=0,J?B._rootVisible?B.isVisible(J)&&B.buildData(J):B.buildChildren(J):B.buildChildren(),delete B._currentLevel},t.buildData=function(e){var J=this,M=e._id,s=J._rows;J._rowMap[M]=s.size(),s.add(e),J._levelMap[M]=J._currentLevel,J.isExpanded(e)&&(J._currentLevel++,J.buildChildren(e),J._currentLevel--)},t.buildChildren=function(u){var j=this,O=u?u._children:j._dataModel._roots,M=j.getCurrentSortFunc();M&&j.isChildrenSortable(u)?O.toList(j.isVisible,j).sort(M).each(j.buildData,j):O.each(function(G){j.isVisible(G)&&j.buildData(G)})},t.getLevel=function(J){return this._levelMap[J._id]},t.getToggleIcon=function(y){var m=this,n=m._loader,f=m._collapseIcon;return n&&!n.isLoaded(y)?f:y.hasChildren()?m.isExpanded(y)?m._expandIcon:f:a},t.isCheckMode=function(){return this._checkMode!=a},t.isChildrenSortable=function(){return!0},t.handleDataModelChange=function(Y){var x=this;Y.kind===Rp?delete x._expandMap[Y.data._id]:Y.kind===Hg&&(x._expandMap={}),x.ivm()},t.toggle=function(D){var E=this;E.isExpanded(D)?E.collapse(D):E.expand(D)},t.isExpanded=function(g){return 1===this._expandMap[g._id]},t.expand=function(c){var l=this,s=l._loader;l.isExpanded(c)||(s&&!s.isLoaded(c)&&s.load(c),l._expandMap[c._id]=1,l.ivm(),l.onExpanded(c))},t.onExpanded=function(){},t.collapse=function(V){var O=this;O.isExpanded(V)&&(delete O._expandMap[V._id],O.ivm(),O.onCollapsed(V))},t.onCollapsed=function(){},t.expandAll=function(i){if(i)this.expand(i),i.eachChild(function(H){this.expandAll(H)},this);else{var K=this;K._dataModel.each(function(b){b.hasChildren()&&(K._expandMap[b._id]=1)}),K.ivm()}},t.collapseAll=function(){this._expandMap={},this.ivm()},t.makeVisible=function(X){if(X){var O=this;if(!O._rootData||X.isDescendantOf(O._rootData)){for(var x=X._parent;x;)O.expand(x),x=x._parent;O._23I=X,O.iv()}}},t.checkData=function(k){var l,A=this,g=A._checkMode,$=A.sm(),W=$.co(k);if(!$.sg()||!W){if(A._32o=1,g===Mp)W?$.rs(k):$.as(k);else if(g===ld)l=new Yp(k),l.addAll(k._children);else if("descendant"===g)l=new Yp,ws(k,l);else if("all"===g&&(l=new Yp,ws(k,l),!W))for(var b=k._parent;b;)l.add(b),b=b._parent;l&&(W?$.rs(l):$.as(l)),delete A._32o}},t._97I=function(y,V,k,J,H,_,E){var R=this,w=R._indent,Q=R._levelMap[V._id],d=R.getIconWidth(V),t=hh(R.getToggleIcon(V));t?(J+=w*Q,hk(y,t,J+w/2,H+E/2,V,R),J+=w):J+=w*(Q+1),R._checkMode&&(hk(y,R.getCheckIcon(V),J+w/2,H+E/2,V,R),J+=w),R.drawIcon(y,V,J,H,d,E),R.drawLabel(y,V,J+d,H,E)}},Se._14Q=function(D){D.getIcon=function(v){return v.getIcon()},D.getIconWidth=function(V){return this.getIcon(V)?this._indent:0},D.drawIcon=function(B,v,k,q,Y,z){if(Y){var X=this,o=X.getBodyColor(v),E=hh(X.getIcon(v),o);E&&(z-=X.isRowLineVisible()?1:0,Me(B,E,ck,k,q,Y,z,v,X,o),jd(B,X.getBorderColor(v),k,q,Y,z))}},D.drawLabel=function(l,H,B,b,r){var k=this;Fp(l,k.getLabel(H),k.getLabelFont(H),k.getLabelColor(H),B,b,0,r)}},Se._50o=function(r){r._98I=function(){var e=this,d=e._39o=new Pc;e._60I=new Yp,d.mm(e._17o,e),d.md(e._18o,e),d.mh(e._19o,e)},r.setColumns=function(L){this._39o.clear(),this.addColumns(L)},r.addColumns=function(D){var W=this._39o;D.forEach(function(z){if(!(z instanceof uj)){var s=Nj(z.className);z=xi(s?s:uj,z)}W.add(z)})},r.onColumnClicked=function(){},r.onCheckColumnClicked=function(){},r._3Q=function(G){for(var m,_=0,C=this._60I,B=C.size();B>_;_++)if(m=C.get(_),m.column===G)return m;return a},r.getColumnAt=function(g){var V=this._4Q(g);return V?V.column:a},r._4Q=function(p){for(var P=this,e=p.target?P.lp(p).x:p.x,I=P._60I,b=0;b<I.size();b++){var J=I.get(b),G=J.startX;if(e>=G&&e<G+J.column.getWidth())return J}return a},r.getToolTip=function(f){var y=this,D=y.getDataAt(f),S=y.getColumnAt(f);return D&&S?S.getToolTip(D,y):a},r.adjustTranslateX=function(c){var t=this.getWidth()-this._91I;return t>c&&(c=t),c>0?0:J(c)},r._99I=function(){var G=this,o=G._29I,J=G._60I;J.clear(),G._91I=0,G._39o._roots.each(function(D){if(D.isVisible()){var l=G._91I+D.getWidth();G._91I<=o.x+o.width&&l>=o.x&&J.add({column:D,startX:G._91I}),G._91I=l}}),G._91I+=G.getScrollBarSize()},r.drawData=function(R,E,$){var Y=this,L=Y._rowHeight,C=L*$,y=Y.isSelected(E),G=Y._29I,D=G.x,g=G.width;Y.drawRowBackground(R,E,y,D,C,g,L),Y._60I.each(function(K){var q=K.column,D=K.startX,X=q.getWidth();X>0&&!Y.isEditing(E,q)&&(R.save(),R.beginPath(),R.rect(D,C,X,L),R.clip(),Y._87o(Y.drawCell(R,E,y,q,D,C,X,L),$,D,C,X,L),Y._columnLineVisible&&Qf(R,D+X-1,C,1,L,Y._columnLineColor),R.restore())}),Y._rowLineVisible&&Qf(R,D,C+L-1,g,1,Y._rowLineColor)},r.drawCell=function(M,P,d,g,Y,m,$,k){var o=this;if(g.drawCell)return g.drawCell(M,P,d,g,Y,m,$,k,o);var U=o.getValue(P,g);nr(M,U,g,o.getLabelFont(P,g,U),o.getLabelColor(P,g,U),Y,m,$,k,P,o)},r.getColumnModel=function(){return this._39o},r._17o=function(){this.redraw()},r._18o=function(W){var I=this;W.data===I._sortColumn&&Nc[W.property]?I.ivm():(I._42o(),I.redraw())},r._19o=function(){this.redraw()},r.getCurrentSortFunc=function(){var c=this,l=c._sortColumn;if(l&&l.isSortable()){var M=l.getSortFunc(),T=hd===l.getSortOrder()?1:-1;return M||(M=Od),function(a,s){return M.call(c,c.getValue(a,l),c.getValue(s,l),a,s)*T}}return c._sortFunc},r.isCellEditable=function(k,b,z){return b.isEditable()&&this.isEditable()?b.isCellEditable?b.isCellEditable(k,b,z,this):!0:!1},r._37O=function(K,d){if(Qk(d))for(var m=this,S=m.lp(d),i=m._60I,M=m._rowHeight,r=m._29I,j=r.x,e=r.y,x=r.width,C=r.height,u=0;u<i.size();u++){var o=i.get(u),W=o.startX,B=o.column,y=B.getWidth();if(B!==m._31o&&B!==m._4o&&S.x>=W&&S.x<W+y&&m.isCellEditable(K,B,d)){var A={x:W,y:m.getRowIndex(K)*M,width:y,height:M},_={x:A.x+m.tx(),y:A.y+m.ty(),width:A.width,height:A.height},T=0,F=0;return A.x<j?T=A.x-j:A.x+A.width>j+x&&(T=A.x+A.width-j-x),T&&(m.tx(m.tx()-T),_.x-=T),A.y<e?F=A.y-e:A.y+M>e+C&&(F=A.y+M-e-C),F&&(m.ty(m.ty()-F),_.y-=F),m.beginEditing({data:K,column:B,value:m.getValue(K,B),event:d,rect:A,editorRect:_,view:m}),void 0}}}},Ed.BaseItemEditor=function(b,r,_,p){this._data=b,this._column=r,this._master=_,this._editInfo=p},$e("BaseItemEditor",E,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var _h=w.Tab=function(){Bh(_h,this)};Cf("Tab",ed,{ms_ac:["view","closable","disabled","visible"],_icon:a,_closable:!1,_disabled:!1,_visible:!0,setParent:db});var uj=w.Column=function(){Bh(uj,this)};Cf("Column",ed,{_46o:1,ms_ac:["accessType","valueType",Wm,_g,tj,np,"align",Be,"sortOrder",Cr,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:hd,_sortFunc:a,_sortable:!0,_clickable:!0,setWidth:function(t){16>t&&(t=16);var R=this._width;this._width=t,this.fp(np,R,t)},getToolTip:function($,O){return this.formatValue(O.getValue($,this))}});var _o=w.Property=function(){Bh(_o,this)};Cf("Property",ed,{_46o:1,ms_ac:["accessType","valueType",_g,tj,"categoryName",Be,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:a,getToolTip:function(z,i,k){var Z=this;return i?Z.formatValue(k.getValue(z,Z)):k.getPropertyName(Z)}}),Ed.AccordionView=function(){var Y=this;Y._20o={},Y._21o=new Yp,Y._10o=a,Y._9o=a,Y._11o=a,Y._view=Ll(0,Y),Y.iv()},$e("AccordionView",E,{ms_v:1,ms_fire:1,ms_ac:[qk,ob,"titleHeight",nc,ab,"titleBackground","selectWidth",An,"orientation","separatorColor"],_expandIcon:n.accordionViewExpandIcon,_collapseIcon:n.accordionViewCollapseIcon,_titleHeight:Td,_labelColor:n.accordionViewLabelColor,_labelFont:n.accordionViewLabelFont,_titleBackground:n.accordionViewTitleBackground,_selectBackground:n.accordionViewSelectBackground,_selectWidth:n.accordionViewSelectWidth,_orientation:"v",_separatorColor:n.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(B,u,P,A){var l=this,W=lj();if(l._20o[B])throw B+" already exists";W.onmousedown=gh,W.style.cursor=kk,W.addEventListener(jl?fh:mo,function(p){gh(p)},Y),W.addEventListener(jl?cm:Kn,function(Z){gh(Z),Qk(Z)&&(l._10o===B?l.collapse():l.expand(B))},Y),eg(l._view,W),l._20o[B]={content:u,div:W,canvas:Hd(W),icon:A},l._21o.add(B),P&&l.expand(B),l.iv()
},remove:function(e){var l=this,P=l._20o[e];P&&(Bm(P.div),delete l._20o[e],l._21o.remove(e),l.iv())},clear:function(){var t=this;t._21o.toArray().forEach(t.remove,t),t._20o={},t._21o.clear(),t.iv()},isExpanded:function(N){return this._10o===N},expand:function(R){var m=this;m._20o[R]&&m._10o!==R&&(m._10o=R,m.onExpanded(R),m.iv())},onExpanded:function(){},collapse:function(){var m=this;m._10o&&(m.onCollapsed(m._10o),delete m._10o,m.iv())},onCollapsed:function(){},initCanvas:function(p,R,a){En(p,R,a);var t=rm(p);return Dh(t,0,0,1),t.clearRect(0,0,R,a),t},drawTitle:function(s,Z,u,R,o){var d=this,y=hh(o.icon),T=d.isExpanded(Z),K=d._titleHeight,a=d._titleBackground,X=d._selectWidth,r=d._separatorColor,O=hh(T?d._expandIcon:d._collapseIcon),c=X+4;Qf(s,0,0,u,R,a),T&&X&&Qf(s,0,0,X,R,d._selectBackground),(T||d._21o.get(d._21o.size()-1)!==Z)&&Qf(s,0,R-1,u,1,r?r:Fe(a)),y&&(hk(s,y,c+Uh(y)/2,K/2),c+=Uh(y)+2),Fp(s,Z,d.getLabelFont(Z),d.getLabelColor(Z),c,0,0,K),O&&hk(s,O,u-Uh(O)/2-4,K/2)},validateImpl:function(){var J=this,$=J._view,K=0,s=0,P=J.getWidth(),N=J.getHeight(),d=J._titleHeight,n=J._21o.size()*d,R=J._11o,Y=J._9o;delete J._11o,delete J._9o,J._21o.each(function(Y){var R,h,o=J._20o[Y],A=o.content,W=J._10o===Y;ym(J)?(Fl(o.div,K,0,d,N),R=J.initCanvas(o.canvas,d,N),Hc(R,0,N),As(R,-Z),J.drawTitle(R,Y,N,d,o),R.restore(),W?(h=t(0,P-n),A&&(J._11o=A,J._9o=Jb(A),Fl(A,K+d,0,h,N)),K+=d+h):K+=d):(Fl(o.div,0,s,P,d),R=J.initCanvas(o.canvas,P,d),J.drawTitle(R,Y,P,d,o),R.restore(),W?(h=t(0,N-n),A&&(J._11o=A,J._9o=Jb(A),Fl(A,0,s+d,P,h)),s+=d+h):s+=d)});var v=J._9o;R&&R!==J._11o&&R.endEditing&&R.endEditing(),v&&v!==Y&&eg($,v),Y&&Y!==v&&Bm(Y)}}),Ed.SplitView=function(o,z,k,I){var h=this,f=h._dividerDiv=lj(),B=h._60O=Hd(),V=h._61O=Hd(),Z=B.style,Y=V.style;h._view=Ll(1,h),eg(h._view,f),Z.msTouchAction=Uo,Z.pointerEvents=Uo,Z.cursor=kk,Y.msTouchAction=Uo,Y.pointerEvents=Uo,Y.cursor=kk,o&&h.setLeftView(o),z&&h.setRightView(z),k&&h.setOrientation(k),I!=a&&h.setPosition(I),h.setStatus(Vm),new Dn(h)},$e("SplitView",E,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:n.splitViewDividerSize,_dividerBackground:n.splitViewDividerBackground,_dragOpacity:n.splitViewDragOpacity,_toggleIcon:n.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(C,Y){var _=this,J=_._position;isNaN(C)||(Y||(_._82O=0>C?-1:C>1?1:0),_._position=C,_.fp(Bk,J,C))},getLeftView:function(){return this._leftView},setLeftView:function(m){var B=this,i=B._leftView,Y=B._view;if(B._leftView!==m){if(i&&i!==B._rightView){var Q=Jb(i);Q.parentNode===Y&&Bm(Q)}if(B._leftView=m,m){var F=Jb(m);F.parentNode!==Y&&Y.insertBefore(F,B._dividerDiv)}B.fp("leftView",i,m)}},getRightView:function(){return this._rightView},setRightView:function(x){var u=this,t=u._rightView,s=u._view;if(u._rightView!==x){if(t&&t!==u._leftView){var o=Jb(t);o.parentNode===s&&Bm(o)}if(u._rightView=x,x){var F=Jb(x);F.parentNode!==s&&s.insertBefore(F,u._dividerDiv)}u.fp("rightView",t,x)}},validateImpl:function(){var x=this,Y=x._draggable,m=x._position,o=x.getWidth(),O=x.getHeight(),I=x._dividerSize,U=x._dividerBackground,w=jl?18:8,j=x._dividerDiv,N=x._82O,u=x._60O,D=x._61O,q=x._toggleIcon,l=x._status,b=j.style,f=null,V=jl?20:4,T=q.comps[0];I>=w||0===I?x._coverDiv&&(Bm(x._coverDiv),delete x._coverDiv):x._coverDiv||(x._coverDiv=lj(),r&&(x._coverDiv.style.background=jq),eg(j,x._coverDiv)),x._togglable?u.parentNode||(eg(j,u),eg(j,D)):(Bm(u),Bm(D));var A=x._coverDiv,K=x._leftView,X=x._rightView;if(ym(x)){if(I>o&&(I=o),l===Vm)if(1===N)var H=p(m,o),i=t(0,o-I-H);else-1===N?(i=p(-m,o),H=t(0,o-I-i)):(H=J((o-I)*m),i=t(0,o-I-H));else"cl"===l?(H=0,i=t(0,o-I)):"cr"===l&&(i=0,H=t(0,o-I));K&&Fl(K,0,0,H,O),X&&Fl(X,H+I,0,i,O),Fl(j,H,0,I,O),x._22o=H,A&&(Fl(A,I/2-w/2,0,w,O),A.style.cursor=Y?be:""),j.style.cursor=Y?be:"";var e=j.clientHeight/2,B=j.clientWidth;En(u,B,B),Fl(u,0,e-B-V,B,B),f=rm(u),Dh(f,0,0,1),T.rotation=-Z,Ad(f,q,0,0,B,B),f.restore(),En(D,B,B),Fl(D,0,e+V,B,B),f=rm(D),Dh(f,0,0,1),T.rotation=Z,Ad(f,q,0,0,B,B),f.restore()}else{if(I>O&&(I=O),l===Vm)if(1===N)var z=p(m,O),Q=t(0,O-I-z);else-1===N?(Q=p(-m,O),z=t(0,O-I-Q)):(z=J((O-I)*m),Q=t(0,O-I-z));else"cl"===l?(z=0,Q=t(0,O-I)):"cr"===l&&(Q=0,z=t(0,O-I));K&&Fl(K,0,0,o,z),X&&Fl(X,0,z+I,o,Q),Fl(j,0,z,o,I),x._22o=z,A&&(Fl(A,0,I/2-w/2,o,w),A.style.cursor=Y?ug:""),b.cursor=Y?ug:"";var G=j.clientWidth/2,B=j.clientHeight;En(u,B,B),Fl(u,G-B-V,0,B,B),f=rm(u),Dh(f,0,0,1),T.rotation=0,Ad(f,q,0,0,B,B),f.restore(),En(D,B,B),Fl(D,G+V,0,B,B),f=rm(D),Dh(f,0,0,1),T.rotation=W,Ad(f,q,0,0,B,B),f.restore()}b.background=U}});var Dn=function(t){this.sv=t,this.addListeners()};Qr(Dn,E,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(q){var P=this,A=P.sv,h=A._dividerDiv,O=A._60O,N=A._61O,Y=A._status,j=q.target;if(j===O)Y===Vm?A.setStatus("cl"):"cr"===Y&&A.setStatus(Vm);else if(j===N)Y===Vm?A.setStatus("cr"):"cl"===Y&&A.setStatus(Vm);else if(Qd(q)&&(j===h||j===A._coverDiv)&&(gh(q),A.isDraggable())){A.getLeftView(),A.getRightView();var J=P.maskDiv=lj();if(J.style.left=0,J.style.top=0,J.style.width=A.getWidth()+"px",J.style.height=A.getHeight()+"px",A.getView().appendChild(J),!A.isContinuousLayout()){var p=P.resizeDiv=lj();p.style.left=h.style.left,p.style.top=h.style.top,p.style.width=h.style.width,p.style.height=h.style.height,p.style.opacity=A.getDragOpacity(),p.style.background=A.getDividerBackground(),eg(P.getView(),p)}P._lastAbsPosition=A._22o,P._86o=ym(A)?Ac(q).x:Ac(q).y,fg(P,q)}},handleWindowTouchMove:function(F){Qd(F)&&this.update(F,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(D){var G=this;G.update(D,!0),G.sv.setStatus(Vm),G.maskDiv&&Bm(G.maskDiv),G.resizeDiv&&Bm(G.resizeDiv),G.maskDiv=G.resizeDiv=a},handle_mousedown:function(Y){Qk(Y)&&this.handle_touchstart(Y)},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowMouseUp:function(P){this.handleWindowTouchEnd(P)},update:function(p,Y){var b=this,x=b.sv,O=ym(x)?x.getWidth():x.getHeight(),j=x._dividerSize,B=b._lastAbsPosition-b._86o;ym(x)?(B+=Ac(p).x,B>O-j&&(B=O-j),0>B&&(B=0),b.resizeDiv&&(b.resizeDiv.style.left=B+$h)):(B+=Ac(p).y,B>O-j&&(B=O-j),0>B&&(B=0),b.resizeDiv&&(b.resizeDiv.style.top=B+$h)),Y&&O!==j&&(1===x._82O?x.setPosition(B,1):-1===x._82O?x.setPosition(B-O+j,1):x.setPosition(B/(O-j),1))}}),Ed.TabView=function(){var S=this,X=S._view=Ll(1,S),U=S._91O=lj(1),z=S._tabModel=new Pc,o=z.sm(),T=S.invalidate;S._7o=new Yp,S._canvas=Hd(U),eg(X,U),eg(X,S._92O=lj(1)),o.setSelectionMode(hn),o.ms(S.handleSelectionChange,S),z.mm(T,S),z.mh(T,S),z.md(T,S),S._interactor=new Ko(S),S.iv()},$e("TabView",E,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",nc,ab,"tabBackground","selectWidth",An,"moveBackground","insertColor"],_tabPosition:rr,_tabHeight:Td,_tabGap:n.tabViewTabGap,_labelColor:n.tabViewLabelColor,_labelFont:n.tabViewLabelFont,_tabBackground:n.tabViewTabBackground,_selectWidth:n.tabViewSelectWidth,_selectBackground:n.tabViewSelectBackground,_moveBackground:n.tabViewMoveBackground,_insertColor:n.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(k,h,B){var O,C=this._tabModel;return k instanceof _h?(O=k,h&&O.setView(h)):(O=new _h,O.setName(k),O.setView(h)),C.add(O),B&&C.sm().ss(O),O},getLabel:function(E){return E.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(Q){this._23o=Q,this.iv()},get:function(t){var H=this,D=H._tabModel;if(qg(t))return D._roots.get(t);if(mc(t)){var f;return D.each(function(D){t===H.getLabel(D)&&(f=D)}),f}return t instanceof _h?t:a},select:function(E){this._tabModel.sm().ss(this.get(E))},remove:function(Q){var D=this;if(Q=D.get(Q)){var p=D._tabModel,j=p._roots.indexOf(Q);D._tabModel.remove(Q),D.selectByIndex(--j)}},getCurrentTab:function(){return this._8o},hideTabView:function(F,d){d.parentNode===this._92O&&(kc(d)?(d.style.display=ik,d._tab_=F):Bm(d),xl())},showTabView:function(Z,H){kc(H)&&(H.style.display="block",H._tab_=Z),H.parentNode!==this._92O&&(eg(this._92O,H),xl())},_24o:function(){var F,i=this,_=i._8o,o=i._9o,w=i._tabModel.sm().ld();w&&(F=Jb(w.getView())),F!==o&&(o&&(_.getView()&&_.getView().endEditing&&_.getView().endEditing(),i.hideTabView(_,o)),F&&i.showTabView(w,F)),i._8o=w,i._9o=F,_!==w&&i.onTabChanged(_,w)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(H,V){this.selectByIndex(--V)},selectByIndex:function(i){var s=this,G=s._tabModel,y=G.size();if(y&&!G.sm().ld()){i==a&&(i=0),i>=y&&(i=y-1),0>i&&(i=0);for(var v=i;v>=0;v--){var j=s.get(v);if(!j.isDisabled())return s.select(j),j}for(v=i+1;y>v;v++)if(j=s.get(v),!j.isDisabled())return s.select(j),j}},getTabWidth:function(p){var G=4,z=hh(p.getIcon());z&&(G+=Uh(z,p)+4);var f=this.getLabel(p);return f&&(G+=kr(this.getLabelFont(p),f).width+4),p.isClosable()&&(G+=10),G},drawTab:function(B,A,Y,L,O,t,M){var n,C=this,z=C._tabPosition,i=Y+4,k=C._selectWidth,v=hh(A.getIcon()),q=A.isDisabled(),r=C.getLabelColor(A),e=C.getLabelFont(A),l=C.getLabel(A),d=C._selectBackground,I=z===Ul+"-vertical",s=z===Te+"-vertical";(I||s)&&(i=L+4),q&&(B.globalAlpha=sj),Qf(B,Y,L,O,t,M),A===C._8o&&k&&(z===rr?Qf(B,Y,L+t-k,O,k,d):z===Ul?Qf(B,Y+O-k,L,k,t,d):z===Te?Qf(B,Y,L,k,t,d):I?Qf(B,Y+O-k,L,k,t,d):s?Qf(B,Y,L,k,t,d):Qf(B,Y,L,O,k,d));var H=O/2;if(I&&(Hc(B,H,L+t/2),As(B,W),Hc(B,-H,-L-t/2)),v){var p=zq(v,A),m=Uh(v,A);if(I||s){var F=Y+O/2,y=i+p/2;Hc(B,F,y),As(B,Z),Hc(B,-F,-y),hk(B,v,Y+O/2,i+p/2,A,C),Hc(B,F,y),As(B,-Z),Hc(B,-F,-y),i+=p+4}else hk(B,v,i+m/2,L+t/2,A,C),i+=m+4}return I||s?(Hc(B,O/2,i+O/2),As(B,Z),Hc(B,-O/2,-i-O/2),Fp(B,l,e,r,Y,i,t,O),Hc(B,O/2,i+O/2),As(B,-Z),Hc(B,-O/2,-i-O/2)):Fp(B,l,e,r,i,L,O,t),I&&(Hc(B,H,L+t/2),As(B,-W),Hc(B,-H,-L-t/2)),A.isClosable()&&(n=s?{x:Y+O-12,y:L+t-12,width:12,height:12}:{x:Y+O-12,y:L+2,width:12,height:12},this.drawCloseIcon(A,B,r,n)),q&&(B.globalAlpha=1),n},drawCloseIcon:function(q,l,o,C){var M=C.x,w=C.y;l.strokeStyle=o,l.lineWidth=1,l.beginPath(),l.moveTo(M+2,w+8),l.lineTo(M+8,w+2),l.moveTo(M+8,w+8),l.lineTo(M+2,w+2),l.stroke()},getTabAt:function(g){var A=this._interactor._8Q(g);return A?A.tab:null},validateImpl:function(){var w=this;w._24o();var o,e=w._canvas,m=w._tabPosition,$=w._91O,k=w._92O,M=w._tabModel,E=w.getWidth(),C=w.getHeight(),f=w._tabHeight,F=w._7o,S=w._tabGap,n=m===rr,N=m===Ul,y=m===Te,g=m===Ul+"-vertical",a=m===Te+"-vertical",c=w._23o,L=0;if((N||y)&&M._roots.each(function(F){L=t(w.getTabWidth(F),L)}),n?(Fl($,0,0,E,f),o={x:0,y:f,width:E,height:t(0,C-f)}):N?(Fl($,0,0,L,C),o={x:L,y:0,width:t(0,E-L),height:C}):y?(Fl($,E-L,0,L,C),o={x:0,y:0,width:t(0,E-L),height:C}):g?(Fl($,0,0,f,C),o={x:f,y:0,width:t(0,E-f),height:C}):a?(Fl($,E-f,0,f,C),o={x:0,y:0,width:t(0,E-f),height:C}):(Fl($,0,C-f,E,f),o={x:0,y:0,width:E,height:t(0,C-f)}),Fl(k,o),g||a){w._9o&&(o.x=0,Fl(w._8o.getView(),o)),En(e,f,C);var s=rm(e),R=0;if(Dh(s,0,w.ty(),1),s.clearRect(0,0,f,C),F.clear(),M._roots.each(function(h){if(h.isVisible()){var B,N=w.getTabWidth(h);c&&c.tab===h||(B=w.drawTab(s,h,0,R,f,N,w._tabBackground)),F.add({_75o:B,tab:h,startY:R,endY:R+N,height:N}),R+=N+S}}),w._23Q=t(0,R-S),c){var P=c.position;w.drawTab(s,c.tab,0,c.startY,f,c.height,w._moveBackground),Qf(s,0,P,f,1,w._insertColor)}if(s.restore(),w._selectionChanged){w._selectionChanged=!1;for(var T=w.ty(),H=0;H<F.size();H++){var h=F.get(H);if(h.tab===w._8o){if(h.endY+T<0){w.ty(-h.startY);break}if(h.startY+T>C){w.ty(C-h.endY);break}}}}w.ty(w.ty())}else if(N||y){w._9o&&(o.x=0,Fl(w._8o.getView(),o)),En(e,L,C);var s=rm(e),R=0;if(Dh(s,0,w.ty(),1),s.clearRect(0,0,L,C),F.clear(),M._roots.each(function(M){if(M.isVisible()){var E;c&&c.tab===M||(E=w.drawTab(s,M,0,R,L,f,w._tabBackground)),F.add({_75o:E,tab:M,startY:R,endY:R+f,height:f}),R+=f+S}}),w._23Q=t(0,R-S),c){var P=c.position;w.drawTab(s,c.tab,0,c.startY,L,c.height,w._moveBackground),Qf(s,0,P,L,1,w._insertColor)}if(s.restore(),w._selectionChanged){w._selectionChanged=!1;for(var T=w.ty(),H=0;H<F.size();H++){var h=F.get(H);if(h.tab===w._8o){if(h.endY+T<0){w.ty(-h.startY);break}if(h.startY+T>C){w.ty(C-h.endY);break}}}}w.ty(w.ty())}else{w._9o&&(o.y=0,Fl(w._8o.getView(),o)),En(e,E,f);var s=rm(e),u=0;if(Dh(s,w.tx(),0,1),s.clearRect(0,0,E,f),F.clear(),M._roots.each(function(I){if(I.isVisible()){var Q,K=w.getTabWidth(I);c&&c.tab===I||(Q=w.drawTab(s,I,u,0,K,f,w._tabBackground)),F.add({_75o:Q,tab:I,startX:u,endX:u+K,width:K}),u+=K+S}}),w._64I=t(0,u-S),c){var P=c.position;w.drawTab(s,c.tab,c.startX,0,c.width,f,w._moveBackground),Oq(s,w._insertColor,P,0,f)}if(s.restore(),w._selectionChanged){w._selectionChanged=!1;for(var d=w.tx(),H=0;H<F.size();H++){var h=F.get(H);if(h.tab===w._8o){if(h.endX+d<0){w.tx(-h.startX);break}if(h.startX+d>E){w.tx(E-h.endX);break}}}}w.tx(w.tx())}for(var B=[],p=k.children,H=0;H<p.length;H++){var J=p[H],G=J._tab_;G&&!M.contains(G)&&B.push(J)}B.forEach(function(N){k.removeChild(N)})}});var Ko=function(s){this.tv=s,this.addListeners()};Qr(Ko,E,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(o){this.handleScroll(o,10*(o.wheelDelta/40))},handle_DOMMouseScroll:function(l){this.handleScroll(l,10*-l.detail)},handleScroll:function(l,x){gh(l);var c=this.tv,$=c._tabPosition;!c._40o()||$!==rr&&$!==tf||c.tx(this.tv.tx()+x),!c._41o()||$!==Ul&&$!==Te&&$!==Ul+"-vertical"&&$!==Te+"-vertical"||c.ty(this.tv.ty()+x)},_8Q:function(G){var o,t,e=this.tv,E=e._tabPosition,C=e._7o;if(E===rr||E===tf){var F=e.lp(G).x;for(o=0;o<C.size();o++)if(t=C.get(o),t.startX<=F&&F<=t.endX)return t}else if(E===Ul||E===Te||E===Ul+"-vertical"||E===Te+"-vertical"){var K=e.lp(G).y;for(o=0;o<C.size();o++)if(t=C.get(o),t.startY<=K&&K<=t.endY)return t}return a},isClickable:function(K){var A=this.tv,h=A._tabPosition,M=this._73o=this._8Q(K);return!A._40o()||h!==rr&&h!==tf?!A._41o()||h!==Ul&&h!==Te&&h!==Ul+"-vertical"&&h!==Te+"-vertical"?M&&(!M.tab.isDisabled()||A.isMovable()):!0:!0},handle_mousemove:function(K){var k=this;Ji?k._74o=k._8Q(K):k.getView().style.cursor=k.isClickable(K)?kk:""},handle_mousedown:function(A){this.handle_mousemove(A),this.handle_touchstart(A)},handle_touchstart:function(k){var s=this,a=s.tv,l=a._tabPosition;gh(k),Qk(k)&&s.isClickable(k)&&(l===rr||l===tf?(s.x=Ac(k).x,s.lp=a.lp(k),s.tx=a.tx()):(s.y=Ac(k).y,s.lp=a.lp(k),s.ty=a.ty()),fg(s,k))},handleWindowMouseMove:function(j){this.handleWindowTouchMove(j)},handleWindowTouchMove:function(C){var i,T=this,H=T.tv,N=H._tabPosition,k=T._73o;if(N===rr||N===tf){if(i=Ac(C).x-T.x,!T._25o&&!T.moving&&y(i)>2&&(H._40o()&&!Zl(C)?T._25o=1:k&&H.isMovable()&&(T.moving=1)),T._25o)H.tx(T.tx+i);else if(T.moving){var J=T.lp.x+i,X=H._tabGap/2;H._7o.each(function(F){var N=F.endX,O=J-F.startX<N-J;J>=F.startX&&N>=J&&H._7Q({tab:k.tab,startX:k.startX+i,width:k.width,front:O,insertTab:F.tab,position:O?t(0,F.startX-X):p(H._64I,N+X)})})}}else if(i=Ac(C).y-T.y,!T._25o&&!T.moving&&y(i)>2&&(H._41o()&&!Zl(C)?T._25o=1:k&&H.isMovable()&&(T.moving=1)),T._25o)H.ty(T.ty+i);else if(T.moving){var P=T.lp.y+i,X=H._tabGap/2;H._7o.each(function(K){var Z=K.endY,x=P-K.startY<Z-P;P>=K.startY&&Z>=P&&H._7Q({tab:k.tab,startY:k.startY+i,height:k.height,front:x,insertTab:K.tab,position:x?t(0,K.startY-X):p(H._23Q,Z+X)})})}},handleWindowMouseUp:function(y){this.handleWindowTouchEnd(y)},handleWindowTouchEnd:function(){var c=this,y=c.tv,l=y._tabPosition,H=y.getTabModel(),G=H._roots,E=c._73o;if(c.moving){var f=y._23o;if(f&&f.insertTab!==f.tab){var M=f.tab,N=G.remove(M),d=G.indexOf(f.insertTab);d>=0&&(f.front||d++,d<=G.size()&&(G.add(M,d),H._38I(M,N,d)))}y._7Q(a),delete c.moving}else if(!c._25o&&E){M=E.tab;var J=c._74o;if(!J||J.tab===M)if(!M.isDisabled()&&Aj(E._75o,c.lp)){var L=function(){var e=G.indexOf(M);H.remove(M),y.onTabClosed(M,e)};y.onTabClosing(M,L)&&L()}else M.isDisabled()||y._8o===M||H.sm().ss(M)}c._25o=c._73o=c._74o=l===rr||l===tf?c.x=c.lp=c.tx=a:c.y=c.lp=c.ty=a}}),Ed.PropertyView=function(y){var O=this;O._view=Ll(1,O),O._canvas=Hd(O._view),eg(O._view,O._79O=lj()),O._rows=new Yp,O._28o=new Yp,O._26o={},O._26Q={};var r=O._propertyModel=new Pc,b=O.ivm;r.mm(b,O),r.md(b,O),r.mh(b,O),O.dm(y?y:new Pc),new Zi(O)},$e("PropertyView",E,{ms_ac:[nc,Hl,ab,_g,tj,"categorizable",ro,Cr,Fm,qk,ob,yf,vr,ai,"selectRowIndex",An,"background",zl,Eo,Jg,xj,Cb],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Ob,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:No,_background:n.propertyViewBackground,_expandIcon:n.propertyViewExpandIcon,_collapseIcon:n.propertyViewCollapseIcon,_scrollBarColor:ne,_scrollBarSize:Xf,_autoHideScrollBar:yg,_selectBackground:n.propertyViewSelectBackground,_rowHeight:oc,_rowLineVisible:n.propertyViewRowLineVisible,_rowLineColor:n.propertyViewRowLineColor,_10I:.5,_columnLineVisible:n.propertyViewColumnLineVisible,_columnLineColor:n.propertyViewColumnLineColor,_labelColor:n.propertyViewLabelColor,_labelSelectColor:n.propertyViewLabelSelectColor,_labelFont:n.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(f){0>f&&(f=0),f>1&&(f=1);var F=this,O=F._10I;F._10I=f,F.fp("columnPosition",O,f)},getPropertyName:function(t){return t.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(Q,R,K){return K===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(t,w){return w===this._selectRowIndex?this._labelSelectColor:t.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(F){var v=this.getHeight()-this._59I;return v>F&&(F=v),F>0?0:J(F)},isExpanded:function(t){if(!t)return!0;var I=this._26o[t];return I?I.isExpanded:!(this._26Q[t]===!1)},toggle:function(t){var C=this;C.isExpanded(t)?C.collapse(t):C.expand(t)},expandAll:function(){this.validate();for(var i in this._26o)this.expand(i)},expand:function(o){if(o&&o!==ik){var m=this,T=m._26o[o];T&&!T.isExpanded&&(T.isExpanded=!0,m.onExpanded(o),m.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var B in this._26o)this.collapse(B)},collapse:function(z){if(z&&z!==ik){var $=this,i=$._26o[z];i&&i.isExpanded&&(i.isExpanded=!1,$.onCollapsed(z),$.ivm())}},onCollapsed:function(){},getCategoryName:function(w){if(!this.isCategorizable())return ik;var N=w.getCategoryName();return N?N:ik},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(c){var Y=this,a=Y._dataModel;a!==c&&(a&&(a.umd(Y.handlePropertyChange,Y),Y._selectionModel||a.sm().ums(Y.handleSelectionChange,Y)),Y._dataModel=c,c.md(Y.handlePropertyChange,Y),Y._selectionModel?Y._selectionModel._21I(c):c.sm().ms(Y.handleSelectionChange,Y),Y.fp(Yo,a,c))},isVisible:function(j){return this._visibleFunc?this._visibleFunc(j):!0},onPropertyChanged:function(J){var I=this,o=J.property;Mo[o]?I.ivm():I.iv(),o===Si&&I._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Wi},handlePropertyChange:function(z){this._27o===z.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var D=this;D._96I||(D.setSelectRowIndex(-1),D._96I=1,D.iv())},redraw:function(){this.iv()},validateModel:function(){var j=this,B=j._rows,f=j._28o,Q={},P=new Yp,Z=j._27o;j.updateCurrentData(),Z!==j._27o&&j.endEditing(),B.clear(),f.clear(),j.getRawProperties().each(function(l){if(j.isVisible(l)){P.add(l);var b=j.getCategoryName(l);Q[b]||(f.add(b,b===ik?0:M),Q[b]={isExpanded:j.isExpanded(b),properties:new Yp})}}),j._sortFunc&&P.sort(j._sortFunc);for(var Y in j._26o)j._26Q[Y]=j.isExpanded(Y);j._26o=Q,f.each(function(Y){Y!==ik&&B.add(Y);var x=Q[Y];x.isExpanded&&P.each(function(W){j.getCategoryName(W)===Y&&(x.properties.add(W),B.add({property:W,data:j._27o}))},j)})},validateImpl:function(){var F=this;F._76o(),F._96I&&(F.validateModel(),delete F._96I);var W=F._canvas,E=F.getWidth(),S=F.getHeight(),i=-F.ty(),P=F._rowHeight,s=F._indent,v=E-s,L=F._rows,C=L.size(),t=F._9I=s+v*F._10I,A=F._59I=C*P;En(W,E,S),F._29I={x:0,y:i,width:E,height:S},F._31I=R(i/P),F._14I=b((i+S)/P),F._31I<0&&(F._31I=0),F._14I>C&&(F._14I=C);var $,z=rm(W),n=F._background;Dh(z,0,-i,1),z.beginPath(),z.rect(0,i,E,S),z.clip(),z.clearRect(0,i,E,S),F._93db(z),n&&Qf(z,0,0,s,A,n);for(var M=F._31I;M<F._14I;M++){var Q=L.get(M),i=P*M;if(mc(Q))n&&Qf(z,s,i,v,P,n),$=hh(F.isExpanded(Q)?F._expandIcon:F._collapseIcon),$&&Me(z,$,ck,0,i,s,P),z.save(),z.beginPath(),z.rect(s,i,v,P),z.clip(),F.drawCategoryName(z,Q,M,s,i,v,P),z.restore();else{var j=Q.property,I=Q.data,$=hh(j.getIcon()),H=F._selectRowIndex===M?F.getSelectBackground():a;if($&&Me(z,$,ck,0,i,s,P),H&&Qf(z,s,i,v,P,H),z.save(),z.beginPath(),z.rect(s,i,t-s,P),z.clip(),F.drawPropertyName(z,j,M,s,i,t-s,P),z.restore(),!F.isEditing(I,j)){var D=t+1,y=E-t-1;z.save(),z.beginPath(),z.rect(D,i,y,P),z.clip(),F._87o(F.drawPropertyValue(z,j,F.getValue(I,j),M,D,i,y,P,I),M,D,i,y,P),z.restore()}}F._rowLineVisible&&Qf(z,s,i+P-1,v,1,F._rowLineColor)}F._columnLineVisible&&(Qf(z,t,0,1,A,F._columnLineColor),Qf(z,E-1,0,1,A)),F._92db(z),F._93I(),z.restore(),F.ty(F.ty())},drawCategoryName:function(E,T,h,o,D,t,$){Fp(E,T,this.getCategoryFont(T),this.getCategoryColor(T),o,D,t,$)},drawPropertyName:function(T,P,y,b,o,z,d){return P.drawPropertyName?(P.drawPropertyName(T,P,y,b,o,z,d,this),void 0):(Fp(T,this.getPropertyName(P),this.getPropertyFont(P,y),this.getPropertyColor(P,y),b,o,z,d),void 0)},drawPropertyValue:function(B,P,i,$,o,F,M,E,V){return P.drawPropertyValue?P.drawPropertyValue(B,P,i,$,o,F,M,E,V,this):(nr(B,i,P,this.getLabelFont(P,i,$),this.getLabelColor(P,i,$),o,F,M,E,V,this),void 0)},isPropertyEditable:function(g){return g.isEditable()&&this.isEditable()},setProperties:function(c){this._propertyModel.clear(),this.addProperties(c)},addProperties:function(g){if(g){var S=this._propertyModel;g.forEach(function(V){if(!(V instanceof _o)){var z=Nj(V.className);V=xi(z?z:_o,V)}S.add(V)})}},getRowIndexAt:function(a){var L=this,f=R(L.lp(a).y/L._rowHeight);return f>=0&&f<L._rows.size()?f:-1},getPropertyAt:function(W){var C=this,x=C.getRowIndexAt(W);return x>=0?C._rows.get(x).property:a},getToolTip:function(d){var f=this,H=f.getPropertyAt(d),Z=f._27o;return H&&Z?H.getToolTip(Z,f._9I<f.lp(d).x,f):a}});var Zi=function(x){this.pv=x,this.addListeners()};Qr(Zi,E,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(B){this.getView().style.cursor=B},clear:function(){var k=this;k._62O=k.cp=k.ty=k.p=a,k.setCursor(Mp)},handle_mousedown:function(e){this.handle_touchstart(e)},handle_touchstart:function(s){var p=this,X=p.pv;gh(s),X.setFocus(s)&&(Qk(s)?(p.cp=Ac(s),p.ty=X.ty(),p.p=X.getColumnPosition(),p.handle_touchmove(s)):X.setSelectRowIndex(X.getRowIndexAt(s)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(z){this.handle_touchend(z)},handle_touchend:function($){var U=this;if(U.cp&&!U._62O){var b=U.pv,B=b.lp($),x=B.x,u=B.y,W=b._indent,o=b.getRowIndexAt($),C=b._9I;if(o>=0){var l=b._rowHeight,g=l*o,T=b._rows.get(o),q=T.property;if(mc(T))hh(b.isExpanded(T)?b._expandIcon:b._collapseIcon)&&x>=0&&W>=x&&u>=g&&g+l>=u?b.toggle(T):Ph($)&&b.toggle(T);else if(x>C&&b.isPropertyEditable(q,$)){var F={x:C+1,y:g,width:b.getWidth()-C-1,height:l},I={x:F.x+b.tx(),y:F.y+b.ty(),width:F.width,height:F.height},Y=0,p=b._29I;F.y<p.y?Y=F.y-p.y:F.y+l>p.y+p.height&&(Y=F.y+l-p.y-p.height),Y&&(b.ty(b.ty()-Y),I.y-=Y),b.beginEditing({data:T.data,property:q,value:b.getValue(T.data,q),event:$,rect:F,editorRect:I,view:b})}}b.setSelectRowIndex(o)}U.clear()},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(t){var p=this,g=p.pv,w=p.ty,v=p.cp,Y=Ac(t),I=p._62O;if("p"===I)g.setTranslateY(w+Y.y-v.y);else if("c"===I){var R=g.getWidth()-g._indent;if(R>16){var x=p.p-(v.x-Y.x)/R,C=16/R;C>x&&(x=C),x>1-C&&(x=1-C),g.setColumnPosition(x)}}else"s"===I&&g.setTranslateY(w+(v.y-Y.y)*g._59I/g._29I.height)},handle_mousemove:function(p){this.handle_touchmove(p)},handle_touchmove:function(j){if(!Ji&&Qk(j)){var s=this,T=s.pv,b=y(T.lp(j).x-T._9I)<=(jl?8:3);s.cp?s._62O||(b?(s._62O="c",fg(s)):y(Ac(j).y-s.cp.y)>=2&&(s._62O=s.isV(j)?"s":"p",fg(s))):(b?s.setCursor(be):s.setCursor(Mp),s.isV(j)&&T._43o())}},isV:function(H){var r=this.pv,h=r._29I;return r._41o()&&h.x+h.width-r.lp(H).x<qf},handle_mousewheel:function(E){this.handleScroll(E,E.wheelDelta/40)},handle_DOMMouseScroll:function(g){2===g.axis&&this.handleScroll(g,-g.detail)},handleScroll:function(p,H){var l=this.pv;gh(p),l.endEditing(),l.translate(0,H*l.getRowHeight())},handle_keydown:function(I){var J=this.pv,c=J._rows.size(),f=J._selectRowIndex+(zb(I)?-1:1);(zb(I)||Ym(I))&&(0>f&&(f=0),f>=c&&(f=c-1),J.setSelectRowIndex(f))}}),Ed.ListView=function(l){this._5o(l),new og(this)},$e("ListView",E,{ms_ac:[nc,Hl,ab,zl,ro,Eo,Jg,Cr,Fm,yf,vr,ai,Hh,An],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:No,_rowHeight:oc,_rowLineVisible:n.listViewRowLineVisible,_rowLineColor:n.listViewRowLineColor,_scrollBarColor:ne,_scrollBarSize:Xf,_autoMakeVisible:Wr,_autoHideScrollBar:yg,_selectBackground:n.listViewSelectBackground,_labelColor:n.listViewLabelColor,_labelSelectColor:n.listViewLabelSelectColor,_labelFont:n.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(t){var N=this,Q=N._checkMode;N._checkMode=t,N.fp(dl,Q,t)},drawRow:function(G,c,K,u,W,l,m){var p=this,_=0,E=p._indent,f=p.getIconWidth(c);p.drawRowBackground(G,c,K,u,W,l,m),p._checkMode&&(hk(G,hh(p.getCheckIcon(c)),_+E/2,W+m/2,c,p),_+=E),p.drawIcon(G,c,_,W,f,m),p.drawLabel(G,c,_+f,W,m)}});var og=function(L){this.list=L,this._lastSelectDataTime=xd(),this.addListeners()};Qr(og,E,{ms_listener:1,getView:function(){return this.list._view},clear:function(K){var T=this,v=T.list;K&&"d"===T._62O&&!T.dragCancel&&v.handleDragAndDrop(K,"end"),v.draggingData&&(v.draggingData=null,v.redraw()),T.dragCancel=T._62O=T._isV=T._isH=T.cp=T.tx=T.ty=a},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function(H){var W=this,J=W.list;if(gh(H),J.setFocus(H)){var G=J.getDataAt(H);W.cp=Ac(H),W.tx=J.tx(),W.ty=J.ty(),Qk(H)?G&&J.handleDragAndDrop&&!W.isV(H)&&!W.isH(H)&&(J.draggingData=G,J.redraw(),J.handleDragAndDrop(H,"prepare")):(G&&W._33o(H,G),W.clear(H))}},handleWindowMouseUp:function(W){this.clear(W)},handleWindowTouchEnd:function(n){this.clear(n)},handle_mouseup:function(W){this.handle_touchend(W)},handle_touchend:function(J){var Z=this,k=Z.list;if(!Z._isV&&!Z._isH&&Z.cp&&!Z._62O){var g=k.getDataAt(J);g?(k.isCheckMode()?Z._34o(J,g):Z._33o(J,g),Ph(J)?k.onDataDoubleClicked(g,J):k.onDataClicked(g,J)):k.handleBackgroundClick(J)}Z.clear(J)},handleWindowMouseMove:function(x){this.handleWindowTouchMove(x)},handleWindowTouchMove:function(k){var R=this,v=R.list,S=R._62O,w=R.tx,J=R.ty,E=R.cp,m=Ac(k),e=v._29I;"p"===S?v.setTranslate(w+m.x-E.x,J+m.y-E.y):"v"===S?v.ty(J+(E.y-m.y)*v._59I/e.height):"h"===S?v.tx(w+(E.x-m.x)*v._91I/e.width):"d"===S&&(R.dragCancel||v.handleDragAndDrop(k,"between"))},handle_mousemove:function(b){this.handle_touchmove(b)},handle_touchmove:function(C){if(!Ji&&Qk(C)){var j=this,$=j.list;if(j._isV=j.isV(C),j._isH=j.isH(C),j.cp){if(!j._62O){if(sh(Ac(C),j.cp)<2)return;j._isV?j._62O="v":j._isH?j._62O="h":$.draggingData&&!this.dragCancel?(j._62O="d",$.handleDragAndDrop(C,"begin")):j._62O="p",j._62O&&"d"!==j._62O&&$.draggingData&&($.draggingData=null,$.redraw()),fg(j)}}else j._isV&&$._43o(),j._isH&&$._42o()}},isV:function(Z){var J=this.list,T=J._29I;return J._41o()&&T.x+T.width-J.lp(Z).x<qf},isH:function(W){var L=this.list,M=L._29I;return L._40o()&&M.y+M.height-L.lp(W).y<qf},handle_mousewheel:function(K){this.handleScroll(K,K.wheelDelta/40,K.wheelDelta!==K.wheelDeltaX)},handle_DOMMouseScroll:function(A){this.handleScroll(A,-A.detail,1)},handleScroll:function(F,a,d){var i=this.list;gh(F),i.endEditing&&i.endEditing(),d&&i._41o()?i.translate(0,a*i.getRowHeight()):i._40o()&&i.translate(10*a,0)},handle_keydown:function(M){if(!n.isInput(M.target)){var D,T=this.list,H=T.sm(),s=T._rows,X=s.size();if(qi(M))T.selectAll();else if(xg(M))T.handleDelete&&T.handleDelete(M);else if(_i(M))"d"!==this._62O||this.dragCancel||(T.handleDragAndDrop(M,"cancel"),this.dragCancel=!0);else if(Lh(M))T.isCheckMode()&&(D=T.getFocusData(),D&&T.checkData(D));else if(zb(M)||Ym(M)){var R=T.isCheckMode();if(D=R?T.getFocusData():H.ld()){var c=T.getRowIndex(D);c>=0&&(zb(M)?0!==c&&(D=s.get(c-1),R?T.setFocusData(D):H.ss(D)):c!==X-1&&(D=s.get(c+1),R?T.setFocusData(D):H.ss(D)))}else X>0&&(D=s.get(0),R?T.setFocusData(D):H.ss(D))}}},_34o:function(I,y){var H=this.list,e=H.lp(I).x;return e>=0&&e<=H._indent?(H.checkData(y),void 0):(H.setFocusData(y),void 0)},_33o:function(j,e){var O=this.list,S=O.sm(),r=S.ld();if(Zl(j))O.isSelected(e)?S.rs(e):S.as(e);else if(Gq(j))if(r)for(var t=O.getRowIndex(r),F=O.getRowIndex(e);t!==F;)t+=F>t?1:-1,S.as(O._rows.get(t));else S.ss(e);else if(Qk(j)){var T=xd();if(S.contains(e)){var H=T-this._lastSelectDataTime;O.handleDataDoubleSelect&&H>500&&1500>H&&O.handleDataDoubleSelect(j,e)}S.ss(e),this._lastSelectDataTime=T}else S.contains(e)||S.ss(e)}}),Ed.TreeView=function(u){var j=this;j._35o(),j._5o(u),new yq(j)},$e("TreeView",E,{ms_ac:[nc,Hl,ab,"rootVisible",dl,"rootData",Cr,Fm,yf,vr,ai,ro,zl,Eo,Jg,qk,ob,Hh,An,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:a,_indent:No,_rowHeight:oc,_rowLineVisible:n.treeViewRowLineVisible,_rowLineColor:n.treeViewRowLineColor,_scrollBarColor:ne,_scrollBarSize:Xf,_autoHideScrollBar:yg,_expandIcon:n.treeViewExpandIcon,_collapseIcon:n.treeViewCollapseIcon,_autoMakeVisible:Wr,_selectBackground:n.treeViewSelectBackground,_labelColor:n.treeViewLabelColor,_labelSelectColor:n.treeViewLabelSelectColor,_labelFont:n.treeViewLabelFont,_doubleClickToToggle:n.treeViewDoubleClickToToggle,drawRow:function(g,O,R,e,H,t,h){var o=this;o.drawRowBackground(g,O,R,e,H,t,h),o._97I(g,O,R,0,H,t,h)},isOnToggleIcon:function(u){var K=this.getDataAt(u);if(K){var e=this.getIndent(),C=this.lp(u).x;if(hh(this.getToggleIcon(K))){var O=e*this.getLevel(K);if(C>=O&&O+e>=C)return!0}}return!1}});var yq=function(q){Bh(yq,this,[q])};Qr(yq,og,{toggle:function(X,E,I,f){var b=this.list,a=b.lp(X).x;if(hh(b.getToggleIcon(E))){var W=I*f;if(a>=W&&W+I>=a)return b.toggle(E),!0}return b.isDoubleClickToToggle()&&Ph(X)?(b.toggle(E),!0):!1},_34o:function(o,G){var X=this.list,p=X.lp(o).x,i=X._levelMap[G._id],M=X._indent,x=M*(i+1);return p>=x&&x+M>=p?(X.checkData(G),void 0):(this.toggle(o,G,M,i)||X.setFocusData(G),void 0)},_33o:function(D,P){var Y=this,d=Y.list;Y.toggle(D,P,d._indent,d.getLevel(P))||yq.superClass._33o.call(Y,D,P)},handle_keydown:function(F){if(Wn(F)||Vd(F)){var A=this.list,o=A._rows,W=A.isCheckMode(),_=A.sm(),f=W?A.getFocusData():_.ld();f?f.hasChildren()&&(Wn(F)?A.collapse(f):A.expand(f)):o.size()>0&&(f=o.get(0),W?A.setFocusData(f):_.ss(f))}else yq.superClass.handle_keydown.call(this,F)}});var Fb=Ed.TableView=function(t){this._98I(),this._5o(t),new Fi(this)};$e("TableView",E,{ms_ac:[nc,Hl,ab,"sortMode",_g,tj,zl,Eo,Jg,xj,Cb,"sortColumn",Cr,Fm,yf,vr,ai,Hh,An],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Dq,_editable:!0,_batchEditable:!1,_rowHeight:oc,_rowLineVisible:n.tableViewRowLineVisible,_rowLineColor:n.tableViewRowLineColor,_columnLineVisible:n.tableViewColumnLineVisible,_columnLineColor:n.tableViewColumnLineColor,_scrollBarColor:ne,_scrollBarSize:Xf,_autoHideScrollBar:yg,_autoMakeVisible:Wr,_selectBackground:n.tableViewSelectBackground,_labelColor:n.tableViewLabelColor,_labelSelectColor:n.tableViewLabelSelectColor,_labelFont:n.tableViewLabelFont,getCheckColumn:function(){var l=this;
if(!l._31o){var j=l._31o=new uj;j.setEditable(!0),j.setWidth(40),j.getValue=l.getCheckColumValue,j.drawCell=l.drawCheckColumnCell}return l._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(K){var E=this,g=E._39o,Q=E.getCheckColumn();K!==E.isCheckMode()&&(K?g.add(Q,0):g.remove(Q),E.fp(dl,!K,K))},getCheckColumValue:function(p,z,Q){return Q.isSelected(p)},drawCheckColumnCell:function(F,m,R,b,f,o,Z,U,N){hk(F,N.getCheckIcon(m),f+Z/2,o+U/2,m,N)}});var Fi=function(b){Bh(Fi,this,[b])};Qr(Fi,og,{_34o:function(_,l){var B=this.list,y=B._31o;if(B.isCellEditable(l,y,_)){var X=B._3Q(y),w=B.lp(_).x;if(X&&w>=X.startX&&w<X.startX+y.getWidth())return B.checkData(l),void 0}B._37O(l,_),B.setFocusData(l)},_33o:function(j,e){this.list._37O(e,j),Fi.superClass._33o.apply(this,arguments)}});var od=Ed.TreeTableView=function($){var d=this,b=d._4o=new uj;d._35o(),d._98I(),d._5o($),b.setDisplayName("Name"),b.setEditable(!0),b.setWidth(180),b.drawCell=Ar,b.getValue=al,d._39o.add(b),new Bq(d)},Ar=function(r,m,$,q,k,D,F,y,i){i._97I(r,m,$,k,D,F,y)},al=function(X,J,i){return i.getLabel(X)};$e("TreeTableView",E,{ms_ac:[nc,Hl,ab,"sortMode",_g,tj,ro,dl,"rootData","rootVisible",Cr,Fm,"sortColumn",qk,ob,yf,vr,ai,Hh,Jg,zl,Eo,xj,Cb,An,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Dq,_checkMode:a,_editable:!0,_batchEditable:!1,_indent:No,_rowHeight:oc,_rowLineVisible:n.treeTableViewRowLineVisible,_rowLineColor:n.treeTableViewRowLineColor,_columnLineVisible:n.treeTableViewColumnLineVisible,_columnLineColor:n.treeTableViewColumnLineColor,_expandIcon:n.treeTableViewExpandIcon,_collapseIcon:n.treeTableViewCollapseIcon,_scrollBarColor:ne,_scrollBarSize:Xf,_autoHideScrollBar:yg,_autoMakeVisible:Wr,_selectBackground:n.treeTableViewSelectBackground,_labelColor:n.treeTableViewLabelColor,_labelSelectColor:n.treeTableViewLabelSelectColor,_labelFont:n.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Bq=function(Z){Bh(Bq,this,[Z])};Qr(Bq,og,{_34o:function(U,w){var M=this.list,R=M._4o,g=M._3Q(R),s=M.lp(U).x;if(g){var V=M._indent,C=g.startX+V*M.getLevel(w);if(hh(M.getToggleIcon(w))&&s>=C&&C+V>=s)return M.toggle(w),void 0;if(M.isCellEditable(w,R)&&(C+=V,s>=C&&C+V>=s))return M.checkData(w),void 0}M._37O(w,U),M.setFocusData(w)},_33o:function(L,K){var O=this.list,B=O.lp(L).x;if(hh(O.getToggleIcon(K))){var D=O._3Q(O._4o);if(D){var U=O._indent,d=D.startX+U*O.getLevel(K);if(B>=d&&d+U>=B)return O.toggle(K),void 0}}O._37O(K,L),Bq.superClass._33o.apply(this,arguments)}});var Ln=Ed.TableHeader=function(w){var h=this,s=h._view=Ll(1,h),S=h._39o=w.getColumnModel(),u=h.iv;h.tv=h._tableView=w,h._60I=new Yp,h._canvas=Hd(s),s.style.background=n.tableHeaderBackground||"",s.style.height=bk+$h,S.mm(u,h),S.md(u,h),S.mh(u,h),w.mp(function(o){Bg[o.property]&&h.iv()},h),new re(h),h.iv()};$e("TableHeader",E,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",nc,ab,ro,"moveBackground","insertColor",xj,Cb,"resizable","movable"],_checkIcon:xk,_movable:!0,_resizable:!0,_labelColor:n.tableHeaderLabelColor,_labelFont:n.tableHeaderLabelFont,_columnLineColor:n.tableHeaderColumnLineColor,_columnLineVisible:n.tableHeaderColumnLineVisible,_sortDescIcon:n.tableHeaderSortDescIcon,_sortAscIcon:n.tableHeaderSortAscIcon,_moveBackground:n.tableHeaderMoveBackground,_insertColor:n.tableHeaderInsertColor,_indent:No,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(H){return H.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(C){return C.getColor()||this._labelColor},getLabelAlign:function(u){return u._align},onPropertyChanged:function(){this.iv()},_5Q:function(x){this._61I=x,this.iv()},getLogicalPoint:function(c){return Ao(c,this._canvas,this.tv.tx())},validateImpl:function(){var A=this,M=A._canvas,x=A.getWidth(),V=A.getHeight(),E=A.tv,r=A._60I,R=A._61I,p=-E.tx(),z=0;(x!==M.clientWidth||V!==M.clientHeight)&&En(M,x,V),r.clear(),A._39o._roots.each(function(R){if(R.isVisible()){var Y=z+R.getWidth();p+x>=z&&Y>=p&&r.add({column:R,startX:z}),z=Y}});var H=rm(M);if(Dh(H,-p,0,1),H.beginPath(),H.rect(p,0,x,V),H.clip(),H.clearRect(p,0,x,V),r.each(function(T){var w=T.column,l=T.startX,_=w.getWidth();_>0&&(H.save(),H.beginPath(),H.rect(l,0,_,V),H.clip(),R&&R.column===w||A.drawColumn(H,w,l,0,_,V),A._columnLineVisible&&Qf(H,l+_-1,0,1,V,A._columnLineColor),H.restore())}),R){var l=R.column,z=R.startX,J=R.position,s=l.getWidth();H.save(),H.beginPath(),H.rect(z,0,s,V),H.clip(),H.fillStyle=A._moveBackground,H.fill(),A.drawColumn(H,l,z,0,s,V),H.restore(),Oq(H,A._insertColor,J,0,V)}H.restore()},_6Q:function(C){var s=this.tv;return s._31o===C&&s.sm().getSelectionMode()===xb},drawColumn:function(k,L,m,b,g,o){var d=this,j=d.tv,E=hh(L.getIcon()),G=d.getLabelAlign(L);if(d._6Q(L)){var f=hh(d._checkIcon);hk(k,f,m+g/2,b+o/2,L,d)}else{var $=d.getLabel(L),D=d.getLabelFont(L),s=d.getLabelColor(L),H=kr(D,$).width,v=E?d._indent:0;G===Ul?(E&&Me(k,E,ck,m,b,v,o),Fp(k,$,D,s,m+v,b,g,o,Ul)):G===Te?(E&&Me(k,E,ck,m+g-H-v,b,v,o),Fp(k,$,D,s,m,b,g,o,Te)):(E&&Me(k,E,ck,m+(g-H-v)/2,b,v,o),Fp(k,$,D,s,m+(g-H+v)/2,b,0,o,Ul))}if(L.isSortable()&&j.getSortColumn()===L&&(E=hh(L.getSortOrder()===hd?d._sortAscIcon:d._sortDescIcon))){var K=Uh(E,L)/2+2;hk(k,E,G===Te?m+K:m+g-K,b+o/2,L,j)}}});var re=function(x){var I=this;I.th=x,I.tv=x._tableView,I.addListeners()};Qr(re,E,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(O){this.getView().style.cursor=O},handle_mousemove:function(p){if(!Ji){var u=this;delete u._29o,u.setCursor(Mp);for(var i=u.th,L=i._60I,H=i.lp(p).x,M=L.size()-1;M>=0;M--){var k=L.get(M),O=k.column,B=k.startX+O.getWidth();if(i.isResizable()&&y(B-H)<=(jl?10:3))return u._29o=k,u.setCursor(be),void 0;H>k.startX&&B>H&&(u._29o=k),(O.isClickable()||O.isSortable()||i.isMovable()||u.tv.getCheckColumn&&O===u.tv.getCheckColumn())&&H>k.startX&&B>H&&u.setCursor(kk)}}},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(G){var H=this;gh(G),H.tv.endEditing(),H.handle_mousemove(G),H._29o&&(H.x=Ac(G).x,H.lx=H.th.lp(G).x,H.w=H._29o.column.getWidth(),fg(H,G))},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowTouchMove:function(n){var f=this,D=f.th,S=f.getView().style.cursor,A=f._29o,a=Ac(n).x-f.x;if(f.resizing||f.moving||(S===be?f.resizing=1:D.isMovable()&&S===kk&&y(a)>2&&(f.moving=1)),f.resizing)A.column.setWidth(f.w+a);else if(f.moving){var v=f.lx+a;D._60I.each(function(k){var R=k.startX,J=R+k.column.getWidth();if(v>=R&&J>=v){var L={column:A.column,startX:A.startX+a,front:J-v>v-R,insertColumn:k.column};L.position=L.front?R:J,D._5Q(L)}})}},_16Q:function(b,P){var r=this,g=r.tv,j=r.th,h=j._checkIcon;if(j._6Q(b)){var O=hh(h),p=r.lx,N=b.getWidth(),V=Uh(O,b);if(p>=P+N/2-V&&P+N/2+V>=p){j.setCheckIcon(h===Yi?xk:Yi);var I=g.sm(),k=g._rows;return h===Yi?I.rs(k):I.ss(k),g.onCheckColumnClicked(b),!0}}return!1},handleWindowMouseUp:function(b){this.handleWindowTouchEnd(b)},handleWindowTouchEnd:function(O){var Z=this,S=Z.tv,w=Z.th,f=Z._29o;if(Z.moving){var G=w._61I;if(G&&G.insertColumn!==G.column){var C=G.column,D=S.getColumnModel()._roots,s=D.remove(C),o=D.indexOf(G.insertColumn);o>=0&&(G.front||o++,o<=D.size()&&(D.add(C,o),S.getColumnModel()._38I(C,s,o)))}w._5Q(a),delete Z.moving}else if(!Z.resizing&&f){C=f.column;var E=w.lp(O).x,M=f.startX,B=!0;if(w.onColumnClicked){var L=w.onColumnClicked(C,O,M);L===!1&&(B=!1)}if(B&&E>=M&&E<=M+C.getWidth()&&!Z._16Q(C,M)){if(C.isSortable()){var m=S.getSortMode(),W=C.getSortOrder();m===Dq?S.getSortColumn()===C?(W===Ur&&S.setSortColumn(a),C.setSortOrder(W===hd?Ur:hd)):S.setSortColumn(C):"bistate"===m&&(S.getSortColumn()===C?C.setSortOrder(W===hd?Ur:hd):S.setSortColumn(C))}S.onColumnClicked(C,O,M)}}Z._29o=Z.resizing=Z.x=Z.lx=Z.w=a}}),Ed.TablePane=function(H){this.init(new Fb(H))},$e("TablePane",E,{ms_v:1,_44o:1}),Ed.TreeTablePane=function(k){this.init(new od(k))},$e("TreeTablePane",E,{ms_v:1,_44o:1}),Ed.Toolbar=function(s){var V=this,e=V._view=Ll(1,V),q=e.style;q.background=n.toolbarBackground||"",q.height=Td+$h,V._canvas=Hd(e),V._30o=new Yp,V._90I=new Yp,V.setItems(s||[]),e.handleGroupSelectedChanged=function(h){if(h.isSelected()){var C=h.getGroupId();null!=C&&V._items.forEach(function(g){var p=g.element;p&&p!==h&&p.setSelected&&p.getGroupId&&p.getGroupId()===C&&p.setSelected(!1)})}},new lp(V)},$e("Toolbar",E,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Ii,nc,ab,Hl,An,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:n.toolbarLabelColor,_labelSelectColor:n.toolbarLabelSelectColor,_labelFont:n.toolbarLabelFont,_selectBackground:n.toolbarSelectBackground,_itemGap:n.toolbarItemGap,_separatorColor:n.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(L){var y=this.getItemInfoAt(L);return y?y.item.toolTip:a},getLabelColor:function(Q){return Q&&Q.selected&&Q.type!==Yi&&Q.type!==mk?this._labelSelectColor:this._labelColor},onPropertyChanged:function(f){this.iv(),f.property===Ii&&this._items.forEach(function(F){ue(F)})},redraw:function(){this.iv()},addItem:function(l,Q){var W=this._items;Q==a?W.push(l):W.splice(Q,0,l),this.fp(Ii,a,W)},removeItem:function(b){if(b)for(var z=this._items,w=0;w<z.length;w++)b===z[w]&&(z.splice(w,1),this.fp(Ii,a,z))},removeItemById:function(y){if(y!=a)for(var X=this._items,O=0;O<X.length;O++)if(y===X[O].id){var Q=X.splice(O,1)[0];return this.fp(Ii,a,X),Q}},getItemById:function(B){if(B!=a)for(var U=this._items,l=0;l<U.length;l++){var g=U[l];if(B===g.id)return g}},setItemVisible:function(q,T){var k=this.getItemById(q);k&&(k.visible=T)},getItemInfos:function(){return this._30o},getItemInfoAt:function(m){var X=this,k=0,J=X._30o,p=X.lp(m),S=p.x,_=p.y;if(_>=0&&_<=X.getHeight())for(;k<J.size();k++){var W=J.get(k);if(W.startX<=S&&S<=W.endX)return W}return a},drawItem:function(K,Q,O,k,D){if(Q.visible===!1)return 0;if(bi(Q.visible)&&!Q.visible())return 0;var I=this,x=Q.disabled;x&&(K.globalAlpha=sj);var d=I.drawItemImpl(K,Q,O,k,D),e=I._itemGap;return x&&(K.globalAlpha=1),this._currentItem!==Q||"separator"===Q||Q.separator===!0||Q.unfocusable||jd(K,I._separatorColor,O-e/2,0,d+e,k),d},drawItemImpl:function(l,E,H,Y,u){var B=this,L=B._view,p=B._itemGap,x=Y/2,o=E.type,V=E.element,h=E.label;mc(V)&&(h=V,V=a);var w,n=B.getLabelFont(E),q=B.getLabelColor(E),U=E.selected,v=hh(E.icon),m=Uh(v,E),M=0,O=m+(h?kr(n,h).width:0);if("separator"===E||E.separator===!0)return Oq(l,B._separatorColor,H,Y/4,x),1;if(V){v&&hk(l,v,H+m/2,x,E,B),Fp(l,h,n,q,H+m,0,0,Y);var f=Jb(V);u||B._90I.add(f),f.parentNode!==L&&eg(L,f),V.iv&&V.iv(),V.validate&&V.validate();var d=f.getBoundingClientRect(),G=d.width,P=f.style;return ke(f),P.left=B.tx()+H+O+$h,P.top=(Y-d.height)/2+$h,O+G}return o===mk?w=hh(U?qh:pf):o===Yi&&(w=hh(U?Yi:xk)),w?(M=Uh(w,E),hk(l,w,H+M/2,x,E,B),H+=M,O+=M):U&&Qf(l,H-p/2,0,O+p,Y,B.getSelectBackground(E)),v&&hk(l,v,H+m/2,x,E,B),Fp(l,h,n,q,H+m,0,0,Y),O},validateImpl:function(){var i=this,p=i._canvas,D=i.getWidth(),Z=i.getHeight(),x=i._30o,Q=i._items;En(p,D,Z);var N=rm(p),J=i._itemGap,S=J/2;Dh(N,i.tx(),0,1),N.clearRect(0,0,D,Z);var Y=i._90I;i._90I=new Yp,x.clear(),Q.forEach(function(f){var h=i.drawItem(N,f,S,Z);x.add({item:f,startX:S,endX:S+h,width:h}),h&&(S+=h+J)}),Y.each(function(I){i._90I.contains(I)||Bm(I)});var A=i._64I;i._64I=t(0,S),N.restore(),i._stickToRight?(i._65O=0,N=rm(p),S=D-i._64I+J,Dh(N,0,0,1),N.clearRect(0,0,D,Z),x.clear(),Q.forEach(function(j){var W=i.drawItem(N,j,S,Z,!0);x.add({item:j,startX:S,endX:S+W,width:W}),W&&(S+=W+J)}),N.restore()):i.tx(i.tx()),A!==i._64I&&i.onSumWidthChanged(A,i._64I)},onSumWidthChanged:function(){},handleClick:function(r,P){var c=this,D=r.type,f=r.action,z=r.groupId,l=r.selected;r.disabled||(z!=a?l||(r.selected=!0,this._items.forEach(function(g){g.groupId===z&&r!==g&&(g.selected=!1)}),f&&r.action(r,c,P)):D===Yi||"toggle"===D?(r.selected=!l,f&&r.action(r,c,P)):f&&r.action(r,c,P)),xl(),c.iv()}});var lp=function(Z){this.tb=Z,this.addListeners()};Qr(lp,E,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(B){this.handleScroll(B,10*(B.wheelDelta/40))},handle_DOMMouseScroll:function(D){this.handleScroll(D,10*-D.detail)},handleScroll:function(R,$){gh(R);var F=this.tb;F.isScrollable()&&!F._stickToRight&&(F.tx(F.tx()+$),Dk())},handle_mousemove:function(q){var $=this;Ji||$.setItem(q)},handle_mouseout:function(q){var F=this;q.target===F.getView()?F.tb.setCurrentItem(a):F.handle_mousemove(q)},handle_mousedown:function(x){this.handle_mousemove(x),this.handle_touchstart(x)},handle_touchstart:function(l){var W=this,Q=W.tb,v=l.target;Qk(l)&&(v===W.getView()||v===Q._canvas)&&(gh(l),Q.setFocus(l)&&(this.setItem(l,!0),(Q.isScrollable()||W.info&&!W.info.item.disabled)&&(W.x=Ac(l).x,W.tx=Q.tx(),fg(W,l))))},handleWindowMouseMove:function(g){this.handleWindowTouchMove(g)},handleWindowTouchMove:function(n){var I=this,x=I.tb;if(!x._stickToRight){var b=Ac(n).x-I.x;!I._25o&&y(b)>2&&x.isScrollable()&&(I._25o=1),I._25o&&x.tx(I.tx+b)}},handleWindowMouseUp:function(z){this.handleWindowTouchEnd(z)},handleWindowTouchEnd:function(q){var k=this,o=k.tb,D=k.info,f=k.tb.getItemInfoAt(q);if(!k._25o&&D){var A=D.item;f&&f.item===A&&o.handleClick(A,q)}k._25o=k.x=k.tx=a,k.setItem()},setItem:function(B,r){var S=this,h=S.tb,Y=S.info=B?h.getItemInfoAt(B):a,i=Y?Y.item:a;h.setCurrentItem(i),r&&i&&bi(i.onDown)&&i.onDown(B)}}),Ed.BorderPane=function(){this._view=Ll(1,this),this.iv()},$e("BorderPane",E,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(o,m){this._12o("leftView",o),m!=a&&this.setLeftWidth(m)},getRightView:function(){return this._rightView},setRightView:function(U,n){this._12o("rightView",U),n!=a&&this.setRightWidth(n)},getTopView:function(){return this._topView},setTopView:function(R,J){this._12o("topView",R),J!=a&&this.setTopHeight(J)},getBottomView:function(){return this._bottomView},setBottomView:function(p,F){this._12o("bottomView",p),F!=a&&this.setBottomHeight(F)},getCenterView:function(){return this._centerView},setCenterView:function(U){this._12o("centerView",U)},_12o:function(Q,L){var w=this,t="_"+Q,n=w._view,G=w[t];G!==L&&(G&&(G.getView?Bm(G.getView()):Bm(G)),w[t]=L,L&&(L.getView?eg(n,L.getView(),1):eg(n,L,1)),w.fp(Q,G,L))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var S=this,Q=S._topView,U=S._bottomView,s=S._leftView,M=S._rightView,y=S._centerView,Y=S.getWidth(),i=S.getHeight(),x=0,_=0,K=Y,A=i,N=0,j=0,Z=0,m=0;Q&&(N=S._topHeight==a?Eb(Q):S._topHeight,_=N),U&&(j=S._bottomHeight==a?Eb(U):S._bottomHeight,A=i-j),s&&(Z=S._leftWidth==a?Nk(s):S._leftWidth,x=Z),M&&(m=S._rightWidth==a?Nk(M):S._rightWidth,K=Y-m);var X=t(0,K-x),u=t(0,A-_);Q&&Fl(Q,0,0,Y,N),U&&Fl(U,0,A,Y,j),s&&Fl(s,0,_,Z,u),M&&Fl(M,K,_,m,u),y&&Fl(y,x,_,X,u)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);